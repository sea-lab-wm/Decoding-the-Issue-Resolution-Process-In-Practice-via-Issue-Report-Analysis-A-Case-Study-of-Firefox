[
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1482681",
        "issue_id": 1482681,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Regression window: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=e17409c5199c0ade0de9899782d6a9f5f4970871&tochange=6f3907a1da34a62133832dc981e9005ee30e9388 Regressed by: Bug 1362034",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1482681 - Fix load iframe in tab context menu. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "You should add your support file under the specific test rather than [DEFAULT].",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Johann Hofmann [:johannh] has approved the revision.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Bug filed: https://bugzilla.mozilla.org/show_bug.cgi?id=1484735",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1485422",
        "issue_id": 1485422,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1485422 - Add rating stars to CFR \u2014 Details Depends on D4532",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "D4532",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Adam Hillier :ahillier has approved the revision.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "I have verified that the issue is no longer reproducible on Nightly 63.0a1 (20180902220539) and the latest Nightly 64.0a1 (20180923220427) on Windows 10 x64, Mac 10.13.3, and Arch Linux x64.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1486074",
        "issue_id": 1486074,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It turns out -moz-column-span are defined _after_ the logic that processes the alias properties.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1486074 - Move logic for copying aliased properties' fields to the bottom of property_database.js. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Bug 1486074 - Move logic for copying aliased properties' fields to the bottom of property_database.js. Emilio Cobos \u00c1lvarez (:emilio) has approved the revision.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1487135",
        "issue_id": 1487135,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In fact, maybe we should consider allocating AuthorStyles lazily in general, for all the cases when shadow trees don't have styles inside them.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "So that we don't waste a bunch of memory with stuff like <svg:use>. I plan to shrink AuthorStyles further, but this should help regardless, and isn't very complex.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "complex.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Xidorn Quan [:xidorn] UTC+10 has approved the revision.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Pushed by emilio@crisal.io: https://hg.mozilla.org/integration/autoland/rev/752786e0dd01 followup: Add a missing check. r=me",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1494092",
        "issue_id": 1494092,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/c7726ff56cbf",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Unfortunately, removing this code causes the following two reftests to fail: layout/reftests/invalidation/scroll-inactive-layers.html layout/reftests/invalidation/scroll-inactive-layers-2.html These tests check that scrolling doesn't cause repainting of inactive (opacity/transform/filter/mask) layers. Despite the IsInObserverList code being purely for filters, it is the masked element that is repainting on scroll, causing the test failure.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 3,
                "quote": "The relevant change to the code is the removal of the first highlighted block here: https://searchfox.org/mozilla-central/source/layout/svg/nsSVGIntegrationUtils.cpp#328-330,334-341 What seems to happen is that, with the removal of the first `if` block we no longer early return aInvalidRegion. Instead we enter the second `if` block because 'observers' is nullptr (since the nsSVGMaskFrame does not have a SVGFilterObserverListForCSSProp of course) and return the value computed there. Specifically in my testing, before removing the hack we return aInvalidRegion with the values: left 748 top 2104 right 952 bottom 4458 After removing the first `if` block we return: left 748 top 254 right 952 bottom 4459 The much smaller value for 'top' is what makes the difference and cause us to fail.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 4,
                "quote": "The call stack here is: nsSVGIntegrationUtils::AdjustInvalidAreaForSVGEffects mozilla::FrameLayerBuilder::AddPaintedDisplayItem mozilla::PaintedLayerDataNode::PopAllPaintedLayerData mozilla::PaintedLayerDataNode::Finish mozilla::PaintedLayerDataNode::FinishChildrenIntersecting mozilla::PaintedLayerDataTree::FinishPotentiallyIntersectingNodes mozilla::PaintedLayerDataTree::AddingOwnLayer mozilla::ContainerState::ProcessDisplayItems mozilla::FrameLayerBuilder::BuildContainerLayerFor nsDisplayList::BuildLayers nsDisplayList::PaintRoot nsLayoutUtils::PaintFrame mozilla::PresShell::Paint nsViewManager::ProcessPendingUpdatesPaint nsViewManager::ProcessPendingUpdatesForView nsViewManager::ProcessPendingUpdates nsRefreshDriver::Tick Looking at AddPaintedDisplayItem, it seems that what it passes into AdjustInvalidAreaForSVGEffects as the value for aInvalidRegion is: frame->GetVisualOverflowRect() .ToOutsidePixels(appUnitsPerDevPixel); whereas what we return when we fail is: (frame->GetVisualOverflowRect() + aToReferenceFrame) .ToOutsidePixels(appUnitsPerDevPixel) There's clearly a bug in the removed `if` block where it fails to take account of aToReferenceFrame, and that that bug is hiding the fact that even without my change we are *already* invalidating the masked element in the two failing reftests. The only reason that the tests don't actually fail is because the preexisting bug results in the invalid area being offscreen.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 5,
                "quote": "The fact that these tests should already currently be failing makes me think that they shouldn't block removing this old hack. We should remove it and be honest about the state of the tests by marking them as failing (filing a follow-up bug to fix that of course).",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 6,
                "quote": "We should remove it and be honest about the state of the tests by marking them as failing (filing a follow-up bug to fix that of course).",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 7,
                "quote": "This code is no longer necessary since we now invalidate using Display List Based Invalidation instead of using recursive calls up the frame tree. The tests that are marked as failing have only been passing due to a bug in the code that's being removed from nsSVGIntegrationUtils.cpp which coincidentally hides the fact that we are actually invalidating in those tests given their particular structure (which the tests are supposed to be checking we're not doing).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "g).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Matt Woodrow (:mattwoodrow) has approved the revision.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1506200",
        "issue_id": 1506200,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Right?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Yes I agree with you. We can get rid of it.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1506200 - Remove ReadableStream EmbeddingFlags. r?baku,jwalden \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "r?baku for the bits in dom/fetch, r?jwalden for the rest.",
                "code": "CODE_REVIEW_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1509994",
        "issue_id": 1509994,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Historically this code was part of webrtc.org but has since been removed from upstream. Rather than maintaining it as a local diff against upstream, we should just move it to where it is used.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "used.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1509994 - Update gn generated json files; r=pehrsons! \u2014 Details Depends on D13092",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "D13092",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1509994 - Update gn generated json files (part 2); r=pehrsons! \u2014 Details Depends on D13094",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "D13094",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached file Bug 1509994 - Regenerate moz.build files; r=pehrsons! \u2014 Details Depends on D13095",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "D13095",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Phabricator choked on the size of the json update patch and I had to manually split it into two.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1510786",
        "issue_id": 1510786,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "dav1d supports all platforms via C interface. asm is x86 and arm only. awilcox on gwyn [pts/5 Wed 28 17:59] build: meson The Meson build system Version: 0.47.2 Source dir: /home/awilcox/Code/contrib/dav1d Build dir: /home/awilcox/Code/contrib/dav1d/build Build type: native build Project name: dav1d Project version: 0.0.1 Native C compiler: cc (gcc 6.4.0 \"cc (Adelie 6.4.0) 6.4.0\") Build machine cpu family: ppc64 Build machine cpu: ppc64 Dependency threads found: YES Check usable header \"stdatomic.h\": YES Check usable header \"unistd.h\": YES Checking for function \"getopt_long\" : YES Checking for function \"posix_memalign\" : YES Compiler for C supports arguments -fvisibility=hidden: YES Compiler for C supports arguments -Wundef: YES Compiler for C supports arguments -Werror=vla: YES Compiler for C supports arguments -Wno-maybe-uninitialized -Wmaybe-uninitialized: YES Compiler for C supports arguments -Wno-unused-parameter -Wunused-parameter: YES Compiler for C supports arguments -Werror=missing-prototypes: YES Compiler for C supports arguments -fomit-frame-pointer: YES Compiler for C supports arguments -ffast-math: YES Configuring config.h using configuration Program doxygen found: NO Build targets in project: 8 Found ninja-1.8.2 at /usr/bin/ninja awilcox on gwyn [pts/5 Wed 28 17:59] build: ninja [63/63] Linking target tools/dav1d. awilcox on gwyn [pts/5 Wed 28 17:59] build: ninja test zsh: correct 'test' to 'tests' [nyae]? n [1/2] Running all tests. No tests defined. awilcox on gwyn [pts/5 Wed 28 17:59] build:",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Can you please build dav1d alone, in those platforms, and provide the config.h file found in the build directory. Dav1d can be found in [1]. [1] https://code.videolan.org/videolan/dav1d",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "It feels like we could reasonably merge all those config.h files and use appropriate ifdefs.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "I mean, including the ones already in the tree.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "Can you please elaborate more with your idea.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "My idea is to create the content of the file in a string variable, and then create the config file using the GENERATED_FILES[] (plus generation attributes).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "Attached file dav1d-build-bug-ppc64-s390x \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Could you please check if this patch fixes you builds?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "there is a missing colon at the end of the \"elif\" line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "but with that added it builds again and runs",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "Attached file Bug 1510786 - Add configuration header for ppc64 and s390x. r?glandium \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "For the record - I can build FF on ppc64/ppc64le/s390x with the last fix.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1513854",
        "issue_id": 1513854,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The Data Science ticket for the progressive rollout using Feature Gate for Fx 67 is Bug 1533030 I suggest that we use this ticket to enable it by default in Fx 68",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Read Normandy recipes from Remote Settings by default",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "default",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Mike, how should we proceed now that Bug 1538248 landed?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Can we use Feature Gates to enable it for Nightly users? (Leaving the default setting to false) Or shall we set default to false in Nightly only using #ifdef RELEASE_OR_BETA in the prefs file? In terms of QA, I'd imagine that we can take an existing test plan and just add the pref flip parts...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "I thought about this a bit, and realized we have a small bug in how feature gates manage prefs.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I filed (and added a patch for) bug 1541469 for that issue. Once that is done, we should be able to turn this on for Nightly users only by updating the feature definition to have: default-value: default: false nightly: true Then later when we want to turn this on for all channels and let it ride the train, we can update it again to be default-value: true Additionally, QA will be able to test this by setting the pref to true. After bug 1541469 they'll need to add the pref, as it won't exist by default.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=90bd702a3db7f0d9afa762308989f422cc57d17b",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Ciprian, how does it look on the QA side? Mike, does the patch seem ok?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 10,
                "quote": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=4722646312bfab234a14fd3f3d6f654d70b3879e",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "The patch looks good.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Backed out 2 changesets (Bug 1535056, Bug 1513854) for linux build bustages and failed Gecko Decision Task CLOSED TREE https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&selectedJob=244114623 https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=244114623&repo=autoland&lineNumber=36549",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 13,
                "quote": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=cd990ee93c08e87b5351cf3cd086d3b0b306c392",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=d5da6d732eb41b2021e5e893ed94a65392c24327",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Removing the ni? as we signed off on the feature as GREEN.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1514429",
        "issue_id": 1514429,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This has been changed a couple of times aready (bug 602580, bug 919437), but I believe we'll need to change it again to align with Blink, which has settled on reporting the layout viewport dimensions [2]. Their justification for that choice is that we have the VisualViewport API [3] to report the visual viewport dimensions; I think that's reasonable.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I've been looking at this. The getters return visual viewport (nsIPresShell::GetVisualViewportSize) only when the visual viewport is overridden, and return the layout viewport (nsPresContext::GetVisibleArea) otherwise. Setters behave similarly. That means that most of the time we're using the layout viewport. Visual viewport override occurs when Responsive Design Mode is enabled.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "I've been looking at this. The getters return visual viewport (nsIPresShell::GetVisualViewportSize) only when the visual viewport is overridden, and return the layout viewport (nsPresContext::GetVisibleArea) otherwise. Setters behave similarly. That means that most of the time we're using the layout viewport. Visual viewport override occurs when Responsive Design Mode is enabled.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Given that RDM already has bugs regarding the visual viewport, is there a problem with making the change now to make innerWidth and innerHeight ALWAYS use the layout viewport?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "If nsIPresShell::IsVisualViewportSizeSet() returns false, the visual and layout viewports have the same size. So, it is the case that currently inner{Width,Height} always evaluates to the visual viewport size. The only reason we have a condition here [1] is that when nsIPresShell::IsVisualViewportSizeSet() returns false, no one has set nsIPresShell::mVisualViewportSize, so we'd be trying to use an empty size if we called nsIPresShell::GetVisualViewportSize() in that case.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "If we make this change before shipping the Visual Viewport API, we would be depriving page authors of a way to obtain the visual viewport size. If you give some more details about how this is causing a problem for RDM, I may be able to suggest an alternate solution.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I had assumed that a meta viewport tag would change the layout viewport size without affecting the visual viewport, and without setting nsIPresShell::IsVisualViewportSizeSet(), leading to a mismatch. If that is not the case, and IsVisualViewportSizeSet() is equivalent to \"visual viewport may differ from layout viewport\", then I agree there is no problem here.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "In Bug 1504659 I need the actual viewport width. The actual visible amount of the document. I see now that GetVisualViewportSize() returns both the viewable area and the area covered by any visible scrollbars. By subtracting away the area of the scrollbars, I should be able to get what I need. I'll needinfo you (on that bug) if I have trouble.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "I believe the only scenario where we process a meta viewport tag but don't set a visual viewport size, is fixed by this patch. So, with that patch in place, there should be no problem.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "That surprises me. The visual viewport size is set here based on MobileViewportManager::GetCompositionSize(), which subtracts the scrollbar dimensions here.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Attached file Bug 1514429 Part 1: Make window inner size getters and setters exclusively use the CSS viewport. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Brad, what's the status on this bug? I did take a look at failures in the try in comment 9. The failure on test_viewport_metrics_on_landscape_content.html is a case that bug 1508177 didn't handle properly. I am fine with replacing is in question with todo and filing a new bug for that. As for the failure on test_innersize_scrollport.html, I believe it's no longer valid, we can drop it entirely. As for browser_viewport_resizing_after_reload.js, I have no idea what's going on there since I can't run it locally due to bug 1595936, but you are more familiar with the code than I am, so you've already known what we should do?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "I can't figure out the fix for this. The test conflates layout and visual viewports starting at const layoutViewportHeight = window.visualViewport.height; and though I could make the test pass, I don't know how the various comparisons it makes (scrollRect, document.clientBoundingRect) should be handled. I'll add a part to the patch that disables this test.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "The failure happens on this line, we can just replace is with todo_is for now. The content in the test case has minimum-scale=0.5 and a width: 200% element, but the root element height is height: 100%, so the content is shrunk to fit the 200% width to the screen, but nsPresContext.mVisibleArea (i.e. height:100%)is unchanged, so once we return the nsPresContext.mVisibleArea for window.innnerHeight, it's no longer correct, it should be size of the expanded size by the minimum-scale. And of course Chrome does returns the expanded size for window.innerHeight. Brad, would you mind filing a bug for this issue and leave a comment in the todo_is? Oops, a collision happened. I'd prefer to use todo_is instead of disabling whole test.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 16,
                "quote": "Brad, would you mind filing a bug for this issue and leave a comment in the todo_is?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 17,
                "quote": "I think this is a foundational issue that makes several of the comparisons fail.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 18,
                "quote": "The fix for this test is a combination of fixing expectations in the test itself (easy) and fixing the RDM waitForViewportResizeTo function, which is not as easy for me. For that function \"viewport\" really means \"device size\". It looks like the internal state of the viewport React component is affected by scaling and is neither the visual viewport nor the layout viewport. I'll sort that out and then we should have a landable patch.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 19,
                "quote": "This test treats innerWidth as being related to the visual viewport, which is no longer is. The test has no purpose now. Depends on D42940",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "D42940",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "This test attempts to relate the visual viewport, layout viewport, the document scroll rect and the document bounding client rect. Some of the logic here is no longer correct and needs revision. It's also possible that there is a bug revealed in the visualviewport API code. I can't find a simple, logical solution so I opened Bug 1598487 for the fix. Depends on D54350",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "D54350",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Responsive Design Mode sends internal messages for the content size and viewport size. The viewport size used to be reflective of the visual viewport. These changes make it use the layout viewport instead. The viewport is also being used as a stand-in for RDM device size. That needs more investigation since content size and viewport size should be conceptually distinct. This need for clarity is less urgent because the RDM feature is being rebuilt for Fission support, tracked by Bug 1574885. If this issue becomes problematic before Bug 1574885 is landed, then we'll need to open a new bug to resolve it. Depends on D54351",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 24,
                "quote": "D54351",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1515665",
        "issue_id": 1515665,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The reason is that this check <https://searchfox.org/mozilla-central/rev/2e5e28f518524f8af5b158ddb605022b6a2d68cf/dom/storage/Storage.cpp#46> is done using the principal object. Internally this maps to <https://searchfox.org/mozilla-central/rev/232ced2697b8938073fa79b8e6aa3718876c0b69/toolkit/components/antitracking/AntiTrackingCommon.cpp#1225> in the antitracking back-end which is oblivious to the content blocking allow list because it can't walk up the window hierarchy.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1515665 - Ensure that DOM Storage checks the content blocking allow list when performing storage access checks; (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Backed out changeset 338f4fbbfddf (Bug 1515665) for bc failures browser/components/sessionstore/test/browser_339445.js CLOSED TREE Push with multiple failures, storage issue: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=superseded%2Ctestfailed%2Cbusted%2Cexception%2Cusercancel%2Crunnable&revision=3a328e80b02cf3c11a36e060380277396e211cd9&selectedJob=218353178 Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=218353178&repo=autoland&lineNumber=3240 https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=218355469&repo=autoland&lineNumber=10989 https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=218355472&repo=autoland&lineNumber=2054 https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=218351107&repo=autoland&lineNumber=26378 Backout push: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=218351107&repo=autoland&lineNumber=26378",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1515665 - Ensure that we perform localStorage access checks with a window always, and the sessionStorage access checks with a principal always; (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This test (which fails with my patch, as you would expect) makes me believe that mIsSessionOnly means we have a session-only permission, not that the Storage object is a session storage object: https://searchfox.org/mozilla-central/source/dom/tests/mochitest/sessionstorage/test_cookieSession.html I'm super confused by all of this code now...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "I think you should be able to use parts of my patch still, but all of the argument passing through the constructors etc should be changed to ultimately set mIsSessionOnly instead of what it currently does.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch part 1 - partitioned storage renamed (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Here is the scenario I want to fix (I can move this in a separate bug if you think it's better): top-level page is example.com with 2 iframes: tracker.com/inDisconnectedList and tracker.com/notInDisconnectedList the 2 iframes share the same sessionStorage, but they should not. I want to use the same storage class used for localStorage, also for sessionStorage.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Attached patch part 3 - reject_cookie policy (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Attached patch part 4 - tests (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Better wrap the entire block in #ifdef DEBUG.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Ditto.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "This is what we want: when storage access is denied by permissions or cookie-policy, SessionStorage must throw security errors. for normal pages and trackers, sessionStorage must work as usual. In order to achieve this configuration, I need to return ePartitionedOrDeny only when rejectedReason is 'TRACKERS'.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Attached patch part 2 - SessionStorage and ePartitionedOrDeny (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "Attached patch part 3 - tests (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Not green enough on try.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 19,
                "quote": "Finally, a green result. This patch exposed rejectedReason in StorageAllowedForNewWindow. This will be mainly used in the next patches. It also moves the privacy.restrict3rdpartystorage.partitionedHosts check in the localStorage code.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "sessionstorage works when rejectedReason is STATE_COOKIES_BLOCKED_FOREIGN and when StorageAccess is ePartitionedOrDeny",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "No window when restoring a window.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Attached patch part 4 - tests \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "No, you shouldn't make up non-existing errors out of thin air. When you aren't sure why you're rejecting, you're supposed to set rejected reason to 0.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Why not make aRejectedReason a reference here so that you can remove this assertion and the weird dereferences below?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "Ditto.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "Again, minting synthetic rejection reasons isn't allowed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Here too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "This change will break the privacy.restrict3rdpartystorage.partitionedHosts pref for non-trackers... I suppose that is fine, but at the very least you need to document this change in semantics here: https://searchfox.org/mozilla-central/rev/dac799c9f4e9f5f05c1071cba94f2522aa31f7eb/modules/libpref/init/all.js#1403",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Attached patch part 1 - exposed PartitionedOrDeny differently \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1565273",
        "issue_id": 1565273,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Regression window: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=9381b434999bc6f36111d1d307416a1f6d57c84c&tochange=759f043488918654501e945736c825529ea70fa5 Regressed by: 759f043488918654501e945736c825529ea70fa5 harry \u2014 Bug 1562145 - Fix mouse-dragging regression caused by patch to 1554864. r=dao",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "harry, Your patch seems to cause the regression. Can you please look into this?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1565273 - Context menu clicks ignore browser.urlbar.clickSelectsAll pref. Add tests for selectAll behaviour. r?mak \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Sorry to only post a WIP patch for this, but I'm out of office tomorrow. I think this issue only affects Windows, and I've removed the part that would cause the issue. Unfortunately I don't have access to a Windows machine or a VM atm-- maybe someone with one could take a look and see if this patch works and if it causes further issues. This patch also includes tests, but they're WIP and some of them fail/hang the browser. Dao, if you have time, would you mind taking a look to see if there's something obviously wrong with the tests, esp the right-click test? That's the one that hangs. I haven't written too many of these so it might be a beginner's mistake.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Dao, if you have time, would you mind taking a look to see if there's something obviously wrong with the tests, esp the right-click test? That's the one that hangs.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "maybe someone with one could take a look and see if this patch works and if it causes further issues.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "mistake.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "This is outdated, right? The bug affects all the cases where clickSelectsAll is true, I didn't test on Mac the before/after situation though. On linux clickSelectsAll is false, but one can set it to true, and afaict it will work as on Windows. And if I read the patch correctly, we are indeed not making a distinction anymore. Is this correct?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "This bug doesn't affect me on my Mac. I think the bad behaviour is caused by the Windows platform gate (removed in the attached patch), meaning this issue only affects Windows. This bug is independent of the browser.urlbar.clickSelectsAll pref and whether clickSelectsAll happens at all -- it only affects contextmenu clicks, and only the contextmenu handler has the Windows platform gate.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "The Windows platform gate originates here: https://searchfox.org/mozilla-central/source/toolkit/content/widgets/textbox.xml#248. I ported it over to the UrlbarInput contextmenu handler when I was removing the clickSelectsAll behaviour from XUL textboxes. This bug shows that the platform gate now causes issues -- I believe Windows was getting its contextmenu clickSelectsAll behaviour from somewhere else in textbox.xml, and that is now removed.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "With version 68, on Linux if I set clickSelectsAll to false, it doesn't select on contextmenu. It does with CSA set to true. On Windows it does regardless of CSA. With your patch, on all platforms it acts like on Linux, that is not the old behavior. I think the old Windows behavior makes more sense for all the platforms, on right click we should select all regardless of clickSelectsAll.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "FWIW, on GNOME Web, the behavior is what exists currently in Firefox (at least on Linux). Same with Falkon. Chromium does the previous Windows behavior. Safari doesn't place a cursor or perform any selection, it just shows a context menu. I'm not sure that the GNOME Web behavior is desirable (or even designed behavior), but figured I would note it, since I am generally in favor of good platform integration.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Backed out for bc failures on browser_urlbar_selection.js Backout link: https://hg.mozilla.org/integration/autoland/rev/ecee4c970f98a929f5b2795438f5ec57ab3dd6df Log link: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=258514024&repo=autoland&lineNumber=38068",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 14,
                "quote": "I've pushed a new revision to Phabricator that passes try on all platforms: https://treeherder.mozilla.org/#/jobs?repo=try&revision=da2bcef0ca0855637bad7f1e91b796557f7c085d&selectedJob=258793266",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "This was backed out because of frequent failures of Bug 1569813. Push with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&revision=d6d95a998ee92e29376666d918c6b52dfd651917&selectedJob=258879611 https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&selectedJob=258896828&resultStatus=testfailed%2Cbusted%2Cexception&revision=8419292a5c75752f661b0ca7f1d2dde341faa8ce&searchStr=os%2Cx%2C10.14%2Cshippable%2Copt%2Cmochitests%2Ctest-macosx1014-64-shippable%2Fopt-mochitest-browser-chrome-e10s-2%2Cm%28bc2%29 Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=258896828&repo=autoland&lineNumber=4034",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 16,
                "quote": "These test failures on Mac look like they might be fairly involved to solve, so on mak's recommendation I've disabled the new tests on Mac and filed follow-up bug 1570474.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 17,
                "quote": "A new revision with the tests disabled on Mac is now on Phabricator. Here's try with browser_urlbar_selection.js re-run a number of times on Windows and Linux to check for intermittent failure: https://treeherder.mozilla.org/#/jobs?repo=try&revision=76e992ee84aa9e9d2412e8ebe67e8dda6b49e72f",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "I think we should have QA do some testing around this since this is itself a regression from another patch which landed in this code.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 19,
                "quote": "Fixes a regression in URL bar behavior in Fx69. Approved for 69.0b11.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 20,
                "quote": "No worries. Just attach a rolled-up patch for Beta uplift when you're ready to do so and re-request approval (you don't need to fill out the questionnaire again, just setting the flag is enough).",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 21,
                "quote": "Attached patch bug_1565273_beta.diff (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "I removed two console.log statements that snuck their way into the previous patch. I'll prepare a patch removing those statements from Nightly as well.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 23,
                "quote": "Attached file Bug 1565273 - Remove unnecessary console.logs. r?mak \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 24,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "Backed out changeset 209780edbdf9 (Bug 1565273) for browser-chrome failures at browser/components/urlbar/tests/browser/browser_urlbar_selection.js Push with failure: https://treeherder.mozilla.org/#/jobs?repo=mozilla-beta&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=209780edbdf9b660eb86fc50dea6041b3a4f977f Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=259797469&repo=mozilla-beta&lineNumber=4003 Backout link: https://treeherder.mozilla.org/#/jobs?repo=mozilla-beta&selectedJob=259797469&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=1270a56d8bb7f6df12008e24b0e56d3b7cf9a160",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 26,
                "quote": "I tested this issue on Windows 10, and Ubuntu 18.04, using the Nightly build from July 30 (build id 20190730095207) where the issue is reproducible, and I tested it on the latest Nightly from August 5th (build id 20190805095413) where the issue is fixed. Note that I also checked on Mac 10.14 using the latest Nightly, and issue is not reproducible. (based on comment 5) Based on this, I can confirm the issue is fixed. I will also verify this on beta when the fix lands.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 27,
                "quote": "Here's the updated beta diff. The old one was backed out since I used gURLBar.querySelector to fetch the contextmenu, but this behaviour was recently changed. The attached diff uses document.getAnonymousElementByAttribute which works in beta. Here's a green beta try: https://treeherder.mozilla.org/#/jobs?repo=try&revision=cfd9849d1ac79fe07a7ea799d5684c34f0c4aa26&selectedJob=260118746 (there's an opt build failure on Linux -- looks like it's an intermittent? I don't see the specific change in this patch causing a build failure). Because of the previous backouts, Mak could you please take one last look at this patch before I request beta uplift?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "Because of the previous backouts, Mak could you please take one last look at this patch before I request beta uplift?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 29,
                "quote": "Mak messaged me that he's having issues posting on Bugzilla today, but that the patch looks good. I requested uplift -- please see filled-out uplift request in comment 19.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "Fixes a regression in URL bar behavior in Fx69, patch has tests. Approved for 69.0b12, thanks.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 31,
                "quote": "Hi, I tested this issue on Windows 10 and Ubuntu 18.04, using the Beta version 69.0b12 where the issue is indeed fixed. Given that it's fixed on Nightly and Beta, I changed the status of the bug to verified fixed. Best regards, Flor.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1823751",
        "issue_id": 1823751,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "As a Windows person, I cannot replicate the problem.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Ran mozgression and found this push https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=9759c11fa52fe6ae5ddb74767fadb7f93a3464a7&tochange=330c5c6b4f5bd2ba3818e6859d1757023a5ac29a Bug 1798548",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": ":evilpie, since you are the author of the regressor, bug 1798548, could you take a look? For more information, please visit auto_nag documentation.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "I am not a mac developer what I can say is that I am very surprised that this even worked before, because from what I remember this was giving me some kind of error: https://hg.mozilla.org/integration/autoland/rev/330c5c6b4f5bd2ba3818e6859d1757023a5ac29a#l3.12",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Brad do you want to take a look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Well, I can replicate and now that I know which test was the inspiring case for the change,",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "Replicating this in a local build generates this console output: Mozilla has caught an Obj-C exception [NSInvalidArgumentException: Calling -setString:forType: on NSPasteboard or NSPasteboardItem with object of type NSConcreteMutableData instead of NSString.] which seems to indicate that the pasteboard will only accept NSString for the \"public.file-url\" key.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "This change makes PasteboardDictFromTransferable use NSString to store the file url in the NSDictionary, and then when converting to the native pasteboard, check whether we should use the setString method for strings, or the setData method for all other values. This complies with the macOS requirement that NSString content is used for the kUTTypeFileURL key.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "key.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Approved for 112.0b8",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 11,
                "quote": "Reproduced the initial issue using a Firefox 111.0.1 on a macOS 13, and also verified that using the latest Firefox Beta build 112.0b8 and latest Nightly 113.0a1 from today I now can drag drop downloaded files to the desktop without issues. I did noticed that the icons for the dragged files are cropped or very tiny while dragged and not dropped. Once they are dropped the correct icon is displayed for the file, will log an additional bug asap. Will leave this bug as RESOLVED for now and not move it to VERIFIED since Firefox 111 is still affected and maybe will be uplifted there as well.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Logged Bug 1825782 as an enhancement for this.",
                "code": "ISSUE_IMPACT"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1821213",
        "issue_id": 1821213,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Retriggers & backfills point to Bug 1820699 after 45e7b3ea7ae3 landed as seen here.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 2,
                "quote": "Brad, could you take a look at it please? Thank you!",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "It looks like implementing NSWindowDelegate windowWillUseStandardFrame: defaultFrame: in Bug 1820699 has caused the browser windows opened in reftests to be larger than they were before, causing this case to be missed, which makes the reftest harness think that it's not checking all of the pixels. Something like that. There may be a logic relaxation we can do that will make this work again.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Rather, either the browsers are bigger or the enclosing windows are smaller.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "The enclosing window, instead of retaining its expected 800 x 1000 size, is being shrunk to 760 x 960 size, which is 20 pixels taken from each edge, which is a magic number used in Bug 1820699. That shrinking is only supposed to happen when there is a request to put the macOS window in \"normal\" state, but the window appears stuck in \"maximized\" state. The maximized state is determined by the window being very close to the bounds of the screen on which it appears. Since the real screen is larger than 800 x 1000, there's perhaps some screen-spoofing that is done in the reftest harness that makes the window think it is filling the screen.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "Things I'll try: See if there is screen-spoofing, figure out what to do about it. See how the reftest harness is requesting normal state, and make it not do so if the window is already in maximized state. Make the macOS forced shrink not happen in the reftest harness using some other heuristic.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "Attached file Bug 1821213: Make CocoaWindow check its maximized state against the screen maximum size. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1820814",
        "issue_id": 1820814,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We should probably be dispatching the DisconnectIfExists calls to the call thread, so it does not race against the packet events.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1820814: Dispatch these DisconnectIfExists calls to the call thread. r?pehrsons \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1818468",
        "issue_id": 1818468,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1818468 - Throw `signal.reason` when already aborted in `navigator.locks.request` r=evilpie \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1815706",
        "issue_id": 1815706,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This needs to be fixed so that the histograms are only updated when a history entry is clicked. Additionally, Leif suggested we add a counter for total history clicks in a session, which we don't currently have.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "fix sidebar click event handling Add scalar for total number of history entries per session Add test for scalar",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "scalar",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Backed out for causing failures on browser_sidebar_history_telemetry.js backout: https://hg.mozilla.org/integration/autoland/rev/02449d7e49332c534a95afe7def303ba1fcfaff3 push: https://treeherder.mozilla.org/jobs?repo=autoland&selectedTaskRun=PnABZl-MQIOnkiVVQdR2tQ.0&revision=b26a56aab365ebd5590a8145f82d11340defe87f&group_state=expanded failure log: https://treeherder.mozilla.org/logviewer?job_id=406073543&repo=autoland&lineNumber=7447",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 5,
                "quote": "Marco, can you take a look at this since Sarah is away until the 27th?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Pushed by kcochrane@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/99ac48311f47 Update history sidebar telemetry r=mak,mkaply",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Approved for 111.0b5",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 8,
                "quote": "Hello! Reproduced the initial issue with Firefox 111.0b4 on Windows 10x64. Clicking anywhere on the sidebar will increase the PLACES_SEARCHBAR_CUMULATIVE_SEARCHES and PLACES_SEARCHBAR_CUMULATIVE_FILTER_COUNT histogram numbers. The above histograms are no longer increased by clicking on the sidebar with Firefox 111.0b5 from comment 10 and Firefox 112.0a1 (2023-02-23) on Windows 10x64, macOS 11, and Ubuntu 20.04. Also the new keyed scalar for sidebar.link > history number is correctly increased each time a history link is clicked inside the history sidebar.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1811466",
        "issue_id": 1811466,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "[Tracking Requested - why for this release]:Menu hover state is broken due to regression from Bug 1805414 Regression window: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=0c989b2bcd7882a9e7106e7879ab8933c2e09071&tochange=47c002d3637247e71ee901f32421deaecc9d8ea3",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1811466 - Restore menubar activation behavior from before bug 1811466. r=smaug \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Approved for 110 beta 8, thanks.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 5,
                "quote": "Reproduced this issue on an affected Nightly build from 2023-01-20 ON Win 10, using the STR from Comment 0. Verified as fixed on Firefox 111.0a1 (20230131093335) and 110.0b8 (treeherder build - 20230130164457) on Windows 10 and Ubuntu 22.04. I have verified this issue on Ubuntu with Light and Dark theme enabled. System theme does not have a visible hover effect on the menu bar items and for this issue I have filled Bug 1814079.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1809080",
        "issue_id": 1809080,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": ":cpeterson, since you are the author of the regressor, bug 1781960, could you take a look?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Because of the mentioned patch, the getter here doesn't return the same value as before: https://searchfox.org/mozilla-central/rev/d62c4c4d5547064487006a1506287da394b64724/toolkit/components/pdfjs/content/PdfStreamConverter.jsm#386 and consequently we don't catch the wheel events anymore: https://github.com/mozilla/pdf.js/blob/067d3b70aa46e1b2a3dff768c36ff5ba670407f2/web/app.js#L2631-L2641 So we need have a way to guess that ctrl+wheel is coming from a pinch.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file pr 15907: Fix pinch-to-zoom on a macbook trackpad (bug 1809080) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1809080 - Pinch-to-zoom in pdf viewer when using the trackpad on Mac r=#pdfjs-reviewers,RyanVM \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Approved for 109.0rc2, thanks.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 8,
                "quote": "Reproduced the issue with Firefox 110.0a1 (2023-01-08) on macOS 11.5. PDF toolbar is also zoomed when using pinch to zoom on a PDF. The issue is verified fixed with Firefox 110.0a1 (2022-01-12) and Firefox 109.0RC2 (20230112150232) on macOS 10.15, 11.5, and 12. PDF toolbar is no longer zoomed in and the PDF can be successfully zoomed out when using pinch to zoom on a PDF while using a trackpad.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1794406",
        "issue_id": 1794406,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1794406 - Report more specific error messages when buffer.mapAsync fails. r=jgilbert,jimb \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1794237",
        "issue_id": 1794237,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "All the crashes come from the GPU process and it seems to be specific to 32-bit builds. There's a wide range of hardware in the crashes (both different device and GPU vendors) so it looks like this isn't a device-specific issue.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "The bug is linked to a topcrash signature, which matches the following criterion: Top 10 AArch64 and ARM crashes on nightly For more information, please visit auto_nag documentation.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Jamie and I spoke about this yesterday, and he is hinting that OOP WebGL will likely have to be disabled because of the issues that are arising (like this). I'll emphasis this with him today.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "I'll disable it for beta but keep OOP-webgl enabled on Nightly, in the hopes that a user will come forward with a crashing URL to help us diagnose the crash.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "The UniformData call accepts a Range<uint8_t>. When serialized by ClientWebGLContext, however, the data is only serialized to the alignment of the supplied uint8_t type. The HostWebGLContext may then alias it to a Range<uint32_t> or similar, while the data was only aligned to 1-byte alignment. On some platforms such as ARM, these unaligned accesses can cause a SIGBUS. As a temporary workaround, we will now pessimistically align such ranges as if they might be accessed as any possible data type with kUniversalAlignment.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "nment.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Backed out for causing multiple WebGL related failures.",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 8,
                "quote": "Pushed by lsalzman@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/4bf6c23773ea Ensure worst case alignment of UniformData Range when serialized. r=jgilbert",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Oops, that aspect was fixed in bug 1797347.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 10,
                "quote": "This was accidentally left enabled by the previous patch, since XP_LINUX is true on Android. We must therefore use defined(XP_LINUX) && !defined(ANDROID) instead, as we did prior to enabling OOP webgl on Android in the first place.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "place.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Follow-up patch in Bug 1797347 uplifted to 107. It will be included in Fenix/Focus 107.0b6. Setting 107 fixed on this bug, but will monitor Fenix/Focus 107.0b6 stability.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1792203",
        "issue_id": 1792203,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1792203 - Add gtest coverage for AsyncBlockers r?nika! \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1792203 - Immediately resolve AsyncBlockers when no blocker are registered r?nika! \u2014 Details Depends on D158025",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "D158025",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "The severity field is not set for this bug. :jld, could you have a look please? For more information, please visit auto_nag documentation.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "I'm getting some weird asan issue: https://treeherder.mozilla.org/logviewer?job_id=394095938&repo=try&lineNumber=12188",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Backed out for causing Gtest failures. Backout link: https://hg.mozilla.org/integration/autoland/rev/77643f3c53d4e7316174f9a220a5aae9fb965ddb Push with failures: https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=b597f145ec5933fbbc8f11130b0b4cadd31832b6&selectedTaskRun=HI3ooE0mQzu1suJQQ7USKQ.0 Failure log: https://treeherder.mozilla.org/logviewer?job_id=394180955&repo=autoland&lineNumber=4520",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 8,
                "quote": "Pushed by alissy@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/119c65339140 Add gtest coverage for AsyncBlockers r=nika https://hg.mozilla.org/integration/autoland/rev/d9048386628e Immediately resolve AsyncBlockers when no blocker are registered r=nika",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Backed out for causing gtest failures. Push with failures Failure log we also got the time out followed by this crash: https://treeherder.mozilla.org/logviewer?job_id=394287507&repo=autoland&lineNumber=11515 Backout link",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 10,
                "quote": "The crash reports started because of bug 1797104: Now gtest timeouts trigger and report a crash stack (I hope that's helpful!).",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 11,
                "quote": "Looks like death gtest is behaving non intuitively on macOS especially in opt and others gtest looks to be avoiding this",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 12,
                "quote": "Pushed by alissy@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/05e994e8e3b5 Add gtest coverage for AsyncBlockers r=nika https://hg.mozilla.org/integration/autoland/rev/5e334e2e3906 Immediately resolve AsyncBlockers when no blocker are registered r=nika",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1790543",
        "issue_id": 1790543,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The assertion also rejects (non-frozen) dense elements on the prototype chain, even though those are actually allowed.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "allowed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Bugmon Analysis Verified bug as reproducible on mozilla-central 20220912214055-b66bbbcc4467. The bug appears to have been introduced in the following build range: Start: 747c206e4fd85e5ef30f5290872fde2204105c61 (20220912124208) End: 1e48e6bda87186e8bef21870b7039f4f4f915007 (20220912124713) Pushlog: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=747c206e4fd85e5ef30f5290872fde2204105c61&tochange=1e48e6bda87186e8bef21870b7039f4f4f915007",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Bugmon Analysis Verified bug as fixed on rev mozilla-central 20220913154221-26065fde0af4. Removing bugmon keyword as no further action possible. Please review the bug and re-add the keyword for further analysis.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1778644",
        "issue_id": 1778644,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This doesn't happen when CTW is disabled. My guess (not yet verified) is that when the table is added to the tree, it is considered a layout table, but it then mutates such that it's not a layout table. We aren't handling that mutation correctly.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This will probably be fixed by pushing a cache update for layout-guess if children are added or removed from the table.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1778644: When a row is added to a table, push a cache update for the table's layout guess. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1774026",
        "issue_id": 1774026,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is a purely speculative attempt to fix bug 1772839. The theory being perhaps that due to the EGL Surface being current, eglDestroySurface does not detach it from the Android Surface. This would cause the subsequent eglCreateWindowSurface to fail as the Android Surface is still attached.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "attached.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "For the record this is what we used to do with layers: CompositorOGL::Pause called GLContextProviderEGL::ReleaseSurface(), which called eglMakeCurrent(EGL_NO_SURFACE, EGL_NO_SURFACE, EGL_NO_CONTEXT). But then again, we also used to silently ignore the error when we couldn't create a surface, so it's possible the root cause of bug 1772839 has existed for years.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "It's definitely too early to tell definitively whether this has worked, but there's been no crashes on nightly in the 24h since it shipped. Let's uplift to beta.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "A couple crashes have come in on nightly since this patch landed, so it doesn't appear to have worked.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1769748",
        "issue_id": 1769748,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It could still be that we are getting IsShutdown() while starting the process, and then this is no different than bug 1769624",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "From https://treeherder.mozilla.org/jobs?repo=try&revision=15f854fcde646992c271cd6cf43b8b3a7fb67f5e: seems like it's not a shutdown issue seems like it's not intermittent",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "It looks like this has become perma.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Could you take a look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Weird. According to https://treeherder.mozilla.org/jobs?repo=try&revision=75b643d11393c983fc10833139f301dd5b35787a even RDD decoder does not work on try for that platform. However, a local build running on a win10-64 VM is able to perform audio decoding on both RDD or Utility",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Attached file Bug 1769748 - Disable dynamic code mitigation on MinGW64 builds r?bobowen! \u2014 Details Depends on D146639",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "D146639",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1769254",
        "issue_id": 1769254,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Reason: EXC_BAD_ACCESS / KERN_INVALID_ADDRESS",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "I can reproduce this crash with SWGL enabled after accelerated Canvas2D bug 1773712 landed. However, this crash bug is not a regression from that Canvas2D bug because the Canvas2D change landed today and this crash bug was filed a month ago. I bisected the crash with my STR to this pushlog with Canvas2D bug 1773712: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=ec7e694733a0dc3d956b6a3ea3a323fc1d41264c&tochange=5c16ac03eca7a366057cb2ac7a6f376f98dd8bf0",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "[Tracking Requested - why for this release]: Kelsey, this crash is a regression from canvas color space bug 1703654. Since accelerated Canvas2D bug 1773712 just enabled the gfx.canvas.accelerated pref, I bisected my crash STR again with that pref force-enabled and landed on this earlier pushlog for canvas color space bug 1703654: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=88a64ff079e144ce530a7f3121244604c29ddf92&tochange=f2d46bb91c9ddd9e6b43c315be70917b334d52a0",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 4,
                "quote": "The crashes are gated to nightly build, so no need to track for 102 and 102ESR, but we should track for nightly as this is a top crasher on macOS and we should decide rapidly on backing out or not bug 1773712 on Nightly.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "The STR I found required the accelerated canvas be enabled (bug 1773712). But this crash signature started in Nightly 102 before the accelerated canvas was enabled and we still have some crash reports from Beta (and DevEdition) 102. Example: bp-cf91cbe1-d3c6-4c54-ba60-59fc70220613 So there may be other STR that hit this same crash without the accelerated canvas. I bisected the original crash to bug 1703654, which landed in Nightly 102.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "I believe this is from wr::RenderMacIOSurfaceTextureHost* texture = aExternalImage->AsRenderMacIOSurfaceTextureHost(); MOZ_ASSERT(texture); <- I bet this is the issue, and that we would crash here if we did MOZ_RELEASE_ASSERT mTextureHost = texture; gfx::IntSize oldSize = mSize; mSize = texture->GetSize(0); <- crashes here",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 7,
                "quote": "I tried this STR, setting gfx.webrender.software and gfx.canvas.accelerated to true, but I don't get a crash.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "My hunch is that the SharedSurfaceIO is not keeping alive the MacIOSurface long with out-of-process WebGL, so it exports a SurfaceDescriptor from GPU process to content process, then back to GPU process for WebRender, but in that gap, for some reason, the SharedSurfaceIO goes away, so that when the MacIOSurfaceTextureHostOGL goes to create it from the SurfaceDescriptor for WebRender, it is already gone, so we end up with a null IOSurface that is causing these crashes downwind.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "Summarizing my findings: My STR crashes on this build with a clean profile when gfx.webrender.software and gfx.canvas.accelerated are true: mach mozregression --launch 5c16ac03eca7a366057cb2ac7a6f376f98dd8bf0 --pref \"gfx.webrender.software:true\" \"gfx.canvas.accelerated:true\" -a \"https://results.enr.clarityelections.com/CA/Contra_Costa/114138/web.285569/#/summary\" But doesn't crash on the same build if gfx.webrender.software or gfx.canvas.accelerated are false: mach mozregression --launch 5c16ac03eca7a366057cb2ac7a6f376f98dd8bf0 --pref \"gfx.webrender.software:true\" \"gfx.canvas.accelerated:false\" -a \"https://results.enr.clarityelections.com/CA/Contra_Costa/114138/web.285569/#/summary\" mach mozregression --launch 5c16ac03eca7a366057cb2ac7a6f376f98dd8bf0 --pref \"gfx.webrender.software:false\" \"gfx.canvas.accelerated:true\" -a \"https://results.enr.clarityelections.com/CA/Contra_Costa/114138/web.285569/#/summary\"",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Lee, I can reproduce this SWGL crash again (using the STR in comment #1) now that gfx.canvas.accelerated has been re-enabled in bug 1773712. bp-43999729-23c4-40db-ab68-930260220806",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 11,
                "quote": "I hit this saving an edited (pdfjs.annotationEditorMode=0) PDF to PDF in yesterday(?)'s nightly on macOS.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 12,
                "quote": "I've hit this four times while using Google Maps over the last two days.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 13,
                "quote": "Sotaro, any ideas here?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 14,
                "quote": "100% repro visiting starlink.sx",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 15,
                "quote": "Attached file Bug 1769254 - Check for null texture host. r?aosmond \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Problem seems to exists at canUpdate check in AsyncImagePipelineManager::UpdateImageKeys(). It could not detect TextureHost change from MacIOSurfaceTextureHostOGL to ShmemTextureHost with same format and size. It happened when accelerated canvas was fallback to sw canvas.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 18,
                "quote": "Attached file Bug 1769254 - Add TextureHost type check for using update in AsyncImagePipelineManager::UpdateImageKeys() \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Reproduced this issue on an affected Nightly build from 2022-05-13 using the STR from Comment 1, on macOS 10.15. Verified as fixed on Firefox 105.0b5 (20220830185924) on the above OS.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1769085",
        "issue_id": 1769085,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Gist below shows the stub usage in test https://gist.github.com/punamdahiya/8c9922a4acea3ace1c753dc44fb85199 With this Stub usage in 'browser_privatebrowsing_about_nimbus_messaging.js, intermittent failure was seen in browser_privatebrowsing_focus_promo.js due to not able to show promo https://treeherder.mozilla.org/jobs?repo=try&author=pdahiya%40mozilla.com&selectedTaskRun=abpWjvG5TlWQI2NdJIOEDg.0&searchStr=Linux%2C18.04%2Cx64%2CWebRender%2Casan%2Copt%2CMochitests%2Cwith%2Csoftware%2Cwebrender%2Cwith%2Cfission%2Cenabled%2Ctest-linux1804-64-asan-qr%2Fopt-mochitest-browser-chrome-swr-fis-e10s%2Cbc2 If stub calls are changed to spy , intermittent failure below is seen for different tests on linux in private browsing browser_privatebrowsing_localStorage.js , browser_privatebrowsing_noSessionRestoreMenuOption.js, browser_privatebrowsing_protocolhandler.js A promise chain failed to handle a rejection: Could not get children of file(/tmp/tmp9c8f4krj.mozrunner/settings/main/ms-images) because it does not exist - stack: (No stack available.) https://treeherder.mozilla.org/logviewer?job_id=377220226&repo=autoland&lineNumber=19988 https://mozilla.slack.com/archives/G90HG2UQH/p1652141301328679?thread_ts=1652119806.446959&cid=G90HG2UQH",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Fix of https://bugzilla.mozilla.org/show_bug.cgi?id=1759214 should help with below error seen due to issue around remote images cleanup A promise chain failed to handle a rejection: Could not get children of file(/tmp/tmp9c8f4krj.mozrunner/settings/main/ms-images) because it does not exist - stack: (No stack available.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1769085 - Fix PBM tests to handle opening Spotlight \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1768744",
        "issue_id": 1768744,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1768744 - Add aria-current to active theme button. r=dao \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1764716",
        "issue_id": 1764716,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "GetIndexOfArgument() doesn't yet support CallFlags::FunCall, so when we inline the Array constructor through Function.prototype.call, use CallFlags::Standard instead. This is the only place where CallFlags::FunCall can be passed through to GetIndexOfArgument(). Changing GetIndexOfArgument() to support CallFlags::FunCall isn't straight forward, because the argument indices are different depending on whether or not this is an inlined or non-inlined Function.prototype.call.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "all.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Bugmon Analysis Verified bug as reproducible on mozilla-central 20220414092955-6c55ba30c858. The bug appears to have been introduced in the following build range: Start: 85290d18c6eeab2c1b741e2c92d2b6eaa252a7d5 (20220412213655) End: 4f936f5e57c8e7c6b25d95e167a4480cbd61fc46 (20220413180638) Pushlog: https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=85290d18c6eeab2c1b741e2c92d2b6eaa252a7d5&tochange=4f936f5e57c8e7c6b25d95e167a4480cbd61fc46",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Bugmon Analysis Verified bug as fixed on rev mozilla-central 20220414214512-d8f67ac43580. Removing bugmon keyword as no further action possible. Please review the bug and re-add the keyword for further analysis.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1762292",
        "issue_id": 1762292,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "emcminn, with bug 1762488 patch adding zap for any Localized, this bug should just be activating zap, e.g., hero_text: { zap: true, \u2026",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1762292 - Turn on Zap for hero text r=mviar \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Improvements: Ratio Test Platform Options Absolute values (old vs new) 9% welcome ContentfulSpeedIndex macosx1015-64-shippable-qr cold fission webrender 1,942.00 -> 1,775.92 7% welcome ContentfulSpeedIndex macosx1015-64-shippable-qr fission warm webrender 1,822.58 -> 1,686.33 For up to date results, see: https://treeherder.mozilla.org/perfherder/alerts?id=33748",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Hello Emily! Could you help figure out which of the two patches (this one or 1762290) corresponds to the performance improvement for the alert posted above ? Thank you!",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Hi Alex! I've chatted with my team a bit and the only thing we can come up with is that the perf improvement may be coming from https://phabricator.services.mozilla.com/D142709; which changed the about:welcome background image to a 3kb .svg (the previous image was a 103kb .avif). These patches were all stacked and landed together, which could explain why the alert is showing up here instead. (Oddly D1422709 has a regression attached to it.) I'll make a note here if I come across anything new.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This enhancement was part of the work done on QA-1448 for which we sent a Preliminary checkpoint. Considering this I am marking it as Verified.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1762088",
        "issue_id": 1762088,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We keep getting this pattern of properties that have a set of joint and disjoint flags, and copy-pasting or writing the same parsing and serialization code in slightly different ways. container-type is one such type, and I think we should have a single way of dealing with this, thus implement deriving for various traits for bitflags, with an attribute that says which flags are single vs mixed. See docs and properties I ported. The remaining ones I left TODOs with, they are a bit trickier but can be ported with some care.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "container-type is one such type, and I think we should have a single way of dealing with this, thus implement deriving for various traits for bitflags, with an attribute that says which flags are single vs mixed.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "care.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Two noteworthy details that may seem random otherwise: Moving values around in nsStyleDisplay is needed so that the struct remains under the size limit that we have to avoid jumping allocator buckets. All the test expectation churn is because tests depend on container-type: size parsing to run, and now they run. Tests for the relevant bits I implemented are passing, with the only exception of some container-name-computed.html failures which are https://github.com/w3c/csswg-drafts/issues/7181. Safari agrees with us there. Other notes when looking at the spec and seeing how it matches the implementation: container syntax doesn't match spec, but matches tests and sanity: https://github.com/w3c/csswg-drafts/issues/7180 container-type syntax doesn't quite match spec, but matches tests and I think it's a spec bug since the definition for the missing keyword is gone: https://github.com/w3c/csswg-drafts/issues/7179 Depends on D142418",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "D142418",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1761994",
        "issue_id": 1761994,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Break the sum out into the component parts",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Break the sum out into the component parts",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "parts",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1761826",
        "issue_id": 1761826,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1761826 - Enable disallowing relaxing referrer policies. r?#anti-tracking-reviewers \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1761435",
        "issue_id": 1761435,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1761435 [Wayland] Store only move-to-rect popup size r?emilio \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1753765",
        "issue_id": 1753765,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Replaced preprocessor includes with CSS imports Removed .inc from CSS files names where all preprocessor code was removed.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "removed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Backed out changeset c83c8662c973 (Bug 1753765) for causing bc failures on browser_parsable_css.js. Backout link Push with failures Failure Log",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 4,
                "quote": "This is flagging up conditionals in panelUI.inc.css.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 5,
                "quote": "You could either fix that here or just add a * to the jar.mn entry for the panelUI.inc.css file in the shared jar.mn, so that it gets preprocessed and the conditions in there continue to work.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 6,
                "quote": "Pushed by bigiri@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/a6d7a4d3a374 Remove preprocessor includes from Customizeable PanelUI r=dao",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1751919",
        "issue_id": 1751919,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Reason: EXCEPTION_ACCESS_VIOLATION_READ",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1751919 - Crash in [@ mozilla::dom::SessionHistoryEntry::ReplaceWith]. r?smaug! \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "97 was merged to release, moving the request over.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 5,
                "quote": "Low-risk crash fix, approved for 97.0rc2.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1751721",
        "issue_id": 1751721,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This will allow users to use gallery view with the web client for Zoom in Firefox.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Firefox.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "There's a r+ patch which didn't land and no activity in this bug for 2 weeks. :aosmond, could you have a look please? If you still have some work to do, you can add an action \"Plan Changes\" in Phabricator. For more information, please visit auto_nag documentation.",
                "code": "CODE_REVIEW_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1748902",
        "issue_id": 1748902,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1748902 - Add test for Uncatchable Size Callback Exceptions, and Handle Size Callback Uncatchable Exceptions. r?saschanaz \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1748376",
        "issue_id": 1748376,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1748376 - Enable more wpt page-name tests with the proper pref. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1742770",
        "issue_id": 1742770,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I've prototyped a new libfuzzer-based fuzzing target that uses dom::ipc::StructuredCloneData as its entry point to cover the StructuredCloneReader code that is browser-only. The target code has not landed on mozilla-central yet, if you need it to reproduce (in case stack + test attached do not suffice), please let me know.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Nika, should we validate and handle this error in the PrincipalInfo::TNullPrincipalInfo case in mozilla::ipc::PrincipalInfoToPrincipal instead? I can try to come up with a patch.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "That's a great idea! Thanks for doing this, I imagine we'll find some useful bugs.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Yeah, we should definitely validate that we're getting a valid moz-nullprincipal: URI when deserializing a null principal from PrincipalInfoToPrincipal. It'd be nice if we could validate more than just the moz-nullprincipal scheme as well, though I suppose that'll be more work. Every valid moz-nullprincipal URI is currently created in NullPrincipal::CreateURI and so follows the pattern of moz-nullprincipal:{uuidhere-edae-4733-9a29-99abcace2a48} with an optional ?https://precursor.spec query at the end. that being said, it occurs to me that we might want to include more validation in general when serializing & deserializing URIs, as right now the process might have some validation holes (potentially which this process will help us find!)",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1742770 - Properly validate URI for null principals. r?nika \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1733898",
        "issue_id": 1733898,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1733898: Support pagination when downloading a test262 pull request. r=mgaudet! \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1732739",
        "issue_id": 1732739,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1732739 - Enable session change handling of window occlusion on Windows for nightly and early beta \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1728953",
        "issue_id": 1728953,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1728953 - Remove unused flag from nsXULPrototypeCache. r?kmag! \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1718748",
        "issue_id": 1718748,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Regression range: This is a regression: pushlog: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=152fdda295bb5f6658d65c2bc48bc6aae499b526&tochange=b873d938120e2cfac6ba3332c663b503dc45d17e possible regressor: Bug 1717077",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "It seems that mozregression pointed out Bug 1717077 for causing this regression.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Can you please take a look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Otherwise nothing invalidates for the potential theme change that it causes on GTK / macOS with dark-mode enabled.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "enabled.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "I managed to reproduce the issue using Nightly from 2021-06-30 on Ubuntu 18.04 x64. I retested everything on Latest Nightly 92.0a1 and Firefox 91.0b7 using the same os. The issue is not reproducing anymore. However there is a bit of a delay on beta that is not reproducing on Nightly.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1718031",
        "issue_id": 1718031,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1718031 - Intermittent [tier2] TV toolkit/components/nimbus/test/browser/browser_remotesettingsexperimentloader_remote_defaults.js \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1717682",
        "issue_id": 1717682,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1717682 - Newtab Pocket layout for compact 4 card layout (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1717682 - Pref and implementation for compact 4 card row layout for Pocket newtab. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1716655",
        "issue_id": 1716655,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Unable to reproduce bug using build mozilla-central 20210613214113-f531f12e5c35. Without a baseline, bugmon is unable to analyze this bug. Removing bugmon keyword as no further action possible. Please review the bug and re-add the keyword for further analysis.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "nsDocumentViewer::mDocument ends up null because Destroy() is called as a result of nsGlobalWindowOuter::SetNewDocument failing because of the AncestorsAreCurrent check: https://searchfox.org/mozilla-central/rev/d6188c9ce02efeea309e7177fc14c9eb2f09db37/dom/base/Document.cpp#13026-13030 https://searchfox.org/mozilla-central/rev/d6188c9ce02efeea309e7177fc14c9eb2f09db37/layout/base/nsDocumentViewer.cpp#1888 https://searchfox.org/mozilla-central/rev/d6188c9ce02efeea309e7177fc14c9eb2f09db37/dom/base/nsGlobalWindowOuter.cpp#2089-2091 Just bail out if we don't have a document when creating the print presentation, as that presentation won't be shown either way.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "way.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1715838",
        "issue_id": 1715838,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is very similar to how we implemented the new print preview with print.tab_modal.enabled [1]. If the pref is true, taking a screenshot should bring up the new screenshots UI (maintained as a browser component). If false, we should operate with the current setup. We'll have to add the pref to StaticPrefList.yaml, similar to the printing pref [2]. Then, in the places where we usually make calls to the screenshots extension UI [3] [4], we should notify the observers if the pref is false. As a reference, here is how the printing service would accomplish that: https://searchfox.org/mozilla-central/rev/2c991232499e826e46f9d976eb653817340ba389/toolkit/components/printing/content/printUtils.js#38-43,342-343",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1715838 - Creates preference for new screenshot components. r?emalysz \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1706916",
        "issue_id": 1706916,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1706916 - Land some in-tree docs for TRR r=#necko,nhnt11 \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1705768",
        "issue_id": 1705768,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1705768 - Update dom/ipc/tests/JSWindowActor/browser_contentWindow.js to pass with Fission+BFCache, r=kmag \u2014 Details Depends on D111403",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "D111403",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1705327",
        "issue_id": 1705327,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Recommandation from UX is to not show this bar, so remove it.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Backed out for failures on browser_pdfjs_notification_close_on_navigation.js backout: https://hg.mozilla.org/integration/autoland/rev/b0887ad1341fa9e85b7bfd4bcf007cc912937aac push: https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&revision=a802bfb0918178fc4599cf39de344ce3c4648ae3&selectedTaskRun=IO-hloKBQBWZD0Uu1NAy6g.0 failure log: https://treeherder.mozilla.org/logviewer?job_id=336718237&repo=autoland&lineNumber=2707",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 4,
                "quote": "Pushed by cdenizet@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/0851da1d6c1d Remove infobar notification from pdf viewer r=bdahl",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Backed out for causing mochitest plain failures Backout link: https://hg.mozilla.org/integration/autoland/rev/120aba36a06e7ae6dbd608e7791b139f25f01878 Push with failures Failure log",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 6,
                "quote": ":sandor, I don't think this failure is related to the patch I landed. When I open log and then I open the job for this log I get: https://treeherder.mozilla.org/jobs?repo=autoland&revision=089fd9e33fe26d5b4215692f84493b2026a071f2&selectedTaskRun=GMMNMWOlQAOVLTGhebnXYg.0 I can see this failing job: https://treeherder.mozilla.org/jobs?repo=autoland&selectedTaskRun=AGz6wbbxRfm3ynvhBgtYug.0 but its name 16-089fd9e33fe2-bk seems to indicate again an issue with the above patch.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 7,
                "quote": "Could you fix that please ?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "That log is from where we discovered the failures. You can see in this range,that the test under your patch are green and they are starting to fail after your patch https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=success%2Ctestfailed%2Cbusted%2Cexception%2Crunning%2Cpending%2Crunnable&fromchange=a00cdb29df1f9c9939332094c15c89026f31eb66&searchStr=linux%2C18.04%2Cx64%2Cdebug%2Cmochitests%2Ctest-linux1804-64%2Fdebug-mochitest-plain-e10s%2C16&tochange=089fd9e33fe26d5b4215692f84493b2026a071f2&group_state=expanded&selectedTaskRun=AGz6wbbxRfm3ynvhBgtYug.0 The name is from the backfilling action task. it shows from what change set the backfill started. You can read about this feature here",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 9,
                "quote": ":sandor, ok I understand the backout. I'm pretty sure that this patch is not the real culprit since it just aims to remove an infobar from pdf reviewer and there nothing related to text selection here.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 10,
                "quote": "So there is something wrong with tests here: https://searchfox.org/mozilla-central/source/dom/base/test/mochitest.ini I just disabled the two tests related to pdf and I got the same error: https://treeherder.mozilla.org/jobs?repo=try&revision=49d1a46d59b564305924db02204f038f53f673d7 So my patch is not the root cause of the regression but just highlights something wrong. This test: https://searchfox.org/mozilla-central/source/dom/base/test/test_pdf_print.html loads a bad pdf and so two (??) infobars are displayed. So my patch implies that these infobars aren't displayed anymore (the innerHeight property isn't the same). Since I can reproduce locally, I made a try in keeping only pdf tests and test_user_select in the mochitest.ini and of course everything runs fine !? so something else is wrong. Using luck and dichotomy, I managed to get similars errors with test_user_select with this basic mochitest.ini: [test_meta_viewport_fixed_width_and_zero_display_width.html] [test_user_select.html]",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": ":botond, would you have an idea here ?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 12,
                "quote": "I can reproduce the failure with those two tests run in sequence, and it certainly looks weird visually (as if the whole harness page briefly zooms in, although I'm not seeing an actual change to the resolution that would result in that).",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "I will try to get to the bottom of it, but if you need a quick fix in the meantime, moving the test_meta_viewport_* tests into their own subdirectory should help.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 14,
                "quote": "Investigation so far shows that, at the beginning of test_user_select.html, the top-level content window (the one containing the mochitest harness) has a nonzero scroll position. That scroll seems to come from here. Not sure yet why the previous test affects whether or not that happens.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 15,
                "quote": "Seems to be related to test_meta_viewport_fixed_with_and_zero_display_width.html changing layout.css.devPixelsPerPx via scaleRatio() here. This does cause the whole test harness to zoom in, albeit using full-zoom rather than resolution.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 16,
                "quote": "Ok, so the logical fix seems to be to pair this call to pushPrefEnv() (which changes layout.css.devPixelsPerPx) with a corresponding call to popPrefEnv() at the end of the test. However, this does not seem to have the desired effect. While the device pixel ratio is changed back to 60, and we get e.g. a call to AppUnitsPerDevPixelChanged() for it, the visible area of the root content document's pres shell remains stuck at a size corresponding to the old ratio, and while the root content doc does get reflowed, it's reflowed into this stale size. I'm not sure what is supposed to trigger the updating of the pres shell's visible area and a reflow to the correct size after the device pixel ratio changes. cc'ing Emilio in case he has some ideas. Perhaps changing layout.css.devPixelsPerPx, which is an action that affects the mochitest harness document itself, is not a well-behaved thing for a mochitest to be doing in the first place?",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 17,
                "quote": "Pushed by cdenizet@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/45376b7c2ff5 Remove infobar notification from pdf viewer r=bdahl",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Looks low risk, has tests and baked a few days on nightly, approved for 89 beta 5, thanks.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 19,
                "quote": "Verified as fixed using the latest Nightly 90.0a1 and the latest Firefox 89 beta 9 - the PDF Infobar notification has been removed. Verified on macOS BigSur 11, Ubuntu 20.04, and Windows 10.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1705253",
        "issue_id": 1705253,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This test has a part where it expects AXMenuOpened events for context menus, which are not observable for us when native context menus are used. It also has a part where it inspects the accessibility-exposed contents of a context menu. This is not testable with native context menus either, so that part of the test needs to be disabled.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "disabled.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1704164",
        "issue_id": 1704164,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "componentWillMount on ASRouterUISurface runs after first paint - we need to ensure the css variable for the background color is set prior to first paint.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This prevents a white flash in about:home in dark mode. Particularly obvious with the skeleton UI enabled. I don't see a reason why we need to do this on pageshow, if we start doing it on DOMContentLoaded, given that we listen for theme change events anyway.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "anyway.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1703558",
        "issue_id": 1703558,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1703558 - fix UITour available targets accountStatus state with proton enabled, r?jaws \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1689742",
        "issue_id": 1689742,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1689742 - Stop using XUL <deck> for #setDefaultPane. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1688325",
        "issue_id": 1688325,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "ni=emilio in case he's up for taking a look, since he just landed a fix for related bug 1686606.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "We don't have any padding on textareas by default. I see the same behavior on other themes. We could certainly add some (Chrome seems to have 2px padding by default). But this doesn't seem like a non-native theme specific thing, unless I'm missing something?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Hmm -- on Ubuntu and MacOS, I do indeed see that there's no padding by default. However, on Windows (where most of our users are), there does seem to be 2px of padding, in the default theme on Firefox release. (screenshot coming up). So we probably don't want to regress that; and given that it seems webcompat-friendly (per Chrome's behavior), maybe we should adopt it as our cross-platform standard behavior in the new non-native theme?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This matches other browsers, and the default themed textareas on Windows too. To be landed after the soft freeze, just in case, of course.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "course.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Backed out for causing failures on browser_inplace-editor_maxwidth.js. Backout link: https://hg.mozilla.org/integration/autoland/rev/31462a8e07406103e8d97b19faf9af3bd63530b6 Push with failures: https://treeherder.mozilla.org/jobs?repo=autoland&selectedTaskRun=E9eyDlOnQi6c4aq97GSfGw.0&revision=64682b454ac62a9ad7bccedd3efce40e1dab29ae&searchStr=dt Failure log: https://treeherder.mozilla.org/logviewer?job_id=327674911&repo=autoland&lineNumber=4367",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 7,
                "quote": "Pushed by ealvarez@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/f2cef92ec339 Make textarea default padding 2px on all platforms. r=dholbert,jdescottes",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1686238",
        "issue_id": 1686238,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Merge day is next Monday, please get the fix for this landed this week (together with bug 1685768).",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "patch pushed here which should fix 1686164",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "This bug and bug 1685768 are still observed with today's central-as-beta simulations.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached file Bug 1686238: Only attempt to traverse containers menu if containers are enabled and defined r?yzen \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "The issue affects both devedition and beta. Beta example: https://treeherder.mozilla.org/jobs?repo=try&revision=87bdd775f40f00139a5f19a998293964b5280b5e&selectedTaskRun=LXjVf98IS3CAJrWwEwQA8w.0",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 7,
                "quote": "Pushed by mreschenberg@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/767c22222bec Only attempt to traverse containers menu if containers are enabled and defined r=yzen",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1686219",
        "issue_id": 1686219,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This clears or sets every bit, taking care not to set trailing unused bits at the end of storage.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "storage.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Previouly this used SpiderMonkey's BitArray, but that's not public. BitSet performs the same function. Depends on D101775",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "D101775",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "This moves the chunk metadata to the start of the chunk and defines the data structures in the public header. This simplifies accessing this data and removes the need for hardcoded offsets. Requesting review from jandem for JIT updates. Depends on D101776",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Requesting review from jandem for JIT updates.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "01776",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1683093",
        "issue_id": 1683093,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1683093 - Remove MCompare::determineCompareType. r?jandem \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1683093 - Remove Compare_Bitwise. r?jandem \u2014 Details Depends on D100012",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "D100012",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1683093 - Remove Compare_DoubleMaybeCoerce. r?jandem \u2014 Details Depends on D100013",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "D100013",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1677183",
        "issue_id": 1677183,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Related to our ability to flip Y",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1677183 - Implement WebGPU's Queue.copyExternalImageToTexture. r=jgilbert \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Here's what I ended up thinking about CORS: Only DOM element objects have CORS. Both DOM element objects and non-DOM objects have \"origin-clean\" flags. In Gecko, we implement origin-clean via isWriteOnly, where origin-clean IFF !isWriteOnly. See https://html.spec.whatwg.org/multipage/canvas.html#the-image-argument-is-not-origin-clean for how CORS becomes origin-clean = false. See https://html.spec.whatwg.org/multipage/canvas.html#security-with-canvas-elements for how this propagates. In particular: All bitmaps start with their origin-clean set to true. The flag is set to false when cross-origin images are used. The value of the origin-clean flag is propagated from a source canvas element's bitmap to a new ImageBitmap object by createImageBitmap(). Conversely, a destination canvas element's bitmap will have its origin-clean flags set to false by drawImage if the source image is an ImageBitmap object whose bitmap has its origin-clean flag set to false. I think we might have some of our CORS checks wrong, but I want to think more about it. But this is unblocked and good to land.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Backed out for causing mochitest failures on test_queue_copyExternalImageToTexture.html Backout link Push with failures Failure log 1 // Failure log 2",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 6,
                "quote": "Pushed by nsilva@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/746fbd28a600 Implement WebGPU's Queue.copyExternalImageToTexture. r=jgilbert,jimb,emilio",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1666607",
        "issue_id": 1666607,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Tyson says it's hit frequently, and that this number is what it usually is, not random uninitialized memory.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Bugmon Analysis: Unable to reproduce bug using the following builds: mozilla-central 20201016032518-c0f6b814ea1d mozilla-central 20200922154306-81d47e620007 Removing bugmon keyword as no further action possible. Please review the bug and re-add the keyword for further analysis.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Bugmon Analysis: Unable to reproduce bug using the following builds: mozilla-central 20201109215349-6659b306f585 mozilla-central 20200922034742-fa0bf905d4cb Removing bugmon keyword as no further action possible. Please review the bug and re-add the keyword for further analysis.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": ":jimm, this issue is frequently hit by fuzzers, is there someone available to have a look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Looks like mRotation is just not initialized.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "It was added in bug 1653166 by Matt. Matt can you look into this?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Attached file Bug 1666607 - Set initial valuye for mRotation. r?jrmuizel \u2014 Details Depends on D99741",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "D99741",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1662097",
        "issue_id": 1662097,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1662097 - QM_TRY/QM_TRY_VAR cleanup functions should have access to tryTempResult; r=#dom-workers-and-storage-reviewers \u2014 Details Depends on D88764",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "D88764",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1661727",
        "issue_id": 1661727,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In order to drive homepage remediation through the CFR/messaging. We need to set up an action that remedates the page away from custom domains. The use case here would be as follows I have search.com as my homepage CFR tells me to switch I click CFR My homepage is now set to a search-only default experience Here's a little fake Schema that is meant to just describe requirements name: SET_HOMEPAGE params: { home: one of 'default', 'blank', <url> newtab: one of 'default', 'blank', <url> layout: <optional, specified to update layout of default page> one of 'search_only' or 'standard' } We could get fancy and make the layout parametric for different layouts (ie, topSiteRows: 5) or whatever, but that seems like follow up here.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1661727 - Messaging System action to allow configuration of the new tab page \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This enhancement was part of the work done on PI-789 that was signed off as GREEN. Considering this I am marking this as Verified.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1654383",
        "issue_id": 1654383,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This removes the need to do some conversions and simplifies the code a little. Drive by remove an assert which is already covered by a switch statement containing a MOZ_ASSERT_UNREACHABLE in ChromiumCDMParent.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "ent.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Backed out for bustages on GMPTypes.h Backout link: https://hg.mozilla.org/integration/autoland/rev/65bce61606aad1a5c472c5275e9502c77f5dc878 Log link: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=311176641&repo=autoland&lineNumber=18211",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 4,
                "quote": "Ah, good ole X11 defines [0]. Looks like the problem is we get X11 headers which #define Status int and then when we compile the ipdl files we include the CDM headers which have an unscoped enum named Status that gets turned into enum int : uint32_t which breaks building the ipdl protocols[1]. We're able to use types from the CDM headers in other ipc[2]. I'm not 100% clear on what exactly is going on with the build. Chromium have updated their headers so the enum causing us problems here no longer exists.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 5,
                "quote": "Re-pulling the headers may be an easier way to fix this than messing with the build. It certainly is from my perspective.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 6,
                "quote": "Re-pulling headers may not work, as I see there exist at least one other Status enum that continues to exist after the update. I wonder if the #define trampling here but not in the other files is a product of the unified build boundaries. Going to be on PTO shortly, holding NI for when I'm back.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Suggestion to self when I return to this is to create a header that contains the CDM header, but ensures Status is undefined. We already do this in GMPUtils [0], we can just shift that into a unified build friendly header so that we can use the CDM symbols without breaking the build in different contexts. Gfx does similarly for X11 [1]. Alternatively we could find what's dragging X11 headers into the unified build and fix that. In some ways that seems more ideal, but I don't know how to quickly do that, and the above seems like a more pragmatic use of time.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 8,
                "quote": "There's a r+ patch which didn't land and no activity in this bug for 2 weeks. :bryce, could you have a look please? For more information, please visit auto_nag documentation.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "Pushed by bvandyk@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/9ba10704b7e3 Replace GMPEncryptionType with cdm::EncryptionScheme. r=alwu,dminor",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1651593",
        "issue_id": 1651593,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Is there any reason to skip the check?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Thanks for catching this! I don't think there is a good reason to skip the check. I will submit a patch for that.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1651593 - Check the return value of db::GetKnownBodyIds(); \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1651332",
        "issue_id": 1651332,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I could have use apz.allow_zooming but using a separate pref means we can flip the pref to check if the new scrollbar code is the source of a regression. Also I haven't tested the code on Fenix at all, so we can disable it there for now.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "now.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1651332. Update scrollbar attrs to use visual viewport offset. r?kats \u2014 Details Depends on D82684",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "D82684",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Now that layout places the scroll thumbs at the visual viewport offset instead of the layout scroll position we need to update how the compositor adjusts them. Depends on D82685",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "D82685",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "The scrollbar is now positioned using the visual viewport offset, so we need to update when that changes. Depends on D82686",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "D82686",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "We already have relative updates (they use a base offset and compute the difference from that to get the offset to apply) but they only seem to know about layout scroll positions. Ideally these two would be merged. We need to communicate with apz to do the scroll because we need to update the visual viewport offset (apz is in charge of that), and usually we need to smooth scroll to the new offset. Depends on D82687",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "D82687",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "I'm having trouble making sense of that last patch. Can you provide more context in this bug as to what kind of problem that patch is solving? In general it's also good to link this bug to the other ones (presumably 1639450 and 1642500) that this work supports and describe what kind of problems this bug is solving or how these patches help those bugs.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "The last patch is basically to make clicking in the scrollbar track outside of the scrollthumb \"work\", so it's pretty close to bug 1639450. Clicking in the scrollbar track usually does a page scroll via nsSliderFrame::PageScroll. This eventually ends up in ScrollFrameHelper::ScrollBy where turn the request from a relative one (\"scroll by a page\") into an absolute one (\"scroll to this position\"). This page scroll is typically a smooth scroll and is currently done on the main thread/layout side. Once we start scrolling the visual viewport offset with the scrollbars we can no longer do this purely on the layout side, we at least need the help of the compositor side. I think the simplest way to do this is to hand the scroll request off to the compositor and have it handle the whole thing. Now we need to consider the following situation: user clicks scrollbar track to page scroll, smooth scroll gets partway complete on the compositor, user clicks again on scrollbar track for a further page scroll. The main thread can't send an absolute scroll offset update request to the compositor at this point because it has outdated information (it needs a 'starting position' to add the page scroll offset amount) so it'll end up scrolling to the wrong place. It has to send a relative scroll offset update. We already have a mechanism to send relative scroll offset updates. It is implemented by sending a base scroll offset and the desired scroll offset, and then on the compositor send the difference between those two is computed and then added to the scroll offset. I used a new mechanism (so called \"pure relative\") that just sends a relative offset update without any absolute scroll positions. The reason I did this is because the existing relative scroll offset update mechanism is not aware of visual viewport offsets, but rather only layout scroll position. For example, here https://searchfox.org/mozilla-central/rev/8d55e18875b89cdf2a22a7cba60dc40999c18356/layout/generic/nsGfxScrollFrame.h#446 the value we use for the base scroll offset (mApzScrollPos) is set to the layout scroll position. It may be entirely reasonable to make this existing mechanism vv offset aware, but I wanted to implement something to get it working with a smaller chance of regressions to things that already exist and work. We could unify these two mechanisms either before or after landing this bug by either: 1) making the existing relative scroll update mechanism work with vv offsets and using it for this bug, 2) moving the existing relative scroll offset updates consumers to the new \"pure relative\" way. assumes that there isn't a good reason to encode relative scroll offset updates as the difference between two scroll positions that I missed. So there are a couple of open questions there. Is a purely relative scroll offset update a good idea? Should we move to the pure relative way? Or to the existing difference between absolute scroll offsets way? And how much of that work is what we want to do right now vs follow ups.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 13,
                "quote": "In the long term I think we'll want to handle this on the APZ side, the way we do scrollthumb dragging. But that might be a bit complicated so for the short term doing it on the main thread seems like a reasonable option. And we might need the main-thread mechanism even in the long term as a fallback if there are cases we can't handle in the compositor.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Seems reasonable, yes.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "The existing mechanism for sending smooth scrolls to the compositor lives in ScrollFrameHelper::ApzSmoothScrollTo and involves setting mApzSmoothScrollDestination to the scroll position at the end of the smooth scroll. Currently that is (I believe) a layout viewport position, and only ever used for deduplicating smooth scroll requests, but in theory it should be possible to have it be a visual viewport position, and then use it as a \"base\" for computing a new destination in the case of multiple consecutive page scrolls. I'm not saying we should do this, since I'm not sure offhand if the complexity/error-prone-ness of this approach will be more or less than what you have now. But I just wanted to mention it as a possible alternative solution.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Ok. Seems like we have a lot of different options here for future consolidation :) One thing I just thought of that we might want to do regardless of which option we do is introduce a new type so that we can distinguish between layout-viewport scroll offsets (e.g. mApzScrollPos) and visual-viewport scroll offsets. That might make things a little less error-prone, and might have saved you some time during your investigations.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "I don't think there is. At least, I just looked at all the places FrameMetrics::mBaseScrollOffset gets used and it seems to always be in combination with either FrameMetrics::mScrollOffset or FrameMetrics::mSmoothScrollOffset. So in theory we could just have mScrollOffset or mSmoothScrollOffset hold the \"pure relative\" value and use the mIsRelative flag to know that it's a relative value rather than an absolute value.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Yeah, I don't know the answers here, but if you have a working solution now I'm inclined to get that landed first. Then we should add a test or two to cover the situation these patches fix, and then look at followups that improve the code structure without regressing the tests.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Oh, maybe I was wrong. There's the use at https://searchfox.org/mozilla-central/rev/af5cff556a9482d7aa2267a82f2ccfaf18e797e9/gfx/layers/FrameMetrics.h#268 which I think can't be supported if we just have a pure relative offset in the metrics.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "After updating my tree and testing with the new patches the smooth scroll animation sometimes stops on the first frame because it hits this line https://searchfox.org/mozilla-central/rev/1b95a0179507a4dc7d4b0c94c2df420dc1a72885/gfx/layers/apz/src/AsyncPanZoomController.cpp#725 looking into why that is.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 21,
                "quote": "The problem seems to be webrender specific: when starting an APZ animation we will get sample times that have large non-monotonic jumps in them regularly: 0x13db6f000 AsyncPanZoomController::StartAnimation mLastSampleTime 13.079496 0x13db6f000 AsyncPanZoomController::UpdateAnimation mLastSampleTime 11.261767 0x13db6f000 AsyncPanZoomController::UpdateAnimation mLastSampleTime 13.096266 mLastSampleTime comes from two different sources, either GetFrameTime() or WebRenderBridgeParent::SetAPZSampleTime. The WebRenderBridgeParent::SetAPZSampleTime ones seem to be the problem. This causes us to scroll to the right place but instantly instead of smoothly when it happens. This clearly does not seem like an issue with these patches but it would be good to resolve it before landing because otherwise these patches would regress the smooth scrolling for any users with webrender and zooming turned on (it happens even if you never pinch zoom though).",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 22,
                "quote": "Filed bug 1653796 for that issue.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1647930",
        "issue_id": 1647930,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1647930 - Create urlbar.update2 prefs. r?adw \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I verified this issue using 82.0a1 (2020-09-14) on macOS 10.13 and Windows 10 x64.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Adrian could you help me with Ubuntu verification?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Verified on Ubuntu 18.04 64-bit, the update2 prefs are disabled on non-Nightly builds.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1645527",
        "issue_id": 1645527,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1645527 - P1 AssociateApplicationCache should be sent in PHttpChannel::OnStartRequest, r=mayhemer \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "We're going to send OnStartRequest via PHttpBackgroundChannel, anything sending via PHttpChannel before OnStartRequest would be a race. https://phabricator.services.mozilla.com/D49773#inline-303635 This link implicates that OverrideReferrerInfoDuringBeginConnect is fine just before OnStartRequest. To reduce the racy and number of IPCs, I move the referrer info overridden to HttpChannelParent::OnStartRequest. Depends on D79579",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "D79579",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1644719",
        "issue_id": 1644719,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1644719 - Add a new API that tells us if SUMO is unreachable. r=prathiksha (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1644719 - Add a new API that tells us if SUMO is unreachable. r=prathiksha (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1644719 - Add basic functionality to display offline support pages when SUMO is unreachable from certerror pages. (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "We are manually downloading support content using support.mozilla.org's KB end-point and shipping them in Firefox here. There are plans to ship a script in Firefox to automate this process. Offline support content is displayed when users cannot access the SUMO website by clicking on \"Learn More...\" links from cert and net error pages. For example, if a user has a clock issue rendering certificate errors whenever they try to access a website in Firefox, we display an offline support page in place of a certerror on the SUMO website.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Backed out changeset a96912059b4c (Bug 1644719) for causing failures in browser_all_files_referenced.js CLOSED TREE Push with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&selectedTaskRun=ZUkMNrmeTRWp5TemkWDvew.0&resultStatus=testfailed%2Cbusted%2Cexception&revision=a96912059b4c1bffe46e8160c055ffd05ff44bea Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=317173348&repo=autoland&lineNumber=2227 https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=317175191&repo=autoland&lineNumber=3062 Backout: https://hg.mozilla.org/integration/autoland/rev/1ac1b37d394e0c7bf03805c1fee7440a67b52b9e",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached file Bug 1644719 - Add basic support to display offline support pages when SUMO is unreachable. r=prathiksha \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Backed out for causing failures on browser_aboutCertError_offlineSupport.js. Backout link: https://hg.mozilla.org/integration/autoland/rev/eb0ac0c5c2150c70a90cf8da9a31a373f46ef73f Push with failures: https://treeherder.mozilla.org/jobs?repo=autoland&selectedTaskRun=G0wjMr2uRoaHv5Je1_HD4g.0&revision=2c4c902ee034512d97ea7638fecb31be175db470&searchStr=os%2Cx%2C10.14%2Cwebrender%2Cdebug%2Cmochitests%2Ctest-macosx1014-64-qr%2Fdebug-mochitest-browser-chrome-e10s%2Cbc7 Failure log: https://treeherder.mozilla.org/logviewer?job_id=337143791&repo=autoland&lineNumber=3041",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 12,
                "quote": "Pushed by prathikshaprasadsuman@gmail.com: https://hg.mozilla.org/integration/autoland/rev/435434f6e0ba Add basic support to display offline support pages when SUMO is unreachable. r=prathiksha,desktop-theme-reviewers,harry",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1640135",
        "issue_id": 1640135,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Adding another attribute for dFPI seems reasonable and is quite cheap, we should probably consider doing this.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I think we already settled that FPI and dFPI should be mutually exclusive, right? I.e., if you enable one, the other is disabled. Then in bug 1637516 we'd like to move the keying from top-level registrable domain to site. If we did that on top of mFirstPartyDomain it would contain a different value based on which of FPI or dFPI is enabled. That probably works, but starts getting confusing. (Migrating FPI to site is being considered as well, but is much more complicated as it already shipped.) Also, dFPI will be impacted by follow-up projects to Fission eventually where there is a desire to hide values from processes the process would not otherwise have access to, i.e., the top-level site (when its referrer policy is \"no-referrer\"). We don't have to tackle that now, but that would also impact this key and not having it impact FPI in addition would probably make that easier. Then in discussions we've considered adding even more keying for non-storage state, though that would likely require another attribute whichever way we go.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1640135 - P1: add new attribute for dFPI; \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1640135 - P2: add new setter; \u2014 Details Depends on D77914",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "D77914",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached file Bug 1640135 - P3: implement new setter; \u2014 Details Depends on D77915",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "D77915",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Attached file Bug 1640135 - P4: update usage of PartitionKey; \u2014 Details Depends on D77916",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "D77916",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Attached file Bug 1640135 - P5: update tests; \u2014 Details Depends on D77917",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "D77917",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1637897",
        "issue_id": 1637897,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We need to enable this pref to allow the DOM cache in insecure context when this test runs in Fission.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Fission.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1634650",
        "issue_id": 1634650,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I have some idea how whitelisting suffixes could look like: Pref could be something like browser.fixup.suffixwhitelist.yoursuffix, so all searches which end with .yoursuffix would be considered as URLs. Additionally, if pref is set to, for example browser.fixup.suffixwhitelist.local.domain, searches which end with .local.domain would be considered as URLs, but searches ending on just .domain won't be. For extensions API for whitelisting TLDs, there are more approaches: If an extension requires host permission (in the manifest) for specific domain/URL, automatically treat that URL as whitelisted domain/suffix. For example, if extension requires *://*.bit/*, automatically treat all searches ending with .bit as whitelisted suffixes, and if extension requires *://*.local.domain, treat searches ending with .local.domain as URLs. The benefit is that it doesn't require changing most of the extensions. However, the problem with this is that it is not really configurable. But much configuration is probably not really needed here, because if extension wants to access websites on some suffix, we can assume that that suffix contains websites. Providing another manifest permission similar to host permission, which is only used to tell Firefox that specific suffix should be whitelisted. The advantage is that it is more configurable. Disadvantages are that the extension would need to be updated to start using it, and would probably result in duplicated configuration/permissions (you would need to set both normal host permission and this new \"suffix permission\" in manifest). And in most, if not all, cases, separate configuration probably won't be needed. Exposing API to JavaScript in some way. The advantage is that it is dynamic. Disadvantage is also that is dynamic, which means that is is probably harder to handle it, and can also cause security and usability problems. And probably also results in duplicated configuration.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Of those three approaches, I most like first, because it doesn't result in too much configuration and can work with existing extensions.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "We should implement the whitelist prefs here, For clarity I think we should go with browser.fixup.domainsuffixwhitelist.yoursuffix (I would have preferred a more readable name but that train left so we're stuck with this). By default we should whitelist the reserved TLDs from bug 1634592. It may be useful to also have a policy. I don't think we can add suffix providers as prefs though, we'd need an updated list in the product, like the PSL, to support an high number of suffixes, we don't have such a list. A WebExtension API is an interesting idea, but honestly it should be filed separately. I must note though that currently the isDomainWhitelisted API we use is synchronous and it would not cope well with the async WebExt API, thus someone should either fix all the isDomainWhitelisted call points (not trivial) or figure out an API that just updates an in-memory list asynchronously, and accept that some hits may fail. Though can't WebExt already intercept traffic? If so it looks like it would be possible to redirect it already. Anyway, please file any WebExt request apart, we don't have the resources to do it here.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "I guess either policies or a WebExt API as requested in bug 1635062 may be useful to setup suffixes collections. Atm we don't have the resources in the Search team to look after those, hopefully the community can pick up those items and provide solutions that would be nicer than autoconfig.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1634650 - Add whitelisting of domain suffixes for URIFixup. r=harry \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Backed out changeset 57d78ba110be (bug 1634650) for marionette failures in migration/tests/marionette/test_refresh_firefox.py. CLOSED TREE Log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=301214468&repo=autoland&lineNumber=55936 Push with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&revision=57d78ba110be3a6db82c7ed4b43c4d0220c8c24a Backout: https://hg.mozilla.org/integration/autoland/rev/9d97dc6359a52aebe9655bfa6a3171320871b240",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 8,
                "quote": "Backed out changeset 57d78ba110be (bug 1634650) for marionette failures in migration/tests/marionette/test_refresh_firefox.py. CLOSED TREE Log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=301214468&repo=autoland&lineNumber=55936 Push with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&revision=57d78ba110be3a6db82c7ed4b43c4d0220c8c24a",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 9,
                "quote": "The problem is I don't see anything in test_refresh_firefox.py that may be affected by my changes...",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "Ok I see the retriggers, I'm totally puzzled, I think some timing changes made an intermittent a bit more frequent, for now I don't have other ideas.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "It must be a crash happening due to some timing changes, we can't exclude this isn't the same failure with different outcomes, due to the code changes in the last 2 months.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 12,
                "quote": "It must be a crash happening due to some timing changes, we can't exclude this isn't the same failure with different outcomes, due to the code changes in the last 2 months. My changes should only affect page loads starting from user input, and afaict there's nothing like that in this test. Without any kind of stack though I wonder how we can figure out anything, and this is also an intermittent, there are green runs on and after my push. It seems to only affect Linux 18.04 x64 shippable opt, that makes me think if we can't get a useful stack, we may have to skip-if = os == \"linux\" && bits == 64 && !debug, but of course I'd prefer to find what's up.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "Interesting. I wonder if this might be something related to bug 1607713, which is a high intermittent crash with the \"new\" Ubuntu 18.04 jobs.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 14,
                "quote": "Maybe we could try to run the Marionette job with the old 16.04 image on try and check if the test passes fine there with a couple of retriggers. I would assume we have to add a worker setting like for our puppeteer jobs to the Marionette Taskcluster configs.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 15,
                "quote": "So, we are in testResetEverything. The restart we crash on is apparently the one after the first checkProfile. One thing I don't understand, by looking at a PASS log, is why after the first self.checkProfile(expect_sync_user=True) and the restart, I cannot find traces of the second self.checkProfile(has_migrated=True, expect_sync_user=True), I instead see a TEST-PASS just after the restart. For example, looking for the string \"services.sync.username\" in the log, I see it set by self.createProfileData() and then get by the first self.checkProfile(expect_sync_user=True), then I don't see it again, but the second self.checkProfile call should get it again, it's like we don't run the second checkProfile at all.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 16,
                "quote": "I downloaded the build and tried to run the test on Ubuntu 18.04, I was never able to crash it. I'll file a separate bug for it and likely disable on that platform there, we'll have to figure out why there's no minidump, and whether this is related to bug 1607713. But There's no change I can do to the patch to avoid this, afaict.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 17,
                "quote": "I'll file a separate bug for it and likely disable on that platform there, we'll have to figure out why there's no minidump, and whether this is related to bug 1607713.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 18,
                "quote": "I'll do a Try push with those lines removed and annotate the results in bug 1636706",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1630806",
        "issue_id": 1630806,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Changes since last update: #11800 Remove any mention of Gitpod from the README (issue 11732) #11809 Update Prettier to version 2.0 #11806 [api-minor] Fix the return value of PDFDocumentProxy.getViewerPreferences when no viewer preferences are present (PR 10738 follow-up) #11810 A couple of small String.fromCodePoint improvements (PR 11698 and 11769 follow-up) #11805 Always skip over any additional, unexpected, RSTx (restart) markers in corrupt JPEG images (issue 11794) #11813 Suppress browser autofill on page number",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1630806 - Update pdf.js to version 2.5.95. r=bdahl \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1629902",
        "issue_id": 1629902,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1629902 - Use nsICookieManager.getCookiesSince() to get cookies in PurgeTrackerService.jsm. r?ewright! \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1626111",
        "issue_id": 1626111,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1626111 - Fix two variable names in Matrix4x4TypedFlagged::TransformAndClipBounds. r=bas \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1624268",
        "issue_id": 1624268,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We introduce a flag HasStoragePermission' in Bug 1616788 which represents whether the document has the storage permission. This flag has to be updated when we add storage permission.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "There is one thing that is unclear to me. I don't know if we need to update the hasStoragePermission flag in different tab when we grant the storage permission for a given tracking origin. Let's say, we grant the storage permission for the tracker.com which is loaded under the example.com. If there is another tab that has the same structure, example.com embeds tracker.com. Does the storage permission be considered as granted for the tracker.com in this tab? Or it should take effect after this tab reloads.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Does the storage permission be considered as granted for the tracker.com in this tab? Or it should take effect after this tab reloads.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Baku and steve, could you provide insight on this?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "According to our discussion, the storage in one tab doesn't have to reflect the storage permission grant from the other tab who has the same configuration. We would expect users to refresh the tab to really get their storage updated in this case. So, we don't really need to update the hasStoragePermission for the other tab.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Per discussion with Dimi, we don't really need to update the 'hasStoragePermission' flag when allowing the storage access since the 'StorageAccessGranted' cache will handle the updating situation. So, we change this bug to implement using the 'hasStoragePermission' flag to check the storage permission.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "We need to check the HasStorageAccessGranted() in the channel version of the ContentBlocking::ShouldAllowAccessFor(). It's because we will move to use the flag 'HasStoragePermission' to check the permission. But, this flag won't get updated if the storage is allowed by the heuristic. So, we need to rely on the HasStorageAccessGranted() to check the storage access in the channel check as well.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "well.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "We need the 'hasStoragePermission' flag for calculating the HasStorageAccess() value. Right now the setting of the flag is later than the calculation. So, we move the setting before the calculation. Depends on D71031",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "D71031",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "We move to use the 'HasStoragePermission' flag to check the storage permission. For the storage permission check of windows, the flag would come from the WindowContext. For the check of channels, the flag would come from the loadInfo of the channel. Depends on D71032",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "D71032",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "As we change to use the 'HasStoragePermission' flag, there are some code became uncessary. This patch removes those code. Depends on D71033",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "D71033",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Backed out 4 changesets (Bug 1624268) for causing brwoser-chrome failure at toolkit/components/antitracking/test/browser/browser_partitionedSharedWorkers.js Push with failure: https://treeherder.mozilla.org/#/jobs?repo=autoland&selectedJob=298095356&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=d58da2438eee32708ab04a2a2313c9d6a5d27fbe Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=298089873&repo=autoland&lineNumber=50228 Backout link: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=0c70ad5623dc33fc7af66625ebcde34bd73f984e",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 16,
                "quote": "Pushed by tihuang@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/601005e66807 Part 1: Add checking the HasStorageAccessGranted() for the ContentBlocking::ShouldAllowAccessFor(channel). r=dimi,baku https://hg.mozilla.org/integration/autoland/rev/8b7137730c6b Part 2: Moving the setting of 'HasStoragePermission' flag to the WindowContext a bit earlier. r=dimi,baku https://hg.mozilla.org/integration/autoland/rev/9d97ffda84cb Part 3: Use the 'HasStoragePermission' flag to check the storage permission. r=dimi,baku https://hg.mozilla.org/integration/autoland/rev/b53169070af1 Part 4: Remove unnecessary code for ContentBlocking::ShouldAllowAccessFor(). r=dimi,baku",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1623400",
        "issue_id": 1623400,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "For more info - I did some tests and several websites with push notifications seems to work. Examples: https://www.bennish.net/web-notifications.html https://www.pushengage.com/demo Not working: https://gauntface.github.io/simple-push-demo/ and most of the sites where I use notifications like YouTube, Facebook etc.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "https://gauntface.github.io/simple-push-demo/ also doesn't work with Firefox 74 or 68.6.0esr here.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "I have attempted to find this bug's regressor on Windows 10 and this are my results: 2020-03-19T11:23:20: INFO : Narrowed integration regression window from [23c4c99d, a0508ae6] (3 builds) to [f6b26481, a0508ae6] (2 builds) (~1 steps left) 2020-03-19T11:23:20: DEBUG : Starting merge handling... 2020-03-19T11:23:20: DEBUG : Using url: https://hg.mozilla.org/integration/autoland/json-pushes?changeset=a0508ae6c037928981ac2733860b6ec84d7069ec&full=1 2020-03-19T11:23:22: DEBUG : Found commit message: Bug 1508292: Implement Sec-Fetch-*. r=baku Differential Revision: https://phabricator.services.mozilla.com/D66283 2020-03-19T11:23:22: DEBUG : Did not find a branch, checking all integration branches 2020-03-19T11:23:22: INFO : The bisection is done. 2020-03-19T11:23:22: INFO : Stopped NI me if it seems incorrect.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 4,
                "quote": "Yes, I confirm that if the \"dom.security.secFetch.enabled\" pref is switched to false, the original issue does not occur anymore.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Since it's related to the \"dom.security.secFetch.enabled\" pref, would you mind taking a look into this bug, Christoph?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "I am willing to help, but I guess it's not a Firefox bug. More precisely, when enabled Firefox sends the Sec-fetch-* HTTP request headers [1]. It seems the problem must be on the server side of the specific app; in the case reported within http://gauntface.github.io/simple-push-demo/ Using a different demo, e.g: https://pushalert.co/demo and pressing 'Send Notification' - push notifications work as expected! [1] https://w3c.github.io/webappsec-fetch-metadata/",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Hey Edouard, I am not sure what I can do here to help. FWIW, adding Sec-Fetch-* headers (implemented in Bug 1508292 ) is behind the pref 'dom.security.secFetch.enabled' which is only enabled in Nightly and we will not let it ride the trains for a while. I added some more information about what I think the problem is within comment 14 - if there is anything else I can be helpful with, please let me know.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": ":ckerschb I don't think this is a server bug. Autopush (the mozilla push server), hasn't changed since October of last year. I know for a fact that it does not use any of the Sec-Fetch-* headers since I just found out about them today while working with the client team on this issue. In addition, if it were a server side issue, sites like https://pushalert.co/demo would also fail. I, too, am confused why that site works yet older code like https://serviceworke.rs/push-simple_demo.html does not. I'm able to connect to the push servers using a python websocket client: >pypy/bin/wsdump.py wss://push.services.mozilla.com/ Press Ctrl+C to quit > {\"messageType\":\"hello\",\"use_webpush\":true} < {\"messageType\":\"hello\",\"uaid\":\"f916f2c314e54c579d4e598a6cb38bc1\",\"status\":200,\"use_webpush\":true,\"broadcasts\":{}} > Looking at the client code that appears correct and also hasn't changed in quite some time. I'll admit that my expertise is in back end and not user agent code, so I'm at a loss to figure out why a connection under nightly is clearly failing. I know that the server will reject any connection that initially sends empty or invalid data, but again, the code linked above does not appear to do that (unless there's some recent change inside of Ci.nsIWebSocketChannel) I think we're just at a loss to determine what might be causing this sudden failure.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Maybe Dan can help us identify the problem - Dan, any suggestions?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 10,
                "quote": "Several of the \"working\" examples are using Notifications, not push. Others are sending pushes to their own sites -- are they setting it up in the backend? Do they later have their own communication when you're on the site that tells the site to send a Notification while you're on it? I didn't see any that sent me a \"push\" when I wasn't on the site itself. The only \"broken\" one I've seen so far is the https://gauntface.github.io/simple-push-demo/ one from earlier. Unlike comment 6 it worked just fine in Firefox 74. It's also the only demo site I've seen making requests to wss://push.services.mozilla.com/. With the sec-fetch- headers that request doesn't get any response at all. With the sec-fetch headers turned off then I get the expected 101 response and the websocket set-up HTTP headers. Is there a load-balancer or something in front of that service that's choking on the sec-fetch headers? Is the server itself looking for Sec- headers instead of sec-websocket- headers and getting confused that there are too many of them?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "The server is not looking for any Sec-* or sec-websocket-* headers. I'm quite positive about that because I'm one of the authors.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "I can run some experiments, but it would be helpful to have candidate headers I can use to ping off of the server. (As an aside, in the future it would be super useful if server impacting changes to the client like these could be be run by the Services Engineering group (services-engineering@/ slack#services-engineering). We can notify other services groups if need be, but it would give us a good start.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 13,
                "quote": "To emphasize, the pref dom.security.secFetch.enabled is currently only enabled in Nightly. If needed we could even flip it to false in Nightly. We are not planning to let it ride the trains in the super near future.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Totally understandable, and these sorts of things can and will happen. As I know you feel intimately, there's an endless tsunami of specifications, features and changes that don't always get propagated to where they should and not everyone always has the bandwidth to monitor every change coming down the pike. It can often be better to over communicate rather than assume \"they'll find out, I suppose\". Just offering a bucket you can yell into if and when you see something that might be a concern in the future.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Using the example at https://serviceworke.rs/push-simple_demo.html I see the same behavior. The headers I get when there's no response: Accept: */* Accept-Encoding: gzip, deflate, br Accept-Language: en-US,en;q=0.5 Cache-Control: no-cache Connection: keep-alive, Upgrade Host: push.services.mozilla.com Origin: wss://push.services.mozilla.com/ Pragma: no-cache Sec-Fetch-Dest: websocket Sec-Fetch-Mode: websocket Sec-Fetch-Site: cross-site Sec-WebSocket-Extensions: permessage-deflate Sec-WebSocket-Key: eyGFCl0x3LtrfBzjknmISg== Sec-WebSocket-Protocol: push-notification Sec-WebSocket-Version: 13 Upgrade: websocket User-Agent: Mozilla/5.0 (Macintosh; Intel \u2026) Gecko/20100101 Firefox/76.0 If I turn off the Sec-Fetch- headers (pref dom.security.secFetch.enabled) it works fine and I get the 101 response with the upgrade response headers.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 16,
                "quote": "Ok, so doing a few experiments using a python web client: > pypy/bin/wsdump.py -vvv --headers=\"Sec-Fetch-Dest: websocket,Sec-Fetch-Mode: websocket,Sec-Fetch-Site: cross-site,Sec-WebSocket-Extensions: permessage-deflate,Sec-WebSocket-Protocol: push-notification\" wss://push.services.mozilla.com --- request header --- GET / HTTP/1.1 Upgrade: websocket Connection: Upgrade Host: push.services.mozilla.com Origin: http://push.services.mozilla.com Sec-WebSocket-Key: EXTeF8flvgcy/dU5uWp0iQ== Sec-WebSocket-Version: 13 Sec-Fetch-Dest: websocket Sec-Fetch-Mode: websocket Sec-Fetch-Site: cross-site Sec-WebSocket-Extensions: permessage-deflate Sec-WebSocket-Protocol: push-notification ----------------------- --- response header --- HTTP/1.1 101 Switching Protocols Connection: Upgrade Upgrade: websocket Sec-WebSocket-Accept: fj9u9cHokh28aUGs4HJJj2PiHRM= ----------------------- Press Ctrl+C to quit > {\"messageType\":\"hello\",\"use_webpush\":true} send: '\\x81\\xaam\\xedTN\\x16\\xcf9+\\x1e\\x9e5)\\x08\\xb9->\\x08\\xcfnl\\x05\\x888\"\\x02\\xcfxl\\x18\\x9e1\\x11\\x1a\\x886>\\x18\\x9e<lW\\x99&;\\x08\\x90' < text: {\"messageType\":\"hello\",\"uaid\":\"6db91383b70b49f8b06aec12b2e00bfb\",\"status\":200,\"use_webpush\":true,\"broadcasts\":{}} > This is a successful connection to our push servers that uses the example headers provided in the above comment.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 17,
                "quote": "I don't believe that the server or anything in between is blocking the connection from working. (note that the send:... is the encrypted data being relayed over websocket.) Please also note that the sending payload ({\"messageType\":\"hello\",\"use_webpush\":true} must be entered within 2 seconds of connection otherwise the server will aggressively timeout the connection Hopefully, this can also act as a connection proof for later integration testing verification.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "The sec-fetch- code in the browser is very simple, just a pref check and a series of calls to aHTTPChannel->SetRequestHeader() which obviously succeed. Is there an internet path issue, and it might be different from your machine to the server? If you try one of the known-broken push examples in Firefox do they work in your nightly? https://gauntface.github.io/simple-push-demo/ seems easier to use since it has a send button. In the servicework.rs example you have to reload the page for each attempt. Is the Browser Console lying about what was actually sent and received? I haven't looked at the actual traffic.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "I don't have the ability to delve into the active User Agent Push internals but there are a few possible reasons for the failure: The client is failing to send the push \"hello\" packet for some reason. The client is failing to accept the push \"hello\" response for some reason. Something in between the WebPush.jsm calls outlined in #20 and the actual websocket network dispatch is intercepting or preventing the data. The push server is deeply, deeply indifferent about any additional header values. It ignores anything that is unknown or unexpected. As noted, setting the dom.security.secFetch.enabled to false allows the socket data to be exchanged and the push service to resume. (I'll note that even in the case of a success, the browser console does not display the exchanged information, so I can only verify off of expected DOM event behaviors.) Therefore, I strongly assert that this is not a server based issue, and urge examining anything that may interfere with either websocket data transmission or reception, particularly around elements related to the dom.security.secFetch component.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 20,
                "quote": "Attached file Bug 1623400: Test SecFetch Headers and websockets. (obsolete) \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "I did a lot of testing trying to narrow down the problem, here is what I found out: a) I wrote a mochitest (see phabricator) which creates a websocket also attaching the three Sec-Fetch-Headers. The details about the websocket: URI: https://example.com/tests/dom/security/test/general/file_sec_fetch_websocket Sec-Fetch-Dest: websocket Sec-Fetch-Mode: websocket Sec-Fetch-Site: cross-site Running the mochitest -> works b) I tested https://gauntface.github.io/simple-push-demo/ using all kinds of settings: The details about the websocket: URI: https://push.services.mozilla.com/ Sec-Fetch-Dest: websocket Sec-Fetch-Mode: websocket Sec-Fetch-Site: cross-site I tested sending all three headers -> failure I tested sending only the first two headers -> works I tested sending only the third header -> works Is it possible that there are some server side size constraints on request headers? Given that I also wrote a mochitest which works correctly, I still think the problem must be somewhere on the server.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Using websocat from my windows platform: > .\\websocat_win64.exe -vvv --header=\"Sec-Fetch-Dest: websocket\" --header=\"Sec-Fetch-Mode: websocket\" --header=\"Sec-Fetch-Site: cross-site\" --header=\"Sec-WebSocket-Extensions: permessage-deflate\" --header=\"Sec-WebSocket-Protocol: push-notification\" wss://push.services.mozilla.com [INFO websocat::lints] Auto-inserting the line mode [DEBUG websocat] Done third phase of interpreting options. [DEBUG websocat] Done fourth phase of interpreting options. [DEBUG websocat] Preparation done. Now actually starting. [INFO websocat::sessionserve] Serving Line2Message(ThreadedStdio) to Message2Line(WsClient(\"wss://push.services.mozilla.com/\")) with Options { websocket_text_mode: true, websocket_protocol: None, websocket_reply_protocol: None, udp_oneshot_mode: false, unidirectional: false, unidirectional_reverse: false, exit_on_eof: false, oneshot: false, unlink_unix_socket: false, exec_args: [], ws_c_uri: \"ws://0.0.0.0/\", linemode_strip_newlines: false, linemode_strict: false, origin: None, custom_headers: [(\"Sec-Fetch-Dest\", [119, 101, 98, 115, 111, 99, 107, 101, 116]), (\"Sec-Fetch-Mode\", [119, 101, 98, 115, 111, 99, 107, 101, 116]), (\"Sec-Fetch-Site\", [99, 114, 111, 115, 115, 45, 115, 105, 116, 101]), (\"Sec-WebSocket-Extensions\", [112, 101, 114, 109, 101, 115, 115, 97, 103, 101, 45, 100, 101, 102, 108, 97, 116, 101]), (\"Sec-WebSocket-Protocol\", [112, 117, 115, 104, 45, 110, 111, 116, 105, 102, 105, 99, 97, 116, 105, 111, 110])], custom_reply_headers: [], websocket_version: None, websocket_dont_close: false, one_message: false, no_auto_linemode: false, buffer_size: 65536, broadcast_queue_len: 16, read_debt_handling: Warn, linemode_zero_terminated: false, restrict_uri: None, serve_static_files: [], exec_set_env: false, reuser_send_zero_msg_on_disconnect: false, process_zero_sighup: false, process_exit_sighup: false, socks_destination: None, auto_socks5: None, socks5_bind_script: None, tls_domain: None, tls_insecure: false, headers_to_env: [], max_parallel_conns: None, ws_ping_interval: None, ws_ping_timeout: None } [INFO websocat::stdio_threaded_peer] get_stdio_peer (threaded) [DEBUG websocat::sessionserve] Underlying connection established [INFO websocat::ws_client_peer] get_ws_client_peer [INFO websocat::ws_client_peer] Connected to ws {\"messageType\":\"hello\",\"use_webpush\":true} [DEBUG websocat::ws_peer] incoming text {\"messageType\":\"hello\",\"uaid\":\"7c8e82bae21d4fc2bacce8ad63d7d9b4\",\"status\":200,\"use_webpush\":true,\"broadcasts\":{}} ^D [DEBUG websocat::ws_peer] incoming close [DEBUG websocat::my_copy] BrokenPipe: read_done [DEBUG websocat::my_copy] done [INFO websocat::sessionserve] Reverse finished [INFO websocat::sessionserve] Reverse shutdown finished [DEBUG websocat::my_copy] zero len [DEBUG websocat::my_copy] read_done While it's a bit hard to read through that output with the verbosity set high, note that I entered {\"messageType\":\"hello\",\"use_webpush\":true} (which is a proper WebPush \"hello\" message) and received back: {\"messageType\":\"hello\",\"uaid\":\"7c8e82bae21d4fc2bacce8ad63d7d9b4\",\"status\":200,\"use_webpush\":true,\"broadcasts\":{}} which is the expected response. Note also that I used the following --header arguments and that they were relayed in the websocat::sessionserve body: Sec-Fetch-Dest: websocket Sec-Fetch-Mode: websocket Sec-Fetch-Site: cross-site Sec-WebSocket-Extensions: permessage-deflate Sec-WebSocket-Protocol: push-notification These include the headers you note. including Sec-Fetch-Dest: websocket which you report as not working. (The sessionserve message transcribes the values of these strings into byte arrays, so some use of an ascii chart may be required to verify.) What this means is that a simple client that specifies these headers and values is indeed able to send and receive data from the mozilla WebPush servers. Look, I don't want to be contrarian or sound overly negative here, but I feel like we're arguing that the road must be broken because your car won't start after you changed the oil. I understand that firefox is a highly complex virtual machine. Far more complex than the push server. That's why I'm trying to provide as much tooling as possible so that you can solve this problem. It may not be with the code responsible for writing these headers (again, highly complex virtual machine), but it could be surfacing because of some inter-relationship around how the browser should act regarding handling these headers. I don't know, either. In fact, if you like, you can run a fake Push Server locally, and alter dom.push.serverURL to point to it. (Websocket is an upgraded HTTP connection, so the server should listen on ports 80 for (ws://) or 443 (for wss://) just like a normal HTTP server.) The client should connect and send the \"hello\" message I've been using. (I'll remind that firefox tends to treat localhost specially, so it might be worth trying a different address as well.) I am not sure how I can possibly proceed on this further. I completely agree that firefox 76.0a1 (2020-03-18+) is unable to properly communicate to the server in order to initiate a push connection. This is not the case for older versions of firefox, or independent clients. I have neither the tools nor experience in order to work out why the internal websocket channels within firefox in order to further diagnose or resolve this issue, but continue to be happy to assist where I can. I will gleefully fix and frankly be in rapture if this does turn out to be a server side issue but I am unable to replicate it using anything other than firefox 76.0a1 (2020-03-18+) which, again, leads me to believe that the problem is not with the server.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Ah, indeed! Awesome, I've got a reproducible error. using the following script: --header=\"Accept: */*\" \\ --header=\"Cache-Control: no-cache\" \\ --header=\"Host: push.services.mozilla.com\" \\ --header=\"Origin: wss://push.services.mozilla.com/\" \\ --header=\"Pragma: no-cache\" \\ --header=\"Sec-Fetch-Dest: websocket\" \\ --header=\"Sec-Fetch-Mode: websocket\" \\ --header=\"Sec-Fetch-Site: cross-site\" \\ --header=\"Sec-WebSocket-Extensions: permessage-deflate\" \\ --header=\"Sec-WebSocket-Protocol: push-notification\" \\ --header=\"Accept-Language: en-US,en;q=0.5\" \\ --header=\"Accept-Encoding: gzip, deflate, br\" \\ wss://push.services.mozilla.com succeeds, but adding an additional header echo '{\"messageType\":\"hello\",\"use_webpush\":true}' | /usr/bin/websocat -v \\ --header=\"Accept: */*\" \\ --header=\"Cache-Control: no-cache\" \\ --header=\"Host: push.services.mozilla.com\" \\ --header=\"Origin: wss://push.services.mozilla.com/\" \\ --header=\"Pragma: no-cache\" \\ --header=\"Sec-Fetch-Dest: websocket\" \\ --header=\"Sec-Fetch-Mode: websocket\" \\ --header=\"Sec-Fetch-Site: cross-site\" \\ --header=\"Sec-WebSocket-Extensions: permessage-deflate\" \\ --header=\"Sec-WebSocket-Protocol: push-notification\" \\ --header=\"Accept-Language: en-US,en;q=0.5\" \\ --header=\"Accept-Encoding: gzip, deflate, br\" \\ --header=\"Jabberwocky: T'was\" \\ wss://push.services.mozilla.com causes the server to fail the connection. In this case I'm using a nonce header in place of the User-Agent string.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 25,
                "quote": "Filed: https://github.com/mozilla-services/autopush-rs/issues/136",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 26,
                "quote": "So as a bit of follow up here while I enjoy this plate of crow: In the rust application, we use httparse, which parses and reads the HTTP headers, but uses a user provided mut slice. (e.g. use httparse; let mut headers = [httparse::EMPTY_HEADER; 16]; let mut req = httparse::Request::new(&mut headers); while 16 may have been plenty in the past, the new headers pushed us to 17. Literally one more than we expected, which triggered an out of bounds error that resulted in a too many headers debug message that got dropped because we don't log those.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 27,
                "quote": "The very short term fix is to just double the number of accepted headers (to 32).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 28,
                "quote": "Yep. The problem is with the server accepting a limited number of headers. A quick patch is included in https://github.com/mozilla-services/autopush-rs/releases/tag/1.55.0 which is part of https://bugzilla.mozilla.org/show_bug.cgi?id=1629973",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "I assume that then many websites can be bitten by this. In this case we probably should understand, to which extent we are breaking the web with this feature and what we can do about it.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 30,
                "quote": "Nightly is now working with the following demo sites that weren't working before: https://gauntface.github.io/simple-push-demo/ https://serviceworke.rs/push-simple_demo.html",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1622369",
        "issue_id": 1622369,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Retriggered: https://treeherder.mozilla.org/#/jobs?repo=autoland&searchStr=android%2C7.0%2Cx86-64%2Copt%2Cweb%2Cplatform%2Ctests%2Ctest-android-em-7.0-x86_64%2Fopt-geckoview-web-platform-tests-e10s-12%2Cw%28wpt12%29&tochange=8ef0a54d7715018ad09e5b6b53d3321252422e44&fromchange=ff66e60f8eea539594b1dee5e333b983a18ef742 Looks like it stated from the wpt sync push.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Brian: is this something you hae time to investigate?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "Looks link the Chrome team updated that test to a \"mechanism ... that is well behaved across browsers\" ;) https://hg.mozilla.org/mozilla-central/rev/1f66d281b8ce3b572f364f86102f3c132ec64c8d",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "I'm afraid I won't have time to look at this. Maybe Boris can?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Various wpt-syncbot pushes have tweaked the annotations for this test. I don't think there have been any behavioral changes in Gecko itself. https://hg.mozilla.org/mozilla-central/rev/9ee1a15632f89853a5ab28ef60566f5508c62783#l47.24 https://hg.mozilla.org/mozilla-central/rev/bce0bdab8c42f018c13f4d071dc03cf713d14847#l101.23 https://hg.mozilla.org/mozilla-central/rev/bbb78f71a5de9849f6697da61a062f59ec960f97#l108.23",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "In fact, as a result we now have unexpected passes too: bug 1625015",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Just notice \"Performs removal in deeply nested iframes\" is easy to be reproduced on mac, becase of time-out or failed on my local build.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "It's easy to get time out on mac if we await the promise inside insertFrameAndAwaitLoad(), so move it out and let's see if there is still timeout or intermittent.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "intermittent.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1618477",
        "issue_id": 1618477,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Having two or more tabs with active webRTC sharing state seems to break the sharing indicator button.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "In case of multiple tabs with active sharing state we should focus one of the tabs and open the identity panel. If a tab with active sharing state is currently in focus that should be prioritized.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1618477 - The permissions prompt is not displayed by clicking on the control sharing panel. r=prathiksha,johannh \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Verified - Fixed in latest Nightly 76.0a1 (Build id: 20200318041411) using Windows 10 and Ubuntu 18.04.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "The patch landed in nightly and beta is affected.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1615767",
        "issue_id": 1615767,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I can't reproduce; I see no difference between behaviour on 72, 73, 74 and 75 - the spacer adds several cm of horizontal empty space on the left-hand side of the toolbar.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Can you find a regression window with mozregression ( https://mozilla.github.io/mozregression/ ), and take screenshots before/after to indicate what you're seeing (presumably different from my machine)? Can you reproduce on a clean profile?",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "Ok very interesting, NOT occuring with new profile! (on current FF Beta)",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "I don't see anything obvious in the about:support data. Did copying prefs.js from your old profile to a clean one break the flexible spaces there, too? If so, what's the value of the browser.uiCustomization.state pref? (It's not in the about:support data)",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Then I don't know what causes this in the profile where this is broken.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "I can also reproduce this, if the bookmark toolbar is overflowed with bookmarks (and the chevron icon is visible at the end). I have only bookmarks and folder there without any other toolbar items.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "This was regressed by bug 1601334 because it changed the min-width of toolbarsprings everywhere, including the bookmarks toolbar, and apparently the way XUL layout works is that we end up squashing the spacer to nothing when the toolbar is full. The min-width of 1px was then removed entirely in bug 1608638.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 8,
                "quote": "We should probably bring back the original min-width outside of the navbar.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "Attached file Bug 1615767 - re-introduce a min-width for flexible spacers so they work as expected outside the navbar, r?dao \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Fixed on latest Nightly. Also, I don't think this is related to the urlbar/magebar in any way.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Low risk css change, uplift approved for 74 beta 9, thanks.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1614706",
        "issue_id": 1614706,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The attached crash information was detected while running CI tests with ThreadSanitizer on mozilla-central revision 11c9c5ce3955. Looks like a simple race on mStatus being updated vs. it being used in RemoveInput.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Acquiring the lock is moved from CacheFile::RemoveInput() to CacheFileInputStream::Release(). This fixes the data race and is consistent with CacheFile::RemoveOutput() which is also called under the lock.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "lock.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1600320",
        "issue_id": 1600320,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The attached crash information was detected while running CI tests with ThreadSanitizer on mozilla-central revision 66531295716a. This race looks very similar to bug 1533521 with the exception that the writing code here is in the Rust function set_len instead of the SetLength C++ counterpart. Not sure if we can apply the same or a similar fix like we did in bug 1533521.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "The only way for this to happen is calling set_len(0) on an already-empty array. We should be replacing these bindings by the ThinVec crate, but this is easier for now.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "now.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1600017",
        "issue_id": 1600017,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "When skimming through the spec proposal, it doesn't look like there's a restriction that additional empty cells can't be added to finalizationGroup.[[Cells]] during iteration. In which case the assertion simply needs to be changed from MOZ_ASSERT(index <= initialLength) to MOZ_ASSERT(index <= holdings->length())?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1600017 - Fix assertion in FinalizationGroupObject::cleanupQueuedHoldings to take account of the fact that holdings can be added during cleanup r?anba \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1598488",
        "issue_id": 1598488,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": ":tnikkel, do you know if this behavior is intended ?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "That seems just wrong. Looking at the callers of GetWidget they are seem to want to widget of the popup and not the root widget. Do you happen to know why GetRootViewForPopup is returning the wrong view? Is it because we skip over the widget for the popup because the window type is not eWindowType_popup? Or because the view we start with from |nsView* view = aStartFrame->GetClosestView()| is a view outside of the popup because the nsMenuPopupFrame doesn't have a view yet?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Hmm, well I don't think it can be the other one actually, because you switched to GetView()->GetWidget(), so we must have a view on the menu popup frame in this case. So we don't understand what's going on here? It would be good to know what's going on.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Yeah, I switched to GetView()->GetWidget() because GetWidget() wasn't correct, GetView()->GetWidget() returns the right thing though.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "How does one reproduce this to figure out whats happening?",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Ah, nevermind, I figured it out. I was missing the obvious. If our view doesn't have a widget we proceed to the parent view, it'll have a widget of the wrong type, but it won't have a parent view, and so we return that view. I'll attach a patch to get rid of this complication, it's not useful.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "It can return the root widget if the menu popup frame doesn't have a widget. None of the callers want this.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "this.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1593658",
        "issue_id": 1593658,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "When we fail to detect the link as mobile data device, we use GW address for ID calculation. And because GW changes often in case of mobile data we often get different ID for the same network.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "network.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Hi, verified as fixed with Samsung Galaxy 9 (Android 8.0.0) and Google Pixel 3a (Android 9) on app build Firefox Preview Nightly 191120 (Build #13240608) and Gecko View 72.0a1-20191118093852.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1584273",
        "issue_id": 1584273,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I think this would be an accessibility win that would be reasonably easy to implement.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1584273 - Disable the megabar animation when prefers-reduced-motion is true. r?dao \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1581315",
        "issue_id": 1581315,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "ThrowTypeError/ThrowRangeError should probably have the annotation too. Maybe others as well (NoteJSContextException, for example).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "It doesn't really make sense to enforce this behavior for calls on stack variables (which presumably we then want to do something with) and doesn't necessarily make sense to enforce it for member variables either.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "either.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Our implementation modified the state, in addition to throwing the exception. And the tests not only didn't test for this, but wouldn't have reached that code anyway, due to the harness giving up as soon as anything failed.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "failed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Attached file Bug 1581315 part 3. Add MOZ_MUST_RETURN_FROM_CALLER_IF_THIS_IS_ARG to more ErrorResult methods. r=smaug \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Can't merge web-platform-tests PR due to failing upstream checks: Github PR https://github.com/web-platform-tests/wpt/pull/19224 * Taskcluster (pull_request) (https://tools.taskcluster.net/task-group-inspector/#/dNeJ9c6jRIypfSJ0x5Ag-A)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "The instability in Firefox causing the upstream test failure is a known issue with that test. See bug 1560454 (which is marked fixed, but was \"fixed\" by disabling the test)...",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 10,
                "quote": "OK, I'll force merge this once it reaches central.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1579004",
        "issue_id": 1579004,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Yes, it should unfocus on any click outside. The intention is that clicking back in will restore the previous state (another item on the list from last week). So for example, if I had typed \"Firefox\" and the dropdown was open with search and history suggestions and I click outside, the dropdown will close and the bar will unfocus. And then when I click back inside, the bar will focus and the dropdown with my results will open back up.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "In this case, let's use the new \"focused & collapsed\" state.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "This should work same as it does today. So for example, if the bar is focused & expanded and I click on the desktop it should become unfocused & collapsed. If I then Alt+Tab back to Firefox it should return to focused & expanded.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Attached file Bug 1579004 - Clicking empty parts of the toolbar should collapse the megabar. r?dao \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Backed out changeset b37620ff38b6 for failures browser_urlbar_collapseOnChromeMousedown.js Backout link: https://hg.mozilla.org/integration/autoland/rev/ececf9f6d9a52ef0a6c3a25699bae62f2f5c2272 Push with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&tochange=ececf9f6d9a52ef0a6c3a25699bae62f2f5c2272&fromchange=b37620ff38b60aa8cf34bd02c4ea5d8cd0afb118&selectedJob=268223800 Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=268223800&repo=autoland&lineNumber=1719",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 7,
                "quote": "I pushed a new revision to Phabricator with a green try: https://treeherder.mozilla.org/#/jobs?repo=try&revision=881defd8994906a91a2d4ca4e957f51febf32619&selectedJob=268231104. I'm going to attempt to push again.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1576778",
        "issue_id": 1576778,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "When bug 1543812 landed it: added an extra parameter (permissionID) to the function getMultichoiceStateLabel (https://searchfox.org/mozilla-central/source/browser/modules/SitePermissions.jsm#883) but it wasn't documented in the comments above it probably needs to be something like: @param {string} permissionID The permission to get the label for. added an extra supported option for gPermissionObject but nothing was added to the comments for that object about it, maybe something like: getMultichoiceStateLabel Allows for custom logic for getting its default value. created a typo Unkown rather than Unknown (https://searchfox.org/mozilla-central/source/browser/modules/SitePermissions.jsm#1028) Unfortunately bugzilla incorrectly autoformats the suggestions",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1576778 - Missing comment changes and typo in SitePermissions.jsm r=pbz \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "etails",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1576600",
        "issue_id": 1576600,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1576600 - Fix styling of Learn More link in protections panel info message. r=andreio \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Backed out 4 changesets (bug 1583355, bug 1576600, bug 1576601, bug 1583350) for browser-chrome failures at browser/base/content/test/siteProtections/browser_protections_UI.js Backout: https://hg.mozilla.org/integration/autoland/rev/283763664a4b94cdfe9124846cdb04114c197440 Failure push: https://treeherder.mozilla.org/#/jobs?repo=autoland&revision=d1fe84998565c0a1f22979b467eb4e21862dc5c0 Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=269024083&repo=autoland&lineNumber=6488",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached file Bug 1576600 - Ensure Learn More link is visible in dark mode. r=andreio \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Polish for Skyline feature, fine for uplift for beta 12.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 7,
                "quote": "I verified the fix using latest Nightly 71.0a1 and Firefox 70.0b12 on Windows 10 x64, macOS 10.13 and Ubuntu 18.04 x64. The issue is not reproducing anymore.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1574259",
        "issue_id": 1574259,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Either the ScopedHandle should be established after checking the return value, or token should be initialized to a safe value before the API call.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1574259 - Improve resource management in ReauthenticateUserWindows r=keeler \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1571487",
        "issue_id": 1571487,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We'd also need to add an actual MathMLElement interface. And as an implementation note, we'd need to add tabindex parsing to nsMathMLElement::ParseAttribute. As a spec note, I don't see anything in https://mathml-refresh.github.io/mathml-core/#dom-and-javascript that has any mention of event handler content attributes (as opposed to IDL attributes), even though the tests test for that. The language at https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers-on-elements,-document-objects,-and-window-objects is specific to HTML elements, obviously. We'd need to implement event handler content attributes as well to pass these tests, which is not a pure binding issue. Note that the mapping from attribute names to event handler event types is NOT the same for HTML and SVG, by the way. If the intent is that MathML uses the HTML mapping, it should probably explicitly say that. I wish SVG actually specified its behavior too...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "It's also possible that what should happen here is bugs blocking this one on the actual behavior changes (i.e. the handling of event handler attributes is a behavior change even if they don't get exposed via IDL), in addition to the IDL changes this bug would make.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "But, it sounds like you are saying they aren't the same in SVG? Can you explain a little more so that we know the right thing to do here?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "I see. I filed https://github.com/w3c/svgwg/issues/719 on the SVG bits.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 5,
                "quote": "Past that, Gecko maps the \"onload\" attribute in SVG to the \"SVGLoad\" event, not the \"load\" event. Similar for a number of other attributes. See https://searchfox.org/mozilla-central/rev/e62c920f7f6463239c6634113f8a8351e263b936/dom/svg/SVGElement.cpp#1374-1382. I just checked, and other browsers don't obviously seem to do that, so maybe we can drop it...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Attached file Bug 1571487 - Implement MathML DOM \u2014 Details Untested WIP patch.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "patch.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "bz, speaking to amelia's reasoning for doing it the way they did on the linked svg issue - was just talking with her about how we manage to not explicitly list and be explicit enough. Would something as simple as the following phrasing work? \"All MathML elements support event handler content attributes, as described in HTML. All event handler content attributes noted by HTML as being supported by all HTMLElements are supported by all MathML elements as well, and reified as the relevant event handler IDL attributes as described in that specification, and defined in the MathMLElement IDL. \"",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I don't know that the \"reified as ...\" bit is needed, as long as the IDL links to the right places (which presumably it does given that presumably it just pulls in the DocumentAndElementEventHandlers and GlobalEventHandlers mixins). I'm not sure whether this \"reified as ...\" bit is actively harmful, but it did confuse me a bit, since the actual reification, if there is one, is in terms of \"event handler\" structs, and the content and IDL attributes are just ways to create and modify those structs; neither one is really the full source of truth.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "@Boris: Can you please take a look at the preliminary rename-only patch https://phabricator.services.mozilla.com/D45128 ?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 11,
                "quote": "I uploaded a new patch. I think the implementation is essentially done, but we need to wait for the latest WPT changes, to send the intent-to and perhaps to write more tests for the tabIndex/focus stuff. Brian has added more details to the MathML Core spec: https://mathml-refresh.github.io/mathml-core/#event-handler-content-attributes https://mathml-refresh.github.io/mathml-core/#focus",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "I wrote the intent to prototype: https://groups.google.com/forum/#!topic/mozilla.dev.platform/ssTytf-pT7k and sent the patch for a first review.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "@Boris: Can you please take a look at attachment 9091079 [details]? IIUC, these are the main things I were not sure about: Whether we need a runtime flag. Whether we need a EventNameType_MathML flag that would basically duplicate the EventNameType_HTML one. Whether we can factor out shared logic between SVG & HTML and use it for MathML too (I guess yes, but that's probably something to do in a separate bug). Whether we need more tests for the tabindex/focus related changes.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 14,
                "quote": "The only reason the EventNameType thing exists is for purposes of implementing IsEventAttributeNameInternal. If you can get the right behavior without adding a new one, I wouldn't introduce a new one.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "That seems reasonable. Some such logic is already factored into nsStyledElement. We could either move move things into there or add another class below or above it. Followup for this is ok, though filing the followup now, with a list of things that can be shared, might not be a bad idea.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Well, the tabindex bits definitely need more tests, since they're buggy... ;)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Pushed by nbeleuzu@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/718ef1098af5 Implement MathML DOM r=bzbarsky",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Backed out changeset 718ef1098af5 (Bug 1571487) for causing perma wpt merges in /mathml/relations/html5-tree/tabindex-002.html CLOSED TREE https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&fromchange=eaa0c1e72e51139f37dd0486c15753b71e33c1fd&selectedJob=269783425 https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=269783425&repo=autoland&lineNumber=3818",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 19,
                "quote": "Backout by shindli@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/e4fc32c3ae1d Backed out changeset 718ef1098af5 for causing perma wpt merges in /mathml/relations/html5-tree/tabindex-002.html CLOSED TREE",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 20,
                "quote": "I only see mathml/relations/html5-tree/tabindex-002.html failing on mac. The test passes on Linux. (This test is basically copied from html/interaction/focus/sequential-focus-navigation-and-the-tabindex-attribute/focus-tabindex-order.html but that one does not have any failure expectation.)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 21,
                "quote": "Focus model is different on mac than on linux / windows. Probably the test assumes the linux / windows focus model.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 22,
                "quote": "In particular, iirc, on mac only buttons and inputs are tab-navigable by default, or something like that...",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 23,
                "quote": "Attached file MDN: Browser compatibility table update \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 24,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "Thanks Emilio. I tried to do a similar test using only HTML (no MathML) and indeed on macOS links are not tab-navigable by default, so the test fails... (see also the related https://github.com/Igalia/chromium-dev/issues/50)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 26,
                "quote": "@Boris: Not sure what would be the easiest way to move forward? Add a failure expectation on mac? Do not test navigation of mathml link? Find a way to force the link to be tab-navigable?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 27,
                "quote": "Well, the test is fundamentally buggy, since it assumes things that are simply not true, right? Tests are meant to test the things specs actually require, not whatever happens to work on one particular setup or operating system. Specs do not require links to be tab-navigable.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 28,
                "quote": "So the right answer in general is to fix the test so it's not testing non-spec-required things. Depending on the purpose of the test that could mean removing the test, or removing just the text6 bit from the test, or having it test that tab-navigability of MathML links matches tab-navigability of HTML links, or something else. I don't know what the exact goal of this test is, so hard to say what it should test. Short-term you can add a failure expectation on Mac, yes. I'd probably go that way. You could likely set the accessibility.tabfocus pref to 7 to override the default Mac behavior, but I would prefer we test the configurations we actually ship. Though it might not be terrible to have a separate test that makes sure that preference works as it should, of course. I see no such tests right now.... That's way out of the scope of this bug, though.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 29,
                "quote": "File a followup for that, please?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 30,
                "quote": "I opened https://github.com/mathml-refresh/mathml/issues/152 and will mark this as failing on mac for now",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 31,
                "quote": "Pushed by btara@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/30154d163aca Implement MathML DOM r=bzbarsky",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 32,
                "quote": "Upstream web-platform-tests status checks passed, PR will merge once commit reaches central.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1571472",
        "issue_id": 1571472,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I noticed the stat calls on omni.ja in this profile: https://perfht.ml/2OPUqTM Looking at the code, https://searchfox.org/mozilla-central/rev/0ffa9e372df56c95547fed9c3433ddec4fbf6f11/toolkit/components/corroborator/Corroborate.jsm#37 does 2 .exists() calls that do a stat on the main thread. Given the function is already async, using OS.File instead to check if the files exist should be easy. I haven't seen it in profiles yet, but I'm almost sure calling .directoryEntries at https://searchfox.org/mozilla-central/rev/0ffa9e372df56c95547fed9c3433ddec4fbf6f11/toolkit/components/corroborator/Corroborate.jsm#47 also does main thread I/O. OS.File has a directory iterator that could be used. And finally, https://searchfox.org/mozilla-central/rev/0ffa9e372df56c95547fed9c3433ddec4fbf6f11/browser/components/BrowserGlue.jsm#1970 loads Corroborate.jsm right at the end of the session restore, likely piling up on existing jank. Unless I missed something, it could be triggered using an idle dispatch from _scheduleStartupIdleTasks instead.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Per https://bugzilla.mozilla.org/show_bug.cgi?id=1515173#c24 we aren't going to sign these and they will instead move into omni.ja",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "omni.ja",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Attached file Bug 1571472 - use async I/O for checking corrupt omni jar r?bdanforth \u2014 Details Depends on D41691",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "D41691",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Attached file Bug 1571472 - use idle dispatch to start up corroborator r?bdanforth \u2014 Details Depends on D41692",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "D41692",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Hm, this test is still failing: browser/base/content/test/performance/browser_startup_mainthreadio.js | unused whitelist entry before handling user events: Z:\\task_1566235067\\build\\application\\firefox\\omni.ja https://treeherder.mozilla.org/#/jobs?repo=try&selectedJob=262304880&revision=54abbee14a13ef75cc30aab0cbab3d2887f6d9d8 mconley/florian, this is behind a Services.tm.idleDispatchToMainThread() in BrowserGlue.jsm now, is that somehow expected, or did I miss something? Thanks!",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "Hey rhelmer, Coming at this having not really examined the patches, Corroborate.jsm, or anything like that, but I've seen failures like this before. So we have this whitelist of main-thread IO for different stages of start-up. We fail in one of two cases: We see new IO that isn't already in the whitelist We fail to see IO that is in the whitelist The error message that you're seeing is for case (2) - we expected to see some IO, and we didn't. This can be a good thing - in the best case, presuming this isn't intermittent, it means that we've successfully moved some IO off of the main thread and now we need to update the whitelist.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 10,
                "quote": "So looking at the log, before that first failure, we see 1 expected stat on application/firefox/user.ja, and then we leave the \"before handling user events\" stage before seeing the other stat, and then the test freaks out because we didn't see the remaining XCurProcD:omni.ja or the one remaining GreD:omni.ja.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 11,
                "quote": "So presuming this isn't an intermittent, I think this can be addressed by updating the whitelist to remove the one GreD:omni.ja entry entirely, and reduce the number of stats for the XCurProcD:omni.ja entry by 1.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 12,
                "quote": "I've added a new patch which I am running through tryserver now: https://treeherder.mozilla.org/#/jobs?repo=try&revision=a3537b588f9e7b044c2c4a8b235577e6a6a9816b",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Huh - still orange. It's complaining about the other omni.ja whitelist entry also being unused... maybe I misinterpreted the first log",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 14,
                "quote": "you can just wipe out those whitelist entries entirely?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "Was just looking at that and pushed a new one: https://treeherder.mozilla.org/#/jobs?repo=try&selectedJob=262376665&revision=e8edd28ee13cbf57ca672ec58dfeac2218cf91a9",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Corroborator.jsm no longer causes file I/O on early startup before user input is possible. Depends on D41693",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "D41693",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Indeed, the test just verifies (should I say celebrate?) that the patches here actually fix the bug! :) Thanks!",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1571124",
        "issue_id": 1571124,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Add a PrivateScriptData::allocationSize() public method (similar to LazyScriptData::allocationSize()) Update the definition of JSScript::computedSizeOfData() to use this Remove JSScript::dataSize_ / dataSize()",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1571124: Calculate the data size of a JSScript dynamically. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1570673",
        "issue_id": 1570673,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We might want to propagate the active state into the VideoFrameConverter.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "There's a second bug here where frames from SameFrameTimer don't get sent due to bug 1522238. Frames broadcast by the timer have the same timestamp as the last frame and get dropped upstream. This didn't seem to impact my manual test of the original STR, but it impacts the mochitest I wrote.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached file Bug 1570673 - Add mochitest. r?bwc \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached file Bug 1570673 - Add an active state to VideoFrameConverter and propagate it from MediaPipeline. r?bwc \u2014 Details Depends on D40597",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "D40597",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached file Bug 1570673 - Update last frame's time on same-frame-ticks. r?bwc \u2014 Details Depends on D40598",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "D40598",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Verified fixed on the latest Firefox Nightly (20190808214929) on Windows 10 and Mac OS 10.14.6",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "Fixes a WebRTC interop bug which can cause users of other browsers to not receive audio from Firefox users. Approved for 69.0b13 and 68.1esr.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 11,
                "quote": "Verified fixed on Windows 10, Mac OS 10.14.6 and Ubuntu 18.04 using Firefox Beta 69.0b13 (20190812173625)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Slight collision with bug 1556696. I'll have the 2nd patch up rebased for esr68 in a bit.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 13,
                "quote": "Rebased attachment 9082952 [details] on top of esr68. Carries forward the r+.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Verified fixed on Windows 10, Mac OS 10.14.6 and Ubuntu 18.04 using Firefox 68.1.0 ESR (20190814031227) downloaded from https://treeherder.mozilla.org/#/jobs?repo=mozilla-esr68",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1569123",
        "issue_id": 1569123,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I think we should just do this. We had this on early-beta and nightly for half a year now. Maybe at some point the Chrome people will respond.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1569123 - Re-enable strict MIME type checking for Worker/SharedWorker everywhere. r?ckerschb \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "I've asked Mike to help make the decision here.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "If we have been warning devs of this change via a console warning for at least three releases, let's go ahead and land this change. If not, please file a blocking bug to land a console warning and then we can land this change after three additional releases.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Attached file Bug 1569123 - Re-enable strict MIME type checking for Worker/SharedWorker everywhere. r?ckerschb \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Details",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1560574",
        "issue_id": 1560574,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1560574 - use FormatPRExplodedTime to display GMT; \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "ls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I tested the patch and it works for me.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Timezone info isn't specified here, so that the parsing here might have different result, where PRTime should always use GMT and be timezone-free.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "FWIW, I tested by visiting ftp://ftp.freebsd.org/ and I found switching privacy.resistFingerprinting on/off doesn't affect timezone displayed here until restart Firefox. But in this bug I'm trying to make the content in view-source:ftp://ftp.freebsd.org/ stable on all platforms.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Gary: FYI: see bug 1491343# comment8 re RFP flipping & TZ spoofing - maybe this needs it's own bug (and tracked/linked in bug 1414162)",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 7,
                "quote": "Update on current status: After applying this patch, macOS will always display GMT time regardless privacy.resistfingerprinting is enabled or disabled, I haven't tested on Linux.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "I suspect what mentioned by Simon is the root cause that my current patch doesn't work properly on mac, I didn't notice this because I was debugging with e10s disabled, that makes everything works well, including dynamically switching privacy.resistfingerprinting and reloading the ftp site.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "It turns out that PR_LocalTimeParameters returns different value in the content process on macOS, and is caused by sandbox.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1540794",
        "issue_id": 1540794,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This file only includes nsID.h, and is unused.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "unused.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1537936",
        "issue_id": 1537936,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We're surprisingly close to getting this to happen. I'll split the patch into three parts: Misc. cleanup (some NameNode changes, tiny change to True/False/Undefined/NullExpr, etc.) Function call cleanup. Deleting pn_op and refactoring all the ParseNode constructors/FullParseHandler/etc. to not provide opcodes. Point 2 is a little weird, because I'll be adding a CallNode that contains a JSOp field. This is because there are a lot of different types of calls, and those are currently encoded into JSOp (for example, CALL, SPREADCALL, NEW, SPREADNEW, SUPERCALL, SPREADSUPERCALL, the list goes on and on). I could make a new enum that corresponds basically 1-to-1 with the JSOp items, and make a mapping function, but... really, what's the point at that point.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file Bug 1537936 part 1 - Remove miscellaneous uses of pn_op. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Attached file Bug 1537936 part 2 - Move pn_op for calls to CallNode::callOp. \u2014 Details Depends on D24409",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Attached file Bug 1537936 part 3 - Remove ParseNode::pn_op. \u2014 Details Depends on D24410",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Backed out for bustages in ParseNode.h Push with failure: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception%2Crunnable&revision=8c405aa4467dfeb34b9df7e875c1584ed6f6a938 Failure log: https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=235272394&repo=autoland&lineNumber=5157 Backout: https://hg.mozilla.org/integration/autoland/rev/c99b0f4470527c183d90c1e7191a08e4933ad1ac",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 9,
                "quote": "Pushed by ahauck@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/647eb65d3451 part 1 - Remove miscellaneous uses of pn_op. r=jorendorff https://hg.mozilla.org/integration/autoland/rev/37d0dcbdffd5 part 2 - Move pn_op for calls to CallNode::callOp. r=jorendorff",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Pushed by ahauck@mozilla.com: https://hg.mozilla.org/integration/autoland/rev/2bf248bc4f3b part 1 - Remove miscellaneous uses of pn_op. r=jorendorff https://hg.mozilla.org/integration/autoland/rev/4011496a13a9 part 2 - Move pn_op for calls to CallNode::callOp. r=jorendorff https://hg.mozilla.org/integration/autoland/rev/d9660cff2091 part 3 - Remove ParseNode::pn_op. r=jorendorff",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1528712",
        "issue_id": 1528712,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1528712 - Remove a couple trivial dependencies on nsPresContext. r=#style,jfkthame \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "It's a global object, it doesn't have to be stored in nsFont. Pass it from the caller like the user font set and co. Depends on D20141",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "D20141",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Backed out 2 changesets (bug 1528712) for Linux spcshell and reftest failures (test_ext_browserSettings.js, 1022481-1.html) push that caused the backout: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&selectedJob=229192047&revision=2d5c4e71e258e24f1a70ed850c619f97e56f2c60 failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&selectedJob=229193147&searchStr=linux%2Copt%2Cxpcshell%2Ctests%2Ctest-linux32%2Fopt-xpcshell-6%2Cx%28x6%29 https://treeherder.mozilla.org/#/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&selectedJob=229194233&searchStr=linux%2Cdebug%2Creftests%2Ctest-linux32%2Fdebug-reftest-8%2Cr%28r8%29 backout: https://hg.mozilla.org/integration/autoland/rev/8a4ad06c05759fe087625f9fd8d047d848bee4c2",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 5,
                "quote": "Pushed by emilio@crisal.io: https://hg.mozilla.org/integration/autoland/rev/533f35feb9eb Remove a couple trivial dependencies on nsPresContext. r=heycam https://hg.mozilla.org/integration/autoland/rev/d15621c6f424 Remove nsFont::featureValueLookup. r=jfkthame",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1526439",
        "issue_id": 1526439,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file Bug 1526439 - Add an enteprise policy for extension updates. \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "New policy, OK for ESR 60.7.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1521066",
        "issue_id": 1521066,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Markup is like this: <style> table { border:double } </style> <table rules=rows>",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Gotta love C++... I missed the break; for that branch so we were always falling back to the solid border rendering path (which we use if the border is too small).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": ".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0 Confirming that testcase and URL are fixed with today's Nightly. Thanks!",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "[Triage Comment] Extremely simple fix with tests for a table border rendering regression. Approved for 65.0rc1.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1519164",
        "issue_id": 1519164,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The UI tours live behind a pref.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "A new pref needs to be uplifted so that 65 Release users are served the correct tour.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "This just made it to production: Normal window: https://www.mozilla.org/en-US/firefox/65.0/content-blocking/start/?newtab=true https://www.mozilla.org/en-US/firefox/65.0/content-blocking/start/?newtab=true&variation=2 Private Window: https://www.mozilla.org/en-US/firefox/65.0/content-blocking/start/ https://www.mozilla.org/en-US/firefox/65.0/content-blocking/start/?variation=2",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Attached file Bug 1519164 - Update content blocking UI tour url. r=nhnt11 \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Details",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Ensures that the Content Blocking UI tour URL is up to date. Approved for 65.0b11.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 7,
                "quote": "I have verified that the Content Blocking UI tour is correctly displayed in normal/private browsing and the URL contains the \"content-blocking\" string. Tested on latest Nightly 66.0a1 and Beta 65.0b11 across OSes: Win 10 x64, macOS 10.13 and Ubuntu 16.04 x86.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1516605",
        "issue_id": 1516605,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "libpng has NEON support using intrinsics, not assembler, so we should use it even if aarch64. MSVC build still turns off NEON since libpng doesn't support it on stable version although upstream has it.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": ".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Oh, I actually already did this in the libpng 1.6.36 update bug (bug 1513236)...",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1324183",
        "issue_id": 1324183,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch part-1-remove-Windows-version-checks.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Part 2: Remove MediaUnsupportedBeforeWindowsVista console message.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "You should try mozreview&autoland!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "r+ if you also remove the code that report 'sMediaUnsupportedBeforeWindowsVista' (lines 548,552-557 in the original version; search \"vista\" to find them)*. You may also want to remove similar XP&Vista code in browser/base/content/browser-media.js and browser/locales/en-US/chrome/browser/browser.properties, but please r?gijs for it. It could be done in a separate bug if you prefer. * See, if you had used mozreview, it would have made it easier for me to check this, and even to auto-quote the relevant part and flag the issue. ;-)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Just for the records, I read bug 1146362 for the original reporting of the 4K videos Vista breakage, and it seems more of a driver/gpu shortcoming. Shouldn't you blacklist the adapters without the required hardware decoding if anything? For example, on a fully updated Windows 7 with a Radeon 7750 and latest driver, even 1440p is already unusable (and oddly CPU isn't maxed out).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Matt, you disabled hardware decoding on XP and Vista in bug 1154536. mirh wonders whether we should be blocklisting the relevant drivers instead of Windows versions.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "I didn't disable hardware decoding on XP/Vista, I stopped us reporting that we could play 4k videos at all (hardware or otherwise). Neither XP nor Vista support 4k video decoding in hardware (on any hardware), so these videos would always be software. The vista/XP check here is being used a proxy for processor speed (albeit not a very good one), so just removing it is fine.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "I didn't mention general hardware decoding myself to be honest (Chris did) Anyway, I was just wondering why there was that awkward check for 4k, other factors are definitively at stake. Checking for DXVA reported bits for example seemed pretty more comprehensive.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "AMD supports it starting with UVD 5 (GCN 1.2 cards). Which indeed have no Vista driver, true. Then you have Intel, that for as much included a decoder all the way back to Ivy Bridge (which have also drivers for XP) possibly doesn't count that much given there's no way to \"retro-fit\" integrated graphics But then you have nvidia, that only dropped those OS months ago (PureVideo HD5 starting from Kepler and a couple of Fermi chips btw).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Oh right, software decoding is a thing too, I was forgetting lol. I'm not sure on the rationale behind that for 4K though. Yes I mean.. Perhaps with some beefy (at least 4 core) desktop CPU that should be possible, but putting aside it still seems a huge energy waste, I really wouldn't know how one would be able to discern between an Atom with hyper-threading and a Xeon.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "The discussion is going off-topic. Perhaps we should file a new bug to investigate a better way to determine whether we offer 4K.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 12,
                "quote": "Staying on topic (I think), I am still testing mozilla-central (firefox 53.0a1) on Windows Vista SP2 32bit here, and I can confirm that this bug 1324183 TOTALLY BROKE h264/aac playback on that OS (through WMF, with Platform Update Supplement for WinVistaSP2 (KB2117917) installed). Last good build: buildID=20161218030213 https://hg.mozilla.org/mozilla-central/rev/a3ce1fce4f15616f66ac328e4a562d0117c93a0d Proof: http://i.imgur.com/6u68iku.jpg First bad build: buildID=20161219030207 https://hg.mozilla.org/mozilla-central/rev/863c2b61bd27bb6099104933134d3be7c052551a Proof: http://i.imgur.com/0HGmlaO.jpg The net effect of this bug on a fully updated Vista OS is the same as toggling pref \"media.wmf.enabled;true\" on a pre20161219 build. But this pref is now irrelevant after bug 1324183 landed on the Dec 19th 2016 nightly build...",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "Heh. Thanks for the pointer; I filed bug 1324790 to give an error message for these kinds of cases. Not out of spite, mind you, but because we're going to start using APIs elsewhere in the browser that don't exist on XP/Vista, and it'd be nice to give a reasonable error message up front rather than running into inscrutable errors later on.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1373154",
        "issue_id": 1373154,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We can just TimeStamp::Now() directly when needed.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "We already have a PlatformData for the thread in its ThreadInfo.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Bug 1357829 added a third kind of sample, in addition to the existing \"periodic\" and \"synchronous\" samples. This patch cleans things up around that change. In particular, it cleans up TickSample, which is a mess of semi-related things. The patch does the following. - It removes everything from TickSample except the register values and renames TickSample as Registers. Almost all the removed stuff is available in ThreadInfo anyway, and the patch adds a ThreadInfo argument to various functions. (Doing it this way wasn't possible until recently because a ThreadInfo wasn't available in profiler_get_backtrace() until recently.) One non-obvious consequence: in synchronous samples we used to use a value of 0 for the stackTop. Because synchronous samples now use ThreadInfo directly, they are able to use the proper stack top value from ThreadInfo::mStackTop. This will presumably only improve the quality of the stack traces. - It splits Tick() in two and renames the halves DoPeriodicSample() and DoSyncSample(). - It reorders arguments in some functions so that ProfileBuffer (the output) is always last, and inputs are passed in roughly the order they are obtained. - It adds a comment at the top of platform.cpp explaining the three kinds of sample. - It renames a couple of other things.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "This is a great improvement.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Could we pass the Registers object to the aDoSample func, instead of returning them as an outparam which the caller then captures into its lambda?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Can we have a follow-up to replace all instances of \"new ProfileBuffer\" with MakeUnique<ProfileBuffer>?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 7,
                "quote": "Can we have a follow-up to replace all instances of \"new ProfileBuffer\" with MakeUnique<ProfileBuffer>?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Sure: bug 1373436.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 9,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/48767f3f315f41ff152d4d3c8a9c418c7bb29aec Bug 1373154 (part 1) - Remove TickSample::mTimeStamp. r=mstange. https://hg.mozilla.org/integration/mozilla-inbound/rev/0e89b1564ea466ad1434fefffe446853bb154ec4 Bug 1373154 (part 2) - Don't call AllocPlatformData() in profiler_get_backtrace(). r=mstange. https://hg.mozilla.org/integration/mozilla-inbound/rev/ca4e62117e6ad325756b62de03917d4fb188165d Bug 1373154 (part 3) - Overhaul TickSample and things around it. r=mstange.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Backed out in https://hg.mozilla.org/integration/mozilla-inbound/rev/cd069d0b934e for the horror of Windows-only timeouts in devtools perf tests like https://treeherder.mozilla.org/logviewer.html#?job_id=107548547&repo=mozilla-inbound",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 11,
                "quote": "Well, this is weird. I did a bunch of try pushes and it clearly shows that part 1 is the culprit. Harmless looking part 1! Here's a run with just part 1 applied: https://treeherder.mozilla.org/#/jobs?repo=try&revision=a877377b61c2b0742e0e9fd6ae323f9ed824cc3e&selectedJob=107575159 (I also did a try run with no patches applied, just to be sure. It was all green.) The most relevant part of the crash info is this thread: > Thread 22 > 0 ntdll.dll!KiFastSystemCallRet + 0x0 > 1 ntdll.dll!ZwWaitForKeyedEvent + 0xc > 2 ntdll.dll!RtlpWaitCouldDeadlock + 0x35 > 3 mozglue.dll!mozilla::detail::MutexImpl::lock() [Mutex_windows.cpp:a877377b61c2 : 27 + 0x7] > 4 mozglue.dll!mozilla::detail::MutexImpl::lock() [Mutex_windows.cpp:a877377b61c2 : 27 + 0x7] > 5 xul.dll!profiler_suspend_and_sample_thread(int,std::function<void > const &,bool) [platform.cpp:a877377b61c2 : 3070 + 0x17] > 6 xul.dll!mozilla::ThreadStackHelper::GetStacksInternal(mozilla::Telemetry::HangStack *,std::vector<unsigned int,std::allocator<unsigned int> > *) [ThreadStackHelper.cpp:a877377b61c2 : 152 + 0x25] > 7 xul.dll!mozilla::BackgroundHangManager::RunMonitorThread() [BackgroundHangMonitor.cpp:a877377b61c2 : 345 + 0xb] > 8 xul.dll!mozilla::BackgroundHangManager::MonitorThread(void *) [BackgroundHangMonitor.cpp:a877377b61c2 : 67 + 0xb] > 9 nss3.dll!_PR_NativeRunThread [pruthr.c:a877377b61c2 : 397 + 0x6] > 10 nss3.dll!pr_root [w95thred.c:a877377b61c2 : 95 + 0xa] > 11 ucrtbase.dll!_o__CIpow + 0x4f > 12 kernel32.dll!BaseThreadInitThunk + 0x12 > 13 mozglue.dll!patched_BaseThreadInitThunk [WindowsDllBlocklist.cpp:a877377b61c2 : 849 + 0x15] > 14 ntdll.dll!__RtlUserThreadStart + 0x27 > 15 ntdll.dll!_RtlUserThreadStart + 0x1b It's crashing on the `PSAutoLock lock(gPSMutex)` line in profiler_suspend_and_sample_thread(). I can't tell from the treeherder log if this is really a crash or a hang. A couple of other threads are waiting to lock the mutex in TimeStamp_windows.cpp. I wonder if that's relevant, given that part 1 only changed some calls to TimeStamp::Now(). Even weirder, I did a try run yesterday with all three patches applied that was fine: https://treeherder.mozilla.org/#/jobs?repo=try&revision=6da4c3baa7971e936bf8e541c00468b4f883cf84&selectedJob=107272738",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Michael, could bug 1357829 have caused the problems discussed in comment 8? My successful try push yesterday was against mozilla-central, which probably didn't have that bug's patches on it at the time.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "I think the answer is that we can't do what you're doing in P1. The hang is happening because on thread 1, we're getting the following: 21:17:47 INFO - Thread 0 21:17:47 INFO - 0 ntdll.dll!RtlEnterCriticalSection + 0x17 21:17:47 INFO - eip = 0x777977b7 esp = 0x001fde0c ebp = 0x001fde20 ebx = 0x6b9de3b8 21:17:47 INFO - esi = 0x6b9de3bc edi = 0x6b9de3b8 eax = 0x6b9de3bc ecx = 0x001fde08 21:17:47 INFO - edx = 0x777970b4 efl = 0x00000217 21:17:47 INFO - Found by: given as instruction pointer in context 21:17:47 INFO - 1 mozglue.dll!mozilla::PerformanceCounter [TimeStamp_windows.cpp:ca4e62117e6a : 203 + 0xc] 21:17:47 INFO - eip = 0x6b9ca7c9 esp = 0x001fde28 ebp = 0x001fde3c 21:17:47 INFO - Found by: call frame info 21:17:47 INFO - 2 mozglue.dll!mozilla::TimeStamp::Now(bool) [TimeStamp_windows.cpp:ca4e62117e6a : 552 + 0x5] 21:17:47 INFO - eip = 0x6b9ca751 esp = 0x001fde44 ebp = 0x001fde6c 21:17:47 INFO - Found by: call frame info Namely, calling PerformanceCounter (which is part of the windows implementation of Now - http://searchfox.org/mozilla-central/rev/20d16dadd336e0c6b97e3e19dc4ff907744b5734/mozglue/misc/TimeStamp_windows.cpp#536) grabs a lock within windows. It's super dangerous to grab a lock while the main thread is suspended in the profiler, which is probably why we grabbed the timestamp before suspending the main thread before.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 14,
                "quote": "I would recommend just leaving in the member variable, and continuing to grab the timestamp before suspending the main thread.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 15,
                "quote": "Thanks for the explanation! Seems plausible. Though it doesn't explain why my first try run was successful; that may have to remain a mystery.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 16,
                "quote": "That won't quite work with the following patches -- the containing struct is being heavily modified -- but I can do something functionally equivalent by passing in the TimeStamp as an extra argument. One downside of getting the TimeStamp in advance is that we don't need it for profiler_suspend_and_sample_thread(). But a small amount of wasted work is better than a deadlock :)",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 17,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/467a9d5b075a7fe2fd17ccd5c384266a78e9fb46 Bug 1373154 (part 1, attempt 2) - Add more comments about the profiler's critical section. r=me. https://hg.mozilla.org/integration/mozilla-inbound/rev/dd7aafba79b287a27baa93be20dd688340967446 Bug 1373154 (part 2, attempt 2) - Don't call AllocPlatformData() in profiler_get_backtrace(). r=mstange. https://hg.mozilla.org/integration/mozilla-inbound/rev/f8819d808fba2abb8f8880dd241c761fa3475940 Bug 1373154 (part 3, attempt 2) - Overhaul TickSample and things around it. r=mstange.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=698552",
        "issue_id": 698552,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is what I will do: * python client.py update_nss NSS_3_13_2_MOZILLA_10_PRERELEASE_1. * verify that security/coreconf/coreconf.dep is +/- a line * update configure.in to require NSS 3.13.2 or later for --use-system-nss.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I will update to NSS 3.13.2 using: python client.py update_nss NSS_3_13_2_BETA1",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "I verified that this will add a blank line to security/coreconf/coreconf.def so that a full rebuild of NSS is done.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Update configure.in to require at least NSS 3.13.2 for --use-system-nss \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "This patch is a Mercurial patch that adds two patches reviewed by rrelyea in bug 542832 to NSS in mozilla-central: bug-542832-ssl-restart-4.patch bug-542832-ssl-restart-tstclnt-4.patch We are taking these local patches so we can start testing the functionality in mozilla-central, while we wait for feedback from Wan-Teh about any changes Google would like to make to the patches. Once all the feedback is in and the final changes (if any) are made, we will commit this to the NSS CVS HEAD, back out this patch, and then import the final NSS 3.13.2 release into mozilla-central. Notice that this patch adds the above patch files to the security/patches/ directory, as is required for patches to NSS that are local to mozilla-central.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Honza, please work with Kai on reviewing the patch, to make sure you understand everything that is happening. See the documentation for this at https://developer.mozilla.org/en/Updating_NSPR_or_NSS_in_mozilla-central",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "If I understand correctly, both patches have been reviewed in bug 542832 already.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "During the conf. call the NSS team decided this is OK. r=kaie",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Update configure.in to require at least NSS 3.13.2 for --use-system-nss r=kaie",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I assume this is identical to the patches, already reviewed, mentioned attached in the bug you have mentioned, plus adding the patch file to the security/patches directory. During the conf. call, Wan-Teh requested that you also add/update a README file in that directory, and add the respective bug numbers and a one line description of the patch. If you do that, r=kaie (it's not necessary to add a patch here, just commit a reasonable README file)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "r=honzab, I checked (in limits of how CVS and HG patches can be compared byte-to-byte) the patches are identical.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "I filed bug 707300 about changing this in NSS CVS. Please reply to my question in that bug.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1116867",
        "issue_id": 1116867,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I tried this same thing in my regular Nightly session, and nothing obviously bad happened, so maybe it is just an overly strict assertion.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Same thing happens with techcrunch.com, cnn.com, and a few other random sites I tried loading.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Though the values were different for \"progress\".",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Patrick, what's the significance of this bug? Should we be tracking it for e10s?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "jason is probably in a better place with the ipdl code to answer the question.. valentin has a repro in 1117442 that he's working.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "I am not able to reproduce any issues (comment 0 or comment 3) with the linux 64 nightly debug build (2015-01-05). I tested in e10s mode on the same sites mentioned.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "It is likely a related fix landed as part of bug 1115976, but this landed on 2015-01-03, which confuses me, since comment 3 is from 2015-01-05.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "Andrew, do you still see this even in the latest debug nightly?",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "I downloaded firefox-37.0a1.en-US.debug-mac64.dmg from here: ftp://ftp.mozilla.org/pub/firefox/nightly/2015-01-06-mozilla-central-debug/ (there's no OSX nightly for 1-7 yet for some reason) and I can reproduce it, in a fresh profile, with e10s enabled. My steps to reproduce: 1. Hit shift-command-J to open the Browser Console. 2. Click over to the address bar in the main window. 3. Type \"google.com\" and hit enter.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 10,
                "quote": "Okay, I am able to reproduce this now.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 11,
                "quote": "What happens is that the Network Monitor code (which is used when the Browser Console is open) intercepts onProgress for its own purposes, and then forwards the message along to the original onProgress listener. Usually, this works correctly. However, if |progressMax| is 0xFFFFFFFFFFFFFFFF (the \"unknown\" value), things get messed up since we are now going C++ -> JS -> C++, and JS can't safely represent integers that large, so it ends up getting forced to 0 when leaving JS. I tried clamping the value down to Number.MAX_SAFE_INTEGER, and this does fix the assertion and crash. However, I see that are some C++ cases where we check for exactly UINT64_MAX. Is there some secret way I can force the JS -> C++ XPCOM conversion to allow JS to pass UINT64_MAX safely?",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "I tried clamping the value down to Number.MAX_SAFE_INTEGER, and this does fix the assertion and crash. However, I see that are some C++ cases where we check for exactly UINT64_MAX.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 13,
                "quote": "So nsIProgressEventSink is a broken interface, at least for JS.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 14,
                "quote": "I think we should update it to use a new constant nsIProgressEventSink::MAX_PROGRESS_UNKNOWN that is set to 2^53 - 1 and change each of the ~10 C++ implementations to use that instead of UINT64_MAX That ought to fix the problem",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 15,
                "quote": "this isn't really an e10s problem.. we see it in e10s because of an assert in the message marshalling code for onProgress().. but the root of it is that when OnProgress, which is a scriptable interface, goes through js a sentinel value is out of range of MAX_SAFE_INTEGER.. so it can't really use the interface correctly.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "In bug 731318, we added code to net monitor which triggers this issue if the Browser Console or DevTools toolbox is open. This landed in 37.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "It's a crash on e10s because HttpChannelChild uses MOZ_ASSERT[1], which forces a crash. The same problem happens without e10s, but it's only an NS_WARNING[2].",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "cool. so 731318 exposes a latent bug. we need to choose between backing that out of 37, or backporting the fix of the long time bug (which is going to have to include a breaking idl change) onto aurora. what do you think?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 19,
                "quote": "I was hoping to construct a safe way to disable for e10s only, but since the merge is on Monday, it's probably best to back out bug 731318. I'll do this now.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Actually, this isn't really an e10s thing. only e10s throws the assert, so we notice it more there, but the single process code path is also going to corrupt maxProgress when it goes through js boundaries - it will just happen silently. The code in places like docshell that checks uint_max64 will do the wrong thing in those cases.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "These scriptable interfaces use uint_64 arguments with sentinel values of UINT64_MAX. However, UINT64_MAX exceeds MAX_SAFE_NUMBER and cannot be gatewayed to/from javascript - so they cannot be used correctly. Change them to use signed 64 bit numbers and -1 as the sentinnel. C++ implementations ought to be enough to audit as the special value could never be used correctly in JS anyhow - also audited OnProgressChange() uses for downstream use of this data.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "honza, I'll have bz r the xhr bits after the necko side gets squared away.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "I put this in reviewboard too.. maybe you want to experiment with using that. nick and I have been using it successfully for larger patches. Doesn't matter to me which way we go.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 24,
                "quote": "JS uses the term MAX_SAFE_INTEGER not MAX_SAFE_NUMBER, probably best to use the same terminology.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "aCount's already uint64",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "These scriptable interfaces use uint_64 arguments with sentinel values of UINT64_MAX. However, UINT64_MAX exceeds MAX_SAFE_NUMBER and cannot be gatewayed to/from javascript - so they cannot be used correctly. Change them to use signed 64 bit numbers and -1 as the sentinnel. C++ implementations ought to be enough to audit as the special value could never be used correctly in JS anyhow - also audited OnProgressChange() uses for downstream use of this data.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 27,
                "quote": "(you can see in the diff on the try run that I changed a printf specifier in one of the C++ tests.. that's the only change)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "We can well get to loaded < 0 here, but out of scope of this bug.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Here are some weird casts left..",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "indent",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "lld ?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "no need to cast",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 33,
                "quote": "Isn't there a define? if not, can you please create one in some \"net.h\" or so?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "And this still uses unsigned",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "If you find some way to split this assert so that we know the progressMax value, I'd love that",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "Ship It!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "I can't figure this comment out.. OnProgress is changed by this patch to take unsigned",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "bz can you look at (at least) the xhr part?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 39,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/91e1a0afee55",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 40,
                "quote": "So I was worried about binary extensions, but the good news is that testing an int64_t for equality against UINT64_MAX is the same as testing it for equality against -1, both in terms of machine code and C/C++ integer promotion behavior. So there should be pretty minimal fallout, if any.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 41,
                "quote": "I would prefer we had an actual constant for MAX_SAFE_JS_INTEGER or JS_MAX_SAFE_INTEGER or whatever somewhere, either in jsapi headers (probably preferred) or at least somewhere in mfbt or something. Then we could also static_assert things like the value being < INT64_MAX.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "The \"tbd\" comment here should go away, right?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "Yeah, this is why I'd prefer a named constant.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "Named constant.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "Named constant. r=me with the nits fixed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 46,
                "quote": "I got lost between the patches. But this one seems to be the r+comments I've already made before (comment 31).",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=991812",
        "issue_id": 991812,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Rather than figure out all the ways in which this stuff is not at parity with the existing stuff, let's just use the thing that already works.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "This class is very weird, and is not directly usable with this change. Also, as far as I can tell, it's actually dead code. If this compiles, I guess it's fine, but please file a follow-up to remove it completely.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Patch for AtomicRefCounted \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Remove a few more.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Please either make this a class again or switch the forward declarations to be a struct as well (MSVC will barf at this).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "And in b2g code.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "nsRefPtr please.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "nsRefPtr please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Backed out for B2G bustage. https://hg.mozilla.org/integration/mozilla-inbound/rev/376496720a0e https://tbpl.mozilla.org/php/getParsedLog.php?id=37777059&tree=Mozilla-Inbound",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 10,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/b54fdf8bb486 https://hg.mozilla.org/mozilla-central/rev/076cdafa93f5 https://hg.mozilla.org/mozilla-central/rev/0c55cac422f2 https://hg.mozilla.org/mozilla-central/rev/3d7bfc590ccd",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "One place this change seems to fall down is when using LazyIdleThread. The LazyIdleThread only ever has one thread at a time, but that thread can go away and a new thread can come back at some future time. This in turn, can cause http://dxr.mozilla.org/mozilla-central/source/xpcom/glue/nsISupportsImpl.h#57 to fire.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 12,
                "quote": "I ran into this in bug 998097. The easy fix seems to just be to make the ref count thread safe. Any other uses of LazyIdleThread and non-threadsafe ref counts may also trip over this.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 13,
                "quote": "Yeah I think we should make that refcount threadsafe as well... Please file a follow-up?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 14,
                "quote": "Can you please file a follow-up to fix all of the remaining cases for other consumers of LazyIdleThread? Thankfully that class seems to only be used in 5 places. Thanks!",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 15,
                "quote": "I filed bug 999864",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=840284",
        "issue_id": 840284,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I think so. Would be interesting to have a random code generator based on the type system itself, and/or to mutate asm.js from emscripten in ways that *do* keep it asm.js, not just break out of it. Both would test things just emscripten output does not.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Additionally, it would be interesting to throw a C fuzzer in front of Emscripten :)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Csmith (http://embed.cs.utah.edu/csmith/) is a high-quality C fuzzer. They say that they've found bugs in every tool they've tested with it. The same research group also produces a test case reducer: http://embed.cs.utah.edu/creduce/",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "As Sam already said, Csmith is the tool of choice for C mutation. LangFuzz can also mutate C with an appropriate grammar, but is not aware of any type system logic in the language, therefore unsuitable for strongly typed languages.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Thanks, I'll take a look at Csmith in emscripten. We should still do fuzzing on the emscripten output though, because the space of outputs generated from clang+emscripten is still constrained, even with random input to it.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Agreed. Between Csmith+Emscripten and decoder's mutation-based fuzzer on Emscripten output, it seems like we'll have good coverage of validating and non-validating inputs.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Linux64 and OSX64 are done (except for the bugs, of course), so we are ready for fuzzing. You should be able to pull http://hg.mozilla.org/users/lwagner_mozilla.com/odinmonkey/ and build. A threadsafe shell would be useful since it allows more realistic operation-callback testing (just add a 'timeout(X)' call at the beginning and the watchdog thread will start firing interrupts every 1/10 of a second). Attached is the Emscripten benchmark suite; just run each file individually from the shell (no args). You should see \"warning: Successfully compiled asm.js code\" printed to the console. A few notes/ideas for fuzzing: - It would be good to direct mutations to *inside* function containing the \"use asm\" directive. - Some of the benchmarks are tiny (corrections, memopsnjn, primes, copy) and short-running, so it would be fruitful to inject probably-valid asm.js into these scripts to see if you can get a crash or divergent behavior (compared to running either on a trunk shell or an odin shell with the \"use asm\" directive removed). Note: different recursion limits are expected. - Other benchmarks are quite large (bullet.js, fannkuch.js, zlib) and take longer to run (esp if the code doesn't asm.js-type-check; several of these benchmarks are 5-10x slower w/o odin). However, they compile relatively quickly (<1s) so these would be good files to mutate randomly to test for errors in the typechecker/compiler. If you set warnings-as-errors (options(\"werror\") toggles this option), you'll get a clean exception when compilation succeeds/fails and not have to wait for the actual script to run. Let me know if you have any problems or ideas. Alon said he started looking at Csmith and it's already caught an Emscripten bug; I think he'll turn the guns on Odin after he gets out from under the MWC work.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Sure. In bug 842411, I changed the threadsafe shell so that, when you call \"timeout(X)\", the watchdog thread will JS_TriggerOperationCallback every 10th of a second. Before X seconds have elapsed, the operation callback will return \"true\", allowing execution to continue.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "That'd work. An improvement would be to add a parameter that lets you configure how often the interrupt occurs. I was using 10,000 times a second earlier to really stress the Odin path.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 10,
                "quote": "I agree, using timeout for fuzzing won't work. Especially with LangFuzz, the \"replay\" timing is different to the timing while the fuzzer is actually running. Tests are unlikely to reproduce/reduce later on.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "We just made a fix in the asm.js spec (http://hg.mozilla.org/users/lwagner_mozilla.com/odinmonkey/rev/f61b4dacc3d1) and type system that will reject one of the benchmarks in the previous zip (bullet). Here is the new version of all the benchmark files. Let the assault continue. (Thanks!)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "I've been running the csmith fuzzer, which generates C code, then compiling that to asm.js. So far I've not found a single bug in OdinMonkey, but I've found several in emscripten and LLVM. decoder, if it would be useful, I can provide a bunch (let me know how many) of randomly-generated asm.js code from csmith for JS-level fuzzing.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "Here are ~100 csmith reduced testcases. I turned on full debug logging in them so they do more ffi calls.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 14,
                "quote": "Christian: Linux32 and OSX32 should work now, please feel free to fuzz them. They use a different protection mechanism (segmentation) and the IonMonkey load/store codegen is different, so it'd be valuable to give one of these a go.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "Per policy at https://wiki.mozilla.org/Bug_Triage/Projects/Bug_Handling/Bug_Husbandry#Inactive_Bugs. If this bug is not an enhancement request or a bug not present in a supported release of Firefox, then it may be reopened.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1105771",
        "issue_id": 1105771,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Confirmed in 37.0a1 (2014-12-05) Win 7",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Our decoders do not support avc3 at present. Could quite easily change FFmpeg h264 decoder to support it, but that won't get us very far...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Extract SPS and PPS NAL from data stream and build extradata from it",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Delay decoder creation until we have all the information to do so.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Add avc3 playback support",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "This should use ByteReader because it protects against all the run-time out of range conditions.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Now would be a good opportunity to move this logic and the above >=7 and |= 3 into the AnnexB class.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Updating the video config seems like a nasty side-effect to have in DemuxVideoSample(). This could perhaps be solved by moving extra_data out of VideoConfig altogether.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "The rest of this patch looks fine to me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "These lines seem unnecessary. We could always create the video decoder.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "well, no, CreateVideoDecoder may fail. NS_ENSURE_SUCCESS will return if rv isn't NS_OK. rather confusing macro I admit, but it's how it was used",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Sorry - that was a typo. We should always create the video decoder lazily rather than having two execution paths, as discussed on IRC.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Retrieve SPS and PPS from AVCC stream when necessary Will take a different approach. It will be up to the decoder to handle the AVC format, not the demuxer",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 14,
                "quote": "David, I have this video playing now, but just like your other MSE sample, it has broken timestamps. The cts offset are marked as being unsigned (version 0 trun), yet are negative (bug 1105778).",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 15,
                "quote": "Bug 1111311 addresses that problem, but still better following the specs.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 16,
                "quote": "I see that Bug 1111311 has now landed in Nightly which makes this less of an issue but, as you say, still better to follow the spec.",
                "code": "SOLUTION_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=627984",
        "issue_id": 627984,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Looks like we mess up the write barrier here. Watch sets a getter which makes shape no longer say yes to \"isMethod\", and resolving another method on that causes bad things. Pretty sketchy stuff.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This is the state right before we hit the methodReadBarrier in print(o.p). The object has clearly not the right method value in the slot",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "We call the watch point in SetMethod after we have updated the shape and then write that value into the slot. The watch point returns undefined and that value is written. It might be possible to trick the property cache into calling the wrong function with this: (gdb) s obj_watch_handler (cx=0x1008130e0, obj=0x100d0d068, id={asBits = 4299215808}, old={asBits = 18444773748872577024, debugView = {payload47 = 0, tag = JSVAL_TAG_UNDEFINED}, s = {payload = {i32 = 0, u32 = 0, why = JS_ARRAY_HOLE, word = 18444773748872577024}}, asDouble = -nan(0x9000000000000), asPtr = 0xfff9000000000000}, nvp=0x7fff5fbfed90, closure=0x100d0e058) at ../jsobj.cpp:1310 1310 callable = (JSObject *) closure; (gdb) n 1312 callbacks = JS_GetSecurityCallbacks(cx); (gdb) n 1313 if (callbacks && callbacks->findObjectPrincipals) { (gdb) n 1332 key.obj = obj; (gdb) n 1333 key.id = id; (gdb) n 1334 if (!js_StartResolving(cx, &key, JSRESFLAG_WATCH, &entry)) (gdb) n 1336 if (!entry) (gdb) n 1338 generation = cx->resolvingTable->generation; (gdb) n 1340 argv[0] = IdToValue(id); (gdb) n 1341 argv[1] = Valueify(old); (gdb) n 1342 argv[2] = Valueify(*nvp); (gdb) n 1343 ok = ExternalInvoke(cx, obj, ObjectOrNullValue(callable), 3, argv, Valueify(nvp)); (gdb) p *nvp $63 = { asBits = 18445477440623000960, debugView = { payload47 = 4308647296, tag = JSVAL_TAG_OBJECT }, s = { payload = { i32 = 13680000, u32 = 13680000, why = 13680000, word = 18445477440623000960 } }, asDouble = -nan(0xb800100d0bd80), asPtr = 0xfffb800100d0bd80 } (gdb) n 1344 js_StopResolving(cx, &key, JSRESFLAG_WATCH, entry, generation); (gdb) p *nvp $64 = { asBits = 18444773748872577024, debugView = { payload47 = 0, tag = JSVAL_TAG_UNDEFINED }, s = { payload = { i32 = 0, u32 = 0, why = JS_ARRAY_HOLE, word = 18444773748872577024 } }, asDouble = -nan(0x9000000000000), asPtr = 0xfff9000000000000 } (gdb) (gdb) l 5662 getter = CastAsPropertyOp(funobj); 5663 } 5664 } 5665 5666 shape = obj->putProperty(cx, id, getter, setter, SHAPE_INVALID_SLOT, 5667 attrs, flags, shortid); 5668 if (!shape) 5669 return JS_FALSE; 5670 5671 if (defineHow & JSDNP_CACHE_RESULT) (gdb) n 5668 if (!shape) (gdb) n 5671 if (defineHow & JSDNP_CACHE_RESULT) (gdb) n 5672 TRACE_1(AddProperty, obj); (gdb) l 5667 attrs, flags, shortid); 5668 if (!shape) 5669 return JS_FALSE; 5670 5671 if (defineHow & JSDNP_CACHE_RESULT) 5672 TRACE_1(AddProperty, obj); 5673 5674 /* 5675 * Initialize the new property value (passed to setter) to undefined. 5676 * Note that we store before calling addProperty, to match the order (gdb) n 5679 if (obj->containsSlot(shape->slot)) (gdb) n 5680 obj->nativeSetSlot(shape->slot, UndefinedValue()); (gdb) n 5683 if (!CallAddPropertyHook(cx, clasp, obj, shape, vp)) { (gdb) p *vp $54 = { data = { asBits = 18445477440623000960, debugView = { payload47 = 4308647296, tag = JSVAL_TAG_OBJECT }, s = { payload = { i32 = 13680000, u32 = 13680000, why = 13680000, word = 18445477440623000960 } }, asDouble = -nan(0xb800100d0bd80), asPtr = 0xfffb800100d0bd80 } } (gdb) call js_DumpValue(*vp) <unnamed function (x.js:6) at 0x100d0bd80 (JSFunction at 0x100d0bd80)> (gdb) s CallAddPropertyHook (cx=0x1008130e0, clasp=0x100438ea0, obj=0x100d0d068, shape=0x10111a5c8, vp=0x7fff5fbfed90) at ../jsobj.cpp:4576 4576 if (clasp->addProperty != PropertyStub) { (gdb) n 4586 return true; (gdb) fin Run till exit from #0 CallAddPropertyHook (cx=0x1008130e0, clasp=0x100438ea0, obj=0x100d0d068, shape=0x10111a5c8, vp=0x7fff5fbfed90) at ../jsobj.cpp:4586 0x0000000100106c62 in js_SetPropertyHelper (cx=0x1008130e0, obj=0x100d0d068, id={asBits = 4299215808}, defineHow=5, vp=0x7fff5fbfed90, strict=0) at ../jsobj.cpp:5683 5683 if (!CallAddPropertyHook(cx, clasp, obj, shape, vp)) { Value returned is $55 = true (gdb) n 5687 added = true; (gdb) p *vp $56 = { data = { asBits = 18445477440623000960, debugView = { payload47 = 4308647296, tag = JSVAL_TAG_OBJECT }, s = { payload = { i32 = 13680000, u32 = 13680000, why = 13680000, word = 18445477440623000960 } }, asDouble = -nan(0xb800100d0bd80), asPtr = 0xfffb800100d0bd80 } } (gdb) n 5690 if (defineHow & JSDNP_CACHE_RESULT) (gdb) n 5691 JS_PROPERTY_CACHE(cx).fill(cx, obj, 0, 0, obj, shape, added); (gdb) n 5693 return js_NativeSet(cx, obj, shape, added, vp);",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "There is a bunch of bugs here actually. In js_NativeSet we never trigger the method write barrier if a property is added (added=true), because we think that can't cause a shape change, but that's not true for watchpoint setters which fire for additions as well since they are persistent. So in other words watch makes our write barrier more expensive in general. Super lame. There is a second bug. The slot is initialized to undefined when we call the setter, so even if we would call the method write barrier it would see undefined (old) == undefined (new) and not brand.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I think this is all pretty seriously broken and all sorts of unsafe. I vote for a hard blocker.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "OK. My first instinct here was to trigger the method *read* barrier in UpdateWatchpointShape. If a method property would be watched, the barrier would convert it an ordinary data property. Then you would watch that. But that would go seriously against the grain, because UpdateWatchpointShape gets called at a point where the method property has been added, but before the slot is filled. So for now watchpoints need to know about the method barrier. (Which after all is only consistent. They know about everything else.)",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "There are three bugs I know very clearly how to fix. 1. js_watch_set passes the property's old slot value (the one we're about to overwrite) to wp->handler without checking to see if the property is a method. If it's a method, the old value is an uncloned function object that must not be exposed to script! The fix is for js_watch_set to trip the read barrier before calling wp->handler. 2. js_watch_set can get called at an unfortunate time. The order of adding a data property, such as a method, is like this: - add the shape to the object - call the setter - store the value in the slot So suppose we watch a property, then delete it, and then use JSOP_INITMETHOD to create it again. Here's what happens: - add the (watched method) shape to the object - call js_watch_set, which calls wp->handler - store the uncloned function object in the slot Note js_watch_set is called *after* the METHOD property is added to obj but *before* the slot is assigned. So the slot value is undefined. To my mind, this state is a violation of the method invariant. We do not want to be calling back into the interpreter with the object in that state. The fix, again, is for js_watch_set to trip the method barrier before calling wp->handler. 3. The watchpoint handler could delete the property and re-add it as a method property again. Then whatever value it returns must not be stored in the slot of that method property; it would violate the method invariant. So after the handler returns, we probably need to call methodWriteBarrier. (This one I'm not quite sure about.) There are also at least 2 other issues: 4. Bug 631723 - Deleted watchpoints can make obj->addProperty/putProperty return a shape not in obj. 5. If wp->handler deletes the property, wp->shape is not set to NULL. I think I have seen wp->shape be wrong (that is, != obj->nativeLookup(propid)) in other circumstances, too, which would be bad. This needs another look, possibly in a follow-up bug.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "1. js_watch_set passes the property's old slot value (the one we're about to overwrite) to wp->handler without checking to see if the property is a method. If it's a method, the old value is an uncloned function object that must not be exposed to script! The fix is for js_watch_set to trip the read barrier before calling wp->handler. 2. js_watch_set can get called at an unfortunate time. The order of adding a data property, such as a method, is like this: - add the shape to the object - call the setter - store the value in the slot So suppose we watch a property, then delete it, and then use JSOP_INITMETHOD to create it again. Here's what happens: - add the (watched method) shape to the object - call js_watch_set, which calls wp->handler - store the uncloned function object in the slot Note js_watch_set is called *after* the METHOD property is added to obj but *before* the slot is assigned. So the slot value is undefined. To my mind, this state is a violation of the method invariant. We do not want to be calling back into the interpreter with the object in that state. The fix, again, is for js_watch_set to trip the method barrier before calling wp->handler. 3. The watchpoint handler could delete the property and re-add it as a method property again. Then whatever value it returns must not be stored in the slot of that method property; it would violate the method invariant. So after the handler returns, we probably need to call methodWriteBarrier. (This one I'm not quite sure about.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "6. js_NativeSet skips the slot write if the before and after shape of the property are different. This means that unwatching from a watchpoint can cause the slot write to be skipped: var obj = {m: 'o'}; var other = {a: 1}; obj.watch(\"m\", function (id, oldval, newval) { delete other.a; obj.unwatch('m'); return newval; }); obj.m = 'n'; // since the watchpoint unconditionally returns newval, // this value should not be lost assertEq(obj.m, 'n'); // FAILS Similarly, scripts can detect the transition to dictionary mode (which re-creates all Shapes) this way. var N = 129; var obj = {m: \"fail\"}; var other = {a: 1}; obj.watch(\"m\", function (id, oldval, newval) { for (var j = 0; j < N; j++) obj['x' + j] = 0; delete other.a; return newval; }); obj.m = 'ok'; assertEq(obj.m, 'ok'); // FAILS when N >= 128",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I found another bug. 7. A method is ostensibly an ordinary data property--but getting its value the first time will trigger a watchpoint on that property. var obj = {m: function () {}}; obj.watch(\"m\", function () { throw 'FAIL'; }); var f = obj.m; // FAIL",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "This patch applies on top of the patches in bug 631723 and bug 631305. This patch does not address comment 17 item 5 or comment 18 item 6. I will file follow-up bugs for those.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Wow, what a mess indeed. Sorry I forgot about watchpoints when doing the method stuff. Could you fix sevearl of these bugs before the js_watch_set setter is invoked, in js_UpdateWatchpointsForShape? Joined methods are an optimization, so deoptimizing as soon as there's sign of a watchpoint seems fine, and it looks from this patch like it would be simpler.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "Two reasons not to do it that way: first, js_UpdateWatchpointsForShape is called at a weird time; the method property exists but the slot isn't populated yet. No big deal; I could populate the slot from shape->methodValue(), then trip the read barrier. Second, and more importantly, js_UpdateWatchpointsForShape's relevant caller (js_SetPropertyHelper) doesn't expect it to trip the read barrier, so it will unconditionally write the noncloned function to the slot. To avoid that, the caller would have to check whether js_UpdateWatchpointsForShape changed the shape. That adds a branch to the no-watchpoint path, and it complicates code outside jsdbgapi.cpp.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "So I put the added complexity in js_watch_set, which seemed more consistent with the design.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 15,
                "quote": "Jason's right, the ancient watchpoint design, which predates user-defined setters, tries to modularize watchpoints by putting their overhead behind a setter wrapper. This hasn't aged particularly well. His preferred approach would add a few if (JS_UNLIKELY(obj->watched())) { // obj->flags & WATCHED . . . } clauses. Sounds worth filing and doing after fx4.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Nit: spaces around --, should rewrap nicely.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Uncomment (fix if needed?) or remove.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Super-duper-nit: no need to parenthesize the whole ?: expression.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Would wrap better if written /* * It is not the setter's job to call methodWriteBarrier, * but js_watch_set must do so, because the caller will be * fooled into not doing it: shape does *not* have the * default setter and therefore seems not to be a method. */ Great work, r=me. Thanks for diving on this grenade.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "http://hg.mozilla.org/tracemonkey/rev/589bb166be02",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=552359",
        "issue_id": 552359,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I don't see how my caret cleanup (bug 544852) could have broken this but I could be missing something...",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This orange boils down to the fact that the input text boxes are not actually focused.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "I think the issue will be solved by making sure that the reftest window is in foreground while reftests are running.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "So, this patch does two things. First, it uses the onfocus event handler on input elements to make sure to run the test only when they're focused. It also modifies the reftest platform to make sure that the window is raised and focused before running each test.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "This same code is used for browser chrome tests, but it doesn't work in the reftest framework.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "I couldn't figure out why, asking for Neil's feedback who knows a lot more about our focus code than me.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Hmmm. I rather liked the idea that reftests can work even when the window isn't focused.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Caret reftests depend on having focus too. What I would really like to do is have a way for tests to *pretend* a browser window has OS-level focus when it really doesn't.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "This particular problem, I think, shows an actual problem in the focus code. Neil said that he's willing to debug this. To debug this, run the reftests like this: /path/to/firefox -reftest layout/reftests/forms/placeholder/reftest.list so that the Firefox window is initially in the background. Running tests that way makes them fail 100% of the time for me.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Replacing the focus manager with a mock (controllable by preference) might be an interesting possibility, although preserving ability to dispatch and respond to OS-level events seems tricky.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "So, Neil said that the main reason behind the problem is that the XUL browser element inside the chrome document is not focused.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Calling gBrowser.focus() seems to solve the problem.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 13,
                "quote": "So, I've fixed that problem in this patch. I've also modified the placeholder reftests to actually depends on the focus event. This means that they would still fail if the window is not focused, but they would time out this time, which is a lot better (at least, it's not misleading as a rendering problem.) Also, note that the Tinderbox machines use |make reftest| which uses automation.py which passes -foreground to firefox, and it makes sure that the window is initially raised on Mac. I think that the attached patch is enough for this bug.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "FYI, on Linux, you can use Xephyr to run tests on its own X server to avoid focus problems. As a bonus, it also makes it easier to limit CPU resources using 'nice' for the tests.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "I still have a random orange for placeholder-7.html. On 10 tries, I got it failing 7 times.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 16,
                "quote": "I simple workaround is to change disableReftestWait(); to setTimeout(disableReftestWait, 5);.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 17,
                "quote": "Attached patch Patch for placeholder-7.html \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Adding timeouts generally doesn't fix orange, it just makes it harder to reproduce. We need to understand why this test fails without the timeout and then we can fix it properly.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Someone else can reproduce this random failure ?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 20,
                "quote": "Then I think this should be another bug, but let's make sure.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 21,
                "quote": "If you get the same failure with make reftest as well, please file a new bug and attach a reftest log of the failure.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 22,
                "quote": "Hmm, based on this log, this is a different bug. Please file it separately.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 23,
                "quote": "Also, it would be great if you could debug this locally (because I haven't been able to reproduce this). You could set a breakpoint in nsCaret::DrawCaret, and see the code path which invokes it for the reference file, and see what happens differently in the original test file when this fails randomly.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 24,
                "quote": "bug 565594 opened. Thansk Ehsan :)",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1003694",
        "issue_id": 1003694,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is flooding jsfunfuzz results.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "JSBugMon: Bisection requested, result: === Tinderbox Build Bisection Results by autoBisect === The \"good\" changeset has the timestamp \"20140429192012\" and the hash \"c0d658d3f739\". The \"bad\" changeset has the timestamp \"20140429210107\" and the hash \"429d4d1f49e1\". Likely regression window: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=c0d658d3f739&tochange=429d4d1f49e1",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I am not sure about the above regression range, but I am able to reproduce it after the landing of Bug 990106 patches, which is by the way adding this assertion.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Settle on first frame by skipping all allocations. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Looks like a security bug to me. I'm getting various crashes [@ js::jit::InlineFrameIteratorMaybeGC<(js::AllowGC)1>::findNextFrame] with bad reads.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "JSBugMon: This bug has been automatically verified fixed.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "JSBugMon: This bug has been automatically verified fixed on Fx32",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1118597",
        "issue_id": 1118597,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In debugging this, it looked like the auxInfoType of the saiz box was 'sinf', and so we didn't setup crypto data. We set the default auxInfoType of the saiz box to \"sinf\", but ISO/IEC 23001-7:2012(E) says that for CENC files a auxInfoType of 'cenc' should be assumed. I still crashed when I changed the default, so that's not the only problem.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch 1118597.patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch 1118597-enable-moofparser-eme.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "I'm not a fan a cascade of parseXXX that you have now. The existing style was to have constructor taking a Box and being \"self-aware\".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "please document where those values come from",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "probably should check that child offset is still within the box range and abort if not.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "can't we just exit and stop there. File won't play but at least it won't crash",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "it's a carry-on from earlier, but I dislike the use of &cenc[0] ; this will assert if the array is empty. cenc.Elements() won't",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "test return value of ReadArray",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "can't you simply break the loop instead? no need to loop when we're not going to do anything later",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "a bit inconsistent with the rest of the code, make them private member of MoofReader",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "test that we have 8 bytes available in BoxReader",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "and here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "test that we have 4 + 3 + 1 + 16...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "The construction of the Sinf should be done in a Sinf constructor that takes a Box& argument (in line with the rest of the code)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "and here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Build the Sinf in a Sinf(Box& aBox) constructor, similar to all other atoms.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "if you takes two arguments, you don't need explicit. However, I think it should take the info type as argument rather than the Sinf; so we untangle what is starting to become messy. Keep it abstracted so a Saiz and Saio box don't need to be aware of the internal implementation of the Sinf",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "same as above, take the encryption type as argument",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "I meant: if (box.IsType(\"sinf\")) { ParseSinf(box); if (mSinf.IsValid()) { break; } though ParseSinf should return a boolean that it has succeeded.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Addressed review comments and IRC comments.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Actually address review comments and IRC comments.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "r=me with nits addressed",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "existing problem, but as this patch is a fix, should test the cenc contains the right amount of bytes and is well formed (otherwise this will assert).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "mSinf.IsValid() isn't required as as soon it is valid we exit the loop",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "mSaizs.AppendElement(Saiz(box, aSinf.GetEncryptionType())",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "not required if you simply override IsValid()",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "warning unused variables...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "warning unused variables...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "Should probably have a method to check that Box is valid, as right now any errors reading the box and setting its member won't be propagated. This can be done in a another patch/bug #",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "0:03.87 Warning: -Wreorder in /Users/jyavenard/Work/Mozilla/mozilla-central/media/libstagefright/binding/include/mp4_demuxer/SinfParser.h: field 'mDefaultEncryptionType' will be initialized after field 'mDefaultIVSize' 0:03.87 /Users/jyavenard/Work/Mozilla/mozilla-central/media/libstagefright/binding/include/mp4_demuxer/SinfParser.h:20:7: warning: field 'mDefaultEncryptionType' will be initialized after field 'mDefaultIVSize' [-Wreorder] 0:03.87 : mDefaultEncryptionType() 0:03.87 ^ 0:03.87 1 warning generated. Something weird on my box: 1:05.58 ../../../dist/include/mp4_demuxer/MoofParser.h:8:10: fatal error: 'mp4_demuxer/Atom.h' file not found 1:05.58 #include \"mp4_demuxer/Atom.h\" jyapro:mozilla-central jyavenard$ ls -l media/libstagefright/binding/include/mp4_demuxer/Atom* -rw-r--r--+ 1 jyavenard staff 425 20 Jan 17:39 media/libstagefright/binding/include/mp4_demuxer/Atom.h -rw-r--r--+ 1 jyavenard staff 833 20 Jan 17:39 media/libstagefright/binding/include/mp4_demuxer/AtomType.h it's there!",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 32,
                "quote": "This can be done in a another patch/bug #",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 33,
                "quote": "Saiz(Box& aBox, const AtomType& aEncryptionType) Due to the implementation of AtomType, probably can not bother with const ref",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "Saio(Box& aBox, const AtomType& aEncryptionType)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "Use existing IsValid() API, no need to set mValid. mValid is only of use if you don't have a IsValid() and you then use the default implementation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "something like .. AtomType GetEncryptionType() { return IsValid() ? mDefaultEncryptionType : AtomType() }",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "Something weird on my box: 1:05.58 ../../../dist/include/mp4_demuxer/MoofParser.h:8:10: fatal error: 'mp4_demuxer/Atom.h' file not found 1:05.58 #include \"mp4_demuxer/Atom.h\" jyapro:mozilla-central jyavenard$ ls -l media/libstagefright/binding/include/mp4_demuxer/Atom* -rw-r--r--+ 1 jyavenard staff 425 20 Jan 17:39 media/libstagefright/binding/include/mp4_demuxer/Atom.h -rw-r--r--+ 1 jyavenard staff 833 20 Jan 17:39 media/libstagefright/binding/include/mp4_demuxer/AtomType.h it's there!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "Oh.. It's missing the required entry in moz.build...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "Actually, on second look Where are MoofParser::ParseMinf MoofParser::ParseStbl MoofParset::ParseStsd MoofParser::ParseSinf ?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 40,
                "quote": "Re-added missing stuff, whipped hg into line, addressed comments.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 41,
                "quote": "r+ with some nits.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "CanRead16 ?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "as we can use mSinf.mDefaultEncryptionType without mSinf being valid, it needs to be initialized to 0 regardless.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "mDefaultIVSize must be initialized before mDefaultEncryptionType (cause a compilation warning otherwise)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "I don't have much concern about this one as it has been on m-c for some time already. Let's make things easier on ourselves for MSE in 37. Aurora+",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 46,
                "quote": "Something in this push caused linux32 debug bustage. Nobody was around to help, so I had to back it out.",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 47,
                "quote": "Also w-p-t permafail.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 48,
                "quote": "I don't see a crash when following these steps with Aurora, but I don't see any media either.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=983489",
        "issue_id": 983489,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Note this is not specific to reftests, it happens whenever nsIAppStartup.quit() is called in an emulator. To reproduce, apply this patch and run |mach mochitest-remote|",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "It seems that we call GrallocTextureSourceOGL::DeallocateDeviceData() after CompositorOGL::CleanupResources(). The gl context is null and we dereference this null ptr for MakeCurrent().",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Is this something your team could look into.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Benoit, can you take a look at this? Jerry, let us know if you've looked at this already, I didn't see any comments.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "We will check the bug 985773. Maybe we have some problem for delete sequence in gfxPlatform::Shutdown()",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "GLContext is released before Texture is released. Wait result: https://tbpl.mozilla.org/?tree=Try&rev=b527e30e4264",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "The crash happen when GLContext released before Texture is released",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "The crash happen when GLContext released before Texture is released. This patch re-order the release sequence.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Crash in buffer release is fixed, but another crash happen. https://tbpl.mozilla.org/?tree=Try&rev=5e7a58e17e3a 23:26:09 WARNING - PROCESS-CRASH | Shutdown | application crashed [Unknown top frame] 23:26:09 INFO - Crash dump filename: /tmp/tmp5lZPug/2bae3694-f663-1620-7d030544-067ad376.dmp 23:26:09 INFO - stderr from minidump_stackwalk: 23:26:09 INFO - 2014-03-27 23:26:09: minidump_processor.cc:264: INFO: Processing minidump in file /tmp/tmp5lZPug/2bae3694-f663-1620-7d030544-067ad376.dmp 23:26:09 INFO - 2014-03-27 23:26:09: minidump.cc:3815: INFO: Minidump opened minidump /tmp/tmp5lZPug/2bae3694-f663-1620-7d030544-067ad376.dmp 23:26:09 INFO - 2014-03-27 23:26:09: minidump.cc:3847: ERROR: Minidump header signature mismatch: (0x0, 0x0) != 0x504d444d 23:26:09 INFO - 2014-03-27 23:26:09: minidump_processor.cc:268: ERROR: Minidump /tmp/tmp5lZPug/2bae3694-f663-1620-7d030544-067ad376.dmp could not be read 23:26:09 INFO - 2014-03-27 23:26:09: minidump.cc:3787: INFO: Minidump closing minidump 23:26:09 INFO - 2014-03-27 23:26:09: minidump_stackwalk.cc:529: ERROR: MinidumpProcessor::Process failed 23:26:09 INFO - minidump_stackwalk exited with return code 1 23:26:09 INFO - WARNING | leakcheck | refcount logging is off, so leaks can't be detected! 23:26:09 INFO - REFTEST INFO | runreftest.py | Running tests: end. 23:26:14 ERROR - Return code: 1",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "Result in local test: Looks like Bug 987251 Crash reason: SIGSEGV Crash address: 0x5a5a5b4a Thread 21 (crashed) 0 libxul.so + 0x65a25c r4 = 0x4617bcc0 r5 = 0x00000000 r6 = 0x00000000 r7 = 0x455ffdf0 r8 = 0x455ffd50 r9 = 0x455ffd80 r10 = 0x00000000 fp = 0x455ffd88 sp = 0x455ffc88 lr = 0x410a225b pc = 0x410a225c Found by: given as instruction pointer in context 1 libxul.so + 0x65ab23 sp = 0x455ffc98 pc = 0x410a2b25 Found by: stack scanning 2 libxul.so + 0x65ab7f sp = 0x455ffca8 pc = 0x410a2b81 Found by: stack scanning 3 libxul.so + 0x60e3f9 sp = 0x455ffcb0 pc = 0x410563fb Found by: stack scanning 4 libxul.so + 0x6693c9 sp = 0x455ffcb8 pc = 0x410b13cb Found by: stack scanning 5 libxul.so + 0x6693ef sp = 0x455ffcc0 pc = 0x410b13f1 Found by: stack scanning 6 libxul.so + 0x6645bd sp = 0x455ffcc8 pc = 0x410ac5bf Found by: stack scanning 7 libxul.so + 0x6651b1 sp = 0x455ffcd8 pc = 0x410ad1b3 Found by: stack scanning 8 libxul.so + 0x44cb59 sp = 0x455ffce8 pc = 0x40e94b5b Found by: stack scanning 9 libxul.so + 0x44cec7 sp = 0x455ffcf8 pc = 0x40e94ec9 Found by: stack scanning 10 libxul.so + 0x42a309 sp = 0x455ffd00 pc = 0x40e7230b Found by: stack scanning 11 libxul.so + 0x42abd1 sp = 0x455ffd08 pc = 0x40e72bd3 Found by: stack scanning 12 libxul.so + 0x42ab6f sp = 0x455ffd18 pc = 0x40e72b71 Found by: stack scanning 13 libxul.so + 0x2cae9d sp = 0x455ffd28 pc = 0x40d12e9f Found by: stack scanning 14 libxul.so + 0x42163f sp = 0x455ffd30 pc = 0x40e69641 Found by: stack scanning 15 libxul.so + 0x4223a1 sp = 0x455ffd40 pc = 0x40e6a3a3 Found by: stack scanning 16 libxul.so + 0x422f5f sp = 0x455ffd48 pc = 0x40e6af61 Found by: stack scanning 17 libxul.so + 0x4232ed sp = 0x455ffd78 pc = 0x40e6b2ef Found by: stack scanning 18 libxul.so + 0x421603 sp = 0x455ffdc0 pc = 0x40e69605 Found by: stack scanning 19 libxul.so + 0x421681 sp = 0x455ffdc8 pc = 0x40e69683 Found by: stack scanning 20 libxul.so + 0x424091 sp = 0x455ffde0 pc = 0x40e6c093 Found by: stack scanning 21 libxul.so + 0x1947ffe sp = 0x455ffde8 pc = 0x42390000 Found by: stack scanning",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "This blocks a blocker.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 12,
                "quote": "This bug is fixed, but it crashed at another point randomly (same as Bug 987251). https://tbpl.mozilla.org/?tree=Try&rev=03e110fde6b3",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "1.4+ this blocks a blocker",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 14,
                "quote": "There are a number of bugs that came in with requests to support better debugging on the emulator. This came in unexpected, and I need to escalate this if it is to be done in 1.4 timeframe, as it will completely mess up the 2.0 plans. Stay tuned.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "If call SendWillStop() then Destroy() it will make GLContext being deleted before Texture and it crashed at end of reftest. Please help to check if switch order is a proper solution. It still crash somewhere else and I'm still to identify root cause.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "The previous patch is obviously wrong.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "The previous patch is obviously wrong. This patch prevent the crash by delay destruct mGLContext.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Root cause: http://dxr.mozilla.org/mozilla-central/source/widget/xpwidgets/nsBaseWidget.cpp#177 mCompositorChild->SendWillStop(); will trigger CompositorParent RecvWillStop() mCompositorChild->Destroy(); will trigger TextureParent to clean texture In RecvWillStop() there are two point which will trigger CompositorOGL to destroy mGLContext and make TextureParent has no valid GLContext.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 19,
                "quote": "Root cause: http://dxr.mozilla.org/mozilla-central/source/widget/xpwidgets/nsBaseWidget.cpp#177 mCompositorChild->SendWillStop(); will trigger CompositorParent RecvWillStop() mCompositorChild->Destroy(); will trigger TextureParent to clean texture In RecvWillStop() there are two point which will trigger CompositorOGL to destroy mGLContext and make TextureParent has no valid GLContext. Solution: Delay the time to destroy mGLContext, as mGLContext will be destroyed at destructor of CompositorOGL, so remove mCompositor = null in LayerManagerComposite.cpp and CompositorParent.cpp.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "Attached patch 983489.patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "Please refer: https://bugzilla.mozilla.org/show_bug.cgi?id=922680#c97 and https://bugzilla.mozilla.org/show_bug.cgi?id=983489#c19 GLContext release too early, and we have many chance to release it. So, mark two line which will release GLContext.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "We can't just do that... CompositorOGL::Destroy does a bunch of work that does need to be done.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Bas suggest for you to review.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 24,
                "quote": "It's not a problem with your patch but I am a bit worried about CompositorOGL making virtual method calls in its destructor. We should mark it MOZ_FINAL with a comment saying that if we want to add a subclass of CompositorOGL (which we might do at some point to have platform specific opengl optimization), then we should remove the error-prone virtual calls in the destructor. I'll file a followup bug. Also, we should be able to call GLContext::MakeCurrent without crashing even after the destruction of the underlying context (it should return false in that case). Some code already expects that to be the case.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "I'll file a followup bug.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "Actually I changed my mind on one detail: please call Compositor::Destroy explicitly in RecvStop. Otherwise because of reference counting hazards, we might not call Shutdown by the end of RecvStop and that will make things chaotic at least on Linux.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Re-triage - this doesn't have proof of being a user facing crash on devices, it only happens in debug build situations & tests. So renoming to reevaluate.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "Update patch 1. Remove potential of calling mCompositor->Destroy() in CompositorParent->RecvWillStop() 2. Call mCompositor->Destroy() in CompositorParent->RecvStop()/CompositorParent->Destroy() explicitly",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "Thanks!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "had to backout this change for test failures like https://tbpl.mozilla.org/php/getParsedLog.php?id=38002451&tree=Mozilla-Inbound",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 31,
                "quote": "Looks like you need to check that mCompositor != nullptr before calling Destroy().",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "Attached patch 983489.patch v3 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 33,
                "quote": "add check mCompositor before call Destroy() https://tbpl.mozilla.org/?tree=Try&rev=c88c51437df2",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "Please include commit information with your patch, including a commit message that says what the patch is doing (not restating the problem it's solving).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "update commit message based on v3.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 36,
                "quote": "backedout since this might have caused the m8 and m10 test failures like https://tbpl.mozilla.org/php/getParsedLog.php?id=39049220&tree=Mozilla-Inbound",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 37,
                "quote": "So far, it appears that this backout did indeed fix the crashes we were seeing.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "From the log: https://tbpl.mozilla.org/php/getParsedLog.php?id=39049220&tree=Mozilla-Inbound it's this pushlog: https://tbpl.mozilla.org/?rev=ba31cd1620bd&tree=Mozilla-Inbound and it's not my patch.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "Would you please double check if it's problem of my patch?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 40,
                "quote": "\"it's this pushlog: https://tbpl.mozilla.org/?rev=ba31cd1620bd&tree=Mozilla-Inbound and it's not my patch.\" yes its not your push. We sheriffs link to test failures and in some cases this might not the first occurence where the problem was seen.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 41,
                "quote": "In your specific case there was in the same cset (since this was a checkin needed bug) a bustage in builds from a different developer. Thats why we linked to a different cset here. However we investigated this for some time yesterday and were double checking a lot of csets that could have caused this test failure and after we did the backout of your patch the failures were gone away (see comment #41 from ryan). So we have the high assumption this test failure was caused by your patch. Btw the reason why this was not seen on your try run is that the try run was done on ics opt and the failure was only on ics debug",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 42,
                "quote": "Ken, High repro reate in m7. https://tbpl.mozilla.org/?tree=Try&rev=5399221c4a8c",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 43,
                "quote": "1. Cannot repro on local 2. Cannot repro on try after update code: https://tbpl.mozilla.org/?tree=Try&rev=3af70562fd0b",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 44,
                "quote": "1. As I cannot repro on local, do you have any suggestion for me to repro this issue? 2. I can repro it on try, but cannot yesterday. Would you please try it on m-i?",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 45,
                "quote": "Nical, Need your help to give me some advice. Although the patch fix the crash after reftest test, but it seems to introduce another crash after mochitest. I have no idea why the patch will make telephony crash. Last week, I can repro the telephony crash on try but cannot on local test. This week, I cannot repro the telephony crash both on try and local. Please help.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 46,
                "quote": "It's really unclear what in your patch could cause a regression in telephony. Looking at the last try push, the first thing i'd look at would probably be this: [Parent 671] ###!!! ASSERTION: Using observer service after XPCOM shutdown!: 'Error', file ../../../gecko/xpcom/ds/nsObserverService.cpp, line 260",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 47,
                "quote": "Maybe see who is using this observer service and if there could be a link with delaying the destruction of the compositor...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 48,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/3939dc732041",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1066726",
        "issue_id": 1066726,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In general: - when the output stream of the entry is closed with a fatal error, set state of the file to that error - forbid opening input stream anymore (it's an atomic way to indicate the entry is in a bad shape and useless that http channel can handle well w/o any more changes needed) - don't throw the entry on SetPredictedSize failure since it: - would crash (bug 1048348) - it wouldn't engage the interrupted concurrent write resume The rest should be commented in the code and covered by tests",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Is it always ensured that the second channel gets the cache entry before the entry is doomed by the first channel?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Definitely is, the second channel gets the entry (OnCheck/OnAvail calls) when the first channel fills the metadata on the entry (what happens on the main thread in OnStart). Dooming happens later in OnData of chan1, by that time chan2 already pump-reads the entry.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Reproduced with Nightly 2014-07-20 on Windows 7 64bit with STR from bug 1036939. Verified as fixed with Firefox 33 beta 6 (Build ID: 20140922173023), latest Aurora 34.0a2 (Build ID: 20140923004002) and latest Nightly 35.0a1 (Build ID: 20140923030204) on Windows 7 64-bit, Linux 14.04 32-bit and Mac OS X 10.9.5 with STR from bug 1036939 and bug 1064408. Also, in Socorro there are no crashes after fixing this issue for [@ mozilla::net::nsHttpChannel::OnDoneReadingPartialCacheEntry(bool*)] signature (bug 1048348):",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Backed out for bustage. Please rebase.",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 6,
                "quote": "The patch is technically dependent on bug 1000338 that has been uplifted on 2014-10-05 14:46:11. I think you can reland now (I will first locally check the build and let you know).",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 7,
                "quote": "Err... the bug is actually bug 1013395. That one is not worth an uplift, but the parts needed to compile are small enough, I'll backport them. However, there is some risk this patch won't be stable (since it is completely untested) w/o all other patches landed on 33+, this is simply a disclaimer.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 8,
                "quote": "This builds, but tests are consistently failing around the code this patch is touching - something I was afraid of. If we want to backport this to b2g/32 we need more patches to go along with it. I have to search for all bugs that we have fixed for 33 and select those needed to make this patch work (best all of them).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "This is the list of cache2 bugs landed on Beta and not on B2G/32. Not sure we can just select few to make the patch for this bug safely back-portable...",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 10,
                "quote": "I can't help but think that a mass uplift isn't what we're going to want to do here given where we are in the B2G v2.0 release cycle.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 11,
                "quote": "So I guess that leaves either wontfixing this or figuring out what the minimum branch patch is that could be safely uplifted to the fix the bug.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 12,
                "quote": "Honza, thoughts?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "I think finding a minimum patch would be very complicated and risky. I vote for all or nothing.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 14,
                "quote": "Honza, you're the best-qualified person to weigh the risks of doing that in comparison to the severity of the bugs it'd fix. B2G v2.0 is at a point where we don't want to be taking any unnecessary risks, so what's your take on wontfixing vs. proceeding with a mass uplift?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "I don't know if there's an easy way to make things work, maybe mshal has some idea.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 16,
                "quote": "I'm against the mass uplift. Those patches are touching also a different code and there can easily be dependencies we are not aware of and totally break the stable b2g 2.0 branch. There are two issue when this bug is left unfixed: - when disk cache size is set to 0, there are some problems with showing favicons, images, sometimes pages (1036939 1064408 1067103); this is a non-standard setting that some people from some reason used to set to disable the cache - null crash in nsHttpChannel::OnDoneReadingPartialCacheEntry The first one can be left as a known issue because of the non-standard setting. The second one can be worked around by one of the options: 1. we can null check and fail on null entry (can lead to a failed response and not sure of all other consequences) 2. we can disobey a single entry limit when doing a partial request (safe and easy to do) I'll create a branch patch with the second solution (one line).",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 17,
                "quote": "Thanks, sounds like the way to go :)",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 18,
                "quote": "- mCacheEntry->SetPredictedDataSize not called for a partial response (avoid the crash, bug 1048348) - concurrent cache reading completely disabled (explanation in the code comment) - test_partial_response_entry_size_smart_shrink.js has been slightly modified to accept missing bug 237623 on this branch (comments in the test)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "As bad as this looks, most of the noise is expected based on being an old branch trying to run tests it wasn't designed to run. That said, https://treeherder.mozilla.org/ui/logviewer.html#?job_id=2961089&repo=try looks real to me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Idea: we could disable the disk cache when capacity is 0 (internally, disabling the cache completely is something else then setting the capacity to 0 bytes right now). I'll provide a second patch here.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 21,
                "quote": "Does this address comment 37?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 22,
                "quote": "Consider cache completely disabled when the capacity is set to 0. I play with an idea to add this patch to m-c as well, Michal, what would you think?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "Guys, I don't know how to properly test this. I need some help here.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 24,
                "quote": "NI some build experts here you may be able help debug the failures or provide input..",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 25,
                "quote": "Marcia, is this something you're able to help with?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 26,
                "quote": "Not really. Guessing tedm is the best one to help here.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 27,
                "quote": "Unfortunately it looks like you're running into problems because the build automation has changed since that branch. I don't know if there's an easy way to make things work, maybe mshal has some idea.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 28,
                "quote": "Well, I think I was able to address the build issues at least. Can you try to rebase on top of b2g32 and see if it's any better? I'm not sure if the test job failures are related or some other issue though.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 29,
                "quote": "Looks like the builds are green, at least. Is that sufficient for you? I don't think we'll be able to get all the tests green on try, since it will always be using m-c's test configuration on try, not b2g32's. Some of them may be easy to address (for example, it looks like the android tests just need an updated tooltool manifest), but from what I can gather I don't think we'll get much further without a lot of effort.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 30,
                "quote": "Don't worry about Android builds/tests on b2g32. Completely unsupported anyway :) Honza, this looks like a real failure? I see it on WinXP debug as well. Everything else looks safe to ignore.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1439571",
        "issue_id": 1439571,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Glenn said this might be caused by https://github.com/servo/webrender/issues/1943",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "I removed the fuzzy marker",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "re-ran these tests, and they're still failing: https://treeherder.mozilla.org/#/jobs?repo=try&revision=aa564e82e9fb651cee824a4f2549a288b08cb5c5",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "I looked at 5 examples of failures of input-radio-required.html and the test image is fairly consistently darker than the reference image, e.g: (TEST): data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAPoCAYAAAAmy5qxAAAU/ElEQVR4nO3csWnDQACGUY+eLTKLZkjjATyAVR64UCF02SBxiPMF7Pfa44drPw7pNAEAACKn/74AAADwOgQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAAJkfBch+7HNsY663dY5tzP3Y/2QDAAA8p7sD5JjHHNuY5+t5Lpdlnq/nObbx8A0AAPC87g6Q/djnelvnclnm+8f7XC7LXG/rwzcAAMDz8gICAABkfAMCAABkfvUXrNPb1/PvzgEAgNeiEAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgIwAAQAAMgIEAADICBAAACAjQAAAgMwntM3xVNZSX2cAAAAASUVORK5CYII= (REFERENCE): data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAPoCAYAAAAmy5qxAAAU/ElEQVR4nO3csW3DMBBAUQ/qvbxFes2QRgN4AKsU4EKFIGYFB3Z+APu9ljiA7QfBOw0AAIDI6b8vAAAAfA4BAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEBGgAAAABkBAgAAZAQIAACQESAAAEDmVwGyH/tYt3Us92Ws2zr2Y/+TGQAA4D09HCDHOMa6rWO+zWO6TmO+zWPd1pfPAAAA7+vhANmPfSz3ZUzXaVy+L2O6TmO5Ly+fAQAA3pcXEAAAIOMPCAAAkHlqC9b56/zUOQAA8Fms4QUAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADICBAAAyAgQAAAgI0AAAICMAAEAADI/9U3zIC3kelkAAAAASUVORK5CYII=",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "pcwalton suggested he may have incidentally fixed this, tagging to confirm",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 6,
                "quote": "Hi Kats -- Can I ask you to re-test this (since you were the reporter) and report back if it's fixed? Thanks!",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Pixel differences on reftests are now reported for all reftests in the log, so we can just look at a recent m-c log to see what the current differences are on these tests. [1] is such a log for linux-qr opt, and it shows 0,0 difference. I looked at a couple of other logs too (linux debug, mac opt) and they are all reporting 0 differences, so it's likely fixed. (Could be just an intermittent 0,0 though). I'll do a try push with the fuzzy annotations removed and retrigger a bunch to confirm. [1] https://treeherder.mozilla.org/logviewer.html#?job_id=202171044&repo=mozilla-central&lineNumber=11124",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "Another one with a couple more tests that I missed the first time: https://treeherder.mozilla.org/#/jobs?repo=try&bugfiler=&group_state=expanded&revision=21fbae0ac9d621d0ab287a645bce28195267d6a3 Anyway, looking green.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch Remove fuzzy-if \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=779500",
        "issue_id": 779500,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The attribute \"speakerEnabled\" is not introduced in the proposed API, but the feature to speaker/headset is required in V1.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch option MOZ_B2G_FM (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch DOMFmManager, FmAdaptor and FmAntenna (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Fallback service (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch Add Permissions (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch ServiceStartup (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Those patches are ready to be reviewed, i just don't know who i should request, so if you would review those as well, that's great!",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "I don't feel comfortable reviewing these build changes -- off to a build peer.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I don't understand why dom/fm/fallback/FmService.jsm is a fallback service. Maybe the word \"fallback\" is getting lost in translation?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "The \"fallback\" service would be the one which does nothing when the FM radio is unavailable. Am I missing something here?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "I'm sorry that I have more than minor nits on this IDL, despite the fact that we went through it on the mailing list. I hope you won't have to make too many big changes. Jonas, I'd appreciate your thoughts on a few comments below.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "MPL2, please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "The filename should match the name of the interface. Also, \"FM\", not \"Fm\", please. I also think it would be better if we called this interface nsIDOMFMRadio. For example, it's nsIDOMScreen, not nsIDOMScreenManager.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Shouldn't this be part of the audio API?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Nit: \"Current frequency, in MHz\".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Nit: Why is this a float, while the frequency is a double? I'd rather use doubles everywhere, unless there's a reason not to. Can we add the signal strength in dBm as well, if we have that available?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Nit: Please use javadoc-like formatting for this and all the other comments in the idl files: /** * Comment comment comment. */ readonly attribute foo; There's no such thing as a \"JSON object\" -- that's just an Object in Javascript. :) We need to figure out what's going on with these bands. If the goal is to support things other than FM radio, then we shouldn't call this nsIDOMFMManager/nsIDOMFMRadio. My instictint is to ignore AM, which I think we're unlikely to support due to physical constraints (the antenna needs to be large). Then we can spec this attribute as follows: \"Returns the band ranges supported by this FM radio. The return value is a list of objects, each of which indicates the band's upper and lower limits, in MHz. For example: [ {lower: 87.5, upper: 108}, {lower: 76, upper: 90} ] Also, if we expose all the supported bands on this object, then it doesn't make a lot of sense to me that you can't change the current band using this object. At the very least, we need to add an attribute which indicates what is the current band. But IMO, if you can't select a band using nsIDOMFMRadio, we shouldn't tease you with the list of available bands, and should only give you the upper and lower limits of the currently-selected band. We also need to give the station interval, since that changes with different bands. Jonas and Ray, what do you think?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "We need to figure out what's going on with these bands. If the goal is to support things other than FM radio, then we shouldn't call this nsIDOMFMManager/nsIDOMFMRadio. My instictint is to ignore AM, which I think we're unlikely to support due to physical constraints (the antenna needs to be large). Then we can spec this attribute as follows: \"Returns the band ranges supported by this FM radio. The return value is a list of objects, each of which indicates the band's upper and lower limits, in MHz. For example: [ {lower: 87.5, upper: 108}, {lower: 76, upper: 90} ] Also, if we expose all the supported bands on this object, then it doesn't make a lot of sense to me that you can't change the current band using this object. At the very least, we need to add an attribute which indicates what is the current band. But IMO, if you can't select a band using nsIDOMFMRadio, we shouldn't tease you with the list of available bands, and should only give you the upper and lower limits of the currently-selected band. We also need to give the station interval, since that changes with different bands.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 19,
                "quote": "Jonas and Ray, what do you think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 20,
                "quote": "onsignalstrength change, perhaps? Also, could you please add a comment here indicating how we throttle these events?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "onantennaavailablechange, or onantennastatechange? Otherwise it sounds like we're changing the antenna itself.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "It's weird to have one event which fires when the antenna is plugged/unplugged but then fire a different event",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "We want to support addEventListener() for these too, which means that nsIDOMFMRadio needs to inherit from nsIDOMEventTarget.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Nit: \"If the given frequency is outside the current band range\". I don't think it's right to say that onerror is fired \"immediately\". Surely you have to wait until we spin the event loop, because otherwise the following won't work: let req = setFrequency(0); // error, fires req.onerror req.onerror = function() { dump(\"An error occurred\"); }; // The dump() is never run, because onerror was already fired.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "What happens if you call seekDown/seekUp while a seek is running?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "It's not wrong to put builtinclass here, but it's a little odd. khuey says: Typically we've added builtinclass to interfaces where if JS implemented it, sg:crits (i.e., critical security bugs) would result. But feel free to sprinkle it liberally. I'd probably leave it off in this case, since nsIFMAdaptor /could/ be implemented in JS with no problems. Could you please add a comment here indicating what this interface is for? It took me a while to figure it out. :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "nsIFMAdaptor, please, and change the filename to match. But I'd prefer this matched the name of the DOM interface. What do you think about calling them nsIDOMFMRadio and nsIFMRadio? This one is an nsIDOMEventTarget, so maybe you just forgot to put that on the other interface?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "Why does this interface duplicate some (but not all) of nsIDOMFMAdaptor's properties? I'd rather not duplicate any and just call into nsIDOMFMAdaptor when necessary.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Again, I don't think builtinclass is exactly right here. Please add a comment indicating that this is implemented by the FM antenna service. I don't understand why this isn't part of nsIFMAdaptor. Even if we wanted multiple radios, I don't see how splitting out the interface like this helps us.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "I realize now that I probably don't have enough context to understand this interface, having read only part 1. Maybe we can figure out the DOM interface and worry about this interface in a later round of reviews.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "If that's the reason, we should make this a separate API. It's not a lot more work to make a separate API than it is to include it on the FM radio API. If FM radio were accessible only to privileged content, then maybe I'd be OK with a hack like this, but if we're exposing this to the world, then we should not create bogus APIs because it's slightly easier.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 32,
                "quote": "AM radio should not be part of the \"FM radio\" api. If we really want to be able to support AM in the future -- and I think that's unlikely to happen, because AM antennas are quite large -- then we should rename this API to \"TunableRadio\" or something. But I think designing for an unlikely eventuality is likely a mistake. If we want to support multiple bands then we should design bandRanges to let you see multiple FM and multiple AM bands. At the moment, you can only see one FM and one AM band. But if we're designing for future extensibility to AM, we should also design for future extensibility to multiple FM bands, because the latter is far more reasonable than the former. But more to the point: We need some way for the app to know which is the currently-selected band; apps shouldn't assume that there's only one band in bandRanges, because that defeats the purpose. So regardless of whether we're allowing multiple bands now or in the future, we still need to have double upperFreq; double lowerFreq double channelFreqInterval; or otherwise jsval currentBand; /* {upper, lower, interval} */ so that you know what the current band is set to. IMO, if we're not allowing switching between bands, we should not expose bandRanges, because it's not useful.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 33,
                "quote": "I'm not sure what you mean by \"such as wiki\". nsIDOMEventTarget is the interface which adds add/removeEventListener. If you don't inherit from nsIDOMEventTarget, you can't do fmManager.addEventListener('antennachange', function() { ... });",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "Yeah, it's a consistency argument. We don't need 52 bits of precision for either signal strength or FM frequency, so neither of them /needs/ to be a double. But double is JavaScript's natural floating-point type (it does not have a 32-bit float, except as a typed array), so in the absence of any good reason to use a float, I think we should use a double.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "I think we're not talking about the same thing. There are two separate things here. * \"The current band\", which indicates the parameters (AM/FM, frequency upper and lower bounds, and channel interval) that the radio is currently using. There is only ever one current band. * \"The band ranges\", which indicates all possible values that the current band might be set to. The FM app needs only \"the current band\" in order to show the dialier. It does not need a list of all band ranges that the FM chipset supports.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 36,
                "quote": "But apps implementing an FM radio cannot necessarily read settings. The settings API is not available to unprivileged web content (or even many apps). If the FM app were able to read settings, then we would not need to expose \"the current band\" to the FM app; we could define that information in the settings, too. In fact, we would not need the FM API at all; we could define everything about this API in the settings.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 37,
                "quote": "Ah, I remember this now. As you discovered, nsIDOMEventTarget is a builtinclass. That means that if nsIDOMFMRadio inherits from nsIDOMEventTarget, you can't implement it in JS. That's probably why nsIDOMWifiManager doesn't inherit from it. But if you don't inherit from nsIDOMEventTarget, then you can't do addEventListener on it. In other words, you can't implement event targets in JS! It's bad that nsIDOMWifiManager is not an event target, but I think it would be worse if the FM radio was not an event target, because we're exposing it to all of the web. So I think you're going to have to rewrite the implementation of nsIDOMFMRadio in C++. I don't think we want to create a public interface where you have to use the onX handlers.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 38,
                "quote": "autoconf.mk.in substitution was just rewritten, so this needs to be updated.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "We cann't implement the nsIDOMEventTarget in JS, but i think we can add \"addEventListener\" and \"removeEventListener\" to nsIFM, and implement the two functions in JS, what do you think?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 40,
                "quote": "what do you think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 41,
                "quote": "If that works, that's fine with me. But I expect that there's some deep problem with trying to do that, otherwise people wouldn't say \"you can't implement event targets in JS\". smaug?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 42,
                "quote": "If that works, that's fine with me. But I expect that there's some deep problem with trying to do that, otherwise people wouldn't say \"you can't implement event targets in JS\".",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "Horrible horrible hack. If avoidable, please avoid. EventTargets should be EventTargets",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "Sure it could work, but please make sure to implement add/removeEventlistener and dispatchEvent the way C++ version does.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "You can't implement event targets in JS, because real event handling needs to be sure that it deals with native objects. Event handling needs to be fast - so, no extra QIing at unsafe times. In general it isn't clear to me why anyone would like to implement eventtargets in JS. But looks like the patch does implement FmAdaptor in C++. Implementation should bind the object to a window though (nsDOMEventTargetHelper::BindToOwner) .",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 46,
                "quote": "Hi Justin, Thinker and I proposed a method. We will implement a class, say JSDOMEventTargetHelper. JSDOMEventTargetHelper inherits from nsDOMEventTargetHelper and nsIJSEventTargetHelper. JSDOMEventTargetHelper is another eventtarget for initializing and setting helpers from JS code. nsIDOMFMRadio provides nsIDOMEventTarget interface. But, its QueryInterface returns an JSDOMEventTargetHelper. Since almost all the functions we need are done in nsDOMEventTargetHelper, we do not need much effort to implement JSDOMEventTargetHelper. So we have - JSDOMEventTargetHelper - implements nsIJSDOMEventTargetHelper - inherit nsDOMEventTargetHelper - nsIJSDOMEventTargetHelper - provide an interface for JS component code for setting helpers For JS components who want to implement nsIDOMEventTarget, it creates an instance of JSDOMEventTargetHelper returned by QueryInterface for nsIDOMEventTarget interface.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 47,
                "quote": "One of the rules of QueryInterface is that you can always get back to your original object: nsIFoo *orig = ...; nsIBar *bar = QueryInterface(orig); nsIFoo *foo = QueryInterface(bar); ASSERT(foo == orig); So to make this work, JSDOMEventTargetHelper's QI function would have to know how to get back to nsIDOMFMRadio. But I guess you could do that with a custom QI function which calls the fm-radio's QI...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 48,
                "quote": "Smaug says this might work, and it sounds fine to me (modulo comment 27). Go for it!",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 49,
                "quote": "- Set signalStrength as a double - rename 'onantennachange' to 'onantennastatechange' - rename 'onsignalchange' to 'onsignalstrengthchange' - rename 'bandRanges' to 'currentBand', it returns an object like: { \"upper\": 87.5, // in MHz \"lower\": 108, // in MHz \"interval\": 0.1 // in MHz } and here is the updated WebIDL: interface FM : EventTarget { /* Indicate if FM is enabled */ readonly attribute boolean enabled; /* Indicate if antenna is available */ readonly attribute boolean antennaAvailable; /** * Current frequency in MHZ. * The value will be 0 or the last frequency if FM is not enabled. */ readonly attribute double frequency; /* the strength of signal, the range is [0, 1] */ readonly attribute double signalStrength; /** * The band info object, it likes: * { * \"lower\": 87.5, // in MHz * \"upper\": 108, // in MHz * \"interval\": 0.1 // in MHz * } */ readonly attribute any currentBand; /* Fired when the the FM is enabled */ attribute Function onenabled; /* Fired when the the FM is disabled */ attribute Function ondisabled; /* Fired when the state of antenna is changed */ attribute Function onantennastatechange; /* Fired when FM frequency is changed. */ attribute Function onfrequencychange; /* Fired when the strength of signal is changed. */ attribute Function onsignalstrengthchange; /* Power on/off the FM device, onpowerchanged will be fired accordingly */ DOMRequest setEnabled(in bool enabled); /** * onsuccess will be triggered if frequency is set successfully. * app should listen on the \"onfreqchange\" to get the right frequency. * If the frequency is out of range, then request.onerror will be fired. */ DOMRequest setFrequency(in double frequency); /** * Tell FM to seek up, if frequency is changed, onfrequencychanged will be triggered. * Only one seek is allowed at once, if the FM is seeking, then onerror will be fired. */ DOMRequest seekUp(); /** * Tell FM to seek down, if frequency is changed, onfrequencychanged will be triggered. * Only one seek is allowed at once, if the FM is seeking, request.onerror will be fired. */ DOMRequest seekDown(); /* Cancel the seek action, if the FM is not seeking, request.onerror will be fired */ DOMRequest cancelSeek(); }",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 50,
                "quote": "This looks great. Just a few small changes, if you don't mind:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 51,
                "quote": "Can we make the value here null if FM is not enabled? That way there's no confusion, nor any contract that this API will remember things.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 52,
                "quote": "If we're only going to expose the current band, I think it would be better to do something simpler: readonly attribute double frequencyLowerBound; readonly attribute double frequencyUpperBound; readonly attribute double channelWidth; If we have fm.availableBands at some later date, they can be {lowerBound, upperBound, width} objects, which would be fine. We don't need to expose our current band data as an Object in order to make the future availableBands property make sense.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 53,
                "quote": "If we're only going to expose the current band, I think it would be better to do something simpler: readonly attribute double frequencyLowerBound; readonly attribute double frequencyUpperBound; readonly attribute double channelWidth; If we have fm.availableBands at some later date, they can be {lowerBound, upperBound, width} objects, which would be fine. We don't need to expose our current band data as an Object in order to make the future availableBands property make sense.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 54,
                "quote": "Perhaps we should have two methods DOMRequest disableRadio(); DOMRequest enableRadio(in double frequency); Otherwise, you have to enable the radio and then set the frequency. But after you enable and before you set the frequency, you're in this weird state where the radio is \"on\" but not tuned. What do you think?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 55,
                "quote": "Perhaps we should have two methods DOMRequest disableRadio(); DOMRequest enableRadio(in double frequency); Otherwise, you have to enable the radio and then set the frequency. But after you enable and before you set the frequency, you're in this weird state where the radio is \"on\" but not tuned.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 56,
                "quote": "What do you think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 57,
                "quote": "What happens if I set the frequency to 87.6, when the min freq is 87.5 and the channel width is .2? I'd guess that can't be an error, because we can't represent all fractions precisely as doubles. Even if I send 87.7, I might actually send 87.70000000000002. In other words, we have to do some amount of rounding. So I guess I have a question and a suggestion. My suggestion is that we say that even if setFrequency(x) succeeds, it is not guaranteed that fm.frequency == x, because we may reduce the precision of the given frequency. And my question is: Do you know if the radio can tune to halfway between a channel, or must it always tune to precisely one of the channels? That is, should the user expect their given frequency to be rounded to a channel, or just rounded to something? Whatever it is is fine, but we should document it. I have nits on the English in the comments (nothing major). I was planning to save those for when you post a patch, but I can give them sooner if you'd prefer.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 58,
                "quote": "I'd guess that can't be an error, because we can't represent all fractions precisely as doubles. Even if I send 87.7, I might actually send 87.70000000000002. In other words, we have to do some amount of rounding. So I guess I have a question and a suggestion. My suggestion is that we say that even if setFrequency(x) succeeds, it is not guaranteed that fm.frequency == x, because we may reduce the precision of the given frequency. And my question is: Do you know if the radio can tune to halfway between a channel, or must it always tune to precisely one of the channels? That is, should the user expect their given frequency to be rounded to a channel, or just rounded to something? Whatever it is is fine, but we should document it. I have nits on the English in the comments (nothing major). I was planning to save those for when you post a patch, but I can give them sooner if you'd prefer.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 59,
                "quote": "Hi Justin, about the frequency rounding, i tried on the Otoro device, there are three spacing type: 50KHz, 100KHz and 200KHz, whatever spacing type i set, the result is the same: - if set the frequency with 88.05, the frequency will be 88.05 - if set the frequency with 88.06, the frequency will be rounded to 88.0 So it's for sure the frequency will be rounded by the FM HW, there may be problem with spacing type setting though. IMO, the frequency should be rounded, depending on the band settings, for example: - lower: 87.5, upper: 108, interval: 0.2 * set with 87.6, the frequency will be 87.5 - lower: 87.5, upper: 108, interval: 0.1 * set with 88.05, the frequency will be 88",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 60,
                "quote": "s/Indicate/Indicates/ s/FM/the FM radio/",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 61,
                "quote": "s/Indicate/Indicates/ s/antenna/the antenna/ This is also pretty repetitive with the attribute name. How about Indicates if the antenna is plugged in and available",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 62,
                "quote": "s/^the/The/ s/strength of signal/signal strength/ This is incorrect use of a comma: \"the range is [0, 1]\" is an independent clause (a complete sentence by itself), so cannot be separated from the clause before it by only a comma. (It would be a comma splice if \"the strength of signal\" were itself an independent clause, but it's not.) How about The signal strength. The value returned is between 0 (no signal) and 1 (full signal), inclusive.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 63,
                "quote": "s/the FM/the FM radio/, or s/the FM/the radio/.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 64,
                "quote": "ibid.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 65,
                "quote": "s/of antenna/of the antenna/ Nowhere else do we talk about the \"state of the antenna\", so I don't think we should use that in the comment here. Maybe Fired when the antenna becomes available or unavailable; i.e., fired when the antennaAvailable attribute changes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 66,
                "quote": "s/FM frequency/the radio's frequency/, or s/FM frequency/the FM radio's frequency/.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 67,
                "quote": "s/strength of signal/signal strength/. We say \"signal strength /changes/\", instead of \"signal strength /is changed/\", because the signal strength is beyond anyone's direct control. By analogy, we'd say \"the weather changes\", not \"the weather is changed\" (unless someone has a weather machine!). Also, you mentioned earlier that this event is throttled -- can you explain how, here?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 68,
                "quote": "s!Power on/off the FM device!Power the FM radio on/off! In general, we should refer to events as \"powerchange\", rather than \"onpowerchange\". \"powerchange\" is the name of the event, and \"onpowerchange\" is the name of the attribute on the FM radio which is tied to the \"powerchange\" event. Also, there's also no onpowerchanged event. This is a traditional comma splice; the two things separated by a comma are both independent clauses. You can fix this by either adding a conjunction (e.g. \", and\"), using a semicolon instead of the comma, or splitting the sentence in two. In this case, I think the latter is the best option: Power the FM radio on/off. The powerchange event will be fired if this request completes successfully.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 69,
                "quote": "I don't think we need to explain when onsuccess and onerror are fired; that's pretty clear from context. I presume the app can listen to the frequencychange event or alternatively listen to request.onsuccess, right? Finally, let's add a summary sentence to the beginning, like we have elsewhere. Tune the FM radio to the given frequency. This will fail if the given frequency is out of range, or if another setFrequency call is pending. Note that the FM radio may not tune to the exact frequency given. To get the frequency the radio is actually tuned to, wait for the request to fire onsuccess (or wait for the frequencychange event to fire), and then read the frequency attribute.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 70,
                "quote": "s/up, if frequency/up to the next channel. If the frequency/ s/is changed/is successfully changed/ s/onfrequencychanged/the frequencychange event/ s/once, if/once: If/ s/the FM/the FM radio/ s/is seeking/is seeking when seekUp is called/",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 71,
                "quote": "ibid",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 72,
                "quote": "s/action, if/action. If/ s/the FM/the FM radio s/not seeking/not currently seeking up or down",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 73,
                "quote": "As far as the implementation plan, why do you need QI weirdness? It seems like all you really need is a way to create a JS object with the right JSClass and native slot (one which will claim to implement EventTarget and have a native which does so, as discussed) and the right prototype (the FM.prototype or FMRadio.prototype, as desired), no?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 74,
                "quote": "Will this duplicate all the EventTarget stuff instead of inheriting from EventTarget.prototype, then? Because the methods on EventTarget.prototype will only work if the object is an EventTarget from their point of view. Maybe I should back up. What's the goal here? Are we exposing some chrome object to content JS via COWs or SOWs or whatever the relevant wrapper is and ignoring WebIDL altogether? Or are we directly creating objects in the content compartment?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 75,
                "quote": "Justin, what do you think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 76,
                "quote": "Well, we wouldn't want an MP3 interface to start playing a random track as soon as it's initialized because that mirrors the behavior of cassette players. :) I don't see any reason to design this annoyance in to our interface when we can easily avoid it. But, like I said, so long as we wait for a trip through the event loop before we start playing sound, that would be an OK compromise to me.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 77,
                "quote": "I agree with Boris. Frequency modulation is a method of sending data over waves; if you leave out the \"radio\" part, it doesn't really describe what's going on here. :)",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 78,
                "quote": "Hmm. If you're just exposing chrome stuff, then the proposed thing with QI may work, yes, since you're not actually implementing what the rest of the world thinks of as an EventTarget.... It's OK for a short-term hack, though obviously long-term we'll want to do something more like what I described. By the way, the existing source files there (nsIFm.idl, dom/fm) have the same problem as having an interface called FM, in my opinion. nsIFmAntenna and nsIFmAdaptor are perhaps fine (though \"adaptor\" doesn't really say anything useful to me).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 79,
                "quote": "I understand you, but your proposed interfaces may still bring the FM to the *weird* state you mentioned: \"the radio is 'on' but not tuned\", if the frequency is out of the band, say 60MHz: navigator.mozFMRadio.enableRadio(60) And what an app should do likes this: var req = navigator.mozFMRadio.setEnabled(true); req.onsuccess = function() { navigator.mozFMRadio.setFrequency(91.5); }; not what you mentioned: fm.setEnabled(true); for(var i = 0; i < 10000; i++) {} fm.setFrequency(100);",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 80,
                "quote": "Perhaps we should make this call not turn on the radio at all, if we wanted to avoid this problem.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 81,
                "quote": "I was using the busyloop to illustrate a problem; I was not suggesting that was the right thing to do. :) But if I don't want to hear a random channel for a moment before I tune the radio, I shouldn't do",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 82,
                "quote": "but should instead do",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 83,
                "quote": "(Provided, of course, that setEnabled is guaranteed not to take effect until we spin the event loop.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 84,
                "quote": "Yes, I think that API is \"bogus\" because speaker enabled has nothing to do with specifically FM radio.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 85,
                "quote": "I think we could discuss details like the security requirements for that separate API and our approach for getting it standardized in a separate bug.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 86,
                "quote": "For Otoro device, it will take about 2s to enable the FM HW, it's doesn't make any sence that we can set the frequency before the HW is turned on, and then the state is also weird: it is enabling and will-be-tuned-to-91.5.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 87,
                "quote": "BTW, i don't quite understand what \"that setEnabled is guaranteed not to take effect until we spin the event loop\" means here, :-(",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 88,
                "quote": "I am proposing the speakerEnabled be a property on mozFMRadio, just like the mozTelephony.speakerEnabled.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 89,
                "quote": "I don't think \"radio is enabling and will be tuned to 91.5\" is a particularly strange state, myself. That seems like exactly the state we want to be in. But what I'm trying to figure out is how to design our API in such a way as we can avoid playing a random radio station (which may be loud static, piped straight into the user's ears) when the radio is turned on. I'm not wed to a specific way of accomplishing this, but I think this is an important design consideration.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 90,
                "quote": "It basically means that if we do setTimeout(function() { alert('Radio about to be enabled.'); }, 0); fmRadio.setEnabled(true); ... that the alert will show before the radio starts playing. The setTimeout will fire some time after you've returned from all the code you're currently running. When whatever JS code you're running finishes, the browser looks at the list of pending tasks (e.g. setTimeouts, onclick handlers, whatever) and runs one. The code which does this is called the \"event loop\", and we say the event loop \"spins\" when it completes once. If that makes any sense.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 91,
                "quote": "I think the telephony property is bogus too, but I also think it's not as bad as putting speakerEnabled on the FM interface, because telephony will not be exposed to the vast majority of pages, while webFM will be available to every page on the web. As a result, we will have much more difficulty removing speakerEnabled from the FM interface than we would removing it from the telephony interface.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 92,
                "quote": "\"setEnabled\" is an async method, when you called \"mozFMRadio.setEnabled(true)\", the enabling FM action will be executed in one thread or process which is obviously different from the thread/process which will execute the \"event loop\" (maybe my understanding is totally wrong), then i don't understand how to prevent \"setEnabled is guaranteed not to take effect until we spin the event loop\".",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 93,
                "quote": "The B2G is designed to enable the speaker automatically when the headset is unplugged, and change it back when the user plugged the headset, it's OK for the MP3 player or video player, but for the FM, the headset is the antenna, if you unplugged the headset, the sound will become noise, so the FM app need such a interface to enable speaker without unplugging the headset.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 94,
                "quote": "If we keep seperating the \"setEnable\"(not tuned to some frequency automatically) and \"setFrequency\", the FM will stay quiet after it is enabled and before we tuned it, and the state will be enabled-but-not-tuned which you feel so weird, if we want to kill such a \"weird\" state, the only thing we can do is combining them into one atom action, i.e. enableRadio(frequency) you proposed, and the app will have to set a frequency which is also a *random* number to the end user when enabling the FM.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 95,
                "quote": "No, because I do not think that a webpage should be able to pipe audio out of the phone's speaker. That's another good reason not to put speakerEnabled on the FM radio interface.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 96,
                "quote": "I think the FM radio should immediately shut itself off when you unplug the headset (which functions as the antenna). Playing static through the phone's external speaker when the headset is disconnected is not useful in any way. Then the only use-case for speakerEnabled that Ray and I were able to come up with on IRC is: I want to listen to the FM radio on my phone's speakers, but I have to leave the headphones plugged in because they function as the radio's antenna, and B2G (currently) doesn't have any way for me to direct audio to the external speaker except by unplugging the headphones. I don't feel like this is a core FM radio use-case. Even if it's a blocker, I think we should figure it out in a follow-up bug, so as to reduce the scope of this bug and land it sooner. We can argue about what interface the relevant APIs should live on in that bug.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 97,
                "quote": "Hi Justin, i updated the WebIDL, here is what i did: - Break setEnabled into two methods: disable, enable(frequency) - Removed bandRanges, and add three new attributes: frequencyUpperBound, frequencyLowerBound and channelWidth - Renamed onantennastatechange to onantennaavailablechange which is more intuitively connected to the attribute antennaAvailable - Changed the type of frequency to 'any' and here is the updated webidl: interface FMRadio : EventTarget { /* Indicates if the FM radio is enabled. */ readonly attribute boolean enabled; /* Indicates if the antenna is plugged and available. */ readonly attribute boolean antennaAvailable; /** * Current frequency in MHz. * The value will be null if the FM radio is disabled. */ readonly attribute any frequency; /** * The signal strength. * The value returned is between 0 (no signal) and 1 (full signal), inclusive. */ readonly attribute double signalStrength; /* The upper bound of frequency in MHz. */ readonly attribute double frequencyUpperBound; /* The lower bound of frequency in MHz. */ readonly attribute double frequencyLowerBound; /** * The channel width of the ranges of frequency, in MHz. * Usually, the value is one of: * - 0.05 MHz * - 0.1 MHz * - 0.2 MHz */ readonly attribute double channelWidth; /* Fired when the FM radio is enabled. */ attribute Function onenabled; /* Fired when the FM radio is disabled. */ attribute Function ondisabled; /** * Fired when the antenna becomes available or unavailable, i.e., fired when * the antennaAvailable attribute changes. */ attribute Function onantennaavailablechange; /* Fired when the FM radio's frequency is changed. */ attribute Function onfrequencychange; /* Fired when the signal strength changes. */ attribute Function onsignalstrengthchange; /** * Power the FM radio off. * The disabled event will be fired if this request completes successfully. */ DOMRequest disable(); /** * Power the FM radio on, and tuned the radio to the given frequency in MHz. * This will fail if the given frequency is out of range. * The enabled event and frequencychange event will be fired if this request * completes successfully. */ DOMRequest enable(in double frequency); /** * Tune the FM radio to the given frequency. * This will fail if the given frequency is out of range. * * Note that the FM radio may not tuned to the exact frequency given. To get * the frequency the radio is actually tuned to, wait for the request to fire * onsucess (or wait for the frequencychange event to fire), and then read the * frequency attribute. */ DOMRequest setFrequency(in double frequency); /** * Tell the FM radio to seek up to the next channel. If the frequency is * successfully changed, the frequencychange event will be triggered. * * Only one seek is allowed at once: * If the radio is seeking when the seekUp is called, onerror will be fired. */ DOMRequest seekUp(); /** * Tell the FM radio to seek down to the next channel. If the frequency is * successfully changed, the frequencychange event will be triggered. * * Only one seek is allowed at once: * If the radio is seeking when the seekDown is called, onerror will be fired. */ DOMRequest seekDown(); /** * Cancel the seek action. * If the radio is not currently seeking up or down, onerror will be fired. */ DOMRequest cancelSeek(); }",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 98,
                "quote": "This should be a nullable-double, which I think is \"double?\" in webidl.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 99,
                "quote": "Nit: s/tuned/tune",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 100,
                "quote": "Hm...it's a little weird that we have two events for FM radio enabled/disabled, but only one event for antenna plugged/unplugged. But antenna unplugged will cause us to disable the radio, so...maybe it's OK. What do you think? Aside from the above, this looks good to me. We should get Jonas's SR (please post a patch), but I don't think you should block on that before working on the rest of the patches.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 101,
                "quote": "Attached patch nsIDOMFMRadio IDL \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 102,
                "quote": "Let's remove toggle feature out of v1. Just provide a note here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 103,
                "quote": "Looks great!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 104,
                "quote": "Nit: I think the name here is a bit too technical. Something like channelStep might be easier to understand. I'm totally fine either way though.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 105,
                "quote": "Attached patch all in one patch, WIP, v1 (obsolete) \u2014 Details \u2014 Splinter Review It depends on the patches of bug731746 and bug749053.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 106,
                "quote": "Could you please obsolete the old patches in this bug? It's not clear to me what is part of this bug anymore.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 107,
                "quote": "I saw the bug 731746 comment 19, which way should i do, implement the two methods in JS or rewrite all code in c++?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 108,
                "quote": "Re-implementing in C++ would yield the most correct result, but it seems to me that adding add/removeEventListener is the path of least resistance. Do you think that's right? A lot of people are itching to get this landed, so we should do whatever is easiest/fastest.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 109,
                "quote": "Attached patch all-in-one patch, WIP, v2 (obsolete) \u2014 Details \u2014 Splinter Review It depends on the patches of bug749053.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 110,
                "quote": "I think we want the hal backend to tell us this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 111,
                "quote": "Hmm.. This doesn't really sound like a fallback since it's being run when we actually have a fm radio.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 112,
                "quote": "You should add the event listener before enabling the radio. If enable immediately enables the radio, your listener won't be called. Same thing goes for the disable listener.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 113,
                "quote": "What's left to make this not a WIP?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 114,
                "quote": "Attached patch all-in-one patch, v1 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 115,
                "quote": "Here is the tests: https://github.com/mozilla-b2g/gaia/pull/4298",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 116,
                "quote": "Attached patch all-in-one patch, v3 (obsolete) \u2014 Details \u2014 Splinter Review Update the patch to make it work with the latest m-c, see bug788561",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 117,
                "quote": "Hi Justin, do you have a plan to review my code?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 118,
                "quote": "\"The addEventListener, removeEventListener, and dispatchEvent methods below are a temporary hack, which will be removed once nsIDOMFMRadio can inherit from nsIJSDOMEventTarget. See bug 731746.\" (The main problem here is that we use \"this\" when we mean \"these\".)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 119,
                "quote": "Does this file not work if you don't include these to files? It's not clear why you need them.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 120,
                "quote": "Please add a brief comment here explaining what nsIFMRadio is for.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 121,
                "quote": "Please indicate what the units are here. (I don't see why this shouldn't be a double like nsIDOMFMRadio.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 122,
                "quote": "Please match nsIDOMFMRadio by making signalStrength a double.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 123,
                "quote": "Please add a comment explaining what settings are expected. In fact, we really should create a new interface (e.g. nsIFMRadioSettings) and use that as the argument type here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 124,
                "quote": "Relying on FM_RADIO_SEEK_DIRECTION_{UP,DOWN} is problematic here, because callers from JS don't have access to those constants. Instead, you should add constants to this IDL file, like: const long SEEK_DIRECTION_UP = 0; const long SEEK_DIRECTION_DOWN = 1; (Notice that these are |long|'s, that is, int32's. I don't think it makes sense to use a short here; this is effectively an enum, and we use XPIDL |long| for that.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 125,
                "quote": "Again, switch this to nsIFMRadioSettings, so that if I called this from C++, I wouldn't have to unpack a mysterious jsval.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 126,
                "quote": "Again, indicate what the units are on frequency, and consider using a double here (unless there's a good reason not to?).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 127,
                "quote": "These should all be nsIRunnable. That will give you a strongly-typed callback function, which is what you're going for here, I think. (In other words, if you used nsIRunnable here, you wouldn't have to change any of the JS code which calls this interface.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 128,
                "quote": "It looks like FM radio support is guarded by MOZ_B2G_FM, but this JSM is included on all B2G builds. Should you add a check here that MOZ_B2G_FM is set?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 129,
                "quote": "We never put |using namespace| inside a header file. That causes serious breakage, because it means that every header file which is included below this one also |uses namespace mozilla::hal|, which effectively puts mozilla::hal into the global namespace!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 130,
                "quote": "This is defined in hal/HalTypes.h, which is included above. Do you need this here?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 131,
                "quote": "Fix spacing, please. (Align everything to the first |public| above.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 132,
                "quote": "Dispatch a trusted, non-cancellable, not-bubbling event to ourself.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 133,
                "quote": "int32_t, or uint32_t, but almost never raw |int|. But it looks like this should actually have the type hal::SwitchState. Please add a comment indicating what this is the status of, and rename the variable to something more meaningful than |mStatus|.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 134,
                "quote": "Why are these protected and not private? Does someone inherit from this class?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 135,
                "quote": "These are virtual methods, no? Notify(SwitchEvent&) comes from SwitchObserver, and Notify(FMRadioOperationInformation&) comes from FMRadioObserver. Both SwitchObserver and FMRadioObserver are instances of mozilla::Observer, defined in xpcom/glue/Observer.h. In that case, these need to be marked as virtual. Also, please put them up with the other public methods.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 136,
                "quote": "A bunch of things will be changing in this file, per my comments in the IDL. I haven't commented on them further here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 137,
                "quote": "As far as I can tell, these log statements are the only android-only feature of this file. Please guard them with an ifdef. (You can just define LOG to do nothing if we're not on Android.) The right solution would be to use prlog, but that's kind of a pain to use in b2g. We have a pretty bad logging story. :(",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 138,
                "quote": "You use these only once, and the macros aren't any shorter than what they're replacing, so I'd inline the macros, if it was me. Whatever you prefer is fine.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 139,
                "quote": "We format this like: FMRadio::FMRadio() : mStatus(1) , mHasInternalAntenna(false)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 140,
                "quote": "We use NS_FAILED instead of !NS_SUCCEEDED and format this like if (NS_FAILED(Preferences::GetBool(DOM_FM_ANTENNA_INTERNAL_PREF, &mHasInternalAntenna)) || !mHasInternalAntenna) { But even better, I think, would be to do mHasInternalAntenna = Preferences::GetBool(\"dom.fm.antenna.internal\", /* default = */ false); if (mHasInternalAntenna) { LOG(\"We have an internal antenna.\"); } else { ... }",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 141,
                "quote": "Please do if (...) { (We almost never put the brace for an if statement on the next line.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 142,
                "quote": "Gecko style is to brace all if/else statements. Also, when you switch mStatus to the |SwitchState| type, please use SWITCH_STATE_{ON,OFF}, not \"0\", here and elsewhere.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 143,
                "quote": "Nit: This is a comma splice. Replace the comma with a period. But I also don't understand this comment; the signal strength is [0-100], but it can be bigger than 100? Perhaps you could elaborate a bit in the comment.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 144,
                "quote": "Nit: how about *aSignalStrength = NS_MIN(signalStrength, 100) / 100.0;",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 145,
                "quote": "Nit: |const JS::Value& settings|. But this whole thing is going to change anyway, per the comments on the IDL.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 146,
                "quote": "Nit: Please do event->InitEvent(aEventName, /* bubbles = */ false, /* cancelable = */ false);",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 147,
                "quote": "TBH, it's not clear to me that we're winning anything by using JS here. We shouldn't rewrite this whole thing in C++ right now, but I think we should start on that project once we land this and shake out the first round of bugs. We'll get increased correctness, which is great, but I think the result may also be simpler in a lot of ways. Currently, the control flow is as follows: webpage (JS) -> nsIDOMFMRadio (JS) -> FMRadioService (JS) -> nsIFMRadio (C++) -> HAL (C++) -> hardware but if nsIDOMFMRadio were implemented in C++, we could simplify this to webpage (JS) -> nsIDOMFMRadio (C++) -> HAL (C++) -> hardware I think that would be a significant improvement. What do you think?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 148,
                "quote": "I think it would be better to call this file \"DOMFMRadioChild.js\" and to call FMRadioService.jsm \"DOMFMRadioParent.jsm\". Then we don't have to guess about what code lives in which process.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 149,
                "quote": "I don't use emacs, but shouldn't this be \"Mode: JavaScript\"?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 150,
                "quote": "Why is getAntennaState in this list? (I think this whole idiom that DOMRequestIpcHelper has developed is pretty bogus; you shouldn't list twice each of the events that you want to listen to, because that's just asking for a mistake. But that's not your bug to fix here.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 151,
                "quote": "_fireSignalStrengthChangeEvent, please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 152,
                "quote": "s/FM/FM radio",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 153,
                "quote": "How about \"FM radio seek-up failed\".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 154,
                "quote": "_call calls _checkPermission(), but everyone who calls _call() also calls _checkPermission().",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 155,
                "quote": "You're not using the wantsUntrusted field, so you should omit it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 156,
                "quote": "Just set this in the constructor so you don't have to check it everywhere. Also, this._eventListenersByType would be a better name than _eventTypes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 157,
                "quote": "We're inconsistent about how we name these string constants. Here they're capitals, like a C++ macro. But then we have kMozSettingsChangedObserverTopic. I don't care what you do, so long as you're consistent. Also, \"spaceType\" is not a good name for the setting. \"fm.channelInterval\" would be better. \"fmRadio.cannelInterval\" would be even better. :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 158,
                "quote": "We're going to move these onto the nsIFMRadio interface, which will be an improvement.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 159,
                "quote": "It's not clear to me why we should have constants like this when we could have const VALID_CHANNEL_INTERVALS = [200, 100, 50]; // KHz let _currentInterval = ...; // _currentInterval is either 200, 100, or 50. But in any case, please call these \"CHANNEL_INTERVAL\" or \"INTERVAL\", but not \"SPACE_TYPE\".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 160,
                "quote": "Please indent this as XPCOMUtils.defineLazyServiceGetter(this, \"gSettingsService\", \"@mozilla.org/settingsService;1\", \"nsISettingsService\");",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 161,
                "quote": "It looks like you intend to pass the frequency to _seekingCallback, but you don't here. I'm not sure, but is the right thing to pass a bool instead of -1? Seems like you don't miss not having the frequency in the callback.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 162,
                "quote": "Also, please wrap this line and the other long comments in this patch.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 163,
                "quote": "s/, need to update current frequency/, so we need to update the current frequency./",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 164,
                "quote": "We're calling |space| the |interval|, right?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 165,
                "quote": "Please add an example here for what happens when we pass an out-of-range value. Also, probably better to use values in KHz rather than MHz in your example, since that's what the function deals with.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 166,
                "quote": "Don't call this \"roundedPart\", because it's not rounded yet. Either shove |freq - lower| into the line below, or call this something else.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 167,
                "quote": "|_initialized|",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 168,
                "quote": "_currentInterval. Why do you initialize _currentBand and _currentSpaceType to actual values, instead of null? We shouldn't use these values until we get them from the FM radio, right?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 169,
                "quote": "It's confusing that we use some global variables and functions and some class variables and functions. Can we make all the variables and functions live on the class, please?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 170,
                "quote": "We hard-code some observer message names but not others, which is inconsistent. I have no problem hard-coding them all.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 171,
                "quote": "It doesn't matter much, but for the sake of cleanliness and not encouraging others to write bad code, please create one lock and get both settings.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 172,
                "quote": "When does this get called? And why is this the right reaction to an error?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 173,
                "quote": "We don't need to inform hal that the band has changed?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 174,
                "quote": "Similarly, we don't need to inform hal here? I guess hal is also listening to the settings notifications?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 175,
                "quote": "Here and elsewhere, you could simplify this by doing let signalStrength = FMRadio.signalStrength; if (signalStrength != _currentSignalStrength) { _currentSignalStrength = signalStrength; pmm.broadcastAsyncMessage(...); } I think that more clearly expresses your intent.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 176,
                "quote": "Passing a callback function here doesn't make much sense, since you always call the callback synchronously! It would make more sense to return true/false, I think.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 177,
                "quote": "Should _updatePowerState call _startSignalChecking/_stopSignalChecking, as appropriate? That would eliminate a class of possible bugs. Also, it sounds like _updatePowerState should call _updateFrequency when we transition to the |on| state?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 178,
                "quote": "Please make this interval value (2000) a pref.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 179,
                "quote": "When this._signalCheckingInterval is undefined, it != null, so we'll do this if statement, even though you don't want us to. A simple fix would be to initialize this._signalCheckingInterval to null in the constructor.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 180,
                "quote": "I'd prefer that the large bodies in this case statement be broken out into separate methods.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 181,
                "quote": "Surely you mean parseInt(msg.data) * 1000! But if this is working as-is, it sounds like you don't need the parseInt at all?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 182,
                "quote": "If you break this out into a separate method, then you can simply return here. We prefer if (...) { ... return; } ... to if (...) { ... } else { ... } in Gecko.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 183,
                "quote": "Doesn't this have the race condition we discussed much earlier, where the radio is enabled and set to some random frequency, and only later set to the correct frequency?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 184,
                "quote": "s/ranges/range Also, we're not really doing \"return false\" so much as \"indicate that the request failed.\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 185,
                "quote": "Again, seems like the callback to seekStation should accept a boolean, since it doesn't care about the exact frequency.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 186,
                "quote": "If it so happens that the seek completes and the frequency didn't change (perhaps because the frequency was manually changed during the seek, maybe for some other reason), then we'll never fire success or failure on the DOM request! That's no good.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 187,
                "quote": "I'd feel better if seekUp and seekDown were implemented by one method.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 188,
                "quote": "Missing semicolon after the close paren. It's not clear to me why you only want to send the DOMFMRadio::cancelSeek message when updateFrequency changes the frequency (the callback is not invoked when we don't change the frequency)!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 189,
                "quote": "Most of these changes are cosmetic; this patch is pretty good! Although one of the downsides of there being so many layers of indirection between the DOM and the hardware is that it's hard to tell for sure whether it's correct. :(",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 190,
                "quote": "It does not make sense to say that a number is \"in the range [X, Y]\" and also that the number \"can be bigger than Y\". Those two statements are contradictory. Perhaps you mean something like The signal strength is interpreted as a percentage (0-100%). But due to a hardware quirk, s can also be greater than 100, in which case we report the signal strength as 100%. But actually, hal should be doing this conversion; this is absolutely not a front-end concern. hal should give back a double in [0,1], or an int in [0,100], or otherwise make /some/ sane guarantee about the value it returns.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 191,
                "quote": "It seems that NS_MIN can not be used on the uint32_t typed value.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 192,
                "quote": "There is no such a method like \"hal::UpdateFMRadioSetting\" to change the settings, the only way i can do is power the radio off, and then turn it on by pass the new settings, i don't think it's good.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 193,
                "quote": "Currently, the chip will stay quiet until we set a frequency.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 194,
                "quote": "The callback will be called anyway, the function name or callback name might be kind of misleading, i will change it to make it more clear.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 195,
                "quote": "Yeah, agreed. We're not even attempting to support dynamic FM band changes, so whatever.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 196,
                "quote": "Oh, fantastic. But please re-arrange this code so that we don't send a message to the child until you've called hal and set the frequency. Otherwise the child might be able to notice that, right after calling enable(freq), the frequency isn't actually what it expects!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 197,
                "quote": "I don't see why we want a callback there at all, since the callback just gets called when the function completes",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 198,
                "quote": "Can we just eliminate that parameter?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 199,
                "quote": "Actually, I was wrong -- these are real events, not fake ones. (You call onantennastatechange by firing an event on the FMRadio class, which is the right way to do it.) You may be able to s/jsval/nsIDOMEventListener without any other changes to your code (see e.g. dom/wifi/nsIWiFi.idl), but if that doesn't work, jsval is fine.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 200,
                "quote": "That leads to different page-visible behavior. For example, consider this: foo.onenabled = { dispatchEvent: function foo() {} }; This would work if onenabled is an nsIDOMEventListener, but not if it's a jsval. Other on* attributes are jsval, fwiw.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 201,
                "quote": "We have some other nsIDOMEventListeners in web-exposed interfaces; I'll file bugs on those.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 202,
                "quote": "er, nsIDOMFMRadio. I filed bug 790263 on the other onfoo properties.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 203,
                "quote": "In the second one, the second and third lines start in the same column as the t in \"this\". This is because the \"@mozilla.org\" argument is contained within the same parenthesis level as \"this\". We break this rule in plenty of places, but in general, we try to indent this way. It's not always possible, and when it's not, we prefer to indent the second line one indent (that is, two or four spaces, depending on the file). If you were to do that here, you'd do",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 204,
                "quote": "Now I'm confused. In comment 85, I wrote XPCOMUtils.defineLazyServiceGetter(this, \"gSettingsService\", \"@mozilla.org/settingsService;1\", \"nsISettingsService\"); How do you think it should be?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 205,
                "quote": "Hi Justin, i checked the patches of the bug749053, there is one function to query the FM radio settings by country code. So it seems that the right way to enable the FM radio should be: - Get country code - Query the settings info from hal::GetFMBandSettings by the country code - Call the hal::EnableFMRadio by passing the settings object I think we can introduce a setting, say \"fmRadio.regionCode\", to define the country code for the FM radio (maybe there is already one setting pref for general use), but the country code is defined as an Enum type in C, which means, we should build a setting-to-enum map, so if the Enum type is changed, the whole map will be rewritted, i think it's hard to be maintained. What do you think?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 206,
                "quote": "Attached patch all-in-one patch, v4 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 207,
                "quote": "Attached patch all-in-one patch, v4 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 208,
                "quote": "Can we get a build peer to look at the build changes again? (You got r- last time.) I'm not comfortable reviewing that stuff. (You'll probably get a faster review from khuey if you split the relevant changes out into a separate patch.)",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 209,
                "quote": "This interdiff was created by manually renaming DOMFMRadio.js --> DOMFMRadioChild.js and FMRadioManager.jsm --> DOMFMRadioParent.jsm in patch v3. This is missing some uninteresting changes in nsLayoutModule, but is hopefully complete aside from that. (I've had problems with interdiff mysteriously missing hunks lately, so fingers crossed.)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 210,
                "quote": "I'm sorry to nit, but this still has a few problems. We need a preposition (\"from\", in this case) between \"inheriting\" and \"nsIJSDOMEventTarget\". It's not clear what \"these\" are. It would be helpful if you'd explicitly list the relevant methods. You also need some kind of connector after the first comma (\"hacks, /which/ will be removed\", or \"hacks; these will be removed\"). The second comma creates a comma splice; it should instead begin a new sentence. I'd also like a period at the end of the sentence.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 211,
                "quote": "We decided to call this the channelInterval? If you want to be fancy, you could put \"[infallible]\" in front of \"attribute\". That would let you do nsCOMPtr<nsIFMRadioSettings> settings; int32_t lowerLimit = settings->GetLowerLimit();",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 212,
                "quote": "s/,/;/. Otherwise this is great.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 213,
                "quote": "s/in JS component/as a JS component/ * \"we need such an interface to be accessed in JS component and JS module\" I'm not sure what you mean, but maybe it should be \"it can't access our C++ hardware interface directly; instead it must go through this interface.\" * \", do not confuse it with the WEbFM DOM interface(nsIDOMFMRadio).\" This is a comma splice, but it's corrected if you take the suggestion above. It's not clear what \"it\" refers to here. It would be better to say \"Do not confuse /this interface/\". Space before the open parenthesis.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 214,
                "quote": "s/will be/is (I have no idea what rule explains why we use the present tense for the first part of this conditional and the future tense for the second part.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 215,
                "quote": "I still don't get why we expose the frequency in KHz here and in MHz in the DOM interface, but it's not a big deal.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 216,
                "quote": "(You can think of \"plugged in\" as a transitive verb. Compare \"My tub is no longer leaking; the hole is plugged,\" and \"I plugged in my antenna.\")",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 217,
                "quote": "The \"ns\" prefix is what we used before we had namespaces (and what we use now in places where we don't have namespaces, like interfaces). I'd be OK if this class lived in the top-level namespace. Otherwise, if you rename it to FMRadioSettings and leave it in mozilla::dom::fm that works too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 218,
                "quote": "Please rename \"spaceType\" here and elsewhere.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 219,
                "quote": "I think mHeadphoneState and mHeadphoneObserver (or mHeadphoneSwitchState and mHeadphoneSwitchObserver) would be better names here. There are lots of switches and observers you might otherwise have.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 220,
                "quote": "When you remove the nsAutoPtr below, you can remove this include, too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 221,
                "quote": "Looks like you missed my earlier comment about this hunk:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 222,
                "quote": "Please indent \"/* default = */ false\" so it's the \"D\" in DOM_FM_ANTENNA_INTERNAL_PREF.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 223,
                "quote": "You could change this to info.upperLimit() = settings->GetUpperLimit(); if you made this attribute [infallible].",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 224,
                "quote": "This is actually quite important, and I'm surprised it's not causing crashes. nsAutoPtr does not call AddRef() on its member. So that means that *_retval has a refcount of 0, while the caller of this function expects it to have a refcount of 1. Which means we're likely to run into a use-after-free crash here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 225,
                "quote": "Nit: Put the && on the line above. (As a rule, we don't start a line with a binary operator like && or +.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 226,
                "quote": "It's pretty confusing to flip the boolean around like this. I don't care which way the boolean goes, but can we make it consistent?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 227,
                "quote": "Just |return FM_BANDS[...] + roundedPart;|",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 228,
                "quote": "Like I said in the earlier review, I think this would be better if you moved the large |case| bodies into their own functions, particularly because it would let you do early returns instead of these long |else| clauses. The small |case| bodies are fine how they are.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 229,
                "quote": "s/being enabled currently/currently being enabled/",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 230,
                "quote": "When you split out this code into a method, perhaps you can combine seekUp and seekDown, if that makes sense. r=me on the JS bits. I'd like to take another look at the C++ parts. And we still need that review from a build peer.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 231,
                "quote": "Then i will rename them all to \"channelWidth\". And what do you think about the comment #107 ?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 232,
                "quote": "So, we should map the \"fmRadio.regionCode\" setting like this: us -> 0, eu -> 1, de -> 4 If we change the enum, say insert FM_RADIO_COUNTRY_CN before FM_RADIO_COUNTRY_EU, the map will have to be changed like this: us -> 0, eu -> 2, de -> 5 unless we promise all the new values will be appended and no value will be removed. If i am wrong, please correct me.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 233,
                "quote": "[infallible] attributes are only allowed on [builtinclass] interfaces, however, if i add [builtinclass] to nsIFMRadio, then the function FMRadio::enable(nsIFMRadioSettings settings) is not callable from JS, here is the error: [JavaScript Error: \"NS_ERROR_FAILURE: Failure arg 0 [nsIFMRadio.enable]\" {file: \"resource://gre/modules/DOMFMRadioParent.jsm\" line: 423}]",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 234,
                "quote": "can't be used on interfaces implemented in JS.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 235,
                "quote": "Comment on attachment 660727 [details] [diff] [review] part B - nsIDOMFMRadio IDL, v1.1 The only change here is the comment over addEventListener? r=me, in that case.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 236,
                "quote": "I don't think you meant to add this newline.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 237,
                "quote": "Part of the benefit of pulling these chunks into their own functions was that \"it would let you do early returns instead of these long |else| clauses.\" That is, you could do here if (...) { sendMessage(...); return; } // The rest of the method.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 238,
                "quote": "Um...I have no idea where this BTDEBUG thing came from, but it's no good. You're just defining LOG to printf for non-gonk systems. A simple fix that I would be OK with is #else //#define LOG(args...) printf(args); #define LOG(args...) #endif A better fix would be to use prlog. See e.g. dom/ipc/ProcessPriorityManager.cpp.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 239,
                "quote": "I think the choice is between doing a 0-5 (or whatever) conversion or reporting the signal strength in dB's and letting the website figure out how to show that to the user.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 240,
                "quote": "But I'm not wed to that idea. What do you think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 241,
                "quote": "If we are talking about signal strength then dBm sounds great to me. That seems much more standard than any 0-5 scale we can invent.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 242,
                "quote": "Um, Jonas, can you unset the security bit?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 243,
                "quote": "If i will create a FM app, i think [0-5] is enough, i don't want to spend anytime to figure out the min and max value it should be, and how to transform it to a meaningful value. I don't quite understand why the app author should care about the accurate number in dBm, we even don't have a signal strength indicator in the FM app of Gaia. So in my opinion, we should provide a relative signal strength at least, either an int value range from 0 to 5, or just keep it as a float value range from 0 to 1.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 244,
                "quote": "Maybe we can just cut out the signal strength for now, if we don't need it for the FM app. Then we wouldn't have to worry about scaling the logarithmic dBm units to more user-friendly units, and we wouldn't have to worry about that broadcast() call.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 245,
                "quote": "Em, it's not a bad idea, Jonas, what do you think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 246,
                "quote": "rebased the lastest m-c",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 247,
                "quote": "Removed signalStrength and onsignalstrengthchange",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 248,
                "quote": "- Rebased the lastest m-c - Removed signalStrength related codes - Fixed nits based on the comment 124 and comment 125",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 249,
                "quote": "Hi, Kyle, do you have a plan to review this?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 250,
                "quote": "Does this really need a configure option? It doesn't seem so. Please just AC_SUBST(MOZ_B2G_FM)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 251,
                "quote": "There's not much point putting this on 3 lines. Just PARALLEL_DIRS += fm on one.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 252,
                "quote": "review comments addressed. AC_DEFINE was left in since there is code looking for that define.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 253,
                "quote": "All patches were folded into one commit. https://hg.mozilla.org/integration/mozilla-inbound/rev/75923725b2fc",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 254,
                "quote": "I backed out a range of patches including this one which caused a perma-leak in all of our test suites on debug builds: https://hg.mozilla.org/integration/mozilla-inbound/rev/e60144694d56",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 255,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/432033434b3a",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1382702",
        "issue_id": 1382702,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I'm unsure what's the difference between Buildbot Windows and Taskcluster Windows. Dragana, would you see why time outs now happen?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "If I do not find bugs (not only this one) TFO will be disabled (most probably it will be disabled). I would like to find out why this tests are failing. Can you run the tests with some logging turned on? (I do not develop on windows so I cannot run them locally)",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I just triggered a new xpcshell job with --verbose on it[1]. If you need print out some variables, you can perform a try run on top of mozilla-inbound (while bug 1374589 comment 25 reaches mozilla-central), with the syntax: > try: -b o -p win64 -u xpcshell -t none Then on treeherder, you just need to display tier-3 jobs. As an example, see this treeherder job[2], ran against this debug patch[3].",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "XPCShell jobs on tc-windowns are landed on central[1]. Per the public email sent to dev-planning, dev-platform, and other mailing lists[2], some windows 10 jobs will be tier-1 on Wednesday July 26th 4pm UTC. Network failures only occur on Windows 10[3]. Dragana, do you think it's okay to turn off TFO before this Wednesday? Or would you need more time to find bugs?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "This is just a tmp fix, by disabling TFO for this tests. They want to turn them on on 26th and I do not want to interfere with that plan. I will leave this bug open and dig into the failure probably tomorrow.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/3e01e416c117",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "dont' you have to reset the pref at the end of the test, as these are run in suites? (with clearUserPref or something..) also - this behavior should probly block TFO overall, right?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "I'm not 100% whether xpcshell needs to be reset or not - I thought it did. Can you either a] find proof that xpcshell does not need a reset.. then r+ or b] just reset things.. then r+",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "Unlike mochitests and reftests, each xpcshell test runs in a separate xpcshell process, and each one gets a clean profile and temp dir...so I don't think it is necessary to reset prefs. On the other hand, I notice a lot of pref-setting xpcshell tests do reset prefs...maybe a good idea in case the harness changes, etc.? Over in bug 1384728 (and other related bugs) we're seeing extremely frequent failures. If there's going to be any delay in resolving this, please let me know and I'll skip the affected tests.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Tests are now back to green[1] thanks to [2]. Thank you very much Dragana!",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "I now know the really problem why this tests are failing. I want to run 1-2 additional tests with logging and I will open a bug and fix the test even with TFO turned on.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=561168",
        "issue_id": 561168,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Here's the first pass at this; posting up here to get feedback, because for some reason invalidation doesn't work. The canvas is drawn at the correct spot, but only get invalidates if I scroll around and reveal the new areas.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Move GetLayerManagerForDoc to nsLayoutUtils and share it please! + nsIntRect mUpdatedRect; You don't need this. Updated can be a no-op for BasicCanvasLayer.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "- Implement basic CanvasLayer (gfxASurface only) - Teach 2D context how to return a CanvasLayer - move nsHTMLCanvasElement.h into public dir - teach HTMLCanvasFrame how to render using layers",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "- move nsICanvasElement functionality into nsHTMLCanvasElement - create nsICanvasElementExternal, for outside-of-layout consumers",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "- fix some refcounting issues - add support for creating pbuffers on OSX - move WebGL to GLContext pbuffers on OSX",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "- add GLContext pbuffer support for Win32, use it in WebGL",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "A bunch of cleanup from earlier patches; remove obsolete WebGL pbuffer interfaces, remove non-layers code paths from canvas. Things that are still to do: - Linux pbuffers - Use the context attribs in pbuffers better, and teach webgl how to request the proper ones - Check callers of RenderContextsExternal (such as d&d code) to make sure that they still work",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "(Forgot to qrefresh patch 5 before attaching, this is the real one)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Your lack of 'a' prefixes on parameters makes me itch. I will let it slide on the canvas rendering context code, but not elsewhere in content/ or in layers. +/* XXX move into nsContentUtils */ This needs to actually move into nsContentUtils :-). Also the version in nsHTMLMediaElement has improved, so you should move that one to nsContentUtils. + PRBool mIsOpaque; We don't need this. You can just use mIsOpaqueContent/SetIsOpaqueContent that the layer already has. + virtual void Initialize(const Data& aData) = 0; + virtual void Updated(const nsIntRect& aRect) = 0; Document these --- and CanvasLayer itself. + NS_ASSERTION(mUpdatedRect.IsEmpty(), \"CanvasLayer::Updated called more than once during a transaction!\"); + NS_ASSERTION(mUpdatedRect.IsEmpty() || mBounds.Contains(mUpdatedRect), \"CanvasLayer: Updated rect bigger than bounds!\"); Break these lines ... think of the teletypes! + nsIntRect mBounds; We only need an nsIntSize here, right? + nsIntRect mUpdatedRect; We don't need this in BasicLayers, so I would just not have it at all. Shouldn't we be calling Updated() somewhere? +#if 0 void PaintVideo(nsIRenderingContext& aRenderingContext, const nsRect& aDirtyRect, nsPoint aPt); - +#endif Er ... lose this?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Presumably debug code :-)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "We probably want to either return here, in case we want this check in release builds (I suspect we do), or assert, because right now this would be a pointless if in a release build.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "If we require it to be empty, wouldn't assigning be cheaper than Union? It would save us a little bit of if-ing in UnionRect.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "This merges the patches and updates them with review comments. It can largely be reviewed in toplevel chunks -- that is, per directory/directory group. mUpdatedRect and friends are easier to keep as a rect than a Size due to unioning/clipping/etc. In the future I think it might be possible to call updated more than once before finalization, hence the checks, though maybe I need to think through that a little more.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "- persist=\"screenX screenY width height sizemode\"> + persist=\"screenX screenY width height sizemode\" + > Discard this hunk @@ -1781,6 +1799,7 @@ public: ~nsAutoScriptBlocker() { nsContentUtils::RemoveScriptBlocker(); } + and this one @@ -5980,3 +6031,4 @@ nsIContentUtils::IsSafeToRunScript() { return nsContentUtils::IsSafeToRunScript(); } + and this one + NS_IMETHOD RenderContextsExternal (gfxContext *ctx, gfxPattern::GraphicsFilter aFilter) = 0; unnecessary space before ( WebGLContext::Render(gfxContext *ctx, gfxPattern::GraphicsFilter f) { ... + return NS_ERROR_NOT_IMPLEMENTED; Hmm ... shouldn't this be fixed before checking in? I assume this gets called when we use the canvas as an image source via nsLayoutUtils::SurfaceForElement? + // if (mCanvasLayer) + // return mCanvasLayer; Might as well remove this + // This flush is required + MakeContextCurrent(); + gl->fFlush(); why is it required? + nsRefPtr<layers::CanvasLayer> mCanvasLayer; Not used, remove. Even with retained layers, you will not be remembering your layer directly, you'll ask the FrameLayerBuilder (new class) for your old layer. + canvasLayer->SetIsOpaqueContent(PR_FALSE); Should probably respect the canvas opaque attribute. Maybe instead of the canvas context exporting GetCanvasLayer, it should be GetCanvasData, returning a CanvasLayer::Data that the caller creates a layer for? Then the rest of the layer initialization can be shared across contexts. + nsRefPtr<CanvasLayer> mCanvasLayer; Don't have this here in the 2D context either. Just create a new one every time. + nsCOMPtr<nsIContent> content = do_QueryInterface(static_cast<nsIDOMHTMLCanvasElement*>(mCanvasElement)); + nsCOMPtr<nsIContent> content = do_QueryInterface(static_cast<nsIDOMHTMLCanvasElement*>(mCanvasElement)); + nsCOMPtr<nsIContent> content = do_QueryInterface(static_cast<nsIDOMHTMLCanvasElement*>(mCanvasElement)); teletype issue + // if (mCanvasLayer) + // return mCanvasLayer; remove + } else { + nsRect r = frame->GetRect(); + r.x = r.y = 0; + frame->Invalidate(r); Should invalidate just the content area, so invalidate GetContentRect() - GetPosition(). nsHTMLCanvasElement::GetCanvasLayer should take a layer manager as a parameter instead of using LayerManagerForDocument. You might be asked to create a canvas layer for a different layer manager than the one being used to render the browser window (e.g., if someone does drawWindow to an arbitrary Thebes context). + struct Data { + Data() + : mSurface(nsnull), mGLContext(nsnull) + { } Fix indent!! + * CONSTRUCTION PHASE ONLY + * Initialize this CanvasLayer with the given data. The data must + * have either mSurface or mGLContext initialized (but not both), as + * well as mSize. + */ Say that this can only be called once? + * CONSTRUCTION PHASE ONLY + * Notify this CanvasLayer that the rectangle given by aRect + * has been updated, and any work that needs to be done + * to bring the contents from the Surface/GLContext to the + * Layer in preparation for compositing should be performed. + */ Say that the canvas buffer contents must not be modified during the layer transaction? That gives the implementation the flexiblity to avoid copying buffer data unless/until it needs it after the end of the transaction. + if (aData.mSurface) { + mSurface = aData.mSurface; Assert here that aData.mGLContext is null + mSurface = aData.mSurface; delete + if (mGLContext) { + nsRefPtr<gfxImageSurface> isurf = + new gfxImageSurface(gfxIntSize(mBounds.width, mBounds.height), + IsOpaqueContent() ? gfxASurface::ImageFormatRGB24 : gfxASurface::ImageFormatARGB32); + if (!isurf || isurf->CairoStatus() != 0) { + return; + } + + mGLContext->MakeCurrent(); + mGLContext->fReadPixels(0, 0, mBounds.width, mBounds.height, + LOCAL_GL_BGRA, LOCAL_GL_UNSIGNED_INT_8_8_8_8_REV, + isurf->Data()); Shouldn't we only be reading back mUpdatedRect, or something like that? Is that future work? Probably deserves a comment at least. I think the readback should happen during ::Paint, though (if mUpdatedRect is non-empty). + //gfxUtils::PermultiplyImageSurface(isurf); What's this about? Do we need to premultiply? +CanvasLayerOGL::Initialize(const Data& aData) +{ + NS_ASSERTION(mSurface == nsnull, \"BasicCanvasLayer::Initialize called twice!\"); + + mUpdatedRect.Empty(); Shouldn't need to set the rect to empty here, it starts empty I'm sad that we need platform-specific pbuffer code here, but I know nothing about this so I have nothing else to suggest. Like for BasicLayers, I think the CanvasLayerOGL code should defer all the real work until RenderLayer in case there are multiple Updated calls. Seems simpler that way anyway. + fprintf (stderr, \"Error: %d %x %p\\n\", err, err, (void*) mGLContext->GetNativeData(GLContext::NativePBuffer)); fflush(stderr); +const GLContextProvider::ContextFormat GLContextProvider::ContextFormat::BasicRGBA32Format(GLContextProvider::ContextFormat::BasicRGBA32); +#define A2_(_x,_y) do { attribs.AppendElement((CGLPixelFormatAttribute) _x); attribs.AppendElement((CGLPixelFormatAttribute) _y); } while(0) wrap somewhere +LibrarySymbolLoader::LoadSymbols(SymLoadStruct *firstStruct, bool tryplatform, const char *prefix) PRBool Looks like all the GLContext code needs to be using a* parameter names + mInitialized = (bool) LoadSymbols(&symbols[0], trygl, prefix); Just change mInitialized to PRBool Personally I suspect the A1/A2 macros aren't worth it... Shouldn't nsHTMLCanvasFrame::GetCanvasSize return 0,0 for errors?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Updated with review comments. Note that this omits all the pure-file removals.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "just the file removals",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "+ NS_IMETHOD RenderContextsExternal (gfxContext *ctx, gfxPattern::GraphicsFilter aFilter) = 0; Unnecessary space before ( + nsRefPtr<gfxImageSurface> surf = new gfxImageSurface(gfxIntSize(mWidth, mHeight), + gfxASurface::ImageFormatARGB32); + if (surf->CairoStatus() != 0) + return NS_ERROR_FAILURE; - int bwidth = mGLPbuffer->Width(); - int bheight = mGLPbuffer->Height(); + MakeContextCurrent(); + gl->fReadPixels(0, 0, mWidth, mHeight, + LOCAL_GL_BGRA, + LOCAL_GL_UNSIGNED_INT_8_8_8_8_REV, + surf->Data()); Can you ASSERT that surf->Stride() is what you expect? + nsRefPtr<layers::CanvasLayer> mCanvasLayer; You removed all uses of mCanvasLayer, but you still need to remove this declaration. + if (!LibrarySymbolLoader::LoadSymbols(mOGLLibrary, &pbufferSymbols[0], (LibrarySymbolLoader::PlatformLookupFunction)fGetProcAddress)) { + // this isn't an error, just means that pbuffers aren't supported + fCreatePbuffer = nsnull; + } + + if (!LibrarySymbolLoader::LoadSymbols(mOGLLibrary, &pixFmtSymbols[0], (LibrarySymbolLoader::PlatformLookupFunction)fGetProcAddress)) { Teletype + // the future we should use mUpdatedRect, thoug hwith WebGL we don't Fix typo",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Small followup -- fixes y-axis flip issues when rendering WebGL using BasicLayers. WebGL is rendered correctly when using OpenGL layers, but normal 2d canvases will be flipped upside down -- I'll fix this next, but it's going to depend on bug 565435 being fixed, since I have to fiddle with texcoords. Might take a day or two. I don't think it's an issue for now, since we don't have accelerated rendering for the browser window currently.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "and one more followup -- the image-rendering mode was being ignored. try server run going again, this was the only reftest that failed last time.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "WebGLArray.h was removed from the EXPORTS in content/canvas/public/Makefile.in, but the file itself sits still in said directory and is an #include dependency for WebGLContextNotSupported.cpp. The build breaks due to not finding the header file. I commented #include WebGLArray.h out and WebGLContextNotSupported.cpp was compiled successfully. Dunno if that's the right fix as another possibility would be to add WebGLArray.h back to the EXPORTS in the Makefile. Please give me a hint that I can open a follow-up bug with a proper fix. I'm building on OS/2 w/o WebGL dissabled (of course), thanks.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 21,
                "quote": "Nope, that's the right fix -- missed that while I was munging removals. Just pushed a fix.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Sorry, it appears that you removed to much here: weakld: error: Unresolved symbol (UNDEF) '_kDOMClassInfo_WebGLFramebuffer_interf aces'. weakld: info: The symbol is referenced by: E:\\mozbuild4\\mozilla\\dom\\base\\jsdombase_s.lib(nsDOMClassInfo.o) and so on DOMCI_DATA(CanvasRenderingContextWebGL, void) -DOMCI_DATA(WebGLBuffer, void) -DOMCI_DATA(WebGLTexture, void) -DOMCI_DATA(WebGLProgram, void) -DOMCI_DATA(WebGLShader, void) -DOMCI_DATA(WebGLFramebuffer, void) -DOMCI_DATA(WebGLRenderbuffer, void) These lines have to be added back",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=985257",
        "issue_id": 985257,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Bug 985257 - add implementation for Path2D constructor that takes an SVG path string (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Bug 985257 - add implementation for Path2D constructor that takes an SVG path string (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "The code you've put in nsSVGUtils would be better located in SVGContentUtils.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Could you move it there please?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "You should change the moz.build file(s) to make it reachable if you need to.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch Bug 985257 - add implementation + test for Path2D constructor that takes an SVG path string (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "try build: https://tbpl.mozilla.org/?tree=Try&rev=a2ccc8c9e639",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "Can you review?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "Backed out for bustage (which you probably would have seen had you not pushed to Try on top of other bustage). https://hg.mozilla.org/integration/mozilla-inbound/rev/d0cf18ff619d https://tbpl.mozilla.org/php/getParsedLog.php?id=36500526&tree=Mozilla-Inbound",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 10,
                "quote": "Attached patch add implementation + test for Path2D constructor that takes an SVG path string \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "new try build: https://tbpl.mozilla.org/?tree=Try&rev=eb4f961a13ef",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1298588",
        "issue_id": 1298588,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Yeah, I was hoping that we could keep the initial computed values totally static and share them across documents (that's why I introduced StyleStructContext). However, last I talked to dbaron he was skeptical about this approach (in particular with respect to text zooming, IIRC).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "David, could you have a look at http://searchfox.org/mozilla-central/rev/f80822840bc5f3d2d3cae3ece621ddbce72e7f54/layout/style/StyleStructContext.h#15 (both the comment and API surface) and let us know whether you think this is a feasible approach, or whether we should just bite the bullet and make style structs per-document?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I guess the basic alternative I was imagining would be that consumers (which are document-aware) would post-process the values when they're used. So I guess the question is whether there are transformations that are not commutative with respect to the cascade. Also, the only time that Gecko calls these constructors is for the initial computed values (everything else is copy-on-write modified from those). Does that match Gecko, and is there any reason that would cause problems if we started making the style structs document-dependent? We'd presumably need to throw them away and regenerate them if text zoom changes, but I wonder if there's anything else.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "I guess that's not really feasible, given the conversion from relative units to computed values depend on this too. Once you exit the style system you don't have rem units, for example, you should have already converted them to computed values. And to do so you need the font-size of the root. Worth waiting for David's input though.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "From https://public.etherpad-mozilla.org/p/stylo-taipei : It seems that the initial style structs depend on a few different external values (Content-Language for 'direction', device pixel ratio, ...) so we should just have per-document initial style structs rather than sharing them across all documents.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch part 1. Make StyleStructContext work with a const nsPresContext \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch part 2. Pass through an nsPresContext to the PerDocumentStyleData constructor \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Attached patch part 3. Add a default ComputedValues member to PerDocumentStyleData \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch part 4. Recreate the default computed values for a document as needed \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Attached patch part 5. Store a ComputedValues on SharedStyleContext \u2014 Details \u2014 Splinter Review The servo side of this is pretty much being left to https://github.com/servo/servo/issues/14773",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Attached patch part 6. Stop using initial_values when doing inheritance in Gecko glue code \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Attached patch part 7. Stop using initial_values in general in Gecko glue code \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Attached patch part 8. Pass a SharedStyleContext, not a Stylist, to Legalizer methods \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Attached patch part 9. Pass through useful default styles to cascade() \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Attached patch part 10. Pass through useful default styles to apply_declarations() \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Attached patch part 11. Pass through useful default styles to CascadePropertyFn \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "Attached patch part 13. Make sure Device has a ComputedValues for stylo \u2014 Details \u2014 Splinter Review Again, a cleaner solution is pending media query stuff being sorted out",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Attached patch part 14. Remove ComputedValues::initial_values for stylo \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Attached patch part 15. Rip out the initial() methods on style structs in stylo \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "Attached patch part 16. Remove StyleStructContext \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "Attached patch Interdiff for part 3 to \"fix\" the crashtest asserts. \u2014 Details \u2014 Splinter Review The real fix will be bug 1328319",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Attached patch Interdiff for part 16 to keep avoiding the assert \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "I'm not super-happy with this, but a better solution is best done after we decide how we're doing media queries in stylo.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 24,
                "quote": "I believe this is more or less done in the attached patches, except for the Device bits.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "As far as I can tell this already happens.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "Things seem to run fine that way (or as fine as without these patches, at least). That said, I don't see --disable-e10s in browser/config/mozconfigs/linux64/stylo or browser/config/mozconfigs/linux64/stylo-debug. So not sure where things need removing from.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "I wouldn't worry too much about the `Device` right now because I probably need to rewrite it in Stylo for bug 1325878. So it's probably acceptable to leave this as-is in the meantime.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "Can we compile out ComputedValues::initial_values too?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Are you sure? The existing failure mode without --disable-e10s is that the initial computed values are null, which I always assumed was because we call Servo_Init in nsAppRunner rather than nsLayoutStatics [1]. The reason for this, which is explained above [1], is obsoleted by your patches. So I think we just need another patch to move the calls back to nsLayoutStatics.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "Yeah, I realized that we're currently building both e10s and non-e10s, so we're actually good there.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "lgtm.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "Flagging Manish for a quick look at the FFI glue if he gets the chance. No need to block on it to land.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 33,
                "quote": "Nit: The convention in Servo is to do: FIXME(bz): This seems dubious Same below.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "Yes, I think that would be better.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "Can you file a blocker against stylo-incremental to implement this method correctly?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "I assume this is never null, since we later pass it unchecked to appendstylesheet.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "Please add some comments explaining why we're compiling these out.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "Probably worth filing a bug depending on bug 1290228 and blocking the stylo metabug to make sure that we end up updating these values.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "OK, fixing things turned out to be a big more complicated than a simple backout. Here's an interdiff of the actual changes needed to make part 6 work again.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 40,
                "quote": "Apart from \"both are totally orange\"? The reftest failures seem about the same. For crashtest, I see a ton more assertions in my try push, coming from CounterStyleManager::NotifyRuleChanged called from the mPresContext->FlushCounterStyles() call in PresShell::FlushPendingNotifications. But I'm not sure why this wouldn't get hit without my patches; I would expect this assert to be hit all the time as things stand...",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 41,
                "quote": "nit: whitespace",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "OK, the crashtest bit was because we started calling CounterStyleManager::BuildCounterStyle() from the default nsStyleFont ctor. I'm going to just hack around it to keep not doing that for now for the servo case.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 43,
                "quote": "nsStyleList, of course.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 44,
                "quote": "The real fix will be bug 1328319",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 45,
                "quote": "In any case, I filed bug 1328651 on this;",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 46,
                "quote": "Fixed.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 47,
                "quote": "Filed bug 1328652.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 48,
                "quote": "Bug 1328655 filed.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1096093",
        "issue_id": 1096093,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "this works for me.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Hi Benjamin, there are known problems with LastPass. Can you try with that disabled? If it still persists please try with the other two disabled as well.",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "From bug 1097601 - I have this whenever I'm using session restore which is all the time on my main profile as I've got tab groups. It happens on all sites. Whereas opening in non-e10s is fine. I've also replicated this with not using tab groups, but using the History -> Restore Previous Session option. I'm using MacBook Pro 10.8 with a retina display on the laptop, and a non-retina external display. I noticed something this morning: I happened to be on just the laptop display, and the scrollbars were there. Now I've switched back to my normal setup I've lost them again (it took a couple of restarts though). My normal setup has the non-retina display as the \"master\" showing the app bar and menu bar.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "I have tried it with all addons disabled and e10s on gives me no scrollbars and e10s off acts normal.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "Still no luck reproducing. :(",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": ":tracy, got any cycles to help me figure out what I need to do to see this?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "I've tried toggling various scroll settings in both Nightly and the System prefs, Session restoring, using external or laptop screen. I am not having any success reproducing this either. Something non-obvious is in play.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "allowed today's nightly to update and restart caused scrolls bars to disappear for me this morning.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 9,
                "quote": "I was finally able to reproduce this.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 10,
                "quote": "Maybe it's helpful or not, but if you restore session from about:home this bug does not reproduce.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 11,
                "quote": "I suspect the flurry of remote browsers being restored on a restart is contributing to a race that we're less likely to hit after start-up has completed. I also suspect that if about:home was a tall page and had a scrollbar, we'd hit this again. I will actually try that experiment.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "So I've done a bit of analysis, and here are my findings: Suppose we're starting Firefox and it automatically restores a session where the selected browser has a vertical scrollbar. In single-process Firefox on post-Lion OS X, we don't initially draw the scrollbar, because we assume that we're using overlay scrollbars. We're constantly polling this nsLookAndFeel metric for overlay scrollbars and it's returning \"true\". OS X has noticed that we're asking about the scrollbars, and after it's done an analysis of the peripherals and user preferences, it tells us \"Actually, we're supposed to use permanent scrollbars here\". nsChildView.mm hears that via the NSPreferredScrollerStyleDidChangeNotification that gets handled by ChildView's scrollbarSystemMetricChanged method. This causes nsPresContext to realize that the theme has changed, and it flushes all caches of the look and feel, and recomputes the layout of the page to draw the scrollbars correctly. In the multi-process case, the look-and-feel metric changes, but the child never hears about the scrollbarSystemMetricChanged event, because the content process doesn't have a ChildView. So the nsPresContext never gets ThemeChanged called on it, and we don't re-lay out the page. So that's the problem. I'm evaluating solutions now.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "/r/7307 - Bug 1096093 - [WIP] Cache overlay scrollbar LookAndFeel metric, and invalidate in the content process when parent sends Refresh message. r=?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Add documentation.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "This comment is wrong.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "TODO.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Remove extra newline.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Remove extra newline.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "/r/7307 - Bug 1096093 - Cache overlay scrollbar LookAndFeel metric, and allow parent process to send down cache to content process. r=? /r/7327 - Bug 1096093 - Send ThemeRefresh message from parent down to content process. r=?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "I think this can be static InfallibleTArray<LookAndFeelInt> GetIntCache(); nowadays.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Better make this take a const InfallibleTArray<LookAndFeelInt>& aLookAndFeelIntCache.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "for (auto entry : *lookAndFeelIntCache) { ... }",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "/r/7307 - Bug 1096093 - Add infrastructure for LookAndFeel metric caching, and allowing the parent process to send down cache to content process. r=? /r/7329 - Bug 1096093 - Have Cocoa widget backend cache overlay scrollbar metrics. r=? /r/7327 - Bug 1096093 - Send ThemeRefresh message from parent down to content process. r=?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 24,
                "quote": "This semicolon is unexpected. Does it compile?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "I think this can just be \"return InfallibleTArray<LookAndFeelInt>()\".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "You don't need the lookAndFeelCache intermediate variable here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Please initialize these members in the member initializer list, and not in the constructor body.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "/r/7307 - Bug 1096093 - Add infrastructure for LookAndFeel metric caching, and allowing the parent process to send down cache to content process. r=? /r/7327 - Bug 1096093 - Send ThemeRefresh message from parent down to content process. r=? /r/7329 - Bug 1096093 - Have Cocoa widget backend cache overlay scrollbar metrics. r=mstange.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "so here's a question - on Windows I can go in and set ui.useOverlayScrollbars to true and get overlay behavior. This works with e10s. I'm assuming we can do the same on mac, but I'm wondering if the change takes effect?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "On this particular patch, which you flagged me on, r+.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "Ship It!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "Not sure about the coding style for */LookAndFeel.h, but 2 spaces for indentation and aFoo naming for arguments?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 33,
                "quote": "document->GetShell() may return null, and so may presShell->GetPresContext();",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "widget/WidgetMessageUtils.h new code should follow Mozilla coding style. So, 2 spaces for indentation.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "InfallibleTArray<LookAndFeelInt> GetIntCacheImpl(); huh, I _hate_ implicit ctor+Move(). So very much hides that we aren't doing copying. Oh well, if other people can live with that insanity, I can survive too (but it does make reviewing slower since one need to look at the ctor implementation).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "(I have no idea why you're using InfallibleTArray and not shorter nsTArray)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "Hey jimm, I pushed my last set of patches up to Try, and oranged out because the LookAndFeel stuff was getting initted when the ContentChild was starting up, and without a display (like when running xpcshell tests), that was causing our GTK self-tests to fail. After consulting with karlt, my solution is to have LookAndFeel in the content process query the parent only when nsXPLookAndFeel::Init is called (so only when layout/painting needs LookAndFeel). Here's the interdiff: https://reviewboard.mozilla.org/r/7307/diff/7-8/ Here's the new try push: https://treeherder.mozilla.org/#/jobs?repo=try&revision=4e057bc88610",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 38,
                "quote": "looks good.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "Is there any way we can move this out to XPLookAndFeel so it applies to all platforms?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 40,
                "quote": "It's not officially supported, but the overlay scrollbar setting can be set on other platforms.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 41,
                "quote": "sorry had to back this out for bustage like https://treeherder.mozilla.org/logviewer.html#?job_id=9226985&repo=mozilla-inbound",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 42,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/5f9c7cd773a5 https://hg.mozilla.org/integration/mozilla-inbound/rev/8ed8157d26a2 https://hg.mozilla.org/integration/mozilla-inbound/rev/70c19dd86f63",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 43,
                "quote": "Backout: https://hg.mozilla.org/integration/mozilla-inbound/rev/9b70530c5898 https://hg.mozilla.org/integration/mozilla-inbound/rev/805d4233dc4b https://hg.mozilla.org/integration/mozilla-inbound/rev/d13a8cde5695",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 44,
                "quote": "Looks like I was missing a header file that b2g didn't use. Here's a new try that's looking pretty green: https://treeherder.mozilla.org/#/jobs?repo=try&revision=f87eaa8bf913 I'll wait for these last few to come in and re-land.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 45,
                "quote": "Try looks green - relanding...",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 46,
                "quote": "I'll open up a follow-up to investigate this, and link it to bug 1096093.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 47,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/fc5b0c1a9a86 https://hg.mozilla.org/integration/mozilla-inbound/rev/4cc6d2d9c5dc https://hg.mozilla.org/integration/mozilla-inbound/rev/a5edb5f659d7",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=819493",
        "issue_id": 819493,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Filed legal bug 819495 to ensure that we're covered there.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 2,
                "quote": "This sounds good to me. Agree with the alert overload upon first run experience. This may require a update to the Snippet Service. From the Engagement perspective, serving out custom communication based on user life-cycle is something we've wanted to have the ability to do for a while. Perhaps we look at it that way instead of focusing on having the \"default\" snippet do this job. Those default snippets contain evergreen content designed to show when the snippet service is down. They have generic messaging to fit any user experience. Ideally in this snippet we would want to say \"Welcome to Firefox! Did you know...\"",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "I don't think we want to block this on snippet service improvements, since that complicates the dependency chain significantly. We don't need to use the existing default snippet mechanism for this; we could have a hard-coded \"first run\" snippet separate from the default snippets, that is used only first run.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Laura, could you take a look at that, or do you think it's a-ok like this?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "All the snippet needs is an image that gives an extra \"oompf!\" to the message.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch this patch moves the 'Know Your Rights' notification box to a snippet (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "In which case I'd say this bug now blocks bug 848118 instead!",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 8,
                "quote": "Attached patch Added unit tests and now passing serialized JSON between documents (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Hrm, this image (and the 2x version) doesn't seem to be in the patch. Did you forget to |hg add| it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I actually kind of prefer having it all on one line, much easier to copy/paste and replace.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "aw yeah proper bracing style",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "This string concatenation may not be acceptable for localization and/or RTL. I think we might need to do something like http://hg.mozilla.org/mozilla-central/annotate/1b49fb552e18/browser/base/content/aboutDialog.xul#l71, where we allow localizers to add text before and after the link.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "But I'm not certain about this - ask Axel?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 14,
                "quote": "Seems like it might be simpler to just have this code be something like: let knowYourRightsData = AboutHomeUtils.knowYourRightsData; if (knowYourRightsData) docElt.setAttribute(...) and have AboutHomeUtils return null when nothing needs to be shown (and have the code in aboutHome.js just check for the presence of the attribute, rather than rightsData.show).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Hrm, now it's starting to seem gratuitous :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Hrm, now it's starting to seem gratuitous :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "clearUserPref before setBoolPref is redundant, FWIW.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "You should remove it from EXTRA_JS_MODULES if you're adding it here, otherwise we will copy it over twice unecessarily during build time.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Gavin, thanks for the thorough review! * The background images won't be added until bug 848118 is resolved (see comment 16) * You're right about the l10n issue here, so I changed the locale properties * put back the one-line PNG for OSX * implemented knowYourRights attribute handling on the pages' documentElement as per your suggestion and adjusted the tests accordingly",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "Please avoid making the bracing changes in this patch.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Seems like you shouldn't add the related style yet, then (or the empty #rightsSnippet {} block).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "This could check \"rightsData.start || rightsData.end\" to be localization-agnostic (we don't currently run browser-chrome tests in non-en-US builds, but we might want to someday).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Wouldn't a more accurate description be \"after it has already been shown once (in the previous test)\"?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Hrm, don't think is kosher. IIRC formatStringFromName can do bad things if it's expecting a variable to substitute and doesn't find one in the string. Axel would probably know the details. But in any case it seems like this would be simpler if you added the relevant strings to aboutHome.dtd, similar to how abouthome.defaultSnippet1.v1 works: <!-- LOCALIZATION NOTE (rightsSnippet.message) text in <a> will be linked to about:rights --> <!ENTITY rightsSnippet.message \"&brandShortName; is free and open source software from the non-profit Mozilla Foundation. <a>Know your rights\u2026</a>\"> and then have the about:home code linkify the <a> appropriately. (I think both this link and the default snippet links should actually be branding-specific, i.e. in brand.dtd, but I can file a separate bug about that.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "It's a bit risky that the setting of the \"shown\" pref is now decoupled from the actual showing. This currently relies on the AboutHomeUtils.knowYourRightsData getter only ever being called when about:home is going to be displayed, which seems a bit fragile. It would be nice to avoid that somehow - I suppose you could just move this block of code to the browser.js block where the AboutHomeUtils.knowYourRightsData is currently accessed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "This #define will never be true, because you didn't also move over the block at: http://hg.mozilla.org/mozilla-central/annotate/5dbcbd03d7ba/browser/components/Makefile.in#l23 to browser/modules/Makefile.in. Should test this manually to make sure official/non-official builds work properly.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Gavin: I think I addressed the issues from your review.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "Could you check that for me?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 29,
                "quote": "Hrm, does this work? In HTML its the existence of the \"hidden\" attribute that matters, rather than its value, so I would think this would need to be removeAttribute(\"hidden\")... Oh, I see that you added a #rightsSnippet[hidden=false] rule - just switch this and remove that, I think.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "Might be worth adding a comment that this stuff all needs to happen before setting searchEngineURL, since that's what triggers the display of the snippets.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "nit: these checks are redundant, and the term \"attribute value\" is kind of vague. Since you're checking that the snippet was actually shown anyways, I don't think it's useful to check the AboutHomeUtils getter directly.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "nit: similarly, this doesn't accurately describe what it's checking. The value of AboutHomeUtils.knowYourRightsData doesn't reflect whether a snippet was shown, so adjust the message accordingly.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 33,
                "quote": "This is not actually used anymore so perhaps you shouldn't add it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "You can get rid of the corresponding DEFINES line in browser/components/Makefile.in now, since this is its only use.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "\"will be linked to about:rights\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "Seems like this should just return a boolean.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "nit: copy/paste means these lines are indented too much",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "Worth filing a followup to remove this now (it hasn't been set since forever).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "Attached patch Know Your Rights notification box has moved to be shown as default snippet on first startup (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 40,
                "quote": "Since I want to be annoying today, https://developer.mozilla.org/en-US/docs/Developer_Guide/Coding_Style#JavaScript_objects has braces on a new line for functions :) This is not to say it's important, it's not. Just wanted to point out how it's hard (and pointless) to have a common style that everyone likes. Fwiw, some of us also likes using a space to label anonymous functions, thus why you found \"function ()\" instead of \"function()\". Again, this doesn't matter, we usually just care a single code module is coherent with itself.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 41,
                "quote": "trailing space",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "this will always set to true, no need to cache showRights into a temp var, you may just if (AboutHomeUtils.showKnowYourRights) { docElt.setAttribute(\"showKnowYourRights\", \"true\");",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "why the need for beforeRun instead of using setup?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "the test should cleanup after itself, this test is setting a pref and not clearing it before existing.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "trailing spaces",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 46,
                "quote": "Adjust code as per Marco's comments. Marco: you are right about the style guide. I did not try to intentionally piss you off, please understand that. I didn't realize I used a different formatting in the test file, so I changed it to be consistent throughout. In the test I introduced `beforeRun`, because when I used `setup` instead, the tests I wrote would fail, due to a timing issue. I re-added `tearDown` to clean up the prefs after the test has run. I hope that is to your liking and/ or acceptable.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 47,
                "quote": "This shouldn't be needed, since \"hidden\" in HTML should just work?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 48,
                "quote": "FWIW clearUserPref now never throws (since bug 487059), so the try/catches aren't necessary.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 49,
                "quote": "The default value of this pref differs depending on whether DEBUG is defined, so I think this test may not work consistently. I also just realized that the test profile has browser.EULA.override set (http://hg.mozilla.org/mozilla-central/annotate/3a5929ebc886/build/automation.py.in#l485), which may be messing with these tests in unexpected ways. It's a bit frustrating that there's no easy way to test the thing we actually want to test, which is that the rights snippet shows up on first launch.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 50,
                "quote": "While we're at it, can you rename OFFICIAL_BUILD to MOZILLA_OFFICIAL to match the thing it's actually depends on? Mapping MOZILLA_OFFICIAL to a slightly differently named define is just confusing.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 51,
                "quote": "and fwiw, you don't need a teardown(), just do whatever you need at the end of run()?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 52,
                "quote": "ah, rather the problem is that the attribute is set on the document element before setup(), so changing the prefs in setup is not enough, they must be changed before the tab is loaded, though setup may probably directly change the attribute.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 53,
                "quote": "added proposed changes of Gavin and Marco.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 54,
                "quote": "Attached patch Know Your Rights notification box has moved to be shown as default snippet on first startup (obsolete) \u2014 Details \u2014 Splinter Review updated commit message, carrying over r+",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 55,
                "quote": "You seem to have forgotten to remove this, per comment 25 and comment 31.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 56,
                "quote": "unbitrotted, carrying over r+",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 57,
                "quote": "Attached patch Know Your Rights notification box has moved to be shown as default snippet on first startup \u2014 Details \u2014 Splinter Review updated commit message. carrying over r+=gavin",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 58,
                "quote": "Backed out in https://hg.mozilla.org/integration/mozilla-inbound/rev/278ea1d0e072 - I don't really know what that buildstep is doing, apparently some sort of test for whether we're breaking l10n repacks, but if you search for \"mozpack.errors.AccumulatedErrors\" in https://tbpl.mozilla.org/php/getParsedLog.php?id=21625292&tree=Mozilla-Inbound, you'll see the thing that failed in a couple of Windows opt builds. I look forward to hearing the explanation you find out, about what on earth it is, and whether the way it only failed in some builds means that it has broken dependencies, or that whenever you remove a dtd/properties file, you now have to clobber, or have to clobber Windows, or... dunno.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 59,
                "quote": "e:\\builds\\moz2_slave\\m-in-w32-000000000000000000000\\build\\browser\\build.mk:55:0: command 'C:/mozilla-build/python27/python.exe e:/builds/moz2_slave/m-in-w32-000000000000000000000/build/build/pymake/pymake/../make.py -C browser/locales l10n-check' failed, return code 2 Error: Missing file: ../../dist/xpi-stage/locale-x-test\\chrome/x-test/locale/x-test/global/aboutRights.properties The patch removes aboutRights.properties. philor suggests a clobber might solve it, but I'd like to understand why that would be needed. Is the \"$(RM) -rf x-test\" in \"make l10n-check\" somehow failing (without showing an error in the log...)? Note also this seems to only happen on some slaves/builds, which suggests some build config/harness issue.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 60,
                "quote": "No idea, I can't really read logs these days. From glancing at it, it seems that the installer repacks OK, but the zip doesn't. Maybe glandium has an idea.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 61,
                "quote": "I think this is what is happening: - on incremental builds, we re-use dist/bin, which contains aboutRights.properties from a previous build. - dist/bin is packaged in dist/firefox and then as a package, which thus contains aboutRights.properties - the package is unpacked for l10n-check - then a new directory is created for the x-test locale, and filled according to the jar manifests, thus not copying aboutRights.properties. - the l10n-repack code wants all chrome locale files from the original locale (en-US, coming from the unpacked package) to be found in the new locale (x-test, filled above), and fails because x-test doesn't have aboutRights.properties.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 62,
                "quote": "Maybe we should remove dist/bin when starting an incremental build as we currently do for sdk, include, etc. That would avoid a clobber in such cases.",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 63,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/b50153f9e011",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 64,
                "quote": "Re-landed on top of bug 860371: https://hg.mozilla.org/integration/mozilla-inbound/rev/c950d2ea4c5b",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1029919",
        "issue_id": 1029919,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Need a regression range.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Doesn't seem to be reproducible on Mac.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "I can reproduce the problem in Aurora32.0a2 and Nightly33.0a1 WindowsXP SP3 default visual style(i.e. Luna). However, I cannnot reproduce in Beta31.0b4. Regression window(m-i) Good: https://hg.mozilla.org/integration/mozilla-inbound/rev/bb8fc1380b00 Mozilla/5.0 (Windows NT 5.1; rv:32.0) Gecko/20100101 Firefox/32.0 ID:20140519202628 Bad: https://hg.mozilla.org/integration/mozilla-inbound/rev/46d9ffb97fe3 Mozilla/5.0 (Windows NT 5.1; rv:32.0) Gecko/20100101 Firefox/32.0 ID:20140519224628 Pushlog: http://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=bb8fc1380b00&tochange=46d9ffb97fe3 Triggered by: 46d9ffb97fe3 Bas Schouten \u2014 Bug 899785: Switch on OMTC and async video on windows. r=BenWa Setting layers.offmainthreadcomposition.enabled = false fixes the problem",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Setting layers.offmainthreadcomposition.enabled = false fixes the problem",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "I can reproduce on Windows8.1update1, Windows7 if OMTC on and HWA off. Graphics Adapter Description ATI Radeon HD 4300/4500 Series Adapter Drivers aticfx64 aticfx64 aticfx32 aticfx32 atiumd64 atidxx64 atiumdag atidxx32 atiumdva atiumd6a atitmm64 Adapter RAM 512 ClearType Parameters Gamma: 2200 Pixel Structure: R ClearType Level: 50 Enhanced Contrast: 200 Device ID 0x954f DirectWrite Enabled false (6.2.9200.16492) Driver Date 4-29-2013 Driver Version 8.970.100.1100 GPU #2 Active false GPU Accelerated Windows 0/1 Basic (OMTC) Vendor ID 0x1002 WebGL Renderer Google Inc. -- ANGLE (ATI Radeon HD 4300/4500 Series Direct3D9Ex vs_3_0 ps_3_0) windowLayerManagerRemote true AzureCanvasBackend skia AzureContentBackend cairo AzureFallbackCanvasBackend cairo AzureSkiaAccelerated 0",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "Bas, can you take a look please?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "So after a long investigation, I've found some interesting information. This appears to be a bug in cairo clipping, it appears that the clip at nsCSSRendering.cpp:1526 fails to be applied properly if there's already a clip present for the small rectangle surrounding the button (which would be disjoint with this clip) (i.e. if I remove that clip the button always gets a green background, if I leave it in it only has a green background when doing a partial invalidation of the button).",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "This patch fixes the bug, providing evidence of the rootcause suggested.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "So as far as my investigation has been able to show this bug is indirectly the results of the extents on a clip path being incorrectly set. At cairo-clip.c:276 we set the extents on the clip_path struct, but those extents no longer contain the real extents but rather the intersection of these clips.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "This patch fixes that, however it does have the downside of extents of the top level clip no longer being the intersection of all the clips on the stack, I think that's okay and will only make a difference in some rare perf cases though.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "I'm not sure this is correct. I don't see why the extents that are set need to be extents of the path and can't be the extents of the intersection.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "I believe this is the correct fix this time, I'd like to hear what you think :-).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Mozilla/5.0 (Windows NT 5.1; rv:33.0) Gecko/20100101 Firefox/33.0 Verified fixed in today's Nightly",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=966240",
        "issue_id": 966240,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It seems that neither Chrome, Safari or Edge support this feature.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Remove support for <meta http-equiv=\"msthemecompatible\" content=\"no\"> \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Do we still need nsIPresShell::DisableThemeSupport? Apparently this is the only caller [1] and nsIPresShell is not scriptable. We could also remove nsGkAtoms::msthemecompatible.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Please also remove nsIPresShell::mIsThemeSupportDisabled.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Good point, I removed the PresShell bits too.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "sounds sensible enough, beta55+ Should be in 55.0b3",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 7,
                "quote": "Already verified in bug 1373417.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=947523",
        "issue_id": 947523,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This issue does not occur on Leo v 1.1.0 COM RIL Environmental Variables Device: Leo v 1.1.0 COM RIL Build ID: 20131024041202 Gecko: http://hg.mozilla.org/releases/mozilla-b2g18/rev/e4cb5a852e3d Gaia: 39b0203fa9809052c8c4d4332fef03bbaf0426fc Platform Version: 18.1 RIL Version: 01.01.00.019.264 The browser crash does not occur when zooming in on the page.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "This issue occurs on the Buri v 1.2.0 COM RIL Environmental Variables Device: Buri v 1.2.0 COM RIL Build ID: 20131204004003 Gecko: http://hg.mozilla.org/releases/mozilla-b2g26_v1_2/rev/758f3fb32dda Gaia: 8d762f3376318fd6be390432db750ae4904c9ab6 Platform Version: 26.0 RIL Version: 01.02.00.019.102 The browser or device will crash when zooming in on the MoPad webpage.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Uh oh. That's an OS restart crash, which is really bad.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "During the few hours of reproing this issue I was only able to get the OS crash three times and there was no dump in the Crash Reports folder on the phone. I talked to Kevin and he said that it could be an OOM issue so I snagged a dmesg. Hopefully that should help you guys out. I was able to get the OS crash on today's 1.2 and 1.3, but the attached dmesg is from the build below. Environmental Variables: Device: Buri 1.3 mozRIL BuildID: 20131209053402 Gaia: 1d45d1dc3201059d5c8f2efdeb92c04576d8e161 Gecko: 9f12a9fab080 Version: 28.0a1 Firmware Version: 20131115",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "Does this reproduce on a 1.1 Buri device?",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "This does not repro on a 1.1 Buri. The same functionality is seen in Leo 1.1 as it simply doesn't let you zoom in far enough and keeps rubber-banding back to to a set zoom if you try to keep pinching to zoom in. Environmental Variables: Device: Buri 1.1 mozRIL BuildID: 20131209041202 Gaia: 6ff3a607f873320d00cb036fa76117f6fadd010f Gecko: 05117f42088f Version: 18.0 Firmware Version: 20131115",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "This issue looks to have started reproducing on the 11/08 1.2 Buri build. On builds before 11/08, the tab would need to be reloaded every so often, but B2G would remain stable. - Works - Environmental Variables: Device: Buri v1.2 MOZ RIL BuildID: 20131107004003 Gaia: 590eb598aacf1e2136b2b6aca5c3124557a365ca Gecko: 26f1e160e696 Version: 26.0 RIL Version: 01.02.00.019.102 Firmware Version: 20131115 - Broken - Environmental Variables: Device: Buri v1.2 MOZ RIL BuildID: 20131108004004 Gaia: 4cf40fb30c7b8380ea83ed0d4efe043b8b81737f Gecko: a886c641a306 Version: 26.0 Firmware Version: 20131115",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "The regression here is likely on the gecko side, as this involves killing the parent process. A suspected patch for causing this regression is bug 927633 because is involving IPC.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Can we get a regression range on 1.3 as well? That will help isolate with bug caused this.",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 10,
                "quote": "Mason - Any ideas if bug 927633 caused this?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 11,
                "quote": "blocking+ - we should never cause the full phone to restart. Also marking security sensitive because a web page should be able to cause the full phone to restart, which could be exploited by a web developer to force phone restarts.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Something similar to this issue looks to have started on the first working 1.3 build from 9/19. The OS will crash and display the crash report page on each build up to 9/23. From 9/24 and on, there is no crash report screen displayed and appears to instead be an OOM issue... exactly as specified in comment 5 and comment 9. There are builds between 9/24 and 12/11 where it is really difficult to get a repro and instead the Browser tab will need to be reloaded since the webpage becomes unresponsive many times. I am making the window be between 9/23 and 9/24 since that is when it looks to have become and OOM issue which is what this bug is about. If the crash is considered relevant to this bug, then it occurred on the first 1.3 build from 9/19. - \"Works\" (OS crashes) - Environmental Variables: Device: Buri v1.3 MOZ RIL BuildID: 20130923040214 Gaia: 3408cc3f6b190c8cd31832fbb8cd2ae571041f29 Gecko: f97307cb4c95 Version: 27.0a1 Firmware Version: 20131115 - Broken (OS restarts with an OOM) - Environmental Variables: Device: Buri v1.3 MOZ RIL BuildID: 20130924040201 Gaia: a22ba4a3a9efd99f94adf9ece8a2b391d4df295b Gecko: 1fda74e33e06 Version: 27.0a1 Firmware Version: 20131115",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 13,
                "quote": "I just tried the broken gaia and gecko revisions from comment 15. I was able to reproduce the crash with and without bug 927633. The patch also reduced memory usage by 1.5 mb per process, so if we're getting an OOM, it should just happen sooner without bug 927633.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 14,
                "quote": "Andrew - Can you find someone to look into this full phone OOM?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "I tried to reproduce this issue after setting pref(\"gfx.canvas.azure.accelerated\", false); and I could not reproduce this issue on the latest Buri 1.3 Build ID: 20131217004001 I also checked without setting the preference on the latest Buri 1.3 and could easily reproduce the bug. Gaia dca0a3dcf062ce3e422a9c56d141c14543c816fb SourceStamp 1f7db4cc788e BuildID 20131217004001 Version 28.0a2",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 16,
                "quote": "Guess I wasn't right - the OOM is being caused by Skia GL. Still puzzled why the OOM is hitting the parent process rather than the child process.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 17,
                "quote": "There's only two gfx bugs in the regression range here: * bug 844819 * bug 934886 Which one caused this regression? Maybe bug 934886? Peter - What do you think?",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 18,
                "quote": "If this is \"just\" OOM, then anything that causes us to use more memory would cause the regression. The memory used is no different than that used by non-graphics code.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "I've reproduced the browser crash. I zoomed in a fair amount and ran b2g-info: | megabytes | NAME PID NICE USS PSS RSS VSIZE OOM_ADJ USER b2g 1531 0 49.5 63.2 77.0 208.1 0 root Browser 1975 1 23.2 36.9 50.6 104.1 2 app_1975 System memory info: Total 179.7 MB Used - cache 94.6 MB B2G procs (PSS) 100.1 MB Non-B2G procs -5.4 MB Free + cache 85.1 MB Free 52.4 MB Cache 32.6 MB I then zoomed just a little bit more and the browser tab was killed. I got the \"oops, this is embarrassing\" dialog. The logcat indicated that \"memory pressure\" was over, so that suggests it was an OOM. I find it interesting that just a tiny bit of zooming could cause us to consume over 50MB of free memory, though. I will continue investigating tomorrow.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 20,
                "quote": "Adding instrumentation I can see that zooming results in extremely large gralloc buffers getting created. For example, with a zoom of 3.75 in APZC I see a gralloc buffer request for 2238x13249. This asks the system for ~110MB of mlocked memory which ends up killing b2g altogether. Sometimes we get moderately smaller requests for gralloc buffers around ~30MB which only end up killing the browser tab. I'm trying to trace where this size is getting calculated. Are we zooming the entire layer and trying to alloc a buffer for the entire thing? Even if that is the case it seems the zoom is being over-accumulated over time or something.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Let's get the explanation - going a bit trigger happy on the ni...",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 22,
                "quote": "So part of the problem here is that the composition bounds on the child APZC is getting scaled up as we zoom. This doesn't happen for the parent because the parent's composition bounds is clamped to the screen bounds [1]. (We have plans to remove that behaviour but it doesn't affect this bug on 1.2). The next contributing factor is that the displayport calculation at [2] doesn't account for this increase in composition bounds. For the parent APZC the composition bounds don't change, so the division by the zoom at line [2] has the desired effect of shrinking the displayport as the zoom increases. For the child APZC the division merely cancels out the increase in composition bounds, and so we end up with a constant-sized displayport (in CSS pixels) regardless of zoom. So the straightforward fix here would be to just divide again by the zoom. However, we can't do that because in general the child APZC doesn't request content repaints (and hence doesn't recalculate its displayport) while the parent is getting zoomed. So if the child last set a displayport of 500x1000 CSS pixels, and then the parent zooms to 5x what it was before, we would want the child to shrink its displayport down to 100x200 CSS pixels but it never gets a chance. The parent sets the resolution without the child knowing about it, and at that point layout tries to render the child's 500x1000 displayport at a 5x resolution which causes the OOM. For a fix to work we would either need the parent APZC to notify all other APZCs in its subtree that it's about to change the zoom (and then have the children recalculate their displayport) or, in TabChild::UpdateRootFrame, find all the displayports inside a presShell and shrink them by the right factor. I'll try to see if either of these approaches are viable.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "So I tried propagating the zoom info to child APZCs as I described above but ran into a threading problem. Specifically, I need to propagate the new zoom to child APZCs in ScheduleContentRepaint *before* posting the message to the GeckoContentController. However propagating the zoom to child APZCs requires holding the tree lock, and that results in a deadlock scenario because we're already holding the APZC lock there. In addition this solution felt pretty hacky and brittle so I'm working on a different solution now which modifies how the displayport is stored. In nsDOMWindowUtils::SetDisplayPortForElement I'm going to multiply in the cumulative resolution and in nsLayoutUtils::GetDisplayPort I'm going to divide out the cumulative resolution. This way when the resolution of intermediate presshells change, the retrieved displayport is automatically scaled accordingly. I *think* this should work because the displayport is stored relative to the scroll offset and so scaling it won't move it around improperly, but I'm building the patch now to test it and see how it fares.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 24,
                "quote": "Since I don't have a working 1.2 build could you guys apply this patch and see if it fixes the problem without introducing any new regressions?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 25,
                "quote": "Since I don't have a working 1.2 build could you guys apply this patch and see if it fixes the problem without introducing any new regressions? Possible regressions would include the painted content (the displayport) not being positioned correctly, specially when zoomed in or out. I did some light testing of this patch on master and I couldn't repro the OOM although there does still appear to be a fair amount of memory pressure and I think the HWC is dropping layers or something.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 26,
                "quote": "I did some light testing of this patch on master and I couldn't repro the OOM although there does still appear to be a fair amount of memory pressure and I think the HWC is dropping layers or something.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 27,
                "quote": "While attempting to build the 1.2 branch with the attached patch applied, I encountered the following compiler errors: /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp: In function 'void DestroyGfxRect(void*, nsIAtom*, void*, void*)': /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: reference to 'gfx' is ambiguous /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/ipc/chromium/src/chrome/common/transport_dib.h:20: error: candidates are: namespace gfx { } ../../dist/include/mozilla/gfx/Types.h:15: error: namespace mozilla::gfx { } /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: 'rect' was not declared in this scope /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: reference to 'gfx' is ambiguous /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/ipc/chromium/src/chrome/common/transport_dib.h:20: error: candidates are: namespace gfx { } ../../dist/include/mozilla/gfx/Types.h:15: error: namespace mozilla::gfx { } /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected type-specifier before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected '>' before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected '(' before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected primary-expression before '>' token /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected ')' before ';' token /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:309: error: type '<type error>' argument given to 'delete', expected pointer /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp: In member function 'virtual nsresult nsDOMWindowUtils::SetDisplayPortForElement(float, float, float, float, nsIDOMElement*)': /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:391: error: reference to 'gfx' is ambiguous /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/ipc/chromium/src/chrome/common/transport_dib.h:20: error: candidates are: namespace gfx { } ../../dist/include/mozilla/gfx/Types.h:15: error: namespace mozilla::gfx { } /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:391: error: expected type-specifier before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:391: error: expected ')' before 'gfx'",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 28,
                "quote": "While attempting to build the 1.2 branch with the attached patch applied, I encountered the following compiler errors: /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp: In function 'void DestroyGfxRect(void*, nsIAtom*, void*, void*)': /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: reference to 'gfx' is ambiguous /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/ipc/chromium/src/chrome/common/transport_dib.h:20: error: candidates are: namespace gfx { } ../../dist/include/mozilla/gfx/Types.h:15: error: namespace mozilla::gfx { } /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: 'rect' was not declared in this scope /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: reference to 'gfx' is ambiguous /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/ipc/chromium/src/chrome/common/transport_dib.h:20: error: candidates are: namespace gfx { } ../../dist/include/mozilla/gfx/Types.h:15: error: namespace mozilla::gfx { } /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected type-specifier before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected '>' before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected '(' before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected primary-expression before '>' token /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:308: error: expected ')' before ';' token /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:309: error: type '<type error>' argument given to 'delete', expected pointer /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp: In member function 'virtual nsresult nsDOMWindowUtils::SetDisplayPortForElement(float, float, float, float, nsIDOMElement*)': /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:391: error: reference to 'gfx' is ambiguous /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/ipc/chromium/src/chrome/common/transport_dib.h:20: error: candidates are: namespace gfx { } ../../dist/include/mozilla/gfx/Types.h:15: error: namespace mozilla::gfx { } /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:391: error: expected type-specifier before 'gfx' /home/botond/dev/mozilla/b2g-hamachi-1.2/gecko/dom/base/nsDOMWindowUtils.cpp:391: error: expected ')' before 'gfx' Attached is an updated patch that fixes these errors.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": ":tn, what do you think of this change? In a nutshell it changes the displayport stored in layout to be in CSS pixels multiplied by the resolution, rather than just CSS pixels. That way when we increase the resolution on an ancestor layer, the descendants texture sizes automatically shrink and we don't OOM.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": ":tn, what do you think of this change?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 31,
                "quote": "My first thought is that we will now have to update every display port under a presshell (and it's child documents) anytime it's resolution changes. Is this feasible/desirable?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "I tested this on my 1.2 hamachi device, and I cannot reproduce the crash with it. I also didn't notice any regressions.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 33,
                "quote": "With this patch I still see Browser crash while zooming the gaia meeting etherpad: https://etherpad.mozilla.org/gaia-meeting-notes I would like to test a bit more with instrumentation to see if its the same OOM issue, but probably won't be able to until tomorrow morning.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 34,
                "quote": "On this page, I see the crash as well with the patch (I saw a phone crash, not a browser crash), though it seemed it required zooming in further to get the crash with the patch than without.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 35,
                "quote": "Talked to kats on irc about this. If we don't change AZPC code too then it will just end up setting the same display port after zooming again, so it won't fix the main problem. We need to at least pair this with an AZPC change. So clearing feedback flag for now.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 36,
                "quote": "Talked to kats on irc about this. If we don't change AZPC code too then it will just end up setting the same display port after zooming again, so it won't fix the main problem. We need to at least pair this with an AZPC change. So clearing feedback flag for now.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "Updated patch to shrink the displayport for subframes in APZC code.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 38,
                "quote": "I've been discussing this issue with :tn and :bkelly and thinking about it, and we might need to take a step back here with the approach taken. The fundamental problem is that when async subframe scrolling is enabled, we need more memory to render content. This is expected behaviour, but it was always unclear just how much more memory we would need, how it would be bounded, and whether we would often run into OOM situations. For the most part we went with a \"let's do it and see\" approach. Turns out that with our current implementation (in 1.2+) the memory usage is unbounded, and can easily run into OOM situations. A simple conceptual example is a page that looks something like this: <body> <iframe style=\"height: 10000px\" src=\"reallylongpage.html\"></iframe> </body> The iframe is 10,000 pixels tall, and we end up requesting a giant displayport (some multiple of 10000px) for this, because we could scroll either the outer page or the iframe, and need to have enough pre-rendered content to paint all of that. This, of course, will trigger an OOM. Even if the patches I uploaded to this bug worked perfectly we would still probably OOM on this page. Going forward I think we have to use the visible region of the iframe (i.e. clipped by parent frames and the screen) rather than the full composition bounds as the base for the displayport. However I think that doing this is too risky for 1.2.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "For 1.2 I see four main options: 1) Disable subframe apzc. This eliminates the memory requirement and also reduces responsiveness. I suspect this is off the table because of commitments we made to partners. 2) Apply some tweaks to make the OOMs less frequent. This is what I've been trying to do with the above patches, but it's hard to reduce the OOM threshold enough to stop OOMing on this etherpad page because the iframe is huge. It also doesn't guarantee OOMs will not happen. 3) Try some other method to clamp the memory usage, such as putting a hard limit on texture sizes. (I don't know if this can be easily implemented, and it would almost certainly result in scenarios where parts of subframes remain blank.) Another option is to just kill the entire tab if the requested displayport is too big. That limits the crash to a browser tab rather than a phone reboot. 4) Do nothing for 1.2; leave this bug unfixed and ship subframe APZC as-is. Focus efforts on getting a proper fix in for 1.3+",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 40,
                "quote": "[3] sounds okay - the blocking factor is the fact that we're OOMing the phone, rather than the browser tab. If we OOM the browser tab here instead, then that's okay enough to remove the blocking factor on the bug.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 41,
                "quote": "I think clamping would be preferable to predictably killing the browser tab. While parts of the screen may not be visible, at least they can zoom back out to a more reasonable level without losing state. The user doesn't get any feedback or options to proceed if the tab dies. Would it be possible to make the existing scale threshold dynamic based on the iframe size? http://mxr.mozilla.org/mozilla-central/source/gfx/layers/ipc/AsyncPanZoomController.cpp#189 So for very large iframes, perhaps zoom is capped at 2.0 or even 1.0?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "Attached patch 1/4 - Add a GetCumulativeResolution function (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 43,
                "quote": "We still need this patch in order to not blow up in the \"transient\" state, where the parent has increased its resolution but the child has not yet requested a new displayport. If we paint in this state then we will apply the old (small) displayport with the new (high) resolution which could OOM. So this patch prevents that.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 44,
                "quote": "We could probably do without this patch but it should help reduce the occurrence of the tab crashes. This contracts the subframe displayport multipliers if those subframes are getting rendered at a resolution > 1.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 45,
                "quote": "If the texture size exceeds 4k then we can't render it anyway so that seems like a sensible limit to hard-code to, and crash if we exceed. We actually deal ok with a page with many small iframes; it's only when the iframe gets big on one or both axes that the total texture area blows up a lot.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 46,
                "quote": "Please let me know if you still see the OOM with this. I didn't see it on my master build for Gaia; I will try to borrow a hamachi and test there as well.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 47,
                "quote": "IID bump on presshell please.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 48,
                "quote": "IID bump on presshell please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 49,
                "quote": "What's the plan for this longer term? Make this be stored in layer pixels? Only land this on 1.2? We should have a comment explaining why we do this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 50,
                "quote": "Is this patch meant for trunk too? On trunk it's not necessarily the case that the root frame's GetParentResolution() returns 1.0, at least it won't be after bug 951936 and bug 935219 land, because then the resolution will be on the non-scrollable root layer which will be the parent of the rootmost scrollable layer. Perhaps we can condition on IsRootForLayersId() instead (or mIsRoot, although see bug 957221)?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 51,
                "quote": "This feels fairly specific to b2g; some environments (metro when it goes with remote tabs) might not be bound by such a limit.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 52,
                "quote": "kats tell me this is for 1.2 only. So just add a comment about thus and r+.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 53,
                "quote": "Should we be multiplying per aMetrics.mDevPixelsPerCSSPixel as well here?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 54,
                "quote": "Would it be possible to log something indicating why the crash occurred? I could see this saving us some investigation time on future bug reports.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 55,
                "quote": "I also was unable to get b2g to crash with the patch.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 56,
                "quote": "I also was unable to get b2g to crash with the patch. The tab reliably got killed. I did, however, see some content fail to draw with this patch. See time 45s to 50s in this movie: https://www.dropbox.com/s/vguya4xf6rgeqwh/20140107_apzc_etherpad_v1_2_patch.mov It appears to occur when you zoom in while simultaneously dragging up a bit causing a scroll. I could not reproduce without the patch. On IRC kats indicated this might be explainable given that the patch shrinks the displayport. Is this regression fixable? If not, is this regression serious enough to hold back the patch? Jason, what do you think? I will try to see if I can reproduce it on any other websites tomorrow. Maybe its isolated to sites with very large iframes like this etherpad.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 57,
                "quote": "I think it would be better to OOM the tab more often and not risk the painting regression seen in the video mainly because I'm concerned about the fallout risk that this has other sites. The blocking factor on the bug is to ensure that we don't OOM the phone. If we end up OOMing the tab a lot, but not the phone, then that's still okay.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 58,
                "quote": "I was able to reproduce the painting problem",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 59,
                "quote": "It's caused by part 2; as we zoom in the outer page the displayport (in CSS pixels) of the inner frame will shrink (by design). It remains the same size in layer pixels, but the composition bounds of the inner frame will expand in layer pixels. This results in the displayport shrinking to be smaller than the composition bounds until the APZC for the inner frame triggers a repaint for it.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 60,
                "quote": "I seem to be able to get the painting defect fairly easily on this iframe example site",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 61,
                "quote": "I believe bug 957668 is the follow-up to address the memory issues in v1.3.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 62,
                "quote": "Updated versions of patches with comments addressed and reviewer info included; ready to land.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 63,
                "quote": "Attached patch 2/4 - Change the displayport storage units v2 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 64,
                "quote": "Attached patch 3/4 - Shrink the displayport multiplier at high zooms v2 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 65,
                "quote": "Attached patch 4/4 - Crash the tab if the texture size is going to exceed the max GL texture size v2 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 66,
                "quote": "Yup, that sounds fine. Let's land this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 67,
                "quote": "Kats told me that 1.3+ will be addressed by bug 957668, so resolving.",
                "code": "ISSUE_IMPACT"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=927544",
        "issue_id": 927544,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The stub call made when Ion deoptimizes a JSOP_CALLPROP does not invoke unknown method hooks on the object.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "+ JS_ASSERT(op = JSOP_CALLPROP);",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I ended up folding this into the patch for bug 925962, rev 81b505e9a435. That rev inadvertently fixed the above bug, by using a different mechanism to distinguish calls vs. gets (weirdly, CallGetProperty isn't associated with a resume point when used to fetch the |prototype| property for callee functions).",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=866474",
        "issue_id": 866474,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The only caller of this method is now using LocaleService which canonicalizes the locale code.",
                "code": "PROBLEM_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=851828",
        "issue_id": 851828,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch (v1) (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Why did you drop <uint32_t>? The return type is still that.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Please rebase on top of bug 851748",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Not sure when bug 851748 will land...",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch rebased \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Backout for Mochitest failures",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 7,
                "quote": "This ended up being a red-herring. Re-landed.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=838565",
        "issue_id": 838565,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch cc taf and nsFind \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "2 extra spaces before NS_INTERFACE_MAP_END",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Two extra spaces before these macros",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Could you split this to two lines. Atm it is a bit too long",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "2 extra spaces before NS_INTERFACE_MAP_END",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "2 extra spaces before these macros",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This change is for some other bug.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=833964",
        "issue_id": 833964,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I only see these... which seem different: https://crash-stats.mozilla.com/report/list?product=B2G&query_search=signature&query_type=contains&query=layers%3A%3AAsyncPanZoomController%3A%3AContentReceivedTouch&reason_type=contains&date=02%2F05%2F2013%2019%3A59%3A13&range_value=1&range_unit=weeks&hang_type=any&process_type=any&do_query=1&signature=mozilla%3A%3Alayers%3A%3AAsyncPanZoomController%3A%3AContentReceivedTouch https://crash-stats.mozilla.com/report/index/1c7e05a0-dd5e-4934-af89-f27cf2130131",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Just guessing: Guessing it had to do with browser, the parent tab, a frame and zooming? Since zooming doesn't change when following a link in the same tab, maybe it crashed during the opening a web page that had an iframe? Going to toy with that idea.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "There have been no crashes since 18.0/20130131.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Do we still need qawanted on this? Looks like the crash isn't reproducible at this point.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "I am not sure it's fixed. Indeed, crashes occurred in B2G 18.0/20130222.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "It still occurs: bp-8cf2155f-801d-4c88-9612-f13af2130319.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "Build ID: 20130404070202 This crash is occured to leo device. We got a same dump file to Comment 10. This issue reproduced when the complex web page is opening accroding to click link in bookmarked twiter on homescreen.(1 time) It concerned us that this issue could be reproduce many times to be used the FFOS by many people.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "If the crash report https://crash-stats.mozilla.com/report/index/8cf2155f-801d-4c88-9612-f13af2130319 https://crash-stats.mozilla.com/report/index/1c7e05a0-dd5e-4934-af89-f27cf2130131 corresponds to https://hg.mozilla.org/releases/mozilla-b2g18/annotate/051fa7fa5ded/gfx/layers/ipc/AsyncPanZoomController.cpp https://hg.mozilla.org/releases/mozilla-b2g18/annotate/d5d6ef77f2d9/gfx/layers/ipc/AsyncPanZoomController.cpp respectively, they both crash at: mTouchListenerTimeoutTask->Cancel(); Are we hitting a race-condition problem? Since both Cancel() and ~RunnableMethod() in class RunnableMethod call ReleaseCallee(), which is obviously not thread safe: void ReleaseCallee() { if (obj_) { RunnableMethodTraits<T>::ReleaseCallee(obj_); obj_ = NULL; } }",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "If I understand correctly, all accesses to mTouchListenerTimeoutTask happen on the controller/UI thread. So there shouldn't be a threading-related race condition here. I don't see how we'd crash here though. mTouchListenerTimeoutTask should always be null or a valid pointer...",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "So AFAICT the actual CancelableTask object pointed to mTouchListenerTimeoutTask is created in NewRunnableMethod (either at line 235 or line 267) and is deleted by the message loop code, I think around [1]. This means that once the task finished executing (i.e. the TimeoutTouchListeners method finishes), the pointer mTouchListenerTimeoutTask is pointing to garbage if it hasn't been nulled out explicitly. This could happen if, for example, the early-exit condition at the top of ContentReceivedTouch gets hit when TimeoutTouchListeners gets called. I don't know if there that early-exit condition is guaranteed to never hit when being called through TimeoutTouchListeners but I don't think it is. So, in a nutshell: - mTouchListenerTimeoutTask is assigned and TimeoutTouchListeners is queued as a delayed task - TimeoutTouchListeners runs - The call to ContentReceivedTouch from TimeoutTouchListeners does an early exit at the top - The message loop deletes the object pointed to by mTouchListenerTimeoutTask since it's done - Some time later (could be much later, since mTouchListenerTimeoutTask is never re-assigned when non-null, except in ContentReceivedTouch), content calls into ContentReceivedTouch - This time the early exit doesn't get hit - Since mTouchListenerTimeoutTask is non-null, calling ->Cancel() on it goes boom. In terms of fixing it, I see two options: one is to move the mTouchListenerTimeoutTask cancellation/nulling to the top of the method, before the early exit. I don't know if this will have other side-effects because I don't know what that check is doing exactly. The second option, much safer, is to just set mTouchListenerTimeoutTask to null in TimeoutTouchListeners(). We know the only place that function gets called is from the task, and once it's done, the task will be destroyed, so we might as well null out the pointer to it. [1] http://mxr.mozilla.org/mozilla-central/source/ipc/chromium/src/base/message_loop.cc#416",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "Attached patch Null out potentially dangling pointer (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Not sure who should review this exactly. See above comment for an explanation of what I think is happening.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "Makes perfect sense to me. I don't even really think this needs a comment explaining it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Updated patch to remove comment. I also felt it was kind of unnecessary.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Hit this on 1.0.1 branch: https://crash-stats.mozilla.com/report/index/18fe8cd7-d78e-4e4c-b2d6-bd3ff2130516 Nominating for consideration. The issue was hit while aggressively panning and zooming in testing scenarious related to Bug 847592.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1047560",
        "issue_id": 1047560,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Enable pinning on dropbox ( \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Great! r=me",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Unfortunately I had to revert this for merge conflicts with the updated update that had already landed on mozilla-central (https://hg.mozilla.org/mozilla-central/rev/192cb23bb176). This can reland after a rebase (was one of several conflicts during this merge; didn't want to have to pick them all back apart again if any of them were resolved incorrectly): https://hg.mozilla.org/integration/mozilla-inbound/rev/4bdadff88a9b",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 4,
                "quote": "Thanks, Ed. https://hg.mozilla.org/integration/mozilla-inbound/rev/4e9cd601aa23",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=790547",
        "issue_id": 790547,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch WIP - Part 1: Add sendLocationStatus in IDL (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch WIP - Part 2: Add SendLocationStatus in IccManager (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch WIP - Part 3: Add sendLocationStatus in RIL (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Add RILContentHelper and update bugs in writing locationStatus",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "renamed sendLocationStatus to sendEventDownload",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Renamed accordingly, also added impl in RadioInterfaceLayer.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "updated to latest IDL change.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Fixed bugs in writing octets, and revised writing MCC/MNC according to TS 24.008",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "supply locationInformation only when service state is normal.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Moved writing location info of TLV into a helper function.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Renamed writeLocationInfo to writeLocationInfoTlv.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Renamed accordingly.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "indent!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Fixed indent.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Hi, smaug I add another interface called 'sendStkEventDownload' in nsIDOMIccManager in part 1, the purpose is to send events to ICC. Would you help to review this patch for me? Thank you.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 16,
                "quote": "Hi, philikon This is the implementations. Would you review this for me ? Thank you.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 17,
                "quote": "Hi, philikon This is the xpcshell test for testing writeLocationInfoTlv. Could you review this for me? Thank you.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 18,
                "quote": "fixed typo in comments.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "forgot qref. sorry",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "should be command.eventList = command.eventType; Thanks for kk11ff to point this out.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Addressed to kk11ff's feedback.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "You know me, I'm the devil's advocate for flatter structures. So I wonder why MozStkLocationEvent and MozStkLocationInfo can't be merged into one. Does MozStkLocationInfo exist outside of an MozStkLocationEvent context?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Same stupid question again: Can't `eventType` not be part of `eventData`, e.g. `eventData.type`? Flat objects FTW! :) Also, I have a question: does the radio respond to this STK command and if so, how? Should be worth documenting in the comment here. r=me so far since this could go in, though I would prefer that the above questions were addressed first.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "I'm sure smaug won't mind if I just r+ this. It's a pretty trivial piece of code.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "Nit: it would be good to have size consts for the individual building blocks so that these numbers are a bit clearer and not so magical, e.g. (options.helpRequested ? SIZE_FOO : 0) + (options.eventList ? SIZE_BAR + SIZE_FOO : 0) +",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "I do like tests. <3",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Addressed to philikon's comments: 1. move eventType into eventData, and rename eventData to event in sendStkEventDownload. 2. Add documentations to indicate ICC won't respond any data with this command. I didn't merge MozStkLocationInfo into MozStkLocationEvent, as I explained in my previous comment. philikon, does my comment make sense to you? Thanks",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "Updated parameters in SendStkEventDownload accordingly.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "Hi, philikon I addressed your comments to const the size of TLVs, but for some TLVs, their size will vary according to content. So in this patch I just const some of them, but I am not sure if this is better. Could you review this part again? Thank you.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 30,
                "quote": "s/respond/respond with/",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "Small nit: this is not a const we need to \"export\", it's an implementation detail, so IMHO would be better at the top of ril_worker (e.g. like PDU_HEX_OCTET_SIZE).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "I'm not quite sure why these can't be const'ed, but I'll take your word for it. This is just a personal pet peeve, I don't want to bikeshed over something unimportant.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 33,
                "quote": "Addressed to philikon's comments in comment 36.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 34,
                "quote": "Addressed to philikon's comment in comment 37",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 35,
                "quote": "I can't say that I understand a lot of the STK still :(. But this looks clean to me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "rebase",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 37,
                "quote": "Try run for c286b232f355 is complete. Detailed breakdown of the results available here: https://tbpl.mozilla.org/?tree=Try&rev=c286b232f355 Results (out of 290 total builds): success: 271 warnings: 18 failure: 1 Builds (or logs if builds failed) available at: http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/yhuang@mozilla.com-c286b232f355",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=731836",
        "issue_id": 731836,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "*** Part 0. Get started with Mozilla hacking *** This page has useful tips to get started, especially for Graphics hacking (tools, how to get source code, etc): https://wiki.mozilla.org/Platform/GFX/Contribute Code search tool: http://mxr.mozilla.org/mozilla-central/ *** Part 1. Get Mesa llvmpipe up and running *** Mesa is an open source OpenGL library. http://www.mesa3d.org Mesa can use various renderers. Some are hardware-accelerated, some are software-only. The best software-only renderer is called 'llvmpipe' because it uses LLVM for compiling shaders. http://www.mesa3d.org/llvmpipe.html This is available for x86 and x86-64 on Linux, Windows and Mac. Build instructions: http://www.mesa3d.org/install.html IIUC, scons is the recommended way on Windows. Your first step is to get a build of Mesa llvmpipe for your favorite OS. To be honest, the most interesting OS here is Windows, because that's where the largest proportion of users have outdated GPU drivers, but all OSes are interesting. *** Part 2. Get Firefox to run WebGL with Mesa llvmpipe *** Building Mesa llvmpipe should produce a OpenGL library that you could use as a drop-in replacement for the system OpenGL libraries. Notice that on Windows, to get Firefox to use OpenGL, you have to go to about:config and set these preferences: webgl.prefer-native-gl = true webgl.force-enabled = true You can check in about:support, 'WebGL renderer', if llvmpipe is actually used. Run the conformance tests to check that things are decently working: https://cvs.khronos.org/svn/repos/registry/trunk/public/webgl/sdk/tests/webgl-conformance-tests.html Also, you can assess performance by first disabling compositing acceleration (we want to optimize for the case where hardware acceleration doesn't work, so better work in real conditions): layers.acceleration.disabled = true and then play some WebGL demos such as http://webglsamples.googlecode.com/hg/aquarium/aquarium.html *** Part 3. Get Firefox to dynamically switch to Mesa llvmpipe *** Until now we haven't had to touch Mozilla code, but now we have to. It was nice to be able to test WebGL on llvmpipe, but for it to be practical, it must not require replacing system OpenGL libraries by llvmpipe, and Firefox must be able to decide at runtime whether to use llvmpipe. Let's not automatically fall back to llvmpipe for now. Instead, let's introduce a new preference in about:config that allows to choose llvmpipe for WebGL rendering. The file to edit, to add a new preference, is: http://hg.mozilla.org/mozilla-central/file/tip/modules/libpref/src/init/all.js Call it webgl.use-llvmpipe, boolean, default to false. In the WebGL initialization code, where we choose our 'GL context provider' (e.g. WGL vs EGL vs GLX...). The problem is twofold. First, we want use-llvmpipe to override the OpenGL driver blacklist i.e. the same effect as webgl.force-enabled. Second, on Windows, switching to Mesa llvmpipe requires switching to WGL (the default is EGL) i.e. the same effect as webgl.prefer-native-gl. So edit this file: http://hg.mozilla.org/mozilla-central/file/tip/content/canvas/src/WebGLContext.cpp Search for Preferences::GetBool in this file, in WebGLContext::SetDimensions, which is where we create the OpenGL context for a WebGL context. Once this is done (so we're now using the correct GL context provider for llvmpipe and ignoring the blacklist) we can proceed to the code where we actually load the OpenGL library and create a OpenGL context. That code is in different files depending on the OS. If you can't test on all OSes, it's fine to only do yours. Windows: http://hg.mozilla.org/mozilla-central/file/tip/gfx/gl/GLContextProviderWGL.cpp Mac: http://hg.mozilla.org/mozilla-central/file/tip/gfx/gl/GLContextProviderCGL.mm Linux: http://hg.mozilla.org/mozilla-central/file/tip/gfx/gl/GLContextProviderGLX.cpp Look for where we're setting the filename of the library we're opening. For example, on Windows it's http://hg.mozilla.org/mozilla-central/file/1c3b291d0830/gfx/gl/GLContextProviderWGL.cpp#l141 There, you want to read the webgl.use-llvmpipe preference again (yes, that's not super efficient, if needed we'll optimize that later). Use again Preferences::GetBool; you might need to add a #include \"mozilla/Preferences.h\" for it. The filename is up to you; it should probably be different from the system default (e.g. not opengl32.dll) otherwise AFAICS we won't be able to choose one over the other. *** Part 4. Wrap this as a Firefox add-on *** I'm not competent with that part. We'll have to find another mentor when we're there. *** Next steps *** Once we're there, we'll want to see how we can get Gecko to automatically download Mesa llvmpipe when needed. We don't want to ship it with the standard Firefox build, as that would inordinately increase the Firefox download size.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I volunteer as a mentor for part 4+. That said, I'm not sure to understand what you meant by \"Wrap this as a Firefox add-on\" if \"this\" are the previous parts, modifying existing native built-in implementations, which is something an add-on cannot do afaik. Otoh, the subsequent \"automatically download llvmpipe if needed\" would imho really fit as a feature of the add-on rather than of Gecko (the add-on possibly being bundled in Firefox at a later stage). IMHO it could be nice (and perhaps even simpler/cleaner in the end) to expose a generic \"add-on aware\" mechanism to specify a fallback GL implementation at context creation time (ie. no 'llvmpipe' reference in Gecko, not even as a pref name). An add-on could provide LLVMpipe fallback but another add-on could provide another alternative software implementation as easily (possibly Transgaming could even release a SwiftShader add-on). The add-on would also have the possibility of forcing a reduced size drawing buffer as it sees fit. It could work by implementing a simple WebGLContextProviderFallbackService XPCOM interface like : interface nsIWebGLContextFallbackProviderService { registerFallbackProvider(in WebGLContextFallbackProvider provider); unregisterFallbackProvider(in WebGLContextFallbackProvider provider); [noscript] WebGLContextFallbackProvider tryFallbackProviders(in DOMCanvasElement canvas); } /* this is an interface declaration only, it's up to the fallback add-on(s) to implement this */ interface nsIWebGLContextFallbackProvider { bool canProvideFallbackForCanvas(in DOMCanvasElement canvas); readonly DOMString providerName; // \"wgl\", \"cgl\", \"glx\" or \"egl\" readonly DOMString nativeLibraryPath;// eg. \"c://win/system32/my_egl.dll\" readonly DOMString glLibraryPath; // eg. \"c://win/system32/my_gles_v2.dll\" readonly long drawingBufferWidth; // eg. same as canvas.width readonly long drawingBufferHeight; // eg. same as canvas.height } tryFallbackProviders implementation: 1) for each registered WebGLContextFallbackProvider, in reverse order of registration: 2) call canProvideFallbackForContext with the given canvas argument 3) if the call returned true, break the loop at 1 and return the current WebGLContextFallbackProvider 4) return null In GLContextProvider interface, append 2 optional string arguments nativeLibraryPath and glLibraryPath to CreateOffscreen(). static GLContextProvider::GetInstance(providerLibraryPath = nsnull, glLibraryPath = nsnull) In setDimensions(), append the following steps when context creation failed : 1) call WebGLContextFallbackProviderService.tryFallbackProviders(canvas) and store the return value in local \"provider\" 2) if \"provider\" is not null, attempt to create a context, using the GLContextProvider interface specified by provider.providerName (eg. GLContextProviderWGL if \"wgl\") and the provider desired attributes. eg: '' gl::GLContextProviderWGL::CreateOffscreen(gfxIntSize(provider.drawingBufferWidth, drawingBufferHeight), format, provider.nativeLibraryPath, provider.glLibraryPath);",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Thoughts?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "The rest of what you write is super interesting, but needs to be moved to a separate bug, depending on this one, \"automatically download llvmpipe when needed for WebGL software rendering\". I would like to keep the present mentored bug not too big and not too scary. In fact, step 4. could already be a separate bug.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 5,
                "quote": "I filed bug 731983 about part 4, so the present bug is now focused on building llvmpipe and adding the preference to use it.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 6,
                "quote": "Hit a snag getting firefox to work with this particular graphics card although after following the exact same steps i got it working previously on a different machine. With this particular card, it defaults to a different webgl renderer: Intel -- Intel(R) HD Graphics Family -- 3.1.0 - Build 8.15.10.2538. //=====Current Graphics Card=========== Adapter Description Intel(R) HD Graphics Family Vendor ID 8086 Device ID 0126 Adapter RAM Unknown Adapter Drivers igdumd64 igd10umd64 igd10umd64 igdumdx32 igd10umd32 igd10umd32 Driver Version 8.15.10.2538 Driver Date9-26-2011 Direct2D Enabled true Direct Write Enabled true(6.1.7601.17776) ClearType Parameters ClearType parameters not found WebGL Renderer Google Inc. -- ANGLE (Intel(R) HD Graphics Family) -- OpenGL ES 2.0 (ANGLE 1.0.0.930) GPU Accelerated Windows 1/1 Direct3D 10 AzureBackend direct2d",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Steps to Build llvmpipe: ======================== Download LLVM 2.9 source Download CMake and install. Ensure it's added to PATH Create a new build folder for llvm. c:\\llvm_build>cmake -DVARIABLE=value ..\\llvm-2.9 -DLLVM_USE_CRT_DEBUG=MTd -DLLVM_USE_CRT_RELEASE=MTd -DLLVM_TARGETS_TO_BUILD=X86 G option not needed as it recognizes installed compiler. Alternatively you use the CMake-Gui to make changes to entry variables: LLVM_USE_CRT_RELEASE=MTd LLVM_USE_CRT_DEBUG=MTd Configure and generate files. Add environment variable to point to LLVM installation and add to PATH. This should be: C:\\Program Files (x86)\\LLVM Open Visual Studio, Go to Configuration Manager for the LLVM.sln and check that INSTALL is built for both release and debug options. Build the solution with INSTALL set as startup project. Download scons(zip file). unzip to C: run these commands: # cd scons-2.1.0 # python setup.py install Download and extract Mesa3d. Mingw installation required for this: Install msys-flex and msys-bison using this command: mingw-get install msys-flex msys-bison. Add mingw\\bin and msys\\bin to PATH change to the folder for mesa 3d run either: c:\\Mesa-8.0.2>scons llvm=yes build=debug machine=x86 opengl32 OR c:\\Mesa-8.0.2>scons build=debug machine=x86 libgl-gdi [Important: make a copy of the existing opengl32.dll in the system folder] Copy the opengl32.dll from Mesa's build directory to C:\\Windows\\System32. You will have to modify the permissions on the existing opengl32.ll there to replace. First change ownership of the dll to yourself and then assign full rights. If the dll is being used by another process, use -say Process Explorer-to locate and kill it",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "That means it's using the Intel OpenGL driver. If you put Mesa's DLL in the same directory as the firefox executable, does it find it? Otherwise, here's what you can try: - search for all files named opengl32.dll on your system - edit gecko source code to replace \"opengl32.dll\" by \"mesallvmpipe.dll\", rename Mesa's binary to that, so that it will only be able to find it and not the system opengl library. That's actually, probably, a step we want to take anyway, as described in comment 0, so that we can dynamically choose between mesa and system opengl.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "With llvmpipe, some of the demos are either totally \"off-color\" or mostly black. I guessed that should be expected. Examples of such are: http://www.chromeexperiments.com/detail/waterstretch/?f=webgl and http://blackberry.github.com/WebGL-Samples/tunneltilt/. Also i failed to mention that attempting to build llvmpipe with LLVM 3.0 doesn't work - still trying to figure that out as it ought to be possible.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I should think that the demos should be accurately rendered. Make sure you're not also using accelerated layers. Also, try some of the very simple demos such as those at SpiderGL.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "State of patch before our discussion on IRC.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "As discussed on IRC, I think we should always refer to it as 'Mesa LLVMpipe', not just 'LLVMpipe'. Both in the pref name and the variable. Indeed: - llvmpipe alone doesn't give Mesa enough credit, - mesa alone isn't specific enough since on Linux, most people use Mesa with their GPU, just not with the llvmpipe driver.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "We can do better/simpler than that, without hardcoding WGL here. Just GLContextProvider will give you the default context provider on the current platform. On Windows, it gives you GLContextProviderWGL. We already do that below, but only after we try EGL which is what we do by default on Windows (ANGLE rendering uses the EGL path). Just edit this part: if (PR_GetEnv(\"MOZ_WEBGL_FORCE_OPENGL\")) { preferEGL = false; useANGLE = false; useOpenGL = true; } and add useMesaLlvmpipe || in that if() condition. This way, enabling llvmpipe will cause ANGLE to be disabled and thus we'll skip straight to the desktop OpenGL path.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Mesa LLVMpipe.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Good call. This way, if we have a surge of crashiness correlated with llvmpipe usage, we'll know that these people did something nonstandard. We'll want to revert that, though, if/when we automatically use llvmpipe.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Please factor out this code by doing e.g. const char *libGLfilename = useMesaLlvmpipe ? \"mesallvmpipe.dll\" : \"opengl32.dll\"; Don't worry about outputting a different NS_WARNING, it's not a sufficient reason to avoid factoring this code.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "I've been tinkereing with building and using llvmpipe with firefox on Linux. I've not had any trouble building it against LLVM 3.0. I just built LLVM 3.0, put it in my $PATH and built Mesa 8.0.2 against it. Using LLVM 3.0 also fixes some rendering bugs I was seeing with LLVM 2.8. Slightly off topic, and maybe something for another bug report, but, I've also hacked my version of Mesa to fast path glReadPixels. With Mesa 8.0.2 the developers significantly improved the performance of glReadPixels. Problem is, the performance boost for llvmpipe is for BGRA data only. Firefox seems to read RGBA data, so it doesn't benefit at all. I bodged the code to force a fast path for RGBA data. My patch regresses BRGA performance (and rendering) but boosts RGBA performance (on my machine) by up to 850%. Before (stats from mesa-demos-8.0.1/src/perf/readpixels): glReadPixels(10 x 10, RGBA/ubyte): 12002.9 images/sec, 4.6 Mpixels/sec glReadPixels(100 x 100, RGBA/ubyte): 2229.7 images/sec, 85.1 Mpixels/sec glReadPixels(500 x 500, RGBA/ubyte): 109.8 images/sec, 104.7 Mpixels/sec glReadPixels(1000 x 1000, RGBA/ubyte): 27.8 images/sec, 106.2 Mpixels/sec glReadPixels(10 x 10, BGRA/ubyte): 12760.1 images/sec, 4.9 Mpixels/sec glReadPixels(100 x 100, BGRA/ubyte): 11959.1 images/sec, 456.2 Mpixels/sec glReadPixels(500 x 500, BGRA/ubyte): 5736.7 images/sec, 5470.9 Mpixels/sec glReadPixels(1000 x 1000, BGRA/ubyte): 567.0 images/sec, 2162.9 Mpixels/sec After: glReadPixels(10 x 10, RGBA/ubyte): 12226.9 images/sec, 4.7 Mpixels/sec glReadPixels(100 x 100, RGBA/ubyte): 8047.2 images/sec, 307.0 Mpixels/sec glReadPixels(500 x 500, RGBA/ubyte): 973.4 images/sec, 928.3 Mpixels/sec glReadPixels(1000 x 1000, RGBA/ubyte): 250.5 images/sec, 955.5 Mpixels/sec glReadPixels(10 x 10, BGRA/ubyte): 12291.1 images/sec, 4.7 Mpixels/sec glReadPixels(100 x 100, BGRA/ubyte): 8287.3 images/sec, 316.1 Mpixels/sec glReadPixels(500 x 500, BGRA/ubyte): 944.6 images/sec, 900.9 Mpixels/sec glReadPixels(1000 x 1000, BGRA/ubyte): 239.9 images/sec, 915.2 Mpixels/sec Patch (a horrible hack, but it works for firefox): --- src/mesa/main/readpix.c 2012-04-08 18:14:38.263151001 +0100 +++ src/mesa/main/readpix.c 2012-04-08 19:30:21.811151008 +0100 @@ -209,8 +209,6 @@ GLubyte *dst, *map; int dstStride, stride, j, texelBytes; - if (!_mesa_format_matches_format_and_type(rb->Format, format, type)) - return GL_FALSE; /* check for things we can't handle here */ if (packing->SwapBytes || @@ -240,10 +238,19 @@ } texelBytes = _mesa_get_format_bytes(rb->Format); + + uint32_t dst_off=0,map_off=0; + uint32_t k; + for (j = 0; j < height; j++) { - memcpy(dst, map, width * texelBytes); - dst += dstStride; - map += stride; + for(k=0;k<width * texelBytes;k=k+4){ + dst[dst_off+k+2]=map[map_off+k+0]; + dst[dst_off+k+1]=map[map_off+k+1]; + dst[dst_off+k+0]=map[map_off+k+2]; + dst[dst_off+k+3]=map[map_off+k+3]; + } + dst_off += dstStride; + map_off += stride; } ctx->Driver.UnmapRenderbuffer(ctx, rb);",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 18,
                "quote": "Depends, but here, we're talking about software compositing, Firefox uses Cairo for that, which wants BGRA. We actually pay for the conversion cost between RGBA and BGRA. So if we have an interface somewhere that wants RGBA, that means we're paying the conversion twice. Very interesting stuff, but please move it to a separate bug to keep the conversation tractable.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Very interesting stuff, but please move it to a separate bug to keep the conversation tractable.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 20,
                "quote": "Thought so, I've opened bug 743585 .",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 21,
                "quote": "Back to the patch. Another issue, that I wasn't aware of when I filed the bug, is that preferences should only be accessed from the main thread. The problem is that GL contexts can be created from outside the main thread; even if it's not actually going to happen here now (WebGL is entirely on the main thread) it's still worth fixing. Fortunately there is a simple fix that will also resolve the issue, mentioned in comment 0, that it's not great to be reading that preference twice. See what is done by the main patch in bug 686735: read the preference in gfxPlatform initialization (which happens on main thread), make it available from there by an inline getter so it's super cheap to access. User code will have to #include \"gfxPlatform.h\".",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 22,
                "quote": "This wont be applicable as the old value is what will be read if the pref is changed after initialization. Unfortunately,the pref will have to be read again to determine which loaded library to use.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Here is another solution: the problem here is that GLContext creation can happen off the main thread, but on the other hand, WebGL context creation can only happen on the main thread, so that is a great place to read the llvmpipe pref. Just find a way to pass that info to GLContext creation. I think the right way is to make that a new flag as in GLContext::ContextFlags. In WebGLContext.cpp, when calling CreateOffscreen, you could pass such a new flag to indicate that you want llvmpipe rendering.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 24,
                "quote": "Made changes to handle the loading of an addtional library, Mesallvmpe.dll. In addition, i am currently running tests to provide performance comparison to Chrome using both fraps and the phoronix test suite.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 25,
                "quote": "It's great to see this progress and unfortunate that GLContextProviderWGL is so poorly designed. R- mostly so we can discuss a different approach to working around GLContextProviderWGL crappiness.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "let's keep preferences all lowercase. you can add more dashes to separate words (maybe between mesa and llvmpipe).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "I would always say 'LLVMPipe' not just LLVM: LLVMPipe is the real name of that driver while LLVM is a general compiler project used in many places.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "Can we have enum values instead of #defines? (But see below about gCurrLib, I'm proposing a different design)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Instead of hardcoding 2, give it a name like GLLibrariesCount. (But see below about gCurrLib, I'm proposing a different design)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "I have to say, I didn't know that we had all these global variables in this file (like gSharedWindow). This makes it hard to find a solution that will really work, and will allow dynamic switching to/from llvmpipe. Your solution seems like it only works as long as only one WGL library is in use at a given time (why else would there be a global variable named gCurrLib). Let me propose that for the short term, we just require that only one WGL library will be used for the whole run of the application. So in the first context creation (maybe in WGLLibrary::EnsureInitialized or in some constructor), record the WGL library type (real opengl or mesa llvmpipe) and in subsequent calls, compare the new library type to the recorded one and fail context creation if they're different. Indeed, the rationale is that if native OpenGL ever succeeds, there should be no reason to use llvmpipe, and if native OpenGL fails, we have no choice but to use llvmpipe. Then, the better solution, that will allow dynamic switching between native OpenGL and llvmpipe, will consist in refactoring this GLContextProviderWGL.cpp file to get rid of these global variables. ::: gfx/thebes/gfxPlatform.cpp",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "Let me propose that for the short term, we just require that only one WGL library will be used for the whole run of the application. So in the first context creation (maybe in WGLLibrary::EnsureInitialized or in some constructor), record the WGL library type (real opengl or mesa llvmpipe) and in subsequent calls, compare the new library type to the recorded one and fail context creation if they're different.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 32,
                "quote": "Please avoid whitespace changes far away from code you edited. Makes hg annotate harder t",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 33,
                "quote": "Same.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "lowercase for preferences.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "Good question. I think that we definitely should let the use-mesa-llvmpipe preference force usage of llvmpipe even if native OpenGL would succeed. So that means that when use-mesa-llvmpipe is true, we should always use Mesa llvmpipe for all OpenGL (non-EGL) contexts and switch WebGL to using OpenGL (non-EGL) as well. Since that means that that preference affects more than just WebGL, how about renaming it to gfx.use-mesa-llvmpipe? Or maybe gfx.prefer-mesa-llvmpipe as I think it should silently revert to native OpenGL is mesa-llvmpipe is not found.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 36,
                "quote": "Refactored GLContextProviderWGL.cpp: moved dependent global variables for loaded libray to WGLLibrary.h. I avoided making changes to initialization logic so as to be consistent with other GLContextProviders{EGL, OSMesa...} Also, since GL contexts can be created off the main thread, i added events to check the Mesa LLVMpipe preference at places where a GLContext can be created via a call to GLContextProviderWGL::CreateForWindow.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 37,
                "quote": "Sorry, there still is something significant I'm not sure I agree with (scroll down to mLibType).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "If this function returned a WGLLibrary::LibraryType, you wouldn't have to cast to PRUint32. If you do return a plain integer type as opposed to an enum type, why not return just |int|? You don't need to explicitly have it 32bit unsigned. Nit: I would put the ? and : on new lines, as proposed in mfbt/STYLE: = condition ? xxx : yyy;",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "Multi-line please, with style proposed above.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 40,
                "quote": "Why 35 ? :-)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 41,
                "quote": "Suggest you use strncat here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "That's the part I don't understand: Didn't we agree earlier that we could make the restriction that only one WGL library type can be used for the entire browser run? So I expected that something that mLibType wouldn't be needed and you could accordingly make substantial simplications in all the places where it's currently used. Sorry for having taken so long for this review. Let's nail this point and land this patch asap!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "IRC discussion -> sorry for self contradicting myself (see comment 26) on whether we want dynamic switching. Will finish the review asap.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "Continued the review; the cost, in terms of code complexity, to allow dynamic switching, is really huge. It will have to be done again for each other context provider. I think I'm back to the opinion I had in comment 26: that allowing dynamic switching is not worth the hassle. Other things to consider: even allowing this dynamic switching, certain things won't work in full generality. For example, the global context is meant to allow resource sharing across contexts, but it won't work across different GL libraries.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "Restriction to use only one library for duration of browser run.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 46,
                "quote": "Added missing namespace qualifiers.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 47,
                "quote": "So, after our conversations today (IRC + skype) and reading this patch, I understand a bit more than before --- sorry I've been a bit slow to understanding this: the added complexity to support dynamic switching is actually not that big, since the majority of that is just the changes to move global variables into members of the WGLLibrary singleton, which is a good change anyway. So, I agree again that dynamic switching is a good idea :-) sorry... this time I shouldn't change my opinion again anymore. So we're very near r+ here, I would just like these changes: 1. revert to allowing dynamic switching 2. only read the llvmpipe preference in WebGL context creation, let every other place create OpenGL contexts with default flags (so, no LLVMpipe) regardless of the preference. Indeed, LLVMpipe is only really useful for WebGL. For Layers, using OpenGL layers with LLVMpipe won't be faster than BasicLayers. We will simply have to ensure that the interop between WebGL/LLVMpipe and BasicLayers works efficiently (i.e. we'll have to ensure that we read back the pixels in LLVMpipe's native format). -> bonus: this means that you won't have to deal anymore with reading preferences outside of the main thread. Some nits below:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 48,
                "quote": "Right, and as we discussed, this should actually be the only place where we read this pref, since only WebGL is interested in LLVMpipe.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 49,
                "quote": "GenerateWarning actually takes varargs so you could do %s here. Up to you.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 50,
                "quote": "Suggestion: align ? and : with aFlags.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 51,
                "quote": "I would just say OpenGL here. Mesa is a special case of it. Mention of Mesa LLVMpipe will be surprising if we ever start using system OpenGL more widely.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 52,
                "quote": "Nit: Given that the choice is between ContextFlagsMesaLLVMPipe and None, the type I would check for is the LLVMPIPE one.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 53,
                "quote": "Reversion to dynamic switching.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 54,
                "quote": "Wonderful! Just one nit. Please address it and I'll land it for you? Unless you have L3 access already?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 55,
                "quote": "Couldn't this function return a WGLLibrary::LibraryType instead of a plain int? Also, I feel that it should be a static method in WGLLibrary instead of a global function. Or if you keep it a global function, at least make its name more specific than mozilla::gl::SelectLibrary. Mention WGL.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 56,
                "quote": "Made SelectLibrary a static function of WGLLibrary and typedef'd WGLLibrary::Library.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 57,
                "quote": "Hey, I haven't had much luck trying to build Mesa llvmpipe on Windows following Comment 11.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 58,
                "quote": "From the feedback I got on the mesa-users mailing list, i was building the release version correctly. I had been using LLVM_USE_CRT_RELEASE=MT and LLVM_USE_CRT_DEBUG=MTd (thought i needed extra options). So with this, the crash issue i mentioned in comment 49 indicates the problem lies elsewhere. Example demo is: http://spidergl.org/example.php?id=11.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1456911",
        "issue_id": 1456911,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I haven't tested this yet, but it seems to be the case from code inspection: if a file descriptor in LaunchOptions::fds_to_remap has the same numeric value in the parent as the child, it won't have its close-on-exec bit cleared. (In contrast, the general case dup2()s the descriptor, which does clear close-on-exec.) So if the fd was close-on-exec, which is the general best practice, it will be closed on exec instead of inherited. Note that dup2(x, x) is defined as a no-op and POSIX specifically says it won't change the close-on-exec bit, so that will need to be done explicitly. This *probably* isn't a problem in practice, because the low-valued fds we map things to will *probably* wind up occupied by long-lived fds in the parent process\u2026 but maybe not. In any case I'd like to rule this out as a possible cause of bug 1455828. Interestingly, Chromium's current version of this code doesn't seem to handle that either, so maybe I'm missing something... or maybe they have a 10-year-old bug.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Another possibility is to just rip out most of this code, and instead dup() as needed to keep the source and destination fd ranges disjoint, at which point everything gets dup2()ed and this isn't a special case. That could also help for the posix_spawn implementation on Mac, which isn't using this and should be (that's another bug I'm in the middle of filing), because I've heard that OS X doesn't like identity mappings with posix_spawn_file_actions_adddup2 (which, if true, is an OS bug, and also I have no idea how it interacts with POSIX_SPAWN_CLOEXEC_DEFAULT).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "I've tested this, and an identity-mapped close-on-exec file does in fact fail to be inherited. As for comment #1: From looking at the kernel code, OS X's implementation of posix_spawn_file_actions_adddup2 seems to correct for the old==new case, and it ought to exempt the fd from POSIX_SPAWN_CLOEXEC_DEFAULT, but I haven't tested that yet. But, the current file_descriptor_shuffle assumes it can dup() in the child process, which will be a problem for bug 1456919, so that's another reason to rewrite.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This directory has a number of places where files unintentionally depend on `#include`s and `using` directives and forward declarations in other files in the same unified build group. Adding a file shifts the group boundaries and exposes some of those bugs; this patch fixes them (but there are others). Review commit: https://reviewboard.mozilla.org/r/249864/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/249864/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "This replaces some old Chromium code that tries to minimally disentangle an arbitrary file descriptor mapping with simpler algorithm, for several reasons: 1. Do something appropriate when a file descriptor is mapped to the same fd number in the child; currently they're ignored, which means they'll be closed if they were close-on-exec. This implementation duplicates the fd twice in that case, which seems to be uncommon in practice; this isn't maximally efficient but avoids special-case code. 2. Make this more generally applicable; the previous design is specialized for arbitrary code running between fork and exec, but we also want to use this on OS X with posix_spawn, which exposes a very limited set of operations. 3. Avoid the use of C++ standard library iterators in async signal safe code; the Chromium developers mention that this is a potential problem in some debugging implementations that take locks. 4. In general the algorithm is simpler and should be more \"obviously correct\"; more concretely, it should get complete coverage just by being run normally in a debug build. As a convenient side benefit, CloseSuperfluousFds now takes an arbitrary predicate for which fds to leave open, which means it can be used in other code that needs it without creating a fake fd mapping. Review commit: https://reviewboard.mozilla.org/r/249866/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/249866/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "This is nice.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Maybe rewrite this as \"Close all file descriptors, except for std{in,out,err} and those for which the given function returns true.\"? I took the current wording to mean the function could return std{in,out,err}, which is admittedly bizarre, and that might have just been me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Should this return value be `const`?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/249864/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/249866/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1407955",
        "issue_id": 1407955,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The example here is fixed by simply removing the \\!aParams.callbacks guard that prevents us rendering the shadow in the (no-selection) PaintText path. It looks like this dates back to bug 655877, originally as the separate aCallbacks param, later moved to the PaintTextParams struct. So :heycam, do you know if removing this will break anything? (Existing reftests seem to be fine with it, according to https://treeherder.mozilla.org/#/jobs?repo=try&revision=2b5eb4766f666c114f0bf5ea348aef7f920edebc, so if it does result in problems that implies we're lacking suitable test coverage...)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "So :heycam, do you know if removing this will break anything? (Existing reftests seem to be fine with it, according to https://treeherder.mozilla.org/#/jobs?repo=try&revision=2b5eb4766f666c114f0bf5ea348aef7f920edebc, so if it does result in problems that implies we're lacking suitable test coverage...)",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "The callbacks are used for two different cases. One is when we have a <text> inside a <clipPath>, and we need to generate paths for the clip path. The second case is when we have SVG patterns, strokes, etc. In this case, where we're still painting the text normally, it does make sense to just go ahead and paint the shadow, and not bother about going through a callback function to do it either. One thing to check would be that when we're in here due to <clipPath>, that aParams.IsPaintText() is indeed false. It might be we only set that for background-clip:text. Can you check that Jonathan?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Can you check that Jonathan?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Currently, the most obvious bug we have is that the text-shadow only appears for text that is rendered with fill (but no stroke). Doing a \"Select All\" on the testcase makes shadows appear on all the examples. However, looking at exactly how the shadows are rendered raises further questions: - When the text has a stroke but no fill, should the shadow be a \"solid\" shadow as if the text were filled, or should it be a shadow of only the stroke? In both Safari and Chrome, it's the stroke that casts the shadow here. - What about partially-opaque text: should the shadow adopt the same opacity as the element? Chrome and Safari do that for SVG text, though this does not apply to partially-opaque HTML text, which still casts a fully-opaque shadow (in all browsers). The difference between their SVG and HTML behavior seems odd. - Is is appropriate for text-shadow to apply to text used as a clipPath (i.e. to contribute to the clip region)? It kinda does so when selected, but it looks like we get the position a bit wrong. Both Safari and Chrome do this, though in Safari the positioning also looks wrong (in a different way from ours). (FWIW, this testcase exhibits painting bugs in both Safari and Chrome, too, so we're not alone in having issues here -- though ours seem the most glaring!)",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Pushed by longsonr@gmail.com: https://hg.mozilla.org/integration/autoland/rev/624c3df8fcd4 Display text shadow with fill and stroke specified r=jfkthame",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1362590",
        "issue_id": 1362590,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: https://hg.mozilla.org/mozilla-central/rev/ed8623eefe6c user: Andr\u00e9 Bargull date: Thu Apr 27 09:24:08 2017 -0700 summary: Bug 1360220 - Replace emitRequireObjectCoercible with JSOP_CHECKOBJCOERCIBLE. r=shu",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Andre, is bug 1360220 a likely regressor?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I was able to resolve this issue by adding a |frame.syncStack(0)| after |frame.push(R0)| in BaselineCompiler::emit_JSOP_INITGLEXICAL() [1]. But I have no idea why this fixes the crash and if that's the correct approach to fix the crash. FWIW the crash can also be reproduced by removing the RequireObjectCoercible() call in BytecodeEmitter.cpp [2], so I assume this isn't a bug in BaselineCompiler::emit_JSOP_CHECKOBJCOERCIBLE(), but instead a problem in BaselineCompiler::emit_JSOP_INITGLEXICAL().",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "shu, can you take a look at this issue?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "From reading comment 6, I think the problem is that BaselineCompiler::emit_JSOP_INITGLEXICAL pushes multiple stack values (for JSOP_SETPROP) but in vm/Opcodes.h we have nuses and ndefs 1. So we're using more frame slots than the compiler expects.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "I don't know how this worked before. Shouldn't have been hardcoding the extra slot into MinJITStackSize, but should've always been conditionally giving global scripts an extra slot.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Typo fix, carrying r=jandem.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Fix a sec-high. Beta54+ & ESR52+. Should be in 54 beta 9.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 9,
                "quote": "JSBugMon: This bug has been automatically verified fixed.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1344721",
        "issue_id": 1344721,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We need the null check if the value's type is MIRType::ObjectOrNull, but we don't need it in the more common MIRType::Object case.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Nice.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "This patch regressed Octane Deltablue and Richards on AWFY (but only on the Mac 64-bit machine)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Yeah it's mysterious. The patch just eliminates a test+jump instruction so it must be some kind of caching or alignment issue.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1343787",
        "issue_id": 1343787,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/116940/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/116940/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/116942/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/116942/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/116942/#review118578",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "https://reviewboard.mozilla.org/r/116940/#review118580",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch 1343787_aurora_53_fix.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Part three of a big media shutdown crash fix, please uplift this after the patches in bug 1336345 and bug 1336356.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch 1343787_esr52_fix.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "crash fix, regression in 52, esr52+",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1253516",
        "issue_id": 1253516,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I guess this was caused by bug 1244897. ni? to me.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This is tough, I can't catch this while running this test with choas mode repeat=1000!",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "I thought the dead lock might be caused from other thread but it was in the same, the main thread!",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "I don't know much about cycle collection. Nick, you are the author who introduced AutoGlobalTimelineMarker in cycle collection codes in bug 1141614. Any ideas?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Thanks for the digging, Hiroyuki! This indeed should not be re-entrant, and I'm not sure why it is. Investigating.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "So this doesn't actually involve CC at all. PopTimelineMarkers | V acquire lock | V create JS objects for markers | V nursery GC | V attempt to acquire lock to add marker for nursery GC | V dead lock",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Hack #1: AutoSuppressGC while creating timeline markers. Not a good solution. Hack #2: Some atomic global flag or something that we set while popping timeline markers and then unset when we're done. We would check this before adding nursery markers, and if it was set not add the marker. Less bad thna #1, but still pretty gross. Solution #3: Swap the timeline markers into a new vec while we have the lock, but do not allocate any JS obejcts yet, release the lock, operate on our vec to create the JS objects. This would be most ideal, but now I need to learn how the heck all this stuff works. Looking into #3 more.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Actually, `sMutex` is acquired by `TimelineConsumers::PopMarkers` here[0] so that it can touch `mMarkerStores` according to the comment, but then it doesn't touch `mMarkerStores` nor does `ObserveDocShell::PopTimelineMarkers`. So assuming the comment is correct, I think we can just delete this lock acquisition!",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "`sMutex` protects the `mMarkersStores` data member, but neither `TimelineConsumers::PopMarkers` nor `ObservedDocShell::PopMarkers` use that data member. Removing this lock acquisition also fixes a dead lock where we re-entrantly attempt to acquire the lock when triggering a GC when allocating JS objects inside `ObservedDocShell::PopMarkers`.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Try push: https://treeherder.mozilla.org/#/jobs?repo=try&revision=bbd8381da834",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "That was my mistake. As I commented in comment#0, I thought the deadlock we had been seeing in bug 1244897 might be caused from other threads. What I don't quite understand is that the assertion message in bug 1244897 is accurate or not.",
                "code": "SOLUTION_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1209952",
        "issue_id": 1209952,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Looks like all of the pointer-values are poison addresses (and we're crashing when we try to deref one of them, mStyleContext). So, I think this is successfully mitigated by frame poisoning.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Our fuzzers are still seeing this issue.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Actually the cause is the violation of pushed-float invariant in nsColumnSetFrame. Under certain cases, it will reflow the content with a smaller height constraint when a bigger one has already overflowed. If the previous failure has pushed some float, then a smaller height constraint could make the prev-in-flow of those pushed floats overflow, thus violates the invariant of pushed-float.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "If a BSize is already infeasible, we should not try a smaller size. Because if the previous failure leaves some pushed floats, a smaller try might make the prev-in-flow of the pushed float overflow, which violates the invariant of pushed float and may cause use-after-free and crash.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Hi Mats, I'm not sure whether you're the correct person to review this patch, I set the reviewer to you because I found multiple comments from you in layout/generic code. Could you assign this bug to me and review my patch? In case I got the reviewer wrong, could you forward the patch to a correct reviewer? Thanks!",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Would you test it on the try server and review the change?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Well, it passed tests on Linux at least: https://treeherder.mozilla.org/#/jobs?repo=try&revision=6ffdbe718e26c854bd4ad98b2d15e602453359a8 As I said earlier, I'm not going to review this until I understand what goes wrong in the frame tree with our current code. It would help if you can try to explain it to me, otherwise I'll have to debug it myself.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "Ok, I will explain the oddity in the nsColumnSetFrame with a further reduced testcase by dropping the surrounding div around dev.float-L which causes an assertion failure (see my explanation in a comment on phabricator). So the testcase would be: <div class=\"multicol-b\"> <div class=\"step\"></div> <div class=\"float-L\"></div> </div> 1px=60 logical unit. Both .step and .float-L have 1px height, thus it's totally 2px=120. And we need at least 40 BSize to place it in 3 columns (120 = 40 * 3). At the beginning of the log, it's the outer multicol .multicol-a relowing the child #0 with availBSize=1699, float-R consumes 26px=1560, while the inner multicol has 1px border, which consumes 2*1px=120. So the availableContentBSize for the inner one only remains 1699 - 1560 - 120 = 19. But because of the lack of a std::min in initialization, it tries to reflow 40. see the inline comments in the log // outer reflows child #0 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #0 0x7fe0ef551be8: availBSize=1699 [00000003] nsBlockFrame:0x7fe0ef551be8 Reflow // .float-R reflows [00000004] nsBlockFrame:0x7fe0ef551d38 Reflow [00000004] nsBlockFrame:0x7fe0ef551d38 Reflow done // inner reflows [Child 8618: Main Thread]: D/ColumnSet ChooseColumnStrategy: numColumns=3, colISize=4000, expectedISizeLeftOver=0, colBSize=40, colGap=0 // at this point, we only have 19 available, why try mColMaxBSize=40? To exceed 19 is pointless [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Doing column reflow pass: mLastBalanceBSize=40, mColMaxBSize=40, RTL=0, mBalanceColCount=3, mColISize=4000, mColGap=0 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #0 0x7fe0ef551df0: availBSize=40 [00000004] nsBlockFrame:0x7fe0ef551df0 Reflow [00000005] nsBlockFrame:0x7fe0ef551f40 Reflow [00000005] nsBlockFrame:0x7fe0ef551f40 Reflow done [00000004] nsBlockFrame:0x7fe0ef551df0 Reflow done [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowed child #0 0x7fe0ef551df0: status=[Complete=N,NIF=Y,Truncated=N,Break=N,FirstLetter=N], desiredSize=(4000,40), CarriedOutBEndMargin=0 (ignored) [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Next childOrigin.iCoord=4060 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #1 0x7fe0ef552398: availBSize=40 [00000004] nsBlockFrame:0x7fe0ef552398 Reflow [00000005] nsBlockFrame:0x7fe0ef552450 Reflow [00000005] nsBlockFrame:0x7fe0ef552450 Reflow done [00000005] nsBlockFrame:0x7fe0ef551ff8 Reflow [00000005] nsBlockFrame:0x7fe0ef551ff8 Reflow done [00000004] nsBlockFrame 0x7fe0ef552398 SplitFloat 0x7fe0ef551ff8 -> 0x7fe0ef5522d0 [00000004] nsBlockFrame:0x7fe0ef552398 Reflow done [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowed child #1 0x7fe0ef552398: status=[Complete=O,NIF=Y,Truncated=N,Break=N,FirstLetter=N], desiredSize=(4000,40), CarriedOutBEndMargin=0 (ignored) [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Next childOrigin.iCoord=8060 // Why inconsistent height? Both child #0 and #1 have 40, #2 only has 19? // That's because https://github.com/mozilla/gecko-dev/blob/master/layout/generic/nsColumnSetFrame.cpp#L712 // the last column is unbounded, thus it takes all avail size, which is 19, which is smaller than the previous columns. // Now we take a look at float splitting state. 60+60 should be split into 3 column, thus (40)+(20+20)+(40), // So there is already a split for 60 -> 20 + 40. // An unfortunate consequence of the oddity here is that the 40 is further split into 40 -> 19 + 21, then // 21 is pushed to child#2 as a pushed-float, see splitting -> below. // After this reflow, we end up with split float 1ff8, 22d0, 2790 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #2 0x7fe0ef552558: availBSize=19 [00000004] nsBlockFrame:0x7fe0ef552558 Reflow [00000005] nsBlockFrame:0x7fe0ef5522d0 Reflow [00000005] nsBlockFrame:0x7fe0ef5522d0 Reflow done -> [00000004] nsBlockFrame 0x7fe0ef552558 SplitFloat 0x7fe0ef5522d0 -> 0x7fe0ef552790 [00000004] nsBlockFrame:0x7fe0ef552558 Reflow done [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowed child #2 0x7fe0ef552558: status=[Complete=O,NIF=Y,Truncated=N,Break=N,FirstLetter=N], desiredSize=(4000,19), CarriedOutBEndMargin=0 (ignored) [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Done column reflow pass: Infeasible :( // Now it ends with an infeasible state, we arrive at https://github.com/mozilla/gecko-dev/blob/master/layout/generic/nsColumnSetFrame.cpp#L1111 // Then we reflow at 19 since it's the available size. But we shouldn't have tried 40 in the first place [Child 8618: Main Thread]: D/ColumnSet FindBestBalanceBSize: KnownInfeasibleBSize=40, KnownFeasibleBSize=40 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Doing column reflow pass: mLastBalanceBSize=40, mColMaxBSize=19, RTL=0, mBalanceColCount=3, mColISize=4000, mColGap=0 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #0 0x7fe0ef551df0: availBSize=19 [00000004] nsBlockFrame:0x7fe0ef551df0 Reflow [00000005] nsBlockFrame:0x7fe0ef551f40 Reflow [00000005] nsBlockFrame:0x7fe0ef551f40 Reflow done [00000004] nsBlockFrame:0x7fe0ef551df0 Reflow done [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowed child #0 0x7fe0ef551df0: status=[Complete=N,NIF=Y,Truncated=N,Break=N,FirstLetter=N], desiredSize=(4000,19), CarriedOutBEndMargin=0 (ignored) [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Next childOrigin.iCoord=4060 [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #1 0x7fe0ef552398: availBSize=19 [00000004] nsBlockFrame:0x7fe0ef552398 Reflow [00000005] nsBlockFrame:0x7fe0ef552450 Reflow [00000005] nsBlockFrame:0x7fe0ef552450 Reflow done [00000004] nsBlockFrame:0x7fe0ef552398 Reflow done [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowed child #1 0x7fe0ef552398: status=[Complete=N,NIF=Y,Truncated=N,Break=N,FirstLetter=N], desiredSize=(4000,19), CarriedOutBEndMargin=0 (ignored) [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Next childOrigin.iCoord=8060 // first 2 children only consume 19+19=38 height, thus the first split float 1ff8 is entirely overflow in child#1, // child#2 drains it, but one of the split float (2790) in its next-in-flow chain is still in child#2's pushed-float list. [Child 8618: Main Thread]: D/ColumnSet ReflowChildren: Reflowing child #2 0x7fe0ef552558: availBSize=19 [00000004] nsBlockFrame:0x7fe0ef552558 Reflow [00000004] nsBlockFrame:0x7fe0ef552558 DrainOverflowLines 0x7fe0ef551ff8 <- this one, overflow from child #1 [00000004] nsBlockFrame:0x7fe0ef552558 DrainOverflowLines: nif=0x7fe0ef5522d0 [00000004] nsBlockFrame:0x7fe0ef552558 DrainOverflowLines: nif=0x7fe0ef552790 <- this one, the third split float still in pushed float list of child#2, which violates assertion. Assertion failure: mFloats.ContainsFrame(nif), at layout/generic/nsBlockFrame.cpp:4756",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "we should not try a size that is greater than availableContentBSize in the first place, it's a wasted computation at best. It will also make some previously overflow-but-not-drained frames hanging around to do bad things.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 10,
                "quote": "My updated patch is to address this problem. As a note, the original code will theoretically produce a wrong layout. Suppose we have 118 content to lay out in 3 columns, with an availableContentBSize 39 after a previously successful reflow (in order to have mLastBalanceBSize=40 so that the first try will start at 40). Then with original code it will be 118 = 40 + 40 + 38 with a feasible state. But the correct layout should respect the constraint and produce 118 = 39 + 39 + 39, with 1 overflow. This is quite theoretical, since a couple of logical unit can hardly have visible effect.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "It's just a kind reminder that this patch I submitted half a month a ago is waiting for your review. I've already explained the timeline of this bug with logging message in a previous comment. Could you review this patch now? Or if you don't have time, could point me to someone who is also eligible to review this patch? I'm afraid I would probably forget some of the detail in the bug if it takes too long.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 12,
                "quote": "Do you have further update of your reviewing? If you have any questions about this bug and my patch, feel free to ask me.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "So here's my initial analysis of what happens in the frame tree that leads up to the crash. I've colorized the interesting float continuation chain, and numbered the interesting frames dumps in a grey background color and numbered them. Referring to each of the numbered trees in this log: initially we have a float in the first column we reflow and find that it overflows (but its parent is complete), so we put a NIF for it on the OverflowContainersList when reflowing the next column, we find that it still doesn't fit so we create another NIF and put it on the PushedFloatsList and create a continuation for the parent on ExcessOverflowContainersList CRASH Now backtracking a bit in rr to see what happens between 3 and the crash... This is the frame tree we start with when reflowing our float (red). Note that the inner ColumnSet has a NIF at this point. Backtracking to where we create that ColumnSet NIF. I think this is the point where things start to go wrong. We've decided that the float's parent doesn't fit in in this column at all and we push the lines containing it (creating the Overflow-lines list) and create the NIF. At this point the NIF has picked up the Overflow-lines so the float first-in-flow is in the ColumnSet NIF and its continuations in the previous ColumnSet. Likewise for the float's parent block which is also in the wrong order. This seems questionable to me. Technically, we would either be COMPLETE, in which case we'd delete the NIFs, or INCOMPLETE, in which case we'd push them, but still... From 6, this is essentially what happens, we decide it's COMPLETE and delete the NIFs. The reason we crash is that one of the float NIFs are registered in the float manager, and we try to use it after it's been deleted (frame-poisoning makes it non-exploitable though).",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "I wrote a WIP to fix the underlying cause of the crash here: https://hg.mozilla.org/try/rev/36932abd37ac11308bfee0068ef5eaf74e9f7846 If a continuation pulls in children from its prev-in-flow then it should also move any overflow containers for those from its OverflowContainers list, to avoid the child continuations from becoming in the wrong order. The WIP currently moves them to the principal child list (mFrames), but ExcessOverflowContainers might be better. I'll investigate this some more...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 15,
                "quote": "FTR, there's one more detail I want to highlight in the log above. At the very end, I print out nsFloatManager::mFloats. We have the (float) child of the overflow container (green) at index 0, and the (red) child float from the line list in slot 1. This is because we call ReflowOverflowContainerChildren before reflowing the principal children (in the lines), so it's added first. The stack when we add that float is: #0 nsTArray_Impl<nsFloatManager::FloatInfo, nsTArrayInfallibleAllocator>::AppendElement #1 nsFloatManager::AddFloat #2 mozilla::BlockReflowInput::FlowAndPlaceFloat #3 nsBlockFrame::ReflowPushedFloats #4 nsBlockFrame::Reflow #5 nsContainerFrame::ReflowChild #6 nsContainerFrame::ReflowOverflowContainerChildren #7 nsBlockFrame::Reflow So after we reflow the red float and find that it's COMPLETE and destroy its continuations, we have a dead continuation in the float manager.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Please file a follow-up bug with your patch since it might give more correct layout results.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 17,
                "quote": "Attached file Bug 1209952 - Move [Excess]OverflowContainers continuations of children we pull in from our prev-in-flow to our principal list to avoid making them unordered. r=dholbert \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1093374",
        "issue_id": 1093374,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It's because of the moz-appearance set here: http://dxr.mozilla.org/mozilla-central/source/browser/themes/osx/browser.css#3082",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Another case where I'm not sure if it would be best to just use !important or to just copy the selector list from browser.css. I went ahead and copied the list but let me know if you think there's a better way to do this.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "let me know if you think there's a better way to do this.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "You can use !important here. The selector should be as simple as '#TabsToolbar', as I understand it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Or am I missing some case where -moz-appearance:none isn't wanted?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "This fixes the issue for me",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch tabstoolbar-overflowing-tabs.patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "stealing again",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Thanks! Updated commit message and pushed to fx-team: https://hg.mozilla.org/integration/fx-team/rev/de9c2a2f67eb",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "This looks fixed in latest gum build (https://hg.mozilla.org/projects/gum/rev/f426e446b9aa) using Mac OS X 10.9.5.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1514062",
        "issue_id": 1514062,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "users are reporting that reverting to 1.4.9.1088 fixes this.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "If you're encountering the issue it would be also be useful to know if reverting to 4.10.1146.0 fixes it (this CDM has a Mac specific crash that shouldn't impact Windows users).",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "To revert your CDM: - Locate your profile directory (you can find this in about:support in the Profile Folder entry). - In that directory there should be a `gmp-widevinecdm` dir, inside that there should be a `4.10.1196.0` directory, inside that dir there should be 5 files, a license, a manifest, and 3 widevine files. These files are the CDM. - Download the old CDM from https://redirector.gvt1.com/edgedl/widevine-cdm/1.4.9.1088-win-x64.zip or https://redirector.gvt1.com/edgedl/widevine-cdm/4.10.1146.0-win-x64.zip - Close Firefox. - Backup the files in the `4.10.1196.0` directory by copying them somewhere else, we're going to want to restore them later. - Extract the files from the `1.4.9.1088-win-x64.zip` or `4.10.1146.0-win-x64.zip` downloaded above over those in the `4.10.1196.0` directory. - Start Firefox (with the profile we've changed the CDM for). - Check if this fixes the issue. - Close Firefox. - (Optional since this appears to cause issues) Restore the old files to `4.10.1196.0` that we backed up earlier. If something goes wrong with the backup, the files can also be downloaded from https://redirector.gvt1.com/edgedl/widevine-cdm/4.10.1196.0-win-x64.zip",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Can confirm that it works when reverting the CDM to 4.9.1088 or 4.10.1146.0.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "I only have two monitors, but do experience the problem. (2* 1920x1080 @ 60Hz)",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "See attached about:support files. (they show the netflix-1808p extension, but the problem still exists when disabling it, this has of course been my first test; also the fact that swapping CDM versions as per :bryce's post worked seemed to point to the latter as the culprit)",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "See attached about:support files. (they show the netflix-1808p extension, but the problem still exists when disabling it, this has of course been my first test; also the fact that swapping CDM versions as per :bryce's post worked seemed to point to the latter as the culprit)",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "We've moved to serve the old version of the CDM on Windows (bug 1514206) while we wait to hear back from Widevine regarding this. The fallback downloader has not yet been adjusted, in hopes that the roll back is a temporary solution.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "Can you confirm that you haven't seen this issues happen again?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 10,
                "quote": "The problem seems solved for me. Just to be sure, I just did a quick test on two different VOD services that use Widevine on Firefox, and the playback is similar to Edge (EdgeHTML, which uses Microsoft's own DRM IIRC, and not Edge Chromium) in terms of quality. I didn't encounter mouse stutter, timestamp not updating, or video stutter, as far as I can tell. FYI, the versions are as follows : Os : Windows 10 x64 Firefox: 70.0.1 Widevine : 4.10.1440.19",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "It sounds like the issue is unique to Widevine 4.10.1196.0.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "I'm still having stutter problem on Amazon Video Japan. Disconnecting non-primary displays and reloading the page fixes it. My system has three displays. OS: Windows 8.1 (build 9600) Browser: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0 Widevine: 4.10.1582.2 GPU: nvidia GTX950 Issue #1544108 is probably the same problem.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=593387",
        "issue_id": 593387,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This feels like a bug in the X-FRAME-OPTIONS implementation, since we are a chrome privileged page loading content in browser element.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Sadly this prevents us also in Beta5 and down to Beta3 to show the one and only location where the Addons Compatibility Reporter is promoted. I would expect more negative via feedback.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 3,
                "quote": "Oddly, if the \"Get Add-ons\" pane is pre-selected when the addon manager loads (previously open the AOM, click \"get addons\", close the tab, reopen the tab), I get this page loading.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Add a system principal check. Boris, perhaps you can tell me the most efficient way to get a principal from a nsIDOMWindow. I'll also add a test.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "nsCOMPtr<nsIScriptObjectPrincipal> objPrin = do_QueryInterface(topWindow); nsIPrincipal* topPrincipal = objPrin->GetPrincipal();",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Or more interest to me.... Why is this a problem at all? Are we seriously loading content off the web in a chrome-type iframe, and if so, why?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This should be a subsumes() check.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "1) If a chrome page in a content docshell loads site A which then frames site B, the framing will be allowed with this patch. Is this desired?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "2) Getting the principal of the current document can just be done with NodePrincipal(); no need to get it off thisWindow.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "X-Frame-Options 1) restricts \"DENY\" documents from being framed in any context and 2) restricts \"SAMEORIGIN\" documents to be framed only if the top-level browsing context is the same origin as the document. This bug is about adding exceptions to the above policy for chrome. We want to allow chrome to frame any resource but we don't want to allow content to frame other content if it would violate any of the above policy. My thinking about GetSameTypeRootTreeItem is: 1) any inner content document with X-F-O: DENY should be blocked if there exists a content docshell anywhere in its parent chain 2) any inner content document with X-F-O: SAMEORIGIN should be blocked if the top content docshell in its parent chain is a different origin 3) we don't need to worry about the \"content > chrome > content\" chain because we don't allow content to frame chrome in any case",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "How does that sound?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 12,
                "quote": "It not relevant here, since in this case the chrome is being loaded in a content-type docshell, so the top content docshell in this case is the chrome page... That old issue with chrome principal vs chrome docshell coming back to bite us. :(",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "A new issue. With current trunk and pending patch for bug 584693 applied, this patch no longer causes the Get Add-ons content to display. For whatever it is worth, the original patch here at least still works.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 14,
                "quote": "The issue here seems to be that we are trying to display content in an iframe where the server specifically says: x-frame-options: DENY It seems to me this really should just not work.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 15,
                "quote": "Perhaps if the header said x-frame-options: SAMEORIGIN some exception for this case would make more sense? Perhaps somehow treating about:addons and addons.mozilla.org as being the same origin? Still a kludge but makes more sense than permitting something that there is an explicit specific deny on the server-side.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 16,
                "quote": "Of course, if besides DENY and SAMEORIGIN, x-frame-options could also specify a whitelist of things permitted to include this in a frame, this would probably be helpful not only here, but in other cases as well. But, I guess Microsoft never thought of that when they specified this.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "I suppose we can punt on that case since we ultimately get to decide who the site A is that we'll be framing in the product, and we can avoid choosing sites that will be framing other X-F-O:DENY pages.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 18,
                "quote": "Sound fair?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 19,
                "quote": "Can you explain the danger you see here a bit more? What are the cases where we load a chrome page in a content area and how is our comparison between the framed content and the top-level page not sufficient for those cases?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 20,
                "quote": "Just spoke to Boris and we decided on a better approach which is to mimic the GetSameTypeRootTreeItem behavior for finding the \"top\" docshell, but with an additional check that will make us stop when we find the first non-SystemPrinicpal-having item. Patch coming up...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 21,
                "quote": "Find the top non-systemPrincipal docshell in our parent chain to avoid comparing principals with chrome documents (who are allowed to frame X-F-O pages).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Just nsIPrincipal* is fine.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Call that curDocShellItem or something?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "You only use these inside the loop. Why not just declare them there?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "I'd think we want to fail safe here (so deny if we can't get an SSM).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "I'm pretty sure you should be able to assert that topDoc is non-null, but if we want ot keep the null-check we should just fail out if !topDoc.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "This is marked betaN but I would really like to see this in for feature freeze. Brandon, possible to get the comments and checkin turned around today?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 28,
                "quote": "This addresses Boris' review comments, but I'm still struggling to get a test working. If drivers want to land this in the meantime, by all means...",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:2.0b6) Gecko/20100101 Firefox/4.0b6 Build Identifier: Mozilla/5.0 (Windows NT 5.1; rv:2.0b6) Gecko/20100101 Firefox/4.0b6 I'm here as a Dupe via Comment 44 . Fixed ? : When I click [Tools][Add-ons] I get this page as the default http://www.mozilla.org/ , and if I click another Tab below \"Get Add-ons\" (EG: Extensions, Themes, or Plug-ins) and then \"Get Add-ons\" again I get a Blank rendering - there is NO frame. A right-click the SECOND time (in the frame area) says the URL is now \"about:addons\" (the \"frame\" is gone). Rob",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 30,
                "quote": "Now with test. Carrying forward Boris' review.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 31,
                "quote": "If you're going to use checkin-needed, please include a commit message in your patch. (Really, you should always include it so the reviewer can review it.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "http://hg.mozilla.org/mozilla-central/rev/f5c0015afe0e I used the bug summary as the commit message, which seems suboptimal.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 33,
                "quote": "Verified fixed with Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0b7pre) Gecko/20101006 Firefox/4.0b7pre. Also tested with 4.0b8pre builds on other platforms.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1203871",
        "issue_id": 1203871,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "So, if we implement eQueryCharRectArray as retrieving each character rect in the specified range, we can reduce the cost of preparing to retrieve each character rect except the first one.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "There's no direct API for this, but you could quite easily add a new nsTextFrame API similar to GetPointFromOffset that returns a set of rects.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Using gfxTexRun, we can get width per character.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "How about make this a pointer to nsTArray? The array may be big and copied to another instance. If InitForQueryTextRectArray() takes a pointer to this, the caller can specify the dist or nsAutoTArray for avoiding memory fragmentation.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "sizeof(nsTArray<nsRect>) is always 8 bytes on 64bit platform and array data is allocated on heap. Even if using pointer instead, allocated AutoTArray will be on heap. So as memory fragmentation, it is same result.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Can SetEventResult and WidgetQueryContentEvent use c++11 move?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "Thanks. Looks like nsTArray_Impl:: SwapElements() is useful.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "We can use mozilla::Move instead. Also, I should mark this event is invalid after using it.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 9,
                "quote": "IME wants to need the width per character. Now nsTextFrame/nsIFrmae has only API to get point of string. So I want to add this method to calculate simply by comment #3.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "If you cannot review this, please change reviewer.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 11,
                "quote": "It will use on ContentCache.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Use new event to update cotent process's cache.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "To test eQueryCharRectArray, I would like to add it to nsIDOMWindowUtils. Also this will require external keyboard support on Android.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "To optimize copy of text rect array, we should use mozilla::Move. Also, after using it, we should mark is invalid result into SetEventResult",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Anyway, it's okay to fix the optimization later.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Hmm, SetRangeFromFlatTextOffset() is very expensive if offset is too large... If this can be optimized, I'd be happy though. But current code also wastes same amount about this, so, not problem for now. (If we can retrieve character rects until the end of the frame, we can reduce this call, I guess.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "So, I think that this should be GetCharacterRectsInRange(int32_t aOffset, int32_t aLenght, nsTArray<nsRect>& aRects). Then, offset can be increased with aRect.Length().",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "nit: s/qQueryTextRect/eQueryTextRect",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "It seems fine to add this API, but I think the implementation could be cleaned up so as to share code with GetPointFromOffset rather than duplicating it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "I guess returning a zero-sized rect is OK here, but wouldn't it make more sense to do the same thing as GetPointFromOffset to come up with a position? Maybe just call GetPointFromOffset to get the x,y coords, and then set width and height to zero. Or factor out a helper method?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "It seems like we should be able to share a lot of the code here with GetPointFromOffset. The two methods are basically doing the same thing, except that the CharacterRect version adds a lookahead to the next cluster so that it can get the advance. Maybe factor out the body of GetPointFromOffset into a helper that GetCharacterRectFromOffset can also call, and then it just needs to do the extra work to get the extent of the rect. Or have a shared helper that returns a rect, and takes a flag telling it whether we want the full rect (position and size) or only its position, which would allow an early return.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "I think that this also needs sr of smaug because you changes *.idl.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Move.h should be included before TextEvents.h (for a-z order). If you don't mind, could you move nsQueryContentEventResult.h after nsPoint.h?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40057/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 25,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40059/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 26,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40061/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 27,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40063/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40065/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40059/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 30,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40061/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 31,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40063/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 32,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40065/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 33,
                "quote": "The comment here needs to be updated now that you're getting a list of character rects in a range, not just a rect for a single offset.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "Please add a comment to clarify why aInOffset is passed as a reference here (as it seems unexpected); looks like it's being clamped to the content range by this method. It would be nice to pass aProperties as a const reference, so it's clearly an inparam only. I guess to do that, you'd need to pull the InitializeForDisplay() call out of this method and let the caller do it. Also, the \"Get...\" name seems a bit wrong, as the iterator was already created, this method is just changing its position. Maybe something like \"UpdateIteratorForOffset\"? And reorder the params so that aIter (the outparam result) is last, please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "Here as well, I think aIter and aProperties should both be const references. And the point can be returned as the function result rather than through an outParam.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "nit, extra space before * in 'int32_t * aLeft'",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "OK, but, although gfxTextRun::GetAdvanceWidth cannot be set as const function, we cannot use const aPropertyProvider on parameter.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40057/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 39,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40059/diff/3-4/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 40,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40061/diff/3-4/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 41,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40063/diff/3-4/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 42,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/40065/diff/3-4/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 43,
                "quote": "Hmm, that's too bad. It really should be a const method, but it looks like doing that would involve pushing the const-ness down through various subsidiary methods, and eventually providing both const and non-const variants of the GetCharacterGlyphs() accessor.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "I think that would be a good thing to do, but it turns into a big enough change that it's probably best done in a separate bug. I've filed bug 1282248 for this. With that, can we use more const here as well?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 45,
                "quote": "Humm.. It cannot... To use const as parameter, PropertyProvider::GetSpacing(...) must be const function. But PropertyProvider::GetSpacingInternal() wants to update mTabWidths on PropertyProvider::CalcTabWidths() and CalcTabWidths() adds tab width data to mFrame....",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1173001",
        "issue_id": 1173001,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is a necessary step towards having mirrored/canonical values, since those need to know the task queue in their constructor.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Part 2 - Fix up some task queue naming to make MediaDecoderReader consistent with MDSM. v1 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "This is going to need some tweaking.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "While at it, it would be great if the task queue constructor could be called on something else but the main thread. As it reads a preference to find out the size of the threads pool, this asserts when called on a thread other than the main thread.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "That seems like a good thing to fix, but I don't plan on doing it in this bug.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 6,
                "quote": "This will allow us to pass the borrowed task queue. It's also more explicit about the fact that we only support mp4 and (sort of) webm.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "This is a necessary step towards having mirrored/canonical values, since those need to know the task queue in their constructor.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Attached patch Part 3 - Fix up some task queue naming to make MediaDecoderReader consistent with MDSM. v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch Part 4 - Enable tail dispatch for the decode task queue. v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Why changing from private to protected?",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1033887",
        "issue_id": 1033887,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Disable the usage of try/catch in TestSTLWrappers.cpp with clang-cl \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "How are we getting WRAP_STL_INCLUDES set in this case? This code: http://mxr.mozilla.org/mozilla-central/source/configure.in#443 shouldn't let us get to the point where we're setting WRAP_STL_INCLUDES. Or is this another case where compiling with clang-cl bypasses the configury that tries to decide if we're compiling with clang?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I assume if clang-cl ever grows the necessary support, this check will be removed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "The point of this test and the STL wrappers is that the CRT is built with exceptions enabled, even when our code isn't. So in order to prevent C++ exceptions from leaking into code which is built without, we catch and abort. If we are using a clang CRT with no exceptions, then we need neither the STL wrappers nor this test. If we are using a clang CRT with exceptions, then we need the wrappers, but perhaps the test makes no sense and we should just not build it in this config. Either way, I don't think the patch here makes sense.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "There is no clang CRT involved here, we use the usual MSVC CRT headers and libraries. Specifically the same STL. My point was that setting _HAS_EXCEPTIONS=0 is the well known (and actually undocumented) way to get the Microsoft STL to not throw exceptions (that is, by #ifdef-ing throw statements out). So if I understand you correctly, this test is attempting to test whether that works? If that's the case, I still think this is a silly test as Microsoft won't be able to remove support for _HAS_EXCEPTIONS without breaking everybody that depends on it.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "(FWIW I'm fine with not taking this workaround and just falling back to cl.exe on this test, this is really not worth much debate! ;-)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Do not build TestSTLWrappers.cpp with clang-cl; r=bsmedberg \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=794507",
        "issue_id": 794507,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "When this bug is fixed, the patch in bug 788365 should be backed out.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 2,
                "quote": "It seems like the result of this bug is that any HTTPS AppCache-based site is indistinguishable from a site that has broken SSL (e.g. mixed content). On the B2G phone we show a crossed-out lock icon in the address bar instead of just the globe like we do on desktop. This makes HTTPS sites that use AppCache look like they're doing something wrong--including, in particular, the Mozilla Marketplace. (I haven't actually verified that this is the reason that the broken lock is shown for the Mozilla Marketplace when AppCache is enabled for it, but it seems very likely.)",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "Damn, I'm fast!",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Honza *is* fast! Note there is also this code in nsHttpChannel.cpp: // XXX: We should not be skilling this check in the offline cache // case, but we have to do so now to work around bug 794507. MOZ_ASSERT(mCachedSecurityInfo || mLoadedFromApplicationCache); if (!mCachedSecurityInfo && !mLoadedFromApplicationCache) { LOG((\"mCacheEntry->GetSecurityInfo returned success but did not \" \"return the security info [channel=%p, entry=%p]\", this, mCacheEntry.get())); return NS_ERROR_UNEXPECTED; // XXX error code } Any suggestions about how to handle previously-offline-cached data (data that was cached before this fix). The proposed fix looks very simple so we should uplift it to aurora and beta after it's been on central for a week.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "May be a bit drastic, but we could delete manifests loaded via https those don't have the security-info metadata from cache to force update. Since all items must have same scheme or same origin, we will reload only what we have to reload. On the other hand, this code (in comment 5) is harmless, so we can remove it in some very future version. Then, we should log to some console that the cache is obsolete or do the previously suggested thing.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Also, when we fetch the cache manifest, if the cache manifest itself doesn't have security-info then we should consider the cache manifest as having been updated, to force a refresh of the app.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I agree that it doesn't need to be removed right away and probably can't be, to avoid breaking things. But, the other things I suggest above are very important to do now.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Reported bug 833834 on that.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 9,
                "quote": "Great. I think it makes sense to split bug 833834, because we can land the patch in this bug for B2G 1.0 (I hope), whereas the changes in bug 833834 shouldn't be needed for B2G because B2G 1.0 won't have any old data without security-info if this lands before 1.0 is frozen. I hope we can land the patch on central soon so that Lee can test it out to make sure it solves the problem he reported.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "This can land to Aurora 20, and we'll approve in the 20+ b2g timeframe for v1.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 11,
                "quote": "Lee, could you please check the latest Firefox Nightly build and make sure the issue is fixed: http://nightly.mozilla.org/ Note that it may not be fixed for already-AppCached content. But, if you clear your appcache then newly-cached content should work.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 12,
                "quote": "Hi guys, Yes, I can verify that the nightly build has fixed that issue, thank you!!!",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1442559",
        "issue_id": 1442559,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Xidorn, you fixed this in bug 1333175. Any reason why this is failing again?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/224784/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/224784/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "We are not shipping unprefixed fullscreen in 60, so I don't expect it to become useless. There must be some other reason...",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "So the reason here is that the propName items added in bug 1441882 whitelists all warnings, and thus any whitelist item appended after them would be reported unused.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Sounds like bug 1441882 is basically making the whole whitelist meaningless. You can remove everything before the first {propName} item and the test would still pass.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "The reason is that function ignoredError would always return true if there is a whitelist item contains neither sourceName nor errorMessage.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "To avoid this kind of issue happens again, we probably should really add a catch all whitelist item and ensure that it never touched.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "https://reviewboard.mozilla.org/r/224784/#review230814 r- per bug comments that this isn't the right fix.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/224804/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/224804/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/224806/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/224806/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/224808/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/224808/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Nit: ```js return JSON.stringify(item, (key, value) => { return (value instanceof RegExp) ? value.toString() : value; }); ```",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Nit: add `because of whitelist item` to the string before dumping the whitelist item, please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Looks like this could also use `dumpWhitelistItem`?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Ditto. More generally, can you factor these 3 loops out into a function that just takes the whitelist in question as an argument, with perhaps an argument to use in the error message string to clarify which whitelist this came from - though if we use `dumpWhitelistItem` everywhere I don't think it'll be much of an issue figuring out what it is anyway.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "https://reviewboard.mozilla.org/r/224808/#review230844",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/224804/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/224806/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/224808/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "Backed out for eslint failure at /builds/worker/checkouts/gecko/browser/base/content/test/static/browser_parsable_css.js:474 Push that caused the failure: https://treeherder.mozilla.org/#/jobs?repo=autoland&revision=d540c55c96c5e4fdab1434032628fa876152b8e1 Failure log: https://treeherder.mozilla.org/logviewer.html#?job_id=165884240&repo=autoland&lineNumber=240 Backout: https://hg.mozilla.org/integration/autoland/rev/53f082b32ba9eb0b9febdc97373c89b9ac500bd3",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 21,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/224804/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/224806/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/224808/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 24,
                "quote": "6 failures in 831 pushes (0.007 failures/push) were associated with this bug in the last 7 days. Repository breakdown: * mozilla-beta: 6 Platform breakdown: * windows7-32-nightly: 1 * windows7-32-devedition: 1 * windows10-64-nightly: 1 * windows10-64-devedition: 1 * macosx64-nightly: 1 * macosx64-devedition: 1 For more details, see: https://brasstacks.mozilla.com/orangefactor/?display=Bug&bugid=1442559&startday=2018-02-26&endday=2018-03-04&tree=all",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 25,
                "quote": "Code analysis found 1 defect in this patch: - 1 defect found by mozlint You can run this analysis locally with: - `./mach lint path/to/file` (JS/Python) If you see a problem in this automated review, please report it here: http://bit.ly/2y9N9Vx",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "Error: 'whitelist' is already declared in the upper scope. [eslint: no-shadow]",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Code analysis found 1 defect in this patch: - 1 defect found by mozlint You can run this analysis locally with: - `./mach lint path/to/file` (JS/Python) If you see a problem in this automated review, please report it here: http://bit.ly/2y9N9Vx",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "Error: 'whitelist' is already declared in the upper scope. [eslint: no-shadow]",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Verified fixed with the latest central-as-beta simulation: https://treeherder.mozilla.org/#/jobs?repo=try&revision=dc0e79a9e1e17888ac8cebe43ae3bdaf1c7b4a57&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1254694",
        "issue_id": 1254694,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I wasn't able to reproduce with a new profile created in 44.0.2 and launching that in 45.0 but will test with a copy of my backup tomorrow.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Florian, any clue? Merci",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "This is likely a side effect of bug 1203167 (large search service refactoring that landed for Firefox 45).",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Florian, just passing on some information from JorgeV as others noticed this bug being flagged as well <jorgev> this should give you a rough idea https://addons.mozilla.org/en-US/firefox/search/?appver=45.0&atype=5 <jorgev> potentially millions <kev> yeah, don't know how many people change order of searches and/or use keywords \u2014 eviljeff suspects few of the former and very few for the latter <kev> same but should be evaluated, all the same <jorgev> also, it looks like the real current usage of these language packs is much higher than the average",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I can't reproduce, so there must be a detail or a step missing.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "One-line fix. I'll try to write a test.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Someone very helpfully emailed me the relevant parts of a profile that could reproduce the issue without lang pack involved. This profile contains lots of user-installed engines (42), and for some reason the synchronous initialization code path gets triggered. Turns out that code path isn't currently covered by tests, and had trivial mistakes.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Note: Surprisingly, the patch was developped against mozilla-release, but also applies cleanly to the current fx-team.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch Fix for engines from language packs, v2 (with test) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "OK, the loss of order and keywords happened before -- annoying but I have already made a txt list that helps me to restore it manually. However with this latest update (v45.0) I cannot even edit the keywords! There's no option for that. Extremely annoying as I do a lot of research and use them hundreds of times every day. How is this related to a language pack anyway? I am using English Mozilla.. I think I only have additional Russian spell-checking dictionary installed. Florian, can I use the fixes you provided and how?",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 11,
                "quote": "https://hg.mozilla.org/integration/fx-team/rev/eed38188ee0ef70c90db4767dd614508a1a9042c Bug 1254694 - Fix synchronous code path for search engines metadata migration, r=adw. https://hg.mozilla.org/integration/fx-team/rev/0837015740ff57ed9c40a6733987f437985b9d9b Bug 1254694 - Fix search engines metadata migration for engines from language packs, r=adw.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Fix a migration issue, taking it on all branches.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 13,
                "quote": "We should perform further Exploratory Testing around this scenario.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 14,
                "quote": "I. Initial Scenario: Using steps from comment 1 and referring only to the update scenario which breaks search settings. 44.02 (update to) 45.0 44.02 (update to) 45.0.1 45ESR (update to) 45.0.1 ESR Windows10 -> reproducible Mac -> not reproducible Ubuntu -> reproducible The update/migration bug can be verified fixed on WINDOWS and UBUNTU for 45.0.1, 45.0.1 ESR with the note that (comment 1) wasn't reproducible on MAC. II. What I noticed for all OS'es was that installing the language pack and setting the \" general.useragent.locale to 'de' \", then just restarting FF was causing the search engines settings to break. (behavior reproducible for 44.02, 45, 45.01, 45.01ESR) I also went back a bit and checked if I. and II. scenarios are reproducible for older releases: 42.0 and 43.0.1 with the following result: I. No II. Yes. Please advise if scenario II. should be split up into a separate issue.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 15,
                "quote": "What I noticed for all OS'es was that installing the language pack and setting the \" general.useragent.locale to 'de' \", then just restarting FF was causing the search engines settings to break. (behavior reproducible for 44.02, 45, 45.01, 45.01ESR)",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 16,
                "quote": "I agree that the scope of this bug was to track and fix the version update issue that was ruining the search settings. In regards to it, the fix can be marked as verified; I can also confirm that the bug does not regress on build 2 for 45.0.1 ESR: 45.0.1 Build-ID 20160316151906 User-Agent Mozilla/5.0 (Windows NT 10.0; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0 45.0.1Build-ID 20160316151906 Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0 45.0.1 Build-ID 20160316151906 User-Agent Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:45.0) Gecko/20100101 Firefox/45.0 Adding the above to comment 34 /point I., we can mark this issues as verified on: Ubuntu14.04/Mac10.11/Windows10 for Release 45.0.1 and 45.0.1ESR (build1+build2)",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1203253",
        "issue_id": 1203253,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This adds back the tests that shouldn't have been removed. All tests pass except for browser_cookies_exceptions.js, which as a weird failure at line 66, where params.tree.view is undefined for some reason that I can't pinpoint. Any ideas, Matt?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "All tests pass except for browser_cookies_exceptions.js, which as a weird failure at line 66, where params.tree.view is undefined for some reason that I can't pinpoint. Any ideas, Matt?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "All tests pass except for browser_cookies_exceptions.js, which as a weird failure at line 66, where params.tree.view is undefined for some reason that I can't pinpoint.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "this change can be removed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Gijs, do you have any idea why the browser_cookies_exception.js test is failing at the line annotated with \"Test failing with params.tree.view is undefined, see bug XXX\"",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Gijs, do you have any idea why the browser_cookies_exception.js test is failing at the line annotated with \"Test failing with params.tree.view is undefined, see bug XXX\" The original test doesn't fail here. Try push, https://treeherder.mozilla.org/#/jobs?repo=try&revision=09e8e1eb849e",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Discussed on vidyo - failures because of the permission manager observer that nukes the tab before the test finishes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Thanks for your help in debugging the test failure over Vidyo. The permission observer was fired while the test was running, and the permission observer was set up to close the preferences once it had been hit. Since test case #5 adds a permission during the test run using the permission manager, the permission observer is ran before the test has completed. This caused the tab to close and thus the tree.view getting destroyed. In the old version of the prefs, the dialog's window.close() was either being done async and/or the references to the dialog within the test kept the window alive long enough to continue the test. However, the test was still written as a no-op since the permission observer was supposed to call cleanUp which would remove the newly added permission causing the rows to be empty at the following check anyways. But... cleanUp() wasn't called, because the permObserver had a typo that was checking for `cleanup`, not `cleanUp`. This is all fixed now.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "nit: doc, (don't need to repeat a local variable name if the property has the same name)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Backed out for bustage: https://treeherder.mozilla.org/logviewer.html#?job_id=4819315&repo=fx-team https://hg.mozilla.org/integration/fx-team/rev/cb4bff637489",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 11,
                "quote": "https://hg.mozilla.org/integration/fx-team/rev/ee1649a0952f",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "The previous landing of the patch for this bug had two issues with the browser.ini changes. In both instances, the 'skip-if' line was not kept adjacent to their associated test, causing browser_change_app_handler.js to run on non-Windows platforms (as well as browser_healthreport.js).",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 13,
                "quote": "I backed that out in https://hg.mozilla.org/integration/fx-team/rev/c6d706919dd2 for bustage https://treeherder.mozilla.org/logviewer.html#?job_id=4839107&repo=fx-team",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 14,
                "quote": "https://hg.mozilla.org/integration/fx-team/rev/3db46f5d82cc",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Test-only change; ok to uplift to aurora.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=894931",
        "issue_id": 894931,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This regressed between 5976b9c673f8 and 0888e29c83a3 (yesterday's and today's build), changesets: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=5976b9c673f8&tochange=0888e29c83a3",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Some further testing: Build from this revision http://hg.mozilla.org/mozilla-central/rev/5f79304fcefe is still fine, this one http://hg.mozilla.org/mozilla-central/rev/fd10ead17ace is broken => http://hg.mozilla.org/mozilla-central/rev/fd10ead17ace is to \"blame\", it's a birch to mozilla-central merge.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Some further testing: Build from this revision http://hg.mozilla.org/mozilla-central/rev/5f79304fcefe is still fine, this one http://hg.mozilla.org/mozilla-central/rev/fd10ead17ace is broken => http://hg.mozilla.org/mozilla-central/rev/fd10ead17ace is to \"blame\", it's a birch to mozilla-central merge.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 4,
                "quote": "Got it: Regression between http://hg.mozilla.org/integration/mozilla-inbound/rev/3d33faf4d81f and http://hg.mozilla.org/integration/mozilla-inbound/rev/e8bf739addfa => Bug 868498",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 5,
                "quote": "roc, see bug 868498 comment 47. The assertion fix there is causing this regression. Would you happen to know a way to work around this?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "roc, see bug 868498 comment 47. The assertion fix there is causing this regression.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "I believe Huffington Post is also affected by this bug. The \"Most Popular\" column is rendered on top of the logo, navigaton bar and the top story, making it impossible to click on some sections on the site.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "You're right, I checked with the two m-i builds. IMHO quite questionable if this patch can stay on trunk/aurora/beta when there is no fast workaround for this.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Looks like this is a bigger issue than first thought. roc, I'm setting this patch to r? although you may have a better way to fix this. It turns out that we don't need to move the z-index rule. The position rule is all we need to get the correct behavior when switching scrollbar styles. The position rule seems to only affect overlay scrollbars, so maybe this is safe to do?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "This patch isn't correct because it changes the z-ordering of scrollbars.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "I know what the bug is. The bug is that we need to reframe when transitioning from position:static to position:relative if there are position:absolute descendants, because they need to change their containing blocks to be the new frame.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "I can't think of an easy, beta-safe fix right now. I think we're going to have to pull disappearing scrollbars from beta, sorry :-(.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 13,
                "quote": "Okay, thanks roc! Let's use this bug to revert the assert fix in m-c, aurora and beta. I'll file a separate bug to turn off overlay scrollbars in beta.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "If this breaks the tree in any way, please back out the other patch from bug 868498.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "Attached patch test \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Maybe use padding-top on the outer div to avoid having to worry about whether margin collapsing makes the test pass in the failure case anyway (given some future margin collapsing changes, at least)?",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=811773",
        "issue_id": 811773,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "There are various ways we may be able to de-footgun this, but as a backportable fix maybe it makes sense to just manually clear these JS fields in Unlink.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "The latter two patches in bug 811206 should have fixed this. We'll get fatal assertions if the code isn't right. Closing",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 3,
                "quote": "Andrew, if you disagree, please re-open.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "It would probably be good to backport at least the bits of the final patch that fix things.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "While writing the patch for bug 811206 I didn't see any sg;crit problems.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1373249",
        "issue_id": 1373249,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/149476/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/149476/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "https://reviewboard.mozilla.org/r/149476/#review161082",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=687754",
        "issue_id": 687754,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attribute should not reset when in _previewMode. Added patch to fix both",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Can \"unread\" state be set on DOMTitleChanged as well? DOMTitleChanged means another kind of \"unread\", doesn't it? Plus it will avoid the inconsistency between the first tab and other tabs.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Move it lower to be parallel to removeAttribute(\"titlechanged\").",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "'unread' is indicating a new/reloaded document in a tab that is not selected. DOMTitleChanged doesn't necessary indicates a new/reloaded document and fires on selected tabs too. Some JS in a document could for example change the title every few seconds. You see the difference? The attachment is fixing the inconsistency between the first and the following tabs. It was caused by the different handling of those tabs by the tabbrowser itself. Now all tabs get the unread attribute after they finished loading the document. A selected tab will not have that attribute. Example of use of 'unread' in userChrome.css: /* set color for unread (and not selected) tabs to blue */ .tabbrowser-tab[unread] { color: blue ! important; } If you additionally want the same coloring while a document loads and if the title has changed, you can add that to the css selector. Watch out that 'busy' and 'titlechanged' both need the additional not(selected).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "A little cleaner and better fitting into the latest code change",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "If Gmail changes its title in background, I'm sure it should be marked as unread. If some JS changes the title indeed, it must indicate that there's something new, otherwise it could be a fault.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "- unread points to the document in the tab - titleChanged points to the title of the document in the tab If Gmail has reloaded the page, I agree and would wonder if it wouldn't be marked unread. If Gmail only changes the title on an already read page, you can mark that easy with .tabbrowser-tab[titleChanged] I wouldn't like to see a tab marked unread after I did read it, only because the page likes to circle through a couple of headlines in the title. I prefer to differ between page title and the page itself. So you have the choice to mark the tab depending on which one you want and how. Give the user a chance to decide what he wants. If you want both marked the same way, you can do it for example like this: /* set color for titleChanged and unread (and not selected) tabs to blue */ .tabbrowser-tab[unread], .tabbrowser-tab[titleChanged] { color: blue ! important; } You can even mark the case of a changed title on an already read tab differently (i.e. red). Or you could use the text color for one case and the background color for the other case. The user has the choice.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "We don't need these comments, they just read out the code.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Backed out since this contained a typo (mismatched brackets) that completely broke Firefox.",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 10,
                "quote": "this contained a typo (mismatched brackets) that completely broke Firefox.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 11,
                "quote": "Comments deleted, typo corrected",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "It would be better to place removeAttribute(\"unread\") here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "I think I have answered that before in comment #6. \"titlechanged\" /= \"unread\" Basically \"unread\" says 'page is loaded from network in background' and removed as soon as the tab is selected. It is not and should not been connected to the title. \"titlechanged\" has it's own logic when it is set and removed. You will have some overlapping but that is all. \"titlechanged\" might come without \"unread\", but it's nothing that \"unread\" has to worry about. \"unread\" tells you if you have selected (unread/read) a tab after a page was loaded from the web. \"titlechanged\" tells you if the title of a tab has changed (no matter what caused it). To move removeAttribute(\"unread\") down to where you suggested means, to put it after several ProcessListeners are started and than into or after the patch of bug 540248 (related to titlebar). To remove unread right after selecting a tab (selected -> read) and than let the ProcessListeners get called seems the far better choice to me. You have the chance to let both attributes lead to the same marking of the tab, like you want to. Others like me don't like that and can handle them separate or ignore \"titlechanged\".",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "a) Maybe switching lines > this.mCurrentTab = this.selectedTab; > if (!this._previewMode) > this.mCurrentTab.removeAttribute(\"unread\"); > this.showTab(this.mCurrentTab); to > this.mCurrentTab = this.selectedTab; > this.showTab(this.mCurrentTab); > if (!this._previewMode) > this.mCurrentTab.removeAttribute(\"unread\"); if that seems more convenient. This would still keep it right were the tab gets selected and viewed, the reason why \"unread\" is getting removed. It's a clear chain of commands that are logically tight connected to each other. Like removing \"busy\" leads to setting \"unread\" (if not selected). Easy to understand and maintain. b) I can't guarantee the Listener calls do not lead to (rare) cases where \"unread\" wouldn't be removed. Is there someone able to guarantee that for now and in the future? Why even take that risk? At this point in code the tab is already selected and shouldn't have the attribute anymore. c) After those Listeners we have the code block that handles fastFind and TitleBar if not in _previewMode. The only connection I can see here is _previewMode. Does it really make sense to move it down 40+ lines to save a single 'if' and at the same time loosing the easy logical understanding of why it has to be removed (selected/viewed => read) plus wondering if those Listener calls might at some point cause something related to removing \"unread\" we haven't thought of right now. If those arguments don't catch, we can even try to move it down another 30+ lines to the TabSelect events where the _previewMode is handled too and test it there.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "fastFind and TitleBar are even less related. So using the 'if (!this._previewMode)' of the TabSelect block makes more sense if we want to move it down to save a separate 'if' for removing the attribute. Anyway. To make some progress I am going to split the patch into 2 parts: Part 1: Only set unread when busy is removed Part 2: Don't remove unread in preview mode (fix on old position) Part 2 alternate: Don't remove unread in preview mode (moved down to use existing if) This way part 1 can get applied and you can choose (or we can discuss further) which one of part 2 is better. After the fixes did land in mozilla-central, we should take care they are getting in aurora too before FF9 moves to beta.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 16,
                "quote": "Fixes the different times \"unread\" is set in tab 1 and tab 2+",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "Fix on old position",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Alternative version; moved down to use existing if",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Please move this to the earlier !this._previewMode section. It doesn't matter that it doesn't correlate with the other pieces there, as those pieces don't correlate with each other either.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Additionally moved leading comment into the 'if' to avoid confusion with that other patch.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "just remove this comment",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "Attached patch Don't remove unread in preview mode (final) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "This feels like a bug with low user impact that can wait until 10 ships. If there's some large number of users having a really bad experience can you please explain that and re-nominate.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "This feels like a bug with low user impact that can wait until 10 ships. If there's some large number of users having a really bad experience can you please explain that and re-nominate.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1187966",
        "issue_id": 1187966,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Looks like GTK3 fallout?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "I mucked around with this on a dev slave and managed to get it working. Since we only need xpcshell and not a fully functional browser context, I was able to download the gtk3 tarball via tooltool and then get the periodic_update script working by setting the LD_LIBRARY_PATH.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "We inherit the env so we can make use of TOOLTOOL_CACHE.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "xpcshell requires gtk3 now, so we download it via tooltool and then set the LD_LIBRARY_PATH.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Here's the job output from these changes running in dry-run mode (-n) in staging. The script returns 2 in dry-run mode if there are updates which is why it's marked as failed.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "Set the env for periodic file update jobs.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Download gtk3 for periodic update script",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "I kicked off a build and it succeeded. Here's the treeherder job triggered by the updates: https://treeherder.mozilla.org/#/jobs?repo=mozilla-central&revision=23e525e2ba35",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1142350",
        "issue_id": 1142350,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Ah, good call. Maybe we can move it to c-c and remove it from m-c.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I will look into moving this code to c-c, but if that fails, I will just remove the code from m-c.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "The code is used in comm-central, but is unused in mozilla-central. It will be imported into comm-central in Bug 1297368. Review commit: https://reviewboard.mozilla.org/r/80070/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/80070/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Awesome - r=me.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1057903",
        "issue_id": 1057903,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Here's the patch. In addition to the switch to DrawableFrameRef there are a lot of small style and code quality issues fixed here, including a consolidation of the various GetImgFrame/GetDrawableImgFrame/etc methods which were mostly useless (and all needed to be touched in this patch anyway).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Shouldn't this go if (!frameRef) { ForceDiscard(); WantDecodedFrames(); if (aFlags & FLAG_SYNC_DECODE) { return CopyFrame(aWhichFrame, aFlags); } } We have the same logic in GetFrame, so same comment for GetFrame.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "This goes from asking for a decode to not asking for a decode, is that okay?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This if is now checking if we can get a drawable ref to the frame, before it was checking if we could get an imgFrame (even if it's buffer had been thrown away). So I think the comment is wrong and you need the force discard want decoded frames dance here that you remove below.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Regression testing points to this patch drawing the top portion of tabs lower on the tab.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 6,
                "quote": "Opened up Bug 1067207",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 7,
                "quote": "Problem might be a different patch. See Bug 1067207 for more info.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "There's pretty much no chance it's this patch, since this patch doesn't touch SVG drawing and the tabs are SVGs. I think the other patch you suggest in that bug is much more likely.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "Actually I was wrong about this; the tabs are now PNGs, not SVGs, so this patch is the culprit.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "So I think this is the problem: we're computing the padding based upon the rect of the final frame, but it actually needs to be computed based upon the original, unscaled frame.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "So I think this is the problem: we're computing the padding based upon the rect of the final frame, but it actually needs to be computed based upon the original, unscaled frame.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=768901",
        "issue_id": 768901,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Looks like nsCSSStyleSheet::SizeOfIncludingThis assumes that it owns its mInner. In fact multiple style sheets can share an mInner (which is then copy-on-write if there are multiple owners) -- that's why there's a sheet vs. inner separation.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "(It should probably just check if it is the inner's mSheets[0].)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "So nsCSSStyleSheetInner::mSheets holds pointers to each of the nsCSSStyleSheets that share the inner? I see. There will be a bit of arbitrariness in terms of who gets blamed for the memory consumption of the inner, but that seems hard to avoid and double-counting is worse.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This simple patch follows dbaron's suggestion. It removes all of DMD's double-counting warnings for both (a) the two-window desktop browser case, and (b) B2G. Hurray.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "s->mInner in the if condition, as long as we're using \"s\" everywhere here, and r=me",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Maybe a followup bug on that?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 7,
                "quote": "And definitely a followup on memory-reporting those hashtables in the loader, please!",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 8,
                "quote": "Bug 799796.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 9,
                "quote": "Can you file that bug? I don't understand the idea enough to write something sensible.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Can you file that bug?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 11,
                "quote": "Filed bug 799816.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 12,
                "quote": "Approving for aurora as it is low risk and help understanding memory consumption better",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=714547",
        "issue_id": 714547,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Luke, could the scope chain changes be responsible? Nominating, since this seems like something we need to fix before ship...",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Regression range: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=ccea01542d0b&tochange=e0ae39a3298e",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Luke, we're getting a SecurityWrapper<CrossCompartmentWrapper> here. Its objectClassIs implementation is this: 868 template <class Base> 869 bool 870 SecurityWrapper<Base>::objectClassIs(JSObject *obj, ESClassValue classValue, JSContext *cx) 871 { 872 /* Let ProxyHandler say 'no'. */ 873 bool ret = ProxyHandler::objectClassIs(obj, classValue, cx); 874 JS_ASSERT(!ret && !cx->isExceptionPending()); 875 return ret; 876 } ProxyHandler::objectClassIs just says \"no\". 344 bool 345 ProxyHandler::objectClassIs(JSObject *proxy, ESClassValue classValue, JSContext *cx) 346 { 347 JS_ASSERT(OperationInProgress(cx, proxy)); 348 return false; 349 } What gives here? Should SecurityWrapper be asking Base::objectClassIs, maybe? I'm having difficulty understanding when it could ever be correct to call ProxyHandler::objectClassIs, honestly, with the semantics it implements.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This is technically working by design: a SecurityWrapper is not supposed to expose information about cross-domain objects. Actually, from discussions with mrbkap, I thought it wasn't supposed to be possible for vanilla JS objects to be exposed cross-domain (but rather a select few things like Window, Location, etc), though clearly I'm wrong.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "This is technically working by design: a SecurityWrapper is not supposed to expose information about cross-domain objects. Actually, from discussions with mrbkap, I thought it wasn't supposed to be possible for vanilla JS objects to be exposed cross-domain (but rather a select few things like Window, Location, etc), though clearly I'm wrong.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Hah, I almost added a \"Is there some document.domain afoot here?\". Thanks for the explanation Blake. Would a more immediate fix (than c-p-g) be for FilteringWrapper to override objectClassIs and then provide an exception for AccessCheck::documentDomainMakesSameOrigin?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "This would definitely fix this bug",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "However, your question isn't the situation we have: our assumption is that these SecurityWrapper'd objects are only being exposed in document.domain situations (where it is ok for them to be transparent). So, for that reason, I'm happy to neuter SecurityWrapper as a quick fix. But it seems like, when we tighten up the document.domain situation after c-p-g, we'll want the proposed fix in comment 7.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "As discussed above, this patch just let nativeCall/objectClassIs pass through.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Either this or actually checking document.domain work for me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Nit: let's -> lets.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Could you file a followup depending on the cpg bug, so we don't lose track?",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 13,
                "quote": "Is this still a major concern for Firefox 10 (web/add-on compatibility)? If so, please nominate for aurora/beta approval ASAP. We're cutting our second to last beta today.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 14,
                "quote": "[Triage Comment] Breaking websites - let's get this in for our second Beta on Tuesday. Approved.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 15,
                "quote": "This is verified fixed on FF 11b3: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0) Gecko/20100101 Firefox/11.0 Mozilla/5.0 (X11; Linux i686; rv:11.0) Gecko/20100101 Firefox/11.0 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:11.0) Gecko/20100101 Firefox/11.0 But still an issue on FF 10.0.2 ESR: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0.2) Gecko/20100101 Firefox/10.0.2 Mozilla/5.0 (X11; Linux i686; rv:10.0.2) Gecko/20100101 Firefox/10.0.2 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:10.0.2) Gecko/20100101 Firefox/10.0.2",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 16,
                "quote": "Actual results: [object Array] of length 2: [\"one\",\"two\"] [object Array] of length 2: [\"one\",\"two\"] Verified fixed on FF 10.0.3 ESR on Win 7, Ubuntu 11.10 and Mac OS X 10.6.8",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=659018",
        "issue_id": 659018,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "When the inbox is refreshed in Thunderbird and the number of unread messages changes, the inbox label (and consequently the name of its accessible) changes, but a property-changed::accessible-name is not fired. This causes problems with Orca and AT-SPI2 since AT-SPI expects to receive the event and continues to read the old cached value (unless AT-SPI 2.0.2 or later is used and setCacheMask is called to disable caching of the name--I plan on proposing that Orca do this for now as a work-around). As I was testing, I saw the property-changed event being fired when I had the setCacheMask work-around in place but not when I did not have it included, so either this only happens sometimes or the event can be triggered somehow (perhaps calling atk_object_get_name on the accessible triggers the event). I'm marking this as \"happens sometimes\" since I'm not entirely sure which is the case.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "I think we are not handling nsIAccessibleEvent::EVENT_NAME_CHANGE on the atk code.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "atk_set_name() sends the proper event for us, so on a name change event we can just see if the name has actually changed and if so set it causing atk to send the signal for us.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "does it really make sense to check whether name weren't changed? I'd guess this can happen iff atk name was requested before we handled the event. Do you handle this case?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "ok, r=me",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=596726",
        "issue_id": 596726,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Seems to be WFM on Trunk on WinXP (Mozilla/5.0 (Windows NT 5.1; rv:2.0b6pre) Gecko/20100913 Firefox/4.0b6pre ID:20100913041656).",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "This has been fixed on trunk by some of the patches that I landed as part of the work in bug 240933.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=554061",
        "issue_id": 554061,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Customize Toolbar and Done, make them into the normal state",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Yes Alice that is true, but you have to do it everytime you restart Minefield.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "This just showed up in shredder too. Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.3a4pre) Gecko/20100322 Shredder/3.2a1pre",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "I'm not sure what to do here. We don't restyle the document because HasDocumentStateDependentStyle doesn't find the :-moz-window-inactive rule because it's in an XBL stylesheet. For normal content state changes we can inspect XBL stylesheets because we can get the binding from the content node (in nsBindingManager::WalkRules), but when the document state changes we only have the root node and no way of getting to the right binding. Does this mean we'll have to iterate over the whole content tree whenever the document state changes?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "Does this mean we'll have to iterate over the whole content tree whenever the document state changes?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "View Source window is also affected and exhibits the same behavior.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "It seems like we'd only have to iterate over all XBL binding style sheets in the document... and that the binding manager itself could coalesce all the document state bits into one for all of them. We'd probably need a different WalkRuleProcessors mechanism to do this, though.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Attached patch v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "r=dbaron",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Verified fixed in Shredder 3.2a1pre and SeaMonkey 2.1a1pre nightly builds.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1462624",
        "issue_id": 1462624,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": ":Mardak Please look for reducing installer size increases, caused by bug 1462427.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "I'm going to make an assumption here that this is caused by https://github.com/mozilla/activity-stream/commit/c132f298c64b3e357d8a492e77299fcf2c3c25fa bug 1448918 and it should be expected.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "About 80KB-82KB of that can be accounted for by images added in https://github.com/mozilla/activity-stream/commit/c132f298c64b3e357d8a492e77299fcf2c3c25fa, and likely the rest by the code changes.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 4,
                "quote": "In addition, https://github.com/mozilla/activity-stream/commit/49d13ab4dfd6c549bf9672c61e92ff69cac88512 for bug 1432676 added about ~67KB for illustrations for the new onboarding tour, which should also be expected",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 5,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/238c2caac25d",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1271750",
        "issue_id": 1271750,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I can still able to reproduce this with version 2.4.11. But it is no more reproducible with the addon's latest version,3.0.7.",
                "code": "REPRODUCTION_ATTEMPT"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1529006",
        "issue_id": 1529006,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Base on your suggestion I work out this patch, I use IgnoreGCPolicy to prevent calling 'trace' on the objects(ImmediateMetadata and DelayMetadata)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "can you help to check is this correct?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "Oh, I hadn't thought of that approach. I was thinking of allowing Rooted<Variant<...>> to contain untraceable types. But come to think of it, your approach seems good -- it keeps the exception localized to types involved. So I'm going to mark this feedback+ from me because I think it's a good approach, but I want to check with jonco for which one he thinks is better. I'll attach a sample patch with the approach I was originally thinking of.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch allowing untraceable variant types \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "I like this approach, it's simple and it's obvious what's happening. Steve's approach is more general though. I guess we'll see how often we need this - if it turns out to be a lot we can shift to the other approach, but for now I'd say let's go with this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "We generally trace roots such as these manually rather than using PersistentRooted everywhere. Can you keep this as is and call GCPolicy<NewObjectMetadataState>::trace in Realm::traceRoots()?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Patch v2 (obsolete) \u2014 Details \u2014 Splinter Review addressed Jonco's comments",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Great! r=me with the changes below.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "We should be able to remove the inheritance from CustomAutoRooter now, and the empty trace() method below.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "removed inherit from CustomAutoRooter",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1493860",
        "issue_id": 1493860,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Consequences of \"null becomes empty dictionary.\" Will do these incrementally... starting with the easy one. ## Payment Request With: ``` PaymentDetailsModifier{ PaymentItem total = null; } ``` Would break, `PaymentItem` has `required` members `currency` and `item`. Those members can't be defaulted, unfortunately. ## dictionary PaymentDetailsUpdate With the following change: ``` dictionary PaymentDetailsUpdate : PaymentDetailsBase { AddressErrors shippingAddressErrors = null; PaymentItem total = null; } ``` Setting `shippingAddressErrors` to null is fine, however. However, setting `total` to null would break for the reasons give above about `PaymentItem`.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "## Audit of Web Authentication / Credential Management 1) Should the \"= null\" stay? This is bug: https://github.com/w3c/webauthn/issues/750 And yes, it should stay. Also with the fixes in #750. The spec needs to be updated to deal with \"challenge\" being null, as well as some other values being nulled. Git blame says ask @qdot :) What happens if `mChallenge` is passed as null in `dom/webauthn/WebAuthnManager.cpp`? I'm guessing it's all good, as you reviewed bug 1368949?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "## Audit of Push API The IDL is out of date! The proposed change was: ``` dictionary PushSubscriptionJSON { PushSubscriptionKeys keys = null; } ``` In the latest spec, it is now: ``` dictionary PushSubscriptionJSON { record<DOMString, USVString> keys; } ``` This one doesn't matter. It's the result of a PushSubscription.toJSON(). @lina, I couldn't find a bug to update the IDL to match latest spec.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "We now need to deal explicitly with `total`s PaymentCurrencyAmount... I don't think suggesting defaults to the Working Group for `currency` and `value` wouldn't got down well.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "So one complication: it's not clear to me that the \"= null\" thing is valid IDL given the current state of the IDL spec. It works in Gecko, and I think having it work in the IDL spec would make some sense, but it's not clear that it does right now. For WebAuthn, I'm not sure whether they decided to allow a missing challenge or to stick with the challenge being required. Needs to get sorted out...",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "My understanding of the WebAuth issue is that null is a valid Buffer value. So even requiring it, a developer can legally pass null (and the spec doesn\u2019t seem to deal with that).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "If null becomes an empty dictionary, then it works just fine because it means one less check. But yes, checking \u201cis present\u201d works, then walk the members that are present (if any).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "It's definitely required, may not be null [0], and if we reach one of the places we copy Challenge [1][2] then badness could ensuse. Best case scenario is an untrustworthy webauthn session. Doing this on current nightly, presumably with bug 1368949, still yields",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "but I would guess we need to check each parameter on the way into the function now rather than rely on the webidl checks?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 10,
                "quote": "Regarding the challenge field in particular, I filed Bug 1494738 to do something for the last sentence of [0].",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 11,
                "quote": "Right, because I explicitly kept the old behavior pending someone who knows webauthn looking at it. What you can do is remove the \"= null\" bits from WebAuthentication.webidl and then fix the resulting compile errors in whatever way the spec says that stuff should work. Assuming it says.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Thanks, I've opened bug 1497351 to fix the WebRTC parts.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 13,
                "quote": "Hi Marcos, I'm so sorry for the delay in getting back to you! I filed bug 1497427 to capture the work to update the Push API; bug 1497429, bug 1497430, and bug 1497431 are for the IDL bits. Unfortunately, I don't have cycles to work on them. :-(",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 14,
                "quote": "The remaining bug for Push is tracked by https://bugzilla.mozilla.org/show_bug.cgi?id=1497427, so closing this.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1486218",
        "issue_id": 1486218,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "There are 2 crashes (from 1 installation) in nightly 63 with buildid 20180824222409. In analyzing the backtrace, the regression may have been introduced by patch [1] to fix bug 1485691. [1] https://hg.mozilla.org/mozilla-central/rev?node=4a57ba156ecf",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "This will most likely be fixed by https://github.com/servo/webrender/pull/3331 when it lands in Gecko.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1479989",
        "issue_id": 1479989,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Disable BigInt variants of tests disabled due to bug 1317416.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Disable BigInt variants of tests disabled due to bug 1317416.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Thanks!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Disable BigInt variants of tests disabled due to bug 1079853, bug 1129202, or bug 1317416.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1441779",
        "issue_id": 1441779,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This patch adds nsTArray::RemoveLastElement() and nsTArray::PopLastElement().",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "With tests, too! Yay! Please file a followup to replace the appropriate `RemoveElementAt` calls with this new API. Thanks!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Please file a followup to replace the appropriate `RemoveElementAt` calls with this new API. Thanks!",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 4,
                "quote": "I think that we want to `mozilla::Move(LastElement())` here, so we're not copying unnecessarily, and so we can support move-only types.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/224280/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/224280/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/223782/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Good catch!",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1435456",
        "issue_id": 1435456,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Looks like the same reason as bug 1434935, so not introduced by what Andrew landed today.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Agreed. Given it is a live pref and can nominally change at any time, I think we can just take out the assert.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I think we can just take out the assert.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Fix all the broken windows! :)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "I was thinking the same thing, then I thought about it more. All image decodes should be finished when the reftest finishes. and we haven't seen this failure for years, so why are we seeing it now?",
                "code": "PROBLEM_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1435264",
        "issue_id": 1435264,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I'm pretty sure this is fixed by https://github.com/jcjones/webauthn.bin.coffee/commit/c21d5be2a739b2b061d3ce580eb4aeb069fb7765.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1430012",
        "issue_id": 1430012,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "After some investigation, the root cause should be that the \"key-up\" event is sent to the restored tab, then causes its document activation.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "When investigating bug 1427984, I found that most browsers (Chrome, Firefox, Safari) fire keyup at the switched tab when the key sequence changes the current tab. I don't think this is a problem.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "For this use case, maybe we could handle the autoplay permission when keydown like other functionalities (e.g. ALT+N to switch tabs, ALT+F4, CTRL+SHIFT+K to open inspector). Or we could ask UX for some suggestions.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "I learned from Alastor that keydown as suggested in comment 3 works well for him.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "We switched to acitvating in keydown in Bug 1456037.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1410565",
        "issue_id": 1410565,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "INFO: Last good revision: aecaa85bb1d9d8b7d2cbd9ab84eb6dbc0ed9eee8 INFO: First bad revision: 4e892b27c2f112e61a74d1bd75cc1d73ff91e2b2 INFO: Pushlog: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=aecaa85bb1d9d8b7d2cbd9ab84eb6dbc0ed9eee8&tochange=4e892b27c2f112e61a74d1bd75cc1d73ff91e2b2",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/192396/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/192396/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/192398/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/192398/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "https://reviewboard.mozilla.org/r/192396/#review197802",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "https://reviewboard.mozilla.org/r/192398/#review197804",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/192396/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/192398/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1403319",
        "issue_id": 1403319,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/184124/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/184124/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Andre, can you take a look? The proposal reached Stage 4 so I'd like to expose it soon. Also, it would help a lot with our tooling if you could pick a `[:abargull]` or similar nick for bugzilla and MR when requesting reviews from you ;)",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "We should now be able to run all NumberFormat.formatToParts tests from test262, so these exclusions should be removed <http://searchfox.org/mozilla-central/rev/f54c1723befe6bcc7229f005217d5c681128fcad/js/src/tests/jstests.list#363-368>, too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Looks like `NumberFormatFormatToParts` and `formatToParts` can both now also be removed from vm/CommonPropertyNames.h.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "`typeof(newGlobal)!==\"function\"` can also be removed now.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/184124/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1386502",
        "issue_id": 1386502,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Jim, is this a known issue? Could you suggest how should I workaround here? I'm not sure why this doesn't break anything on CI, probably because CI doesn't run reftest and crashtest on Windows 10?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "If it's content sandboxing related, maybe some permutation of the env vars to disable can be used as a workaround? https://wiki.mozilla.org/Security/Sandbox#Debugging_Features",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "I'm hitting this on Linux as well. In my case, I see this logging right after the reftest canvas window (& focus-stealing tiny-window) appear: ========== Chrome file doesn't exist: /scratch/work/builds/mozilla-inbound/obj/_tests/reftest/reftest/chrome/reftest/content/reftest-content.js [Child 27730] WARNING: NS_ENSURE_SUCCESS_VOID(rv) failed with result 0x80520015: file ../../../mozilla/dom/base/nsFrameMessageManager.cpp, line 1618 JavaScript error: file:///scratch/work/builds/mozilla-inbound/obj/dist/bin/browser/components/nsBrowserGlue.js, line 993: TypeError: win is null [Parent 27603] WARNING: attempt to modify an immutable nsStandardURL: file /scratch/work/builds/mozilla-inbound/mozilla/netwerk/base/nsStandardURL.cpp, line 1807 [Parent 27603] WARNING: Failed to retarget HTML data delivery to the parser thread.: file /scratch/work/builds/mozilla-inbound/mozilla/parser/html/nsHtml5StreamParser.cpp, line 977 And then it just sits there doing nothing.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "I'm slowly narrowing in on a regression range on my linux box, with \"hg bisect\" + rebuild + ./mach reftest. In my current \"guilty\" range, bug 1308400 (which tightened the sandbox on linux) is looking most-likely-suspicious. (I assume Windows would have a somewhat different regression cause, since bug 1308400 was linux-only -- but I wouldn't be surprised if we made similar changes on both platforms recently.)",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 5,
                "quote": "(I spun off bug 1386826 for the linux version of this issue (my comment 4 - comment 5), since it seems that this appeared on Linux due to a linux-specific change (bug 1308400), and I don't want to derail this bug here since it was filed for Windows.)",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 6,
                "quote": "Yeah, adding MOZ_DISABLE_CONTENT_SANDBOX=1 makes the test run as expected, so this is indeed because of content sandbox.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "The may be regressed by different bugs, but I imagine that the fix can be the same: either disable content sandbox for reftest or add the harness directory to the whitelist somehow. So it probably isn't necessary to have a separate bug for that.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Can confirm on Windows 10, adding MOZ_DISABLE_CONTENT_SANDBOX=1 fixes it.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Likely correct. We can dupe as-appropriate after we've got a fix somewhere.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "haik says in bug 1386826 comment 2 that (on linux at least) he can work around this by putting his objdir inside of his srcdir (e.g. in its default location -- just avoid setting MOZ_OBJDIR in your mozconfig).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "Attached patch White-list source and obj dirs for Windows content process sandbox in developer builds (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "test harness wise this looks good",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "is there a way to not ship with this? couldn't any addon just set this pref and then hack around the sandbox?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Alex - what do you think? (I think you hit these problems initially)",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "Can webExtensions set prefs? I didn't think they could, if so there are worse things that they could do. The original reason IsDevelopmentBuild() and the SRCDIR and OBJDIR variables were introduced were for handling the fact that on macOS and Linux we rely on symlinks from the built application to those directories. I don't think it's correct to use these variables if these tests need to access these directories not-via-symlinks (or stated another way, if Windows is affected, I don't think these are the right solution :-)). Right now these values are only used with InDevelopmentBuild, and we'd very much like to avoid changing that. That said, it might make sense to use these in the short term.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Updated patch with revised comment, as I'll probably need to use checkin-needed. Carrying r+ from jmaher in comment 14. It looks like web extensions can't set prefs, so after Fx56 we should be OK. Although we'd like to remove the need for these anyway to simplify things.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1385699",
        "issue_id": 1385699,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "On version 54 and above, Firefox were able to retrieve the correct duration anyway ; since 55 it returns Infinity. Note that chrome always returned Infinity, but there is a workaround[2] for them, which consists in setting the currentTime of the video to a large number. The duration is then correctly set. FF55+ doesn't allow this workaround to work : duration is always Infinity, even when it knows the actual duration.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "The current workaround I use is to grab the value of currentTime after I set it to the large number. But currentTime property can't be overridden by scripts, so this implies an ugly _duration property... To make things even worse, when the ended event fires, the currentTime property too is set to Infinity. So all in all, the best would be to retrieve the previous behavior (automagically grab the duration), and if it's really too hard, at least update the duration once it is known.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "There are several issues revealed by this bug: 1. We have MediaDecoder::mInfiniteStream==true to present an infinite stream. However, mDuration==inf can also present an infinite stream. This causes inconsistency and fails to mark the stream as finite when playback reaches the end. 2. http://searchfox.org/mozilla-central/rev/bbc1c59e460a27b20929b56489e2e55438de81fa/dom/media/MediaDecoderStateMachine.cpp#2009-2012 MDSM adjust playback position to max(clockTime, mMaster->Duration()) when playback reaches the end. Since mMaster->Duration() returns inf in this case, we end up having mediaElement.currentTime==inf. 3. http://searchfox.org/mozilla-central/rev/bbc1c59e460a27b20929b56489e2e55438de81fa/dom/media/MediaDecoderStateMachine.cpp#2252 It is bad to modify mDuration directly which should the result of RecomputeDuration(). Changing mDuration directly will break data consistency because any changes to mExplicitDuration or mObservedDuration will overwrite mDuration.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "We will let MediaDecoder do the final adjustment. Review commit: https://reviewboard.mozilla.org/r/164222/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/164222/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "We pretty much rewrite the whole logic of duration calculation of MDSM. The new logic is much simpler for we have only one duration to manage which is mDuration. Below is the details of the code changes: 1. remove the mExplicitDuration mirror since it should be handled in MediaDecoder. 2. remove mObservedDuration and mDuration will take its place. 3. mDuration is updated from: a. metadata b. playback position as playback progresses. c. buffer ranges. 4. change mDuration to be finite when playback reaches the end. Review commit: https://reviewboard.mozilla.org/r/164224/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/164224/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Since inf can be encoded in MDSM::mDuration, we don't need an additional flag in MediaDecoder to indicate 'infinite' anymore. Note duration change from infinite to finite is handled by MDSM, so we can remove the explicit calls to SetInfinite(false). Review commit: https://reviewboard.mozilla.org/r/164226/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/164226/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/164228/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/164228/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "AudioEndTime() returns 0 if the media sink is not started. This is wrong because the audio/video end time should be at least the current position to ensure playback won't go backwards. http://searchfox.org/mozilla-central/rev/bbc1c59e460a27b20929b56489e2e55438de81fa/dom/media/MediaDecoderStateMachine.cpp#2009-2012 This fix the case where we wrongly set playback position to 0 after seeking to the end of resource. Review commit: https://reviewboard.mozilla.org/r/164230/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/164230/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "https://reviewboard.mozilla.org/r/164222/#review170060",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "https://reviewboard.mozilla.org/r/164224/#review170064",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "https://reviewboard.mozilla.org/r/164226/#review170066",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "https://reviewboard.mozilla.org/r/164228/#review170068",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "https://reviewboard.mozilla.org/r/164230/#review170070 Nice, this all makes handling of infinite much better. Thanks!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "I believe that the removal of explicit duration (which is used with MSE, where we never need to set the duration in the MDSM nor guess the duration) will regress the MSE handling of duration.",
                "code": "ISSUE_IMPACT"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1384677",
        "issue_id": 1384677,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/161614/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/161614/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "https://reviewboard.mozilla.org/r/161614/#review166932",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=717147",
        "issue_id": 717147,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The text event handler of editor doesn't make nsAutoEditorKeypressOperation instance. Therefore, the input events during compsition (and at commit the composition) are not trusted events. With the attached patch, input events during composition become trusted events. However, it causes some regressions in chrome UI.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Patch part.2 Don't do autocomplete during composition (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Patch part.2 Don't do autocomplete during composition (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Patch part.3 Findbar shouldn't do incremental search during composition (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch Patch part.3 Findbar shouldn't do incremental search during composition (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "autocomplete shouldn't show popup during composition because it disturbs IME's candidate window. See bug 165055's screenshots.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "autocomplete shouldn't show popup during composition because it disturbs IME's candidate window. See bug 165055's screenshots. The new test is copied from editor/libeditor/text/tests/test_bug527935.html, therefore it's in the path rather than under toolkit/.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Findbar shouldn't find a word for unconverted composition string. For example, if user wants to convert \"ABC\" to \"DEF\" by IME, user types \"ABC\" by keyboard. Then, if findbar did incremental search in \"DEFABCDEF\", the \"ABC\" would be selected. And when the user did convert to \"DEF\", findbar found the *second* \"DEF\". It's bad behavior. The first \"DEF\" should be selected. Therefore, I think that findbar shouldn't do incremental search during composition.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "nit: for tests, the comment should be an assertion about the correct behavior, not a description of the error. So you should have:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "-> \"findbar should be hidden after testNormalFindWithComposition\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "-> \"testNormalFindWithComposition: find field should be focused\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "-> \"testNormalFindWithComposition: text should be found after committing composition\" etc. This applies to a bunch of places in the existing test, it looks like...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Looks reasonable",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=597389",
        "issue_id": 597389,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch v1.0 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Flash Player disables non-Roman keyboard layout and if you click the link, Flash Player doesn't recover the keyboard layout state when it's destroying. Gecko stores latest keyboard layout state when Gecko changes it because 10.4 doesn't provide any APIs for getting the state. And Gecko reduces unnecessary API call at nsTSMManager::SetRomanKeyboardsOnly(). Therefore, Gecko doesn't restore the keyboard state until Gecko's password field gets focus.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "# NOTE #1: This bug isn't reproduced on Minefield, probably, the reason is that Minefield uses new APIs which are usable 10.5 and later. # NOTE #2: This bug isn't reproduced with Flash Player 10.0.x.x. So, this is a regression of Flash Player.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "This bug can be reproduced on Fx3.5 too.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "I can't reproduce this bug (testing in FF 3.6.9 on OS X 10.5.8) ... or at least I don't think I can. Here's what I did: 1) Load this bug's URL (http://www.tbs.co.jp/radio/todays954/) and click somewhere in the Flash object. Notice that it's no longer possible to choose Kotoeri Hiragana or Katakana from the \"flags\" menu (those choices are greyed out). 2) Click elsewhere in the page. Now it's once again possible to choose Hiragana or Katakana. 3) Click on the Flash object -- Hiragana and Katakana are greyed out. 4) Switch tabs -- Hiragana and Katakana are no longer greyed out. 5) Switch back to the tab with http://www.tbs.co.jp/radio/todays954/ in it -- Hiragana and Katakana are still not greyed out. 6) Click on the Flash object -- Hiragana and Katakana are greyed out. 7) Close the current tab (with http://www.tbs.co.jp/radio/todays954/ in it) -- Hiragana and Katakana are no longer greyed out. Later I'll try it on OS X 10.6.4.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "I get the same results on OS X 10.6.4. By the way, on both OS versions I tested with en-US Firefox and the preferred language was set to English.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "I can reproduced this bug on 10.5 and 10.6. The original reporter in Japan said that he/she can reproduce this bug on 10.4 too.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "OK, thanks. Now I can reproduce it.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 9,
                "quote": "This looks fine to me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "This patch just removes an optimizing code for reducing API call. I think that this change doesn't affect to performance.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "NOTE: the method is called at focus moving only when IME state is changed by new focused content.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Approved for 1.9.2.11 and 1.9.1.14, a=dveditz for release-drivers",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Verified fixed in 1.9.2 with Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.11pre) Gecko/20100923 Namoroka/3.6.11pre. Verified fixed in 1.9.1 with Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.14pre) Gecko/20100923 Shiretoko/3.5.14pre.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1454126",
        "issue_id": 1454126,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Masayuki, this looks editor related.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Could you take a look? Thanks.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I investigated this yesterday but I still don't understand what happens. I cannot access the bugs mentioned in comment 3. If they could be good hint, could you cc me them too?",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Okay, got it. insertHorizontalRule command inserted <hr> element into the <input> element such DOM tree isn't expected by some places.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "See the commit message for the detail. This is caused by creating unexpected anonymous subtree in <input> element.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "This is caused by creating unexpected anonymous subtree in <input> element.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Patch for Beta (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Since this bug is marked as core-security, I think you shouldn't land test case with fix according to https://wiki.mozilla.org/Security/Bug_Approval_Process.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "nsIContent* parent?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Attached patch The patch for m-c (r=m_kato) (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "[Security approval request comment] How easily could an exploit be constructed based on the patch? It's easy since the patch includes the testcase to reproduce this crash. Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? I don't think so. This looks like just a crash bug fix if there is no link to this closed bug report. Which older supported branches are affected by this flaw? Not sure but ESR 52 doesn't support <detail> and the testcase won't work as expected. If not all supported branches, which bug introduced the flaw? Not sure. Possible to change native anonymous subtree in <input>/<textarea> with execCommand() must be long standing bug. However, the crash itself must be newer bug since a lot of safer code have been replaced with faster code with Quantum Flow. Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? I created same patch for Beta branch too. How likely is this patch to cause regressions; how much testing does it need? This patch just avoids to insert unexpected DOM nodes into <input>/<textarea>'s anonymous subtree. And such behavior has never been expected. Therefore, this patch must be safe. And also this patch includes the testcase of comment 0.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Attached patch Patch for Beta (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Masayuki, please update with a new patch and set sec-approval? on it.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 14,
                "quote": "[Security approval request comment] See comment 10. But this does NOT include the test.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Attached patch Patch for Beta \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "sec-approval+ for trunk. Given we have a week of betas left, I'll let release management make the decision about taking it on Beta.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Approved for today's 60.0b15 build.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1396319",
        "issue_id": 1396319,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Off hand, this looks like conduit_ becomes nullptr, either due to it being set to nullptr after the check is made earlier in this function, or getting stale data due to lack of synchronization. Looks similar to Bug 1382932, but may be more actionable.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "yeah - nullptr crash, possible (very unlikely) UAF since I'll bet it's getting cleared on one thread, and another thread is dereferencing conduit_. That can (with very unlikely timing) lead to a UAF.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "My guess would be that the addition of the RTP logging in 55 changed the timing slightly so that an old lingering problem starts to result in crashes.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "I have a friend that can consistently reproduce this crash when starting a call: https://crash-stats.mozilla.com/report/index/a6117985-e56a-4696-8186-d94c20171031.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "Still happening, and happening in 57/8/9. All crashes in the last week are nullptr still, so this may in fact be a clean nullptr crash and not a sec issue. If marco can repro this, we should look more closely.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "Nico, can you take a look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Possibly fixed though bug 1425780 getting uplifted into 58 Beta on 2018-01-11.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 8,
                "quote": "Possibly fixed though bug 1425780 getting uplifted into 58 Beta on 2018-01-11.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 9,
                "quote": "I can verify that my friend is no longer crashing, although he apparently can't use any website which requests both camera and microphone (such as appear.in, or appr.tc, or https://janus.conf.meetecho.com/echotest.html). They don't crash anymore, but his camera and microphone never actually work (both me and him can't see/hear him). He can use demos which only request the camera though (such as https://webrtc.github.io/samples/src/content/getusermedia/gum/).",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "Looks like we managed to fix this through another bug (possibly bug 1425780).",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1359490",
        "issue_id": 1359490,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "template<typename Pred> void SpinEventLoopUntil(Pred aPredicate, nsIThread* aThread = nullptr) { nsIThread* thread = aThread ? aThread : NS_GetCurrentThread(); while (!aPredicate()) { MOZ_ALWAYS_TRUE(NS_ProcessNextEvent(thread, true)); } } would be a little bit nicer than what we have, and would be slightly more efficient for a lot of the cases that we have. For Quantum DOM, this change would also enable us to add the thread-yielding smarts we need in one place, rather than having it scattered all over. With any luck, we can *almost* eliminate NS_ProcessNextEvent except from a few well-known places.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "This function is arguably nicer than calling NS_ProcessNextEvent manually, is slightly more efficient, and will enable better auditing for NS_ProcessNextEvent when we do Quantum DOM scheduling changes.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Thanks for your explanation! I have changed NS_ProcessNextEvent(..., false) to NS_ProcessNextEvent(..., true) and it's supposed to identical to using SpinEventLoopUntil(). The change is verified to work perfectly.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Pushed by nfroyd@mozilla.com: https://hg.mozilla.org/integration/mozilla-inbound/rev/c8840a3a2c3b add an event loop spinning abstraction function; r=gerald",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Things I'd especially like feedback on: * Lambda syntax; this is my first significant patch with lambdas; * The big comment before ProcessFailureBehavior. Strictly speaking, we don't *need* the enum, as we could just do: while (!SpinEventLoopUntil(...)) {} but that seems kind of ugly. Better ways to address this welcome. * Other things that I may not have thought of here!",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "To be clear, this patch passes the static analysis, so the concerns from comment 1 are unfounded!",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "r+ with my small nits addressed (or ignored as appropriate). Happy to re-review if you implement my crazy suggestions!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "'&' also captures '*this' by reference, so 'this' is not needed. (And more cases in this patch.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "In this kind of cases (only accessing member variables), `[this]` should be enough.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I'd unindent `}));` to be two columns left, below `return false;`.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "No more warning in the error case, is that intended?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "You removed the MOZ_ALWAYS_TRUE, is that intended? (Guessing: Probably yes, otherwise we would have got crash reports by now.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Wow, someone worked really hard to write a `do while` loop! I'm guessing that doing the extra initial test now is fine though. No more MOZ_ALWAYS_TRUE?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Assuming gFoo is global, there's no need to capture it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Forget anyOpen, just do: `for(){if(){/*still open*/ return false;}} /*all closed*/ return true;`",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "You didn't keep the PR_Sleep -- intended?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "The assertion doesn't just work inside the lambda?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "No more MOZ_ALWAYS_TRUE?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "I think you should put the full argument here!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "No need for the `enum` keyword here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "0. Returned bool I think you should document what its value means, probably in the first doc block above. And it would gently introduce the behaviors. :-) I see most calls just ignore it. It seems a bit dangerous in a way, especially when the default behavior mentions \"Report\", but then we ignore that report! Crazy thinking about that: How about having two specializations, so that either the function will be `void`, or will return `MOZ_MUST_USE bool` (Assuming MOZ_MUST_USE can indeed be selectively applied to a specialization.) Tweaked behaviors could be: - ProcessFailureBehavior::ReportToCaller -> `MOZ_MUST_USE bool`, and `return false;` if !didSomething. - ProcessFailureBehavior::Stop -> `void`, and `return;` if !didSomething. - ProcessFailureBehavior::IgnoreAndContinue -> `void` and no early return. I'd vote for ReportToCaller to still be the default, as it should force people to think a bit about which behavior to pick at every call, because either they'll need to understand and deal with the return value, or explicitly choose a non-returning behavior. 1. Function name: Strictly speaking, you're not spinning \"Until\", but more \"WhileNot\" -- i.e., the predicate is tested even before the first event-processing loop. But it sounds a bit awkward and mind-bending, so I'm not sure it would be such a good idea? Alternatively, you could change it to \"While\", i.e., reverse the predicate's meaning -- but then you'd have to change every caller! :-P However most of the original loops were `while (pred)`, which means the predicate would stay the same as it was, instead of having to reverse it as you have (painfully) done! But then again, it's probably simpler to usually think about how to end a loop, instead of when to keep it running, so as a user I would probably like Until/WhileNot better. AARGH! Sorry for the over-thinking. I'll let you decide... 2. Predicate parameter: Take it by '&&'. As it's a templated type, the most appropriate passing method will be taken, potentially avoiding some copies.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "Crazy thinking about that: How about having two specializations, so that either the function will be `void`, or will return `MOZ_MUST_USE bool` (Assuming MOZ_MUST_USE can indeed be selectively applied to a specialization.) Tweaked behaviors could be: - ProcessFailureBehavior::ReportToCaller -> `MOZ_MUST_USE bool`, and `return false;` if !didSomething. - ProcessFailureBehavior::Stop -> `void`, and `return;` if !didSomething. - ProcessFailureBehavior::IgnoreAndContinue -> `void` and no early return. I'd vote for ReportToCaller to still be the default, as it should force people to think a bit about which behavior to pick at every call, because either they'll need to understand and deal with the return value, or explicitly choose a non-returning behavior.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 23,
                "quote": "Strictly speaking, you're not spinning \"Until\", but more \"WhileNot\" -- i.e., the predicate is tested even before the first event-processing loop. But it sounds a bit awkward and mind-bending, so I'm not sure it would be such a good idea? Alternatively, you could change it to \"While\", i.e., reverse the predicate's meaning -- but then you'd have to change every caller! :-P However most of the original loops were `while (pred)`, which means the predicate would stay the same as it was, instead of having to reverse it as you have (painfully) done! But then again, it's probably simpler to usually think about how to end a loop, instead of when to keep it running, so as a user I would probably like Until/WhileNot better.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 24,
                "quote": "Instead of `if (B==I) { continue; } else if (!d) {return}` you could just do `if (B==R && !d) {return}`, it feels simpler to me in this case.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "`[=]` seems wrong; why not `[&]` like everywhere else?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "I kind of like this idea, but then I have to audit every site that I use this function at, and I'm not confident of being able to identify the correct behavior at every site. I guess maybe ReportToCaller for all the places that use MOZ_ALWAYS_TRUE or similar, and IgnoreAndContinue for everybody else? I'm also not sure that Stop would ever be the correct behavior during shutdown, for reasons (obliquely) described in the comment for the enum.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "I like the Until variant, seems more natural to me.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "AysncApplyUpdate() would just post an event to a separate thread (let's call it the update thread) for update and notify the result via a callback on the caller thread. The intention is to wrap that AysncApplyUpdate() to a synchronous update API for test case itself. (since the very original API is synchronous and all the test cases were written with that assumption in mind.) I was supposed to use a condition variable or a simple busy-wait to synchronize with the AsyncApplyUpdate()'s completion. However, I ended up failing to do any of them because somewhere on the update thread would \"SyncRunnable to main thread\" be done for initializing NS_CRYPTO_HASH_CONTRACTID [1], which is triggered by [2]. As a result, on the main thread, we have to wait and process pending events to unblock the update thread. |done| is only a flag for the main thread to know if AsyncApplyUpdate() has been complete. To get rid of that busy-wait, I have no better solution than pre-initializing NS_CRYPTO_HASH_CONTRACTID on non-main thread prior to calling AsyncApplyUpdate(). However, in that case, we still have to synchronize with the completion of creating NS_CRYPTO_HASH_CONTRACTID on the main thread.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 29,
                "quote": "Attached patch 0001-Avoid-racing-on-done.patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 30,
                "quote": "Please file a new bug, blocking this one.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 31,
                "quote": "And please change the AbstractThread::MainThread()->Dispatch(...) bit to just use NS_DispatchToMainThread instead. Thanks!",
                "code": "CODE_UPDATE_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1354406",
        "issue_id": 1354406,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This was fixed by bug 1417251 FWIW.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1332070",
        "issue_id": 1332070,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Enabling OpenGL plane splitting caused regressions for certain sites: http://www.simulationcurriculum.com https://github.com/webcompat/web-bugs/issues/4284",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Initially the regressions on these two sites seemed related, since both of them were using CSS transforms combined with transparency. However, they ended up being two separate problems (bug 1332268 and bug 1333934). These bugs are now fixed, which is why I am closing this bug.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1325731",
        "issue_id": 1325731,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The read back data turns out to be swizzled for some reason.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "This is fixed on my local webgl2 fixes branch.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 3,
                "quote": "It's possible this was bug 1325741.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 4,
                "quote": "Please retest.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "All good now, closing",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=817531",
        "issue_id": 817531,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Matthias, sorry, but it seems we already deployed a fix for this on our side using css. I put up some example html: http://www.fotocommunity.net/ff-bug-817531.html In Firebug you can validate the the Referer beeing sent with the request for http://cdn.fotocommunity.com/photos/27941525.jpg is \"http://cdn.fotocommunity.com/photos/27941525.jpg\", not the URL to the main request. Thanks, Moritz",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Firefox17: Referer: http://cdn.fotocommunity.com/photos/27941525.jpg Firefox10ESR: Referer: http://www.fotocommunity.net/ff-bug-817531.html We have 2 regressions here. The first regression is that we stop loading the image over the net Last good nightly: 2012-08-15 First bad nightly: 2012-08-16 Pushlog: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=86ee4deea55b&tochan ge=50e4ff05741e I suspect bug 697230 Some builds later we start to load the image again but with the wrong referer header Last good nightly: 2012-08-24 First bad nightly: 2012-08-25 Pushlog: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=1c0ac073dc65&tochan ge=f077de66e52d I suspect bug 783162",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Ah, the wrong referrer thing is definitely from bug 783162. This part in nsGenericHTMLElement::ParseBackgroundAttribute: + mozilla::css::URLValue *url = + new mozilla::css::URLValue(buffer, baseURI, uri, NodePrincipal()); should be: mozilla::css::URLValue *url = new mozilla::css::URLValue(uri, buffer, doc->GetDocumentURI(), NodePrincipal()); I think.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Fix the referrer header for background image loads. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Backed out for: REFTEST TEST-UNEXPECTED-FAIL | http://10.250.48.232:30278/tests/layout/reftests/backgrounds/background-referrer.html | image comparison (==), max difference: 255, number of differing pixels: 800000 https://tbpl.mozilla.org/php/getParsedLog.php?id=17684273&tree=Mozilla-Inbound https://hg.mozilla.org/integration/mozilla-inbound/rev/dee7d08baf04",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 6,
                "quote": "Relanded as https://hg.mozilla.org/integration/mozilla-inbound/rev/a381a84d7af2",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Looks like Android uses a different hostname. Fixed the test to deal with that and reenabled it on Android: https://hg.mozilla.org/integration/mozilla-inbound/rev/732f04efe8f5",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Fix the referrer header for background image loads. low risk regression fix, approving.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 9,
                "quote": "I confirm the fix is verified on MacOS 10.8, Windows 7 x64 and Ubuntu 12.04 on FF 20RC: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0 Mozilla/5.0 (X11; Linux i686; rv:20.0) Gecko/20100101 Firefox/20.0 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:20.0) Gecko/20100101 Firefox/20.0",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=817341",
        "issue_id": 817341,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In order for the GC statistics to be useful, there has to be a strict hierarchy of phases. Right now, we have a problem where PHASE_MARK_DELAYED can happen both during marking and during sweeping. This patch fixes that. I also realized that we weren't timing finalization of Ion code, so it fixes that too.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "I added some extra assertions that ensure that phases are always properly nested. This found one or two problems in the previous version. Here's the updated patch.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Yes, looks good.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=812431",
        "issue_id": 812431,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Regression window (mozilla-inbound-win64-pgo) Good: https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-inbound-win64-pgo/1353020623/ Bad: https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-inbound-win64-pgo/1353032056/ Pushlog: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=045367d6644e&tochange=a0cd4bcb3217 Regression window (mozilla-inbound-win64) Good: https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-inbound-win64/1353024231/ Bad: https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-inbound-win64/1353026752/ Pushlog: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=e8c599817e97&tochange=1a53df18c076 Probably triggered by: Bug #779029 - Mask region ignored when rendering with Direct2D More info: not happens with HW Acceleration disabled",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Very minor regression (if at all), but we'd take a low risk fix on Aurora if found.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "I think it's not anymore and issue as updated patch in bug #779029 probably fixed this. Can someone confirm this too?",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 4,
                "quote": "Can someone confirm this too?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "May be there is some regression. In today's nightly some tab titles are blurred. But bookmarks are normal. If that helps - I have 4k monitor, and 200% zoom.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "It's new issue, which is reported here - bug #1544830.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=797889",
        "issue_id": 797889,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Can this happen? I think we should be able to assert that it can't...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Hm. I don't understand this part. We should chat.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "You should be able to use GetCurrentTransaction here without needing to ask the request.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Nit: Space above here, and between the rest.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Nit: Whitespace",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I think you should set this before calling Close(), otherwise we risk reentering.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "I really don't think we need a bitfield here. Two bools should be fine.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I'd rather we not add this since AsyncConnectionHelper already knows the current transaction.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Nit: Remove extra parens",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "mDatabase could be null here, need to check. Also, if the open request is in progress, do we need to do anything to ensure that it disconnects when it completes?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Nit: void on its own line.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "# HG changeset patch # Parent 0a095af171f4fa1fa6509727e0f9daaf15d5ba88 # User Kyle Huey <khuey@kylehuey.com> diff --git a/dom/indexedDB/AsyncConnectionHelper.cpp b/dom/indexedDB/AsyncConnectionHelper.cpp --- a/dom/indexedDB/AsyncConnectionHelper.cpp +++ b/dom/indexedDB/AsyncConnectionHelper.cpp @@ -508,16 +508,47 @@ AsyncConnectionHelper::ReleaseMainThread NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); mDatabase = nullptr; mTransaction = nullptr; HelperBase::ReleaseMainThreadObjects(); } +AsyncConnectionHelper::ChildProcessSendResult +AsyncConnectionHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +{ + NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); + NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); + + // If there's no request, there could never have been an actor, and so there + // is nothing to do. + if (!mRequest) { + return Success_NotSent; + } + + IDBTransaction* trans = GetCurrentTransaction(); + // We may not have a transaction, e.g. for deleteDatabase + if (!trans) { + return Success_NotSent; + } + + // Are we shutting down the child? + if (trans->Database()->IsDisconnectedFromActor()) { + return Success_ActorDisconnected; + } + + IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); + if (!actor) { + return Success_NotSent; + } + + return SendResponseToChildProcess(aResultCode); +} + nsresult AsyncConnectionHelper::OnParentProcessRequestComplete( const ResponseValue& aResponseValue) { NS_ASSERTION(!IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); if (aResponseValue.type() == ResponseValue::Tnsresult) { NS_ASSERTION(NS_FAILED(aResponseValue.get_nsresult()), \"Huh?\"); diff --git a/dom/indexedDB/AsyncConnectionHelper.h b/dom/indexedDB/AsyncConnectionHelper.h --- a/dom/indexedDB/AsyncConnectionHelper.h +++ b/dom/indexedDB/AsyncConnectionHelper.h @@ -32,25 +32,16 @@ class ResponseValue; // A common base class for AsyncConnectionHelper and OpenDatabaseHelper that // IDBRequest can use. class HelperBase : public nsIRunnable { friend class IDBRequest; public: - enum ChildProcessSendResult - { - Success_Sent = 0, - Success_NotSent, - Error - }; - - virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) = 0; virtual nsresult GetResultCode() = 0; virtual nsresult GetSuccessResult(JSContext* aCx, jsval* aVal) = 0; IDBRequest* GetRequest() const { @@ -126,16 +117,35 @@ public: return mRequest ? mRequest->Source() : nullptr; } virtual nsresult GetResultCode() MOZ_OVERRIDE { return mResultCode; } + enum ChildProcessSendResult + { + // The result was successfully sent to the child process + Success_Sent = 0, + + // The result was not sent, because this is not an out-of-process request. + Success_NotSent, + + // The result was not sent, because the actor has been disconnected + // (if the child process has shut down or crashed). + Success_ActorDisconnected, + + // An error occurred. + Error + }; + + ChildProcessSendResult + MaybeSendResponseToChildProcess(nsresult aResultCode); + virtual nsresult OnParentProcessRequestComplete( const ResponseValue& aResponseValue); virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) = 0; protected: AsyncConnectionHelper(IDBDatabase* aDatabase, @@ -202,16 +212,24 @@ protected: nsTArray<StructuredCloneReadInfo>& aReadInfos, jsval* aResult); /** * This should only be called by AutoSetCurrentTransaction. */ static void SetCurrentTransaction(IDBTransaction* aTransaction); + /** + * Allows the subclass to send its results to the child process. Will only + * be called if all of the IPC infrastructure is available (there is an + * actor, the child is stil alive and hasn't begun shutting down). + */ + virtual ChildProcessSendResult + SendResponseToChildProcess(nsresult aResultCode) = 0; + protected: nsRefPtr<IDBDatabase> mDatabase; nsRefPtr<IDBTransaction> mTransaction; private: nsCOMPtr<mozIStorageProgressHandler> mOldProgressHandler; nsresult mResultCode; bool mDispatched; diff --git a/dom/indexedDB/IDBCursor.cpp b/dom/indexedDB/IDBCursor.cpp --- a/dom/indexedDB/IDBCursor.cpp +++ b/dom/indexedDB/IDBCursor.cpp @@ -90,17 +90,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(CursorRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: virtual nsresult BindArgumentsToStatement(mozIStorageStatement* aStatement) = 0; @@ -869,26 +869,24 @@ ContinueHelper::PackArgumentsForParentPr params.key() = mCursor->mContinueToKey; params.count() = uint32_t(mCount); aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -ContinueHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +ContinueHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); InfallibleTArray<PBlobParent*> blobsParent; if (NS_SUCCEEDED(aResultCode)) { IDBDatabase* database = mTransaction->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); diff --git a/dom/indexedDB/IDBDatabase.cpp b/dom/indexedDB/IDBDatabase.cpp --- a/dom/indexedDB/IDBDatabase.cpp +++ b/dom/indexedDB/IDBDatabase.cpp @@ -45,17 +45,17 @@ public: NoRequestDatabaseHelper(IDBTransaction* aTransaction) : AsyncConnectionHelper(aTransaction, nullptr) { NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); NS_ASSERTION(aTransaction, \"Null transaction!\"); } virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; virtual nsresult OnSuccess() MOZ_OVERRIDE; virtual void OnError() MOZ_OVERRIDE; @@ -112,17 +112,17 @@ public: nsresult GetSuccessResult(JSContext* aCx, jsval* aVal); void ReleaseMainThreadObjects() { mFileInfo = nullptr; AsyncConnectionHelper::ReleaseMainThreadObjects(); } - virtual ChildProcessSendResult MaybeSendResponseToChildProcess( + virtual ChildProcessSendResult SendResponseToChildProcess( nsresult aResultCode) MOZ_OVERRIDE { return Success_NotSent; } virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) @@ -211,17 +211,18 @@ IDBDatabase::Create(IDBWrapperCache* aOw return db.forget(); } IDBDatabase::IDBDatabase() : mDatabaseId(0), mActorChild(nullptr), mActorParent(nullptr), mContentParent(nullptr), - mInvalidated(0), + mInvalidated(false), + mDisconnected(false), mRegistered(false), mClosed(false), mRunningVersionChange(false) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); } IDBDatabase::~IDBDatabase() @@ -251,34 +252,61 @@ void IDBDatabase::Invalidate() { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); if (IsInvalidated()) { return; } + mInvalidated = true; + // Make sure we're closed too. Close(); // When the IndexedDatabaseManager needs to invalidate databases, all it has // is an origin, so we call back into the manager to cancel any prompts for // our owner. nsPIDOMWindow* owner = GetOwner(); if (owner) { IndexedDatabaseManager::CancelPromptsForWindow(owner); } - - mInvalidated = true; } bool IDBDatabase::IsInvalidated() { - return !!mInvalidated; + return mInvalidated; +} + +void +IDBDatabase::DisconnectFromActor() +{ + NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); + + if (IsDisconnectedFromActor()) { + return; + } + + mDisconnected = true; + + // Make sure we're closed too. + Close(); + + // Kill any outstanding prompts. + nsPIDOMWindow* owner = GetOwner(); + if (owner) { + IndexedDatabaseManager::CancelPromptsForWindow(owner); + } +} + +bool +IDBDatabase::IsDisconnectedFromActor() +{ + return mDisconnected; } void IDBDatabase::CloseInternal(bool aIsDead) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); if (!mClosed) { @@ -792,18 +820,18 @@ IDBDatabase::UnsetThreadLocals() } nsresult IDBDatabase::PostHandleEvent(nsEventChainPostVisitor& aVisitor) { return IndexedDatabaseManager::FireWindowOnError(GetOwner(), aVisitor); } -HelperBase::ChildProcessSendResult -NoRequestDatabaseHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +NoRequestDatabaseHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); return Success_NotSent; } nsresult NoRequestDatabaseHelper::UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) diff --git a/dom/indexedDB/IDBDatabase.h b/dom/indexedDB/IDBDatabase.h --- a/dom/indexedDB/IDBDatabase.h +++ b/dom/indexedDB/IDBDatabase.h @@ -101,16 +101,23 @@ public: } void Invalidate(); // Whether or not the database has been invalidated. If it has then no further // transactions for this database will be allowed to run. bool IsInvalidated(); + void DisconnectFromActor(); + + // Whether or not the database has been disconnected from its actor. If true + // it is not safe to send any IPC messages to the actor representing this db + // or any of its subactors. + bool IsDisconnectedFromActor(); + void CloseInternal(bool aIsDead); // Whether or not the database has had Close called on it. bool IsClosed(); void EnterSetVersionTransaction(); void ExitSetVersionTransaction(); @@ -178,17 +185,18 @@ private: nsRefPtr<FileManager> mFileManager; IndexedDBDatabaseChild* mActorChild; IndexedDBDatabaseParent* mActorParent; mozilla::dom::ContentParent* mContentParent; - int32_t mInvalidated; + bool mInvalidated; + bool mDisconnected; bool mRegistered; bool mClosed; bool mRunningVersionChange; }; END_INDEXEDDB_NAMESPACE #endif // mozilla_dom_indexeddb_idbdatabase_h__ diff --git a/dom/indexedDB/IDBIndex.cpp b/dom/indexedDB/IDBIndex.cpp --- a/dom/indexedDB/IDBIndex.cpp +++ b/dom/indexedDB/IDBIndex.cpp @@ -88,17 +88,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: // In-params. nsRefPtr<IDBKeyRange> mKeyRange; @@ -129,17 +129,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: StructuredCloneReadInfo mCloneReadInfo; }; @@ -160,17 +160,17 @@ public: virtual nsresult GetSuccessResult(JSContext* aCx, jsval* aVal) MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: const uint32_t mLimit; nsTArray<Key> mKeys; @@ -201,17 +201,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: const uint32_t mLimit; nsTArray<StructuredCloneReadInfo> mCloneReadInfos; @@ -241,17 +241,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: virtual nsresult EnsureCursor(); @@ -290,17 +290,17 @@ public: MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; private: virtual nsresult EnsureCursor(); StructuredCloneReadInfo mCloneReadInfo; // Only used in the parent process. SerializedStructuredCloneReadInfo mSerializedCloneReadInfo; @@ -323,17 +323,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(IndexRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; private: nsRefPtr<IDBKeyRange> mKeyRange; uint64_t mCount; @@ -1104,26 +1104,24 @@ GetKeyHelper::PackArgumentsForParentProc GetKeyParams params; mKeyRange->ToSerializedKeyRange(params.keyRange()); aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -GetKeyHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +GetKeyHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { GetKeyResponse getKeyResponse; getKeyResponse.key() = mKey; @@ -1226,26 +1224,24 @@ GetHelper::PackArgumentsForParentProcess FIXME_Bug_521898_index::GetParams params; mKeyRange->ToSerializedKeyRange(params.keyRange()); aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -GetHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +GetHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); InfallibleTArray<PBlobParent*> blobsParent; if (NS_SUCCEEDED(aResultCode)) { IDBDatabase* database = mIndex->ObjectStore()->Transaction()->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); @@ -1428,26 +1424,24 @@ GetAllKeysHelper::PackArgumentsForParent } params.limit() = mLimit; aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -GetAllKeysHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +GetAllKeysHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { GetAllKeysResponse getAllKeysResponse; getAllKeysResponse.keys().AppendElements(mKeys); @@ -1575,26 +1569,24 @@ GetAllHelper::PackArgumentsForParentProc } params.limit() = mLimit; aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -GetAllHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +GetAllHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); GetAllResponse getAllResponse; if (NS_SUCCEEDED(aResultCode) && !mCloneReadInfos.IsEmpty()) { IDBDatabase* database = mIndex->ObjectStore()->Transaction()->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); @@ -1904,28 +1896,25 @@ OpenKeyCursorHelper::PackArgumentsForPar } params.direction() = mDirection; aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -OpenKeyCursorHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +OpenKeyCursorHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); + NS_ASSERTION(!mCursor, \"Shouldn't have this yet!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } - - NS_ASSERTION(!mCursor, \"Shouldn't have this yet!\"); + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); if (NS_SUCCEEDED(aResultCode)) { nsresult rv = EnsureCursor(); if (NS_FAILED(rv)) { NS_WARNING(\"EnsureCursor failed!\"); aResultCode = rv; } } @@ -2240,28 +2229,25 @@ OpenCursorHelper::PackArgumentsForParent } params.direction() = mDirection; aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -OpenCursorHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +OpenCursorHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); + NS_ASSERTION(!mCursor, \"Shouldn't have this yet!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } - - NS_ASSERTION(!mCursor, \"Shouldn't have this yet!\"); + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); InfallibleTArray<PBlobParent*> blobsParent; if (NS_SUCCEEDED(aResultCode)) { IDBDatabase* database = mIndex->ObjectStore()->Transaction()->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); @@ -2423,26 +2409,24 @@ CountHelper::PackArgumentsForParentProce else { params.optionalKeyRange() = mozilla::void_t(); } aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -CountHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +CountHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { CountResponse countResponse = mCount; response = countResponse; diff --git a/dom/indexedDB/IDBObjectStore.cpp b/dom/indexedDB/IDBObjectStore.cpp --- a/dom/indexedDB/IDBObjectStore.cpp +++ b/dom/indexedDB/IDBObjectStore.cpp @@ -106,17 +106,17 @@ public: virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult OnSuccess() MOZ_OVERRIDE; virtual void OnError() MOZ_OVERRIDE; protected: nsRefPtr<IDBObjectStore> mObjectStore; }; @@ -150,17 +150,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; private: // These may change in the autoincrement case. StructuredCloneWriteInfo mCloneWriteInfo; @@ -194,17 +194,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: // In-params. nsRefPtr<IDBKeyRange> mKeyRange; @@ -229,17 +229,17 @@ public: virtual nsresult GetSuccessResult(JSContext* aCx, jsval* aVal) MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; }; class ClearHelper : public ObjectStoreHelper { @@ -252,17 +252,17 @@ public: virtual nsresult DoDatabaseWork(mozIStorageConnection* aConnection) MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; }; class OpenCursorHelper : public ObjectStoreHelper { @@ -288,17 +288,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; private: nsresult EnsureCursor(); @@ -394,17 +394,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; protected: // In-params. nsRefPtr<IDBKeyRange> mKeyRange; @@ -433,17 +433,17 @@ public: jsval* aVal) MOZ_OVERRIDE; virtual void ReleaseMainThreadObjects() MOZ_OVERRIDE; virtual nsresult PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult UnpackResponseFromParentProcess(const ResponseValue& aResponseValue) MOZ_OVERRIDE; private: nsRefPtr<IDBKeyRange> mKeyRange; uint64_t mCount; @@ -2558,19 +2558,18 @@ NoRequestObjectStoreHelper::ReleaseMainT nsresult NoRequestObjectStoreHelper::UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) { NS_NOTREACHED(\"Should never get here!\"); return NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR; } -HelperBase::ChildProcessSendResult -NoRequestObjectStoreHelper::MaybeSendResponseToChildProcess( - nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +NoRequestObjectStoreHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); return Success_NotSent; } nsresult NoRequestObjectStoreHelper::OnSuccess() { @@ -2819,26 +2818,24 @@ AddHelper::PackArgumentsForParentProcess AddParams addParams; addParams.commonParams() = commonParams; aParams = addParams; } return NS_OK; } -HelperBase::ChildProcessSendResult -AddHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +AddHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else if (mOverwrite) { PutResponse putResponse; putResponse.key() = mKey; @@ -2938,26 +2935,24 @@ GetHelper::PackArgumentsForParentProcess FIXME_Bug_521898_objectstore::GetParams params; mKeyRange->ToSerializedKeyRange(params.keyRange()); aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -GetHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +GetHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); InfallibleTArray<PBlobParent*> blobsParent; if (NS_SUCCEEDED(aResultCode)) { IDBDatabase* database = mObjectStore->Transaction()->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); @@ -2968,17 +2963,17 @@ GetHelper::MaybeSendResponseToChildProce const nsTArray<StructuredCloneFile>& files = mCloneReadInfo.mFiles; aResultCode = IDBObjectStore::ConvertBlobsToActors(contentParent, fileManager, files, blobsParent); if (NS_FAILED(aResultCode)) { NS_WARNING(\"ConvertBlobsToActors failed!\"); - } + } } ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { GetResponse getResponse; @@ -3065,26 +3060,24 @@ DeleteHelper::PackArgumentsForParentProc DeleteParams params; mKeyRange->ToSerializedKeyRange(params.keyRange()); aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -DeleteHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +DeleteHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { response = DeleteResponse(); } @@ -3131,26 +3124,24 @@ ClearHelper::DoDatabaseWork(mozIStorageC nsresult ClearHelper::PackArgumentsForParentProcess(ObjectStoreRequestParams& aParams) { aParams = ClearParams(); return NS_OK; } -HelperBase::ChildProcessSendResult -ClearHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +ClearHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { response = ClearResponse(); } @@ -3366,28 +3357,25 @@ OpenCursorHelper::PackArgumentsForParent } params.direction() = mDirection; aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -OpenCursorHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +OpenCursorHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); + NS_ASSERTION(!mCursor, \"Shouldn't have this yet!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } - - NS_ASSERTION(!mCursor, \"Shouldn't have this yet!\"); + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); InfallibleTArray<PBlobParent*> blobsParent; if (NS_SUCCEEDED(aResultCode)) { IDBDatabase* database = mObjectStore->Transaction()->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); @@ -3809,29 +3797,26 @@ GetAllHelper::PackArgumentsForParentProc } params.limit() = mLimit; aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -GetAllHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +GetAllHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } - - GetAllResponse getAllResponse; - + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); + + GetAllResponse getAllResponse; if (NS_SUCCEEDED(aResultCode) && !mCloneReadInfos.IsEmpty()) { IDBDatabase* database = mObjectStore->Transaction()->Database(); NS_ASSERTION(database, \"This should never be null!\"); ContentParent* contentParent = database->GetContentParent(); NS_ASSERTION(contentParent, \"This should never be null!\"); FileManager* fileManager = database->Manager(); @@ -4006,26 +3991,24 @@ CountHelper::PackArgumentsForParentProce else { params.optionalKeyRange() = mozilla::void_t(); } aParams = params; return NS_OK; } -HelperBase::ChildProcessSendResult -CountHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +CountHelper::SendResponseToChildProcess(nsresult aResultCode) { NS_ASSERTION(NS_IsMainThread(), \"Wrong thread!\"); NS_ASSERTION(IndexedDatabaseManager::IsMainProcess(), \"Wrong process!\"); IndexedDBRequestParentBase* actor = mRequest->GetActorParent(); - if (!actor) { - return Success_NotSent; - } + NS_ASSERTION(actor, \"How did we get this far without an actor?\"); ResponseValue response; if (NS_FAILED(aResultCode)) { response = aResultCode; } else { CountResponse countResponse = mCount; response = countResponse; diff --git a/dom/indexedDB/OpenDatabaseHelper.cpp b/dom/indexedDB/OpenDatabaseHelper.cpp --- a/dom/indexedDB/OpenDatabaseHelper.cpp +++ b/dom/indexedDB/OpenDatabaseHelper.cpp @@ -1356,17 +1356,17 @@ protected: virtual already_AddRefed<nsDOMEvent> CreateSuccessEvent() MOZ_OVERRIDE; virtual nsresult NotifyTransactionPreComplete(IDBTransaction* aTransaction) MOZ_OVERRIDE; virtual nsresult NotifyTransactionPostComplete(IDBTransaction* aTransaction) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE { return Success_NotSent; } virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) MOZ_OVERRIDE { @@ -1430,17 +1430,17 @@ protected: } uint64_t RequestedVersion() const { return 0; } virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE { return Success_NotSent; } virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) MOZ_OVERRIDE { diff --git a/dom/indexedDB/OpenDatabaseHelper.h b/dom/indexedDB/OpenDatabaseHelper.h --- a/dom/indexedDB/OpenDatabaseHelper.h +++ b/dom/indexedDB/OpenDatabaseHelper.h @@ -52,22 +52,16 @@ public: nsresult RunImmediately(); void SetError(nsresult rv) { NS_ASSERTION(NS_FAILED(rv), \"Why are you telling me?\"); mResultCode = rv; } - virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE - { - return Success_NotSent; - } - virtual nsresult GetResultCode() MOZ_OVERRIDE { return mResultCode; } nsresult NotifySetVersionFinished(); nsresult NotifyDeleteFinished(); void BlockDatabase(); diff --git a/dom/indexedDB/ipc/IndexedDBChild.cpp b/dom/indexedDB/ipc/IndexedDBChild.cpp --- a/dom/indexedDB/ipc/IndexedDBChild.cpp +++ b/dom/indexedDB/ipc/IndexedDBChild.cpp @@ -36,17 +36,17 @@ public: MOZ_ASSERT(aRequest); } virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult GetSuccessResult(JSContext* aCx, jsval* aVal) MOZ_OVERRIDE; virtual nsresult OnSuccess() MOZ_OVERRIDE { static_cast<IDBOpenDBRequest*>(mRequest.get())->SetTransaction(NULL); @@ -81,17 +81,17 @@ public: MOZ_ASSERT(aRequest); } virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult DoDatabaseWork(mozIStorageConnection* aConnection) MOZ_OVERRIDE; virtual already_AddRefed<nsDOMEvent> CreateSuccessEvent() MOZ_OVERRIDE; virtual nsresult @@ -105,17 +105,17 @@ public: : AsyncConnectionHelper(static_cast<IDBDatabase*>(NULL), aRequest) { } virtual nsresult UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) MOZ_OVERRIDE; virtual ChildProcessSendResult - MaybeSendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; + SendResponseToChildProcess(nsresult aResultCode) MOZ_OVERRIDE; virtual nsresult GetSuccessResult(JSContext* aCx, jsval* aVal) MOZ_OVERRIDE; virtual nsresult DoDatabaseWork(mozIStorageConnection* aConnection) MOZ_OVERRIDE; }; @@ -1142,18 +1142,18 @@ IndexedDBDeleteDatabaseRequestChild::Rec nsresult IPCOpenDatabaseHelper::UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) { NS_NOTREACHED(\"Should never get here!\"); return NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR; } -HelperBase::ChildProcessSendResult -IPCOpenDatabaseHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +IPCOpenDatabaseHelper::SendResponseToChildProcess(nsresult aResultCode) { MOZ_NOT_REACHED(\"Don't call me!\"); return Error; } nsresult IPCOpenDatabaseHelper::DoDatabaseWork(mozIStorageConnection* aConnection) { @@ -1171,18 +1171,18 @@ IPCOpenDatabaseHelper::GetSuccessResult( nsresult IPCSetVersionHelper::UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) { NS_NOTREACHED(\"Should never get here!\"); return NS_ERROR_DOM_INDEXEDDB_UNKNOWN_ERR; } -HelperBase::ChildProcessSendResult -IPCSetVersionHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +IPCSetVersionHelper::SendResponseToChildProcess(nsresult aResultCode) { MOZ_NOT_REACHED(\"Don't call me!\"); return Error; } nsresult IPCSetVersionHelper::DoDatabaseWork(mozIStorageConnection* aConnection) { @@ -1209,18 +1209,18 @@ IPCSetVersionHelper::GetSuccessResult(JS nsresult IPCDeleteDatabaseHelper::UnpackResponseFromParentProcess( const ResponseValue& aResponseValue) { MOZ_NOT_REACHED(\"Don't call me!\"); return NS_ERROR_FAILURE; } -HelperBase::ChildProcessSendResult -IPCDeleteDatabaseHelper::MaybeSendResponseToChildProcess(nsresult aResultCode) +AsyncConnectionHelper::ChildProcessSendResult +IPCDeleteDatabaseHelper::SendResponseToChildProcess(nsresult aResultCode) { MOZ_NOT_REACHED(\"Don't call me!\"); return Error; } nsresult IPCDeleteDatabaseHelper::GetSuccessResult(JSContext* aCx, jsval* aVal) { diff --git a/dom/indexedDB/ipc/IndexedDBParent.cpp b/dom/indexedDB/ipc/IndexedDBParent.cpp --- a/dom/indexedDB/ipc/IndexedDBParent.cpp +++ b/dom/indexedDB/ipc/IndexedDBParent.cpp @@ -47,26 +47,40 @@ AutoSetCurrentTransaction::~AutoSetCurre AsyncConnectionHelper::SetCurrentTransaction(NULL); } /******************************************************************************* * IndexedDBParent ******************************************************************************/ IndexedDBParent::IndexedDBParent() + : mDisconnected(false) { MOZ_COUNT_CTOR(IndexedDBParent); } IndexedDBParent::~IndexedDBParent() { MOZ_COUNT_DTOR(IndexedDBParent); } void +IndexedDBParent::Disconnect() +{ + mDisconnected = true; + + const InfallibleTArray<PIndexedDBDatabaseParent*>& dbs = + ManagedPIndexedDBDatabaseParent(); + + for (uint32_t i = 0; i < dbs.Length(); ++i) { + static_cast<IndexedDBDatabaseParent*>(dbs[i])->Disconnect(); + } +} + +void IndexedDBParent::ActorDestroy(ActorDestroyReason aWhy) { // Nothing really needs to be done here... } bool IndexedDBParent::RecvPIndexedDBDatabaseConstructor( PIndexedDBDatabaseParent* aActor, @@ -179,16 +193,21 @@ IndexedDBDatabaseParent::SetOpenRequest( return NS_OK; } nsresult IndexedDBDatabaseParent::HandleEvent(nsIDOMEvent* aEvent) { MOZ_ASSERT(aEvent); + if (Manager() && + static_cast<IndexedDBParent*>(Manager())->IsDisconnected()) { + return NS_OK; + } + nsString type; nsresult rv = aEvent->GetType(type); NS_ENSURE_SUCCESS(rv, rv); nsCOMPtr<nsIDOMEventTarget> target; rv = aEvent->GetTarget(getter_AddRefs(target)); NS_ENSURE_SUCCESS(rv, rv); @@ -209,16 +228,24 @@ IndexedDBDatabaseParent::HandleEvent(nsI return NS_OK; } MOZ_NOT_REACHED(\"Unexpected message!\"); return NS_ERROR_UNEXPECTED; } +void +IndexedDBDatabaseParent::Disconnect() +{ + if (mDatabase) { + mDatabase->DisconnectFromActor(); + } +} + nsresult IndexedDBDatabaseParent::HandleRequestEvent(nsIDOMEvent* aEvent, const nsAString& aType) { MOZ_ASSERT(mOpenRequest); nsresult rv; @@ -1774,16 +1801,21 @@ IndexedDBDeleteDatabaseRequestParent::In IndexedDBDeleteDatabaseRequestParent::~IndexedDBDeleteDatabaseRequestParent() { MOZ_COUNT_DTOR(IndexedDBDeleteDatabaseRequestParent); } nsresult IndexedDBDeleteDatabaseRequestParent::HandleEvent(nsIDOMEvent* aEvent) { + if (Manager() && + static_cast<IndexedDBParent*>(Manager())->IsDisconnected()) { + return NS_OK; + } + MOZ_ASSERT(aEvent); nsString type; nsresult rv = aEvent->GetType(type); NS_ENSURE_SUCCESS(rv, rv); if (type.EqualsASCII(BLOCKED_EVT_STR)) { nsCOMPtr<nsIIDBVersionChangeEvent> event = do_QueryInterface(aEvent); diff --git a/dom/indexedDB/ipc/IndexedDBParent.h b/dom/indexedDB/ipc/IndexedDBParent.h --- a/dom/indexedDB/ipc/IndexedDBParent.h +++ b/dom/indexedDB/ipc/IndexedDBParent.h @@ -132,27 +132,37 @@ public: class IndexedDBParent : public PIndexedDBParent { friend class mozilla::dom::ContentParent; friend class mozilla::dom::TabParent; nsRefPtr<IDBFactory> mFactory; nsCString mASCIIOrigin; + bool mDisconnected; public: IndexedDBParent(); virtual ~IndexedDBParent(); const nsCString& GetASCIIOrigin() const { return mASCIIOrigin; } + void + Disconnect(); + + bool + IsDisconnected() const + { + return mDisconnected; + } + protected: virtual void ActorDestroy(ActorDestroyReason aWhy) MOZ_OVERRIDE; virtual bool RecvPIndexedDBDatabaseConstructor(PIndexedDBDatabaseParent* aActor, const nsString& aName, const uint64_t& aVersion) MOZ_OVERRIDE; @@ -194,16 +204,19 @@ public: virtual ~IndexedDBDatabaseParent(); nsresult SetOpenRequest(IDBOpenDBRequest* aRequest); nsresult HandleEvent(nsIDOMEvent* aEvent); + void + Disconnect(); + protected: nsresult HandleRequestEvent(nsIDOMEvent* aEvent, const nsAString& aType); nsresult HandleDatabaseEvent(nsIDOMEvent* aEvent, const nsAString& aType); virtual void diff --git a/dom/ipc/ContentParent.cpp b/dom/ipc/ContentParent.cpp --- a/dom/ipc/ContentParent.cpp +++ b/dom/ipc/ContentParent.cpp @@ -457,24 +457,30 @@ ContentParent::SetManifestFromPreallocat // Clients should think of mAppManifestURL as const ... we're // bending the rules here just for the preallocation hack. const_cast<nsString&>(mAppManifestURL) = aAppManifestURL; } void ContentParent::ShutDownProcess() { - if (mIsAlive) { - // Close() can only be called once. It kicks off the - // destruction sequence. - Close(); + if (mIsAlive) { + const InfallibleTArray<PIndexedDBParent*>& idbParents = + ManagedPIndexedDBParent(); + for (uint32_t i = 0; i < idbParents.Length(); ++i) { + static_cast<IndexedDBParent*>(idbParents[i])->Disconnect(); } - // NB: must MarkAsDead() here so that this isn't accidentally - // returned from Get*() while in the midst of shutdown. - MarkAsDead(); + + // Close() can only be called once. It kicks off the + // destruction sequence. + Close(); + } + // NB: must MarkAsDead() here so that this isn't accidentally + // returned from Get*() while in the midst of shutdown. + MarkAsDead(); } void ContentParent::MarkAsDead() { if (!mAppManifestURL.IsEmpty()) { if (gAppContentParents) { gAppContentParents->Remove(mAppManifestURL); diff --git a/dom/ipc/TabParent.cpp b/dom/ipc/TabParent.cpp --- a/dom/ipc/TabParent.cpp +++ b/dom/ipc/TabParent.cpp @@ -104,16 +104,22 @@ TabParent::SetOwnerElement(nsIDOMElement void TabParent::Destroy() { // If this fails, it's most likely due to a content-process crash, // and auto-cleanup will kick in. Otherwise, the child side will // destroy itself and send back __delete__(). unused << SendDestroy(); + const InfallibleTArray<PIndexedDBParent*>& idbParents = + ManagedPIndexedDBParent(); + for (uint32_t i = 0; i < idbParents.Length(); ++i) { + static_cast<IndexedDBParent*>(idbParents[i])->Disconnect(); + } + if (RenderFrameParent* frame = GetRenderFrame()) { frame->Destroy(); } } bool TabParent::Recv__delete__() { Comments addressed",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Attached patch Patch \u2014 Details \u2014 Splinter Review Comments addressed",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=758103",
        "issue_id": 758103,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is a patch based on the comments in bug 816620. I observed this problem on the PandaBoard. In addition to fixing the actual bug, the patch cleans up the implementation of the getter function and adds handling for interrupted system calls.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Coding style: Don't do: if (foo) bar; But: if (foo) { bar; } I haven't reviewed much GetCurrentBatteryCharging() because the C-style code of this function is a bit hard to read for me. In C++, you shouldn't need labels to close a file descriptor, you should use a guard object for that. I haven't try to find why \"out\" label is used. Also, note that you will need a review from a Gonk peer. Putting mwu as a reviewer to make sure that happens.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Take a pointer. A common C++ convention is that pointers are out parameters and reference are in parameters, that way the caller can guess if this is going to be in or out.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This pattern is un-familliar to me. Why do you put fopen (and later fclose) in loops?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Pointers, too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "aBatteryInfo->remainingTime() = dom::battery::kDefaultRemainingTime;",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This is an update to the previous patch. The major changes are the use of TEMP_FAILURE_RETRY and ScopedClose. Because of the latter, the file I/O has been rewritten to use file descriptors, and all gotos are gone.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Don't pass |aChargingTime| to this method if you don't actually use it. It might give the wrong impression to the caller.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I think this entire block should be something like: int charging; if (GetCurrentBatteryCharging(&charging)) { aBatteryInfo->charging() = charging; } else { aBatteryInfo->charging() = true; } aBatteryInfo->remainingTime = dom::battery::kUnknownRemainingTime; if (aBatteryInfo->charging() && aBatteryInfo->level == 1.0) { aBatteryInfo->remainingTime = dom::battery::kDefaultRemainingTime; } (feel free to use a ternary operator)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "This function name seems to be a poor choice (the /sys file name seems to be poor as well). To me capacity implies how much the battery is capable of holding. This seems to be returning the current charge or level of the battery. So I'd be inclined to call it GetCurrentBatteryLevel (this matches the field names in the BateryInformation structure).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Since the bulk of the above function actually also appears below, I would prefer to factor this into a helper function, Something like the two functions here: https://mxr.mozilla.org/mozilla-central/source/dom/system/gonk/AutoMounter.cpp#99 but you'll want another version which parses a double. The versions in AutoMounter are missing the TEMP_FAILURE_RETRY. In fact, we should probably make these available somewhere in Gonk since they occur so frequently. we should factor these out into a common location. I created bug 819016 to do that, so I would probably just do the first level of factoring here and we can probably make your factored routines be the basis for the common routines in bug 819016",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "The strings read will contain a trailing newline so these comparisons won't work properly. i.e. if you do: adb shell cat /sys/class/power_supply/battery/status > /data/local/batt exit adb pull /data/local/batt hd batt then you'll see something like: 00000000 46 75 6c 6c 0a |Full.| 00000005 Note: If you try to combine the adb shell and cat then you'll get a CR inserted before the NL",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Since this is floating point, shouldn't the comparison have some small epsilon for the comparison? i.e. 0.99999 should probably be considered the same as 1.0 Picking the right epsilon will probably be tricky (perhaps taking into consideration how many decimal places we show to the user).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "V3 of the patch incorporates the reviews of previous versions. - The remaining time is now separate from the charge level. - I choose to rename 'GetCurrentBatteryCapacity' to 'GetCurrentBatteryCharge' instead of 'GetCurrentBatteryLevel'. This way the percentage value 'charge' is clearly distinguished from the dimension-less 'level'. Using type int for 'charge' makes the code a bit simpler. - I also adapted the ReadSysFile functions, which simplifies the code a lot. Dave, I think there is a bug in ReadSysFile for strings. When you read 0 bytes, you access the byte before the string array when testing for '\\n'. It's fixed in my copy. - I left the floating-point comparison as it was. See my previous comments",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Shouldn't this be == 1 ?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "&& success",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "The logic of the above doesn't seem right to me. I thought the intent was: if charging && (battery-level >= 1.0) return NoTimeRemaining The logic as coded will return NoTimeRemaining if it's not charging, which feels wrong.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "I made a similar assumption about the remaining time in my first attempt to fix the problem. For v4 of the patch I fixed the invalid test of the scanf return value and the test for successfully reading a value from the sysfs file.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Attached patch Set remaining time to 0 if battery level is 1 [v4] \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "Please go ahead with uplift to the tip of mozilla-b2g18 branch for v1.0.1",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 21,
                "quote": "Please go ahead with uplift to the tip of mozilla-b2g18 branch for v1.0.1",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=730907",
        "issue_id": 730907,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It'd still be a good idea to update to the latest libvpx release so that it's obvious we're up to date.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Just spoke with kinetik in IRC to clarify. He let me know that he believes we're not vulnerable now that bug 696390 is fixed. On a separate note - it's not clear that we'd need to chemspill for this DOS if it wasn't fixed in bug 696390. Crashing (DOS) when opening a webm video seems like an \"stop hitting yourself\" sort of bug.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Update libvpx to v1.0.0 \u2014 Details \u2014 Splinter Review khuey: You only need to review the build-system bits (configure.in and Makefile.in changes). cpearce: If you need me to break out the series of patches we now apply into individual attachments to make reviewing them in bugzilla easier, I'm happy to do so. Sorry for the delay on this. This update required an unusual amount of work to get things into decent shape. The new MFQE post-processing filter in the decoder started using a number of variance functions from the encoder, but outside the existing run-time CPU detection framework (which was all still in the encoder structures, which we normally don't compile). This is fixed upstream, but that fix was done after the entire RTCD framework was rewritten. That rewrite is probably too invasive to backport to this release, and had at least one known issue that wasn't fixed until earlier this week, so I chose to move everything within the existing RTCD framework instead (see I256a37c6.patch and variance-invoke.patch; the latter is obsoleted by the new RTCD framework and shouldn't need to go upstream). I'll work on getting textrels.patch (needed to keep native Fennec from crashing on startup) and compile_errors.patch upstream as well (I had pointed them at the latter before, but the problem has only gotten worse since then, so I'll be more proactive about it). Maybe I can rekindle their interest in solaris.patch, too, so we can stop carrying that one. stdint.patch should already be upstream, but didn't make the v1.0.0 release.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Champion effort.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Doesn't look too crazy.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Greenish on try: Decoder only: https://tbpl.mozilla.org/?tree=Try&rev=47b6d7f1589c Plus error concealment and encoder: https://tbpl.mozilla.org/?tree=Try&rev=275fa2f2ab18",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=700508",
        "issue_id": 700508,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I did this, it was easier than working out how to track all the SQLite connections. aboutMemory.js's complexity didn't change much -- it no longer has to deal with non-leaf nodes, which is good, but it has to special case \"explicit/storage/sqlite\", which is bad. GetExplicit is much simpler, though, and avoids the quadratic case. I need to test the sqlite special-casing in test_aboutmemory.xul, I'll do that on Monday.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "I'm not certain that this is the right way to go -- who's to say we won't have another SQLite-like situation on our hands -- but I don't see the harm in trying it out. This one-exception rule is interesting...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Nit: Parallelism. \"Non-leaf TreeNodes, *which* are just scaffolding\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "What should never happen for \"explicit\"? Shouldn't you reverse this? \"We should always find a reporter when aTreeName == explicit, but some 'map' trees might be missing\". In fact, you could assert(aTreeName != 'explicit' || foundReporter).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Kind of a weird variable name... I guess it's supposed to be like |aT|? Maybe |heapUnclassifiedNode| would be better?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Typo.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I'd add an explicit mention of the fact that non-leaf reporters other than sqlite/other are not allowed. (The sqlite/other special-case is now part of our interface, so we might as well document it here.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "We usually do |NS_ENSURE_ARG_POINTER(aExplicit)| first, just to be paranoid.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "This doesn't seem to be the prevailing style in this file. r=me, but we need to test the sql reporter hack.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Attached patch patch without the sqlite hack (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Sorry, here's the right patch.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Wow, bugzilla's interdiff actually worked. That was cool.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "I've found the 'interdiff' that comes with patchutils on Linux is much more robust than Bugzilla's.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Yeah, I usually do interdiff <(curl -L http://attachment-url-1) <(curl -L http://attachment-url-2) | vim -",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Backed out in order to back out bug 703143:",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 16,
                "quote": "Merge of backout:",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 17,
                "quote": "Relanded:",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 18,
                "quote": "Backed out for linux64 moth orange:",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 19,
                "quote": "With the first patch in bug 715453 having removed this assertion, I thought I'd give this another spin:",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1148078",
        "issue_id": 1148078,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I used \"logical position/size\" to refer to \"main-axis/cross-axis position/size\". For now, I'm going to switch to call these \"flex-relative\" instead of \"logical\". (We may come up with a better term down the line; ideally, we should use something that applies to flex & grid. For now, \"FlexRelative\" is pretty clear, though, and we can do search-and-replace later if we think of something better.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch fix v1 \u2014 Details \u2014 Splinter Review # HG changeset patch # Parent d5a537c7c5582d7edcdf83a3705d888259c62a6e # User Daniel Holbert <dholbert@cs.stanford.edu> Bug 1148078: Replace the word \"Logical\" with \"Flex-Relative\" in some vars & functions in flexbox layout. r=mats diff --git a/layout/generic/nsFlexContainerFrame.cpp b/layout/generic/nsFlexContainerFrame.cpp --- a/layout/generic/nsFlexContainerFrame.cpp +++ b/layout/generic/nsFlexContainerFrame.cpp @@ -39,18 +39,18 @@ GetFlexContainerLog() static PRLogModuleInfo *sLog; if (!sLog) sLog = PR_NewLogModule(\"nsFlexContainerFrame\"); return sLog; } #endif /* PR_LOGGING */ // XXXdholbert Some of this helper-stuff should be separated out into a general -// \"LogicalAxisUtils.h\" helper. Should that be a class, or a namespace (under -// what super-namespace?), or what? +// \"main/cross-axis utils\" header, shared by grid & flexbox? +// (Particularly when grid gets support for align-*/justify-* properties.) // Helper enums // ============ // Represents a physical orientation for an axis. // The directional suffix indicates the direction in which the axis *grows*. // So e.g. eAxis_LR means a horizontal left-to-right axis, whereas eAxis_BT // means a vertical bottom-to-top axis. @@ -132,32 +132,34 @@ GetSizePropertyForAxis(const nsIFrame* a const nsStylePosition* stylePos = aFrame->StylePosition(); return IsAxisHorizontal(aAxis) ? stylePos->mWidth : stylePos->mHeight; } /** - * Converts a logical position in a given axis into a position in the - * corresponding physical (x or y) axis. If the logical axis already maps - * directly onto one of our physical axes (i.e. LTR or TTB), then the logical - * and physical positions are equal; otherwise, we subtract the logical - * position from the container-size in that axis, to flip the polarity. - * (so e.g. a logical position of 2px in a RTL 20px-wide container - * would correspond to a physical position of 18px.) + * Converts a \"flex-relative\" coordinate in a single axis (a main- or cross-axis + * coordinate) into a coordinate in the corresponding physical (x or y) axis. If + * the flex-relative axis in question already maps *directly* to a physical + * axis (i.e. if it's LTR or TTB), then the physical coordinate has the same + * numeric value as the provided flex-relative coordinate. Otherwise, we have to + * subtract the flex-relative coordinate from the flex container's size in that + * axis, to flip the polarity. (So e.g. a main-axis position of 2px in a RTL + * 20px-wide container would correspond to a physical coordinate (x-value) of + * 18px.) */ static nscoord -PhysicalPosFromLogicalPos(nscoord aLogicalPosn, - nscoord aLogicalContainerSize, - AxisOrientationType aAxis) { +PhysicalCoordFromFlexRelativeCoord(nscoord aFlexRelativeCoord, + nscoord aContainerSize, + AxisOrientationType aAxis) { if (AxisGrowsInPositiveDirection(aAxis)) { - return aLogicalPosn; + return aFlexRelativeCoord; } - return aLogicalContainerSize - aLogicalPosn; + return aContainerSize - aFlexRelativeCoord; } // Helper-macro to let us pick one of two expressions to evaluate // (a width expression vs. a height expression), to get a main-axis or // cross-axis component. // For code that has e.g. a nsSize object, FlexboxAxisTracker::GetMainComponent // and GetCrossComponent are cleaner; but in cases where we simply have // two separate expressions for width and height (which may be expensive to @@ -199,44 +201,49 @@ public: } nscoord GetMarginSizeInCrossAxis(const nsMargin& aMargin) const { return IsAxisHorizontal(mCrossAxis) ? aMargin.LeftRight() : aMargin.TopBottom(); } /** - * Converts a logical point into a \"physical\" x,y point. + * Converts a \"flex-relative\" point (a main-axis & cross-axis coordinate) + * into a \"physical\" x,y point. * * In the simplest case where the main-axis is left-to-right and the * cross-axis is top-to-bottom, this just returns - * nsPoint(aMainPosn, aCrossPosn). + * nsPoint(aMainCoord, aCrossCoord). * - * @arg aMainPosn The main-axis position -- i.e an offset from the - * main-start edge of the container's content box. - * @arg aCrossPosn The cross-axis position -- i.e an offset from the - * cross-start edge of the container's content box. + * @arg aMainCoord The main-axis coordinate -- i.e an offset from the + * main-start edge of the container's content box. + * @arg aCrossCoord The cross-axis coordinate -- i.e an offset from the + * cross-start edge of the container's content box. * @return A nsPoint representing the same position (in coordinates * relative to the container's content box). */ - nsPoint PhysicalPointFromLogicalPoint(nscoord aMainPosn, - nscoord aCrossPosn, - nscoord aContainerMainSize, - nscoord aContainerCrossSize) const { - nscoord physicalPosnInMainAxis = - PhysicalPosFromLogicalPos(aMainPosn, aContainerMainSize, mMainAxis); - nscoord physicalPosnInCrossAxis = - PhysicalPosFromLogicalPos(aCrossPosn, aContainerCrossSize, mCrossAxis); + nsPoint PhysicalPointFromFlexRelativePoint(nscoord aMainCoord, + nscoord aCrossCoord, + nscoord aContainerMainSize, + nscoord aContainerCrossSize) const { + nscoord physicalCoordInMainAxis = + PhysicalCoordFromFlexRelativeCoord(aMainCoord, aContainerMainSize, + mMainAxis); + nscoord physicalCoordInCrossAxis = + PhysicalCoordFromFlexRelativeCoord(aCrossCoord, aContainerCrossSize, + mCrossAxis); return IsAxisHorizontal(mMainAxis) ? - nsPoint(physicalPosnInMainAxis, physicalPosnInCrossAxis) : - nsPoint(physicalPosnInCrossAxis, physicalPosnInMainAxis); + nsPoint(physicalCoordInMainAxis, physicalCoordInCrossAxis) : + nsPoint(physicalCoordInCrossAxis, physicalCoordInMainAxis); } - nsSize PhysicalSizeFromLogicalSizes(nscoord aMainSize, - nscoord aCrossSize) const { + + + nsSize PhysicalSizeFromFlexRelativeSizes(nscoord aMainSize, + nscoord aCrossSize) const { return IsAxisHorizontal(mMainAxis) ? nsSize(aMainSize, aCrossSize) : nsSize(aCrossSize, aMainSize); } // Are my axes reversed with respect to what the author asked for? // (We may reverse the axes in the FlexboxAxisTracker constructor and set // this flag, to avoid reflowing our children in bottom-to-top order.) @@ -3247,30 +3254,32 @@ FlexLine::PositionItemsInMainAxis(uint8_ mainAxisPosnTracker.ExitChildFrame(itemMainBorderBoxSize); mainAxisPosnTracker.ExitMargin(item->GetMargin()); mainAxisPosnTracker.TraversePackingSpace(); } } /** - * Given the flex container's \"logical ascent\" (i.e. distance from the + * Given the flex container's \"flex-relative ascent\" (i.e. distance from the * flex container's content-box cross-start edge to its baseline), returns * its actual physical ascent value (the distance from the *border-box* top * edge to its baseline). */ static nscoord -ComputePhysicalAscentFromLogicalAscent(nscoord aLogicalAscent, - nscoord aContentBoxCrossSize, - const nsHTMLReflowState& aReflowState, - const FlexboxAxisTracker& aAxisTracker) +ComputePhysicalAscentFromFlexRelativeAscent( + nscoord aFlexRelativeAscent, + nscoord aContentBoxCrossSize, + const nsHTMLReflowState& aReflowState, + const FlexboxAxisTracker& aAxisTracker) { return aReflowState.ComputedPhysicalBorderPadding().top + - PhysicalPosFromLogicalPos(aLogicalAscent, aContentBoxCrossSize, - aAxisTracker.GetCrossAxis()); + PhysicalCoordFromFlexRelativeCoord(aFlexRelativeAscent, + aContentBoxCrossSize, + aAxisTracker.GetCrossAxis()); } void nsFlexContainerFrame::SizeItemInCrossAxis( nsPresContext* aPresContext, const FlexboxAxisTracker& aAxisTracker, nsHTMLReflowState& aChildReflowState, FlexItem& aItem) @@ -3604,17 +3613,17 @@ nsFlexContainerFrame::DoFlexLayout(nsPre if (!aAxisTracker.AreAxesInternallyReversed()) { nscoord firstLineBaselineOffset = lines.getFirst()->GetBaselineOffset(); if (firstLineBaselineOffset == nscoord_MIN) { // No baseline-aligned items in line. Use sentinel value to prompt us to // get baseline from the first FlexItem after we've reflowed it. flexContainerAscent = nscoord_MIN; } else { flexContainerAscent = - ComputePhysicalAscentFromLogicalAscent( + ComputePhysicalAscentFromFlexRelativeAscent( crossAxisPosnTracker.GetPosition() + firstLineBaselineOffset, contentBoxCrossSize, aReflowState, aAxisTracker); } } for (FlexLine* line = lines.getFirst(); line; line = line->getNext()) { // Main-Axis Alignment - Flexbox spec section 9.5 @@ -3638,17 +3647,17 @@ nsFlexContainerFrame::DoFlexLayout(nsPre if (aAxisTracker.AreAxesInternallyReversed()) { nscoord lastLineBaselineOffset = lines.getLast()->GetBaselineOffset(); if (lastLineBaselineOffset == nscoord_MIN) { // No baseline-aligned items in line. Use sentinel value to prompt us to // get baseline from the last FlexItem after we've reflowed it. flexContainerAscent = nscoord_MIN; } else { flexContainerAscent = - ComputePhysicalAscentFromLogicalAscent( + ComputePhysicalAscentFromFlexRelativeAscent( crossAxisPosnTracker.GetPosition() - lastLineBaselineOffset, contentBoxCrossSize, aReflowState, aAxisTracker); } } // Before giving each child a final reflow, calculate the origin of the // flex container's content box (with respect to its border-box), so that // we can compute our flex item's final positions. @@ -3660,30 +3669,30 @@ nsFlexContainerFrame::DoFlexLayout(nsPre nscoord containerWidth = IsAxisHorizontal(aAxisTracker.GetMainAxis()) ? aContentBoxMainSize : contentBoxCrossSize; // FINAL REFLOW: Give each child frame another chance to reflow, now that // we know its final size and position. for (const FlexLine* line = lines.getFirst(); line; line = line->getNext()) { for (const FlexItem* item = line->GetFirstItem(); item; item = item->getNext()) { - nsPoint physicalPosn = aAxisTracker.PhysicalPointFromLogicalPoint( + nsPoint physicalPosn = aAxisTracker.PhysicalPointFromFlexRelativePoint( item->GetMainPosition(), item->GetCrossPosition(), aContentBoxMainSize, contentBoxCrossSize); // Adjust physicalPosn to be relative to the container's border-box // (i.e. its frame rect), instead of the container's content-box: physicalPosn += containerContentBoxOrigin; //XXX Can we calculate the logical position more directly instead // of this double conversion? nsSize finalFlexedPhysicalSize = - aAxisTracker.PhysicalSizeFromLogicalSizes(item->GetMainSize(), - item->GetCrossSize()); + aAxisTracker.PhysicalSizeFromFlexRelativeSizes(item->GetMainSize(), + item->GetCrossSize()); LogicalPoint framePos(outerWM, physicalPosn, containerWidth - finalFlexedPhysicalSize.width - item->GetBorderPadding().LeftRight()); // (Intentionally snapshotting this before ApplyRelativePositioning, to // maybe use for setting the flex container's baseline.) const nscoord itemNormalBPos = framePos.B(outerWM); @@ -3721,18 +3730,18 @@ nsFlexContainerFrame::DoFlexLayout(nsPre if (item->Frame() == mFrames.FirstChild() && flexContainerAscent == nscoord_MIN) { flexContainerAscent = itemNormalBPos + item->ResolvedAscent(); } } } nsSize desiredContentBoxSize = - aAxisTracker.PhysicalSizeFromLogicalSizes(aContentBoxMainSize, - contentBoxCrossSize); + aAxisTracker.PhysicalSizeFromFlexRelativeSizes(aContentBoxMainSize, + contentBoxCrossSize); aDesiredSize.Width() = desiredContentBoxSize.width + containerBorderPadding.LeftRight(); // Does *NOT* include bottom border/padding yet (we add that a bit lower down) aDesiredSize.Height() = desiredContentBoxSize.height + containerBorderPadding.top; if (flexContainerAscent == nscoord_MIN) {",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "I'm also changing some usages of position/posn/pos in the tweaked code to \"coord\" instead. (so e.g. \"PhysicalPosFromLogicalPos\" is now known as \"PhysicalCoordFromFlexRelativeCoord\"). I'm making this change since \"position\" is ambiguous about whether it's 1- or 2-dimensional value. \"Coord\" is a bit less ambiguous. (Elsewhere in this file, I still have e.g. FlexItem::GetMainPosition/GetCrossPosition, but I think that's less ambiguous.)",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1104875",
        "issue_id": 1104875,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The code here: http://hg.mozilla.org/mozilla-central/annotate/acde07cb4e4d/dom/base/nsGlobalWindow.cpp#l11171 should truncate scriptLocation in some way.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "Hmm. I guess the UI can't do that because we're using a generic dialog?",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "Yes. That and we concatenate it with the l10n string so there's really very little way to tell anything what/how to truncate otherwise.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Fair! I would just lowball it at 60 characters, take the first/last 30 and add an ellipsis in the middle. That will still not be good enough for customized windows themes that have a really high font-size for message-box text, but that's not the 99% case, and this dialog isn't either, so it doesn't seem to me like we should do the (significant amount of) work here to get it right 100% of the time.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch Ellipsize long unresponsive script locations so they don't make the slow script dialog too big (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Er, no, this is bunk. It's better to do on UTF-16, because what I have totally fails on multibyte UTF-8 sequences!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Ellipsize long unresponsive script locations so they don't make the slow script dialog too big \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Fixed typo and https://hg.mozilla.org/integration/mozilla-inbound/rev/7e81094bc8f9",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "include",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1076026",
        "issue_id": 1076026,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Uninitialized lexicals as required by the TDZ shouldn't escape to script and shouldn't be picked up by type sets, which will confuse the type set into thinking it's seen lazyargs.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Uninitialized lexicals as required by the TDZ shouldn't escape to script and shouldn't be picked up by type sets, which will confuse the type set into thinking it's seen lazyargs.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1071367",
        "issue_id": 1071367,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is a regression from bug 1043644 part 1, which switched to using the content viewer bounds instead of the frame bounds to fix behaviour on metro.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Switching back to the frame bounds fixes the problem. It also fixes the problem where, with APZC enabled, the displayport is offset from tile boundaries by the height of the chrome.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Thing that fixes the bug (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Real patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Yeah, that makes sense. Wouldn't expect content viewer bounds to have the right offset.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1324053",
        "issue_id": 1324053,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Ensure that speculative connect and DNS prefetching aren't disabled when annotating tracking channels \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Thanks!",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1319370",
        "issue_id": 1319370,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Based on bug 1188880, jwatt, do you know what's going on here?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Baku, you were the last person to be working on this code. Can you look into this?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "This issue is about how we create a FilePicker and I suspect it is platform depending. On linux, the GTK FilePicker (GTKFileChooser) has a default action. It means that, pressing 'enter', the user confirms the selection of the default selected file/directory.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "We could remove the default action for GTK, windows and mac, or move the focus out of the action button.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "Who's going to decide which way we go here?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "The bug was that, we were taking always the parent directory of the last selected file/directory. In this way we were exposing the full filesystem in this test script.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "needs rebasing for beta",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "needs rebasing for beta applying 1319370.patch patching file dom/html/HTMLInputElement.cpp Hunk #1 FAILED at 479 1 out of 3 hunks FAILED -- saving rejects to file dom/html/HTMLInputElement.cpp.rej patch failed, unable to continue (try -v) patch failed, rejects left in working directory errors during apply, please fix and qrefresh 1319370.patch",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch m-b \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Both bugs still work 100% using Nightly 54.0a1 (2017-02-03) (64-bit)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "I cannot reproduce this STR (from the description of the bug): 1. Open PoC on a fresh URL where directory uploading has never been performed (to make sure it defaults to dekstop) 2. Hold down enter 3. Since webkitdirectory keeps going back a folder every time its used, we only need to make sure a victim keeps hitting enter for at least 2-3 upload dialogues and then we would have successfully grabbed the OS username. We are not going back a folder every time. We stay on the current one. If you see some other issues, please file a new bug.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Yes, please. It's a separate bug. Thanks. And NI me.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 13,
                "quote": "Reproduced the bad behavior on the current Release Version: 51.0.1 20170125094131, then proceeded to verify the fix on: Ubuntu 16.04 x64 / Mac OS X 10.12 / Windows 10 x64 on the following builds: 54.0a1 20170302030206 53.0a2 20170302004002 52.0 20170227080736 Based on the above marking this bug as verified and updating all tracking flags accordingly.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1315285",
        "issue_id": 1315285,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Not sure this is really jemalloc4's fault or not, but starting with the Memory Allocator component for now until there's a better sense of what's going on here. While testing the forthcoming jemalloc 4.3.0 release on Try, glandium and I noticed that Win8 in particular was hitting a lot of hangs along the line of the logs below (the dom-level* tests seem to be best for reliably triggering it): https://treeherder.mozilla.org/logviewer.html#?job_id=30453758&repo=try https://treeherder.mozilla.org/logviewer.html#?job_id=30453765&repo=try",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Both win32 and win64 Talos also have been seeing hangs like: https://treeherder.mozilla.org/logviewer.html#?job_id=30404691&repo=try https://treeherder.mozilla.org/logviewer.html#?job_id=30399341&repo=try",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "I tried bisecting this to a broken jemalloc commit only to realize that it reproduced with the in-tree 4.1.1 version as well. I was eventually able to bisect it down to the debugging patch from bug 1293501 as the culprit.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "For now I have no ideas how could VirtualProtect in necko cause hangs.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Any ideas about what objects the ZwWaitForMultipleObjects is waiting for in memset?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Those stacks don't seem the culprit I'm hunting for in bug 1293501 as those come with jemalloc4. Note the debug patch may stay a bit longer in the tree (and merge to Aurora) because I haven't seen any access violation write crashes that seems from it.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "... except the patch in bug 1293501 looks wrong to me. First, it wastes a page by element in the array, even though only the beginning of that array is meant to be protected. Second, the padding is not large enough to put what follows it out of the protected page. Third, I don't see anything to handle the array being reallocated when its size changes. Which means the protected page stays there, and can end up being given away to something else by jemalloc, while the array itself is not protected anymore. Essentially, it seems to me you're *very* lucky that those crashes are not happening with mozjemalloc already. In fact, for all I know, there may well be unidentified crashes due to that patch.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "Fixed by the bug 1293501 backout.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1314193",
        "issue_id": 1314193,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch return-begin-transaction-fails \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1306719",
        "issue_id": 1306719,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The MemoryProtectionExceptionHandler.cpp was pushed to the different unified build group (and looks like we don't test non-unified build for Mac OSX)",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch fix-MemoryProtectionExceptionHandler.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Erk, more non-unified bustage? Sorry about that. I don't have Mac to compile this on locally, and we don't have a non-unified build in automation for OSX, but if this fixes compilation for you then it's fine. Just did a non-unified build on Windows (was easier than I expected), confirmed nothing is missing there.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1300206",
        "issue_id": 1300206,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Patch coming up to preemptively add some missing includes & declarations to avoid this problem.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/76468/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/76468/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/76468/#review74558",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1263083",
        "issue_id": 1263083,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Any chance you can get a narrower regression window with mozregression ? You can use the --profile switch to run it against your usual profile.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "I've been experiencing this too, but recent (last 2-3 days) Nightlies actually don't even load Inbox completely.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "I filed bug 1263170 for the 'failed to load' issue, which appears in Beta too so it's probably an Inbox change.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 4,
                "quote": "I don't reproduce this on my Linux machine so it might be Mac-specific.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "James, I've not seen bug 1263170 at all. Things load always for me, just takes a lonnggggg time. Gabriele, yeah testing w/ e10s enabled since that is default in a new profile. With e10s off: Super slow initial load, including brief beachballing, but otherwise didn't exhibit the bug.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "I have tested this issue on Mac OS X 10.10 with FF Nightly 48.0a1 (2016-04-10) and I can't reproduce the issue.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "Can you please retest this with the latest build?",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "I've seen this once last week, very slow load but then everything is fine but can't reproduce it anymore.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 9,
                "quote": "So I just checked this on my local (Mac (late 2013 15\", though), OSX 10.11.3, current Nightly) and I can't reproduce it either.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 10,
                "quote": "Tested again on MacBook Pro (Retina, 15-inch, late 2013) OS X 10.11 with the latest Nightly (2016-04-11) and I can't reproduce this issue.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 11,
                "quote": "Considering they can't reproduce, any chance you can try using ./mach mozregression yourself to reproduce the issue on your local machine and get an inbound branch (fx-team, m-i, b2g-i or whatever) regression window? It seems like having such a window might also shed some light on why others aren't reproducing...",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 12,
                "quote": "Considering they can't reproduce, any chance you can try using ./mach mozregression yourself to reproduce the issue on your local machine",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "I can definitely still repro this.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 14,
                "quote": "I looked into it a bit and it seems like layerization is going crazy. My guess is that we end up putting every message into its own layer.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 15,
                "quote": "Matt/Jamie can one of you look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 16,
                "quote": "I cannot personally reproduce the noticeable performance regression, each of these operations always takes about 1 second for me. I did however notice a change in how it layerizes on the 9th.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 17,
                "quote": "The change I notice is that we are using more multi-tiled layers than before. This would explain why it only affects OS X, although even with tiling enabled on linux I cannot reproduce a noticeable performance regression. I ran a bisection looking out for the extra multi-tiled layers and found bug 1221094 to be the culprit, which makes sense. Memory usage after that commit is greater than before. Each of the operations listed as slow will now result in more memory allocations required to perform them. (Perhaps on a hi-dpi display this would be even more pronounced and therefore cause a more noticeable slow down.)",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "I ran a bisection looking out for the extra multi-tiled layers and found bug 1221094 to be the culprit, which makes sense.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 19,
                "quote": "The commit in question usually causes positive improvements in my experience. But I think the combination of it along with some existing bad decisions on this page is what's causing problems. There should be a way to layerize this page better, I'll keep investigating.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 20,
                "quote": "Sorry for the brain dump, but here's another. Each email is given its own layer. Previously these were single-tiled layers, so only use memory for the size of the layer. But since bug 1221094 we use mutli-tiled layers for them. So each of these short and wide layers are using tiles that are far too tall for them, hence the massive increase in memory usage. Bug 1243589 made it so that we don't use multi-tiled layers when the layers are smaller than the tile size, but only when both the width AND height are smaller, whereas these layers are short but wide.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 21,
                "quote": "We need to update that logic to consider width and height separately. I'm not sure what the correct heuristic would be, but these definitely shouldn't be being multi-tiled. That would fix this regression.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 22,
                "quote": "But I also want to find out why each email is getting its own layer in the first place. I'd guess it's something to do with them being transformed, but ideally they'd all be in the one large multi-tiled layer, at least until you hover over one and it gets animated.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Thanks, Jamie. I am on a 4k display and the window is sized to be the entire height and half the width of the display. After your comment, I found that reducing the width substantially improved performance. This likely made each mail fit into one tile, so I think you are on the right track.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/60804/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/60804/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 25,
                "quote": "The reason each email has its own layer is because they are marked as will-change. That is the right thing to do. But we should still be single-tiling instead of multi-tiling, so the above patch makes that the case.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "The heuristic sounds good, but please factor out the condition into a separate variable and add a comment. Something like \"don't waste more than 50% of the tile's pixels in either direction\".",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/60804/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "This patch fixes a performance regression. Take it in 48 beta 6 and aurora.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 29,
                "quote": "I could not reproduce this bug using Fx 48.0a1 build ID:20160407062903 and ID:20160309030419, on OS X 10.11.1 (tested with both e10s enabled and disabled).",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 30,
                "quote": "Can you please confirm if it is still reproducible on your platform?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 31,
                "quote": "I could never reproduce the slowness on my platform (Ubuntu), but I can confirm that the patch fixes what I believe was the cause of the slowness on OS X.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1262069",
        "issue_id": 1262069,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Wrap promise resolution values before storing \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "I seem to recall there were actual reasons for storing the value as-is instead of wrapping into the promise compartment. Have you run the full test suite with this patch? In any case, this won't help with the spidermonkey promise implementation, which we're about to turn on. As in, you're touching code that's about to become dead code.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "A few tests are still running, but so far most of them have passed.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "I could see choosing not to re-wrap the value, on the expectation that some handlers may be in the same compartment that fulfilled the promise. But I don't think that should cause any actual problems, unless there are some weird corner cases with cached WN reflectors. Even if there are, though, I think that re-wrapping for the target compartment is the expected behavior. A call to a promise handler for a promise in a different compartment should be the same as any other call that passes a value into that compartment. Any code that relies on different behavior is, I think, broken.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I just tested with spidermonkey promises enabled, and I no longer get these errors. But the unhandled rejections aren't reported, either.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "From a quick read through Promise.js and Promise.cpp, it looks like the resolution values should be wrapped for the compartment that owns the promise before calling the self-hosted fulfillment methods, so this may not be a problem there. Either way, if the new implementation isn't going to be turned on in this release, I'd still like to address this. These errors are extremely confusing for users, and I'm worried that they may mask issues in our tests.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "You should probably set value to undefined too, or something.... And you probably want a test for whatever thing it is you care about here, so someone doesn't simplify things and re-break it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "I guess the code you're adding comes after we've done the thenable thing. So maybe it's OK to mess with the value at that point.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "What bz said. I have all tests passing on Linux and OS X now, but Windows does weird things.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "In any case, this seems like it's a small enough fix that landing it shouldn't hurt. Given that we want to keep open the option of disabling SM Promise if it misbehaves in bad ways on Aurora or Beta, I think it'd make sense to fix issues with the DOM implementation.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Correct, it's not a problem in the new implementation.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "https://hg.mozilla.org/integration/fx-team/rev/bb1926280d496c73c43f89db6b7b5f8f9165504c Bug 1262069: Wrap promise resolution values before storing. r=bz",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1253884",
        "issue_id": 1253884,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch neg-zero \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "The lack of .0 causes the token to be classified as an integer and then the -0 is lost.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=837955",
        "issue_id": 837955,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Our usual fix for this is to just #define these macros to be empty when PR_LOGGING is off. That fixes this.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch fix \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=835157",
        "issue_id": 835157,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "These are totally unused and I don't think they are part of anyone's future plans either. If anyone does know why these are here, please speak up.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Hmm. I remember why we had these, now. I think they were used for boxing up primitive |this| values. I guess whenever we clean up how we handle primitive |this|, we can deal with this sutff then.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=823917",
        "issue_id": 823917,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "They've supported equivalent functionality through a contextual \"sealed\" keyword since MSVC 2005. Is this only about making MOZ_FINAL expand to final rather than sealed in new-enough MSVC? I'm not complaining if you do that, but it doesn't seem to matter to me much, and if it were me I'd leave it all alone until every compiler we support supports the final contextual keyword.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "After all, I wrote the patch with another cleanup. |#if _MSC_VER >= 1400| is redundant because our minimum compiler requirement is MSVC 2005 (Or MFBT has a different requirement?).",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Try result (along with other patches): https://tbpl.mozilla.org/?tree=Try&rev=ee97ff67d30b",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "mfbt follows overall JS/Gecko compiler requirements (or at least there's been no reason not to follow them so far). rs=me",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=822952",
        "issue_id": 822952,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Tests pass locally. Try push: https://tbpl.mozilla.org/?tree=Try&rev=9c79c64b62d2",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Good catch",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=801993",
        "issue_id": 801993,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "try push: https://tbpl.mozilla.org/?tree=Try&rev=01ef459d190a (I've fixed the orange)",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=783505",
        "issue_id": 783505,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "CCing espindola for last part of comment 1.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "It looks like this was caused by 777174. The problem reduces to gcc 4.2 not accepting typedef bool (*NativeImpl)(); template<NativeImpl Impl> inline bool CallNonGenericMethod() { } template<typename NativeType> class TypedArrayTemplate { typedef TypedArrayTemplate<NativeType> ThisTypeArray; template<int ValueGetter()> static bool GetterImpl() { return CallNonGenericMethod< ThisTypeArray::GetterImpl<ValueGetter> >(); } };",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "git bisect found this to be fixed by http://gcc.gnu.org/bugzilla/show_bug.cgi?id=39608. Which is strange, since is marked as a regression fix. Looking a bit more to see if there is a way to avoid the bug.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch fix gcc 4.2 build. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "I pushed the patch + a hack to use gcc 4.2 to https://tbpl.mozilla.org/?tree=Try&rev=3c393fe37a76",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Fwiw att #652883 fixes my openbsd/gcc 4.2 builds too.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Oh, I don't know that that hack is \"really bad\". It's the circumstances that are bad; the workaround is sensible enough. r=me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "not 100% sure but i think this one can be marked as fixed. my openbsd/gcc 4.2 builds are green again.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "This has also fixed the OS X nightly builds",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=752781",
        "issue_id": 752781,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "A more accurate time would probably be \"started failing right around the time compartment-per-global landed, along with several other scrolling-related tests, but nobody wanted to get stuck filing it.\"",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "I'm not sure how this test worked between April 30 and May 7; as far as I can tell, the test is failing due to changeset c70f3a9b31f8. It initiates scrolling (asynchronous but not smooth) then does a setTimeout(0) to check the results and asserts that scrolling has actually happened. However, now that AsyncScroll isn't flushed until the refresh driver runs, the setTimeout could easily happen before the refresh driver runs the AsyncScroll.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch fix test \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "fix test Please update the \"0-interval timer\" part in the is() comment too. r=mats",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=738440",
        "issue_id": 738440,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I think the old behavior was just a bug. The code set STATE_ATTRIBUTE to a boolean, but it's supposed to be a string. So when QueryCommandValue() tried retrieving \"state_attribute\" as a string, it found nothing. And when QueryCommandState() tried retrieving \"state_all\" as a boolean, it also found nothing. All this just demonstrates that the code here is sufficiently confusing that it baffled the people who wrote it . . . I had to add a special case for useCSS, because the spec says queryCommandState() shouldn't be supported for it. It's legacy cruft, and I want to support as few features as possible for it. Plus, we'd need a special case for it anyway, because we'd have to invert the return value if it were to make any sense.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "r=me, but I think you should also modify http://mxr.mozilla.org/comm-central/source/mozilla/content/html/content/test/test_bug408231.html.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Same as last patch, but with test_bug408231.html fixed. I wrote the test based on bug 738366 being fixed, so it should be false rather than true. Thus bug 738366 needs to land first, or at the same time. This patch will conflict with the bug 738385 changes, but that's okay, it should be easy to merge. (I don't know why queryCommandValue(\"stylewithcss\") is suddenly returning the empty string instead of throwing, but it's moot, because it will do that anyway after bug 738385 lands.)",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=722137",
        "issue_id": 722137,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The patch from bug 698335 should have used GetNextInFlow instead of GetNextSibling.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Test \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=724586",
        "issue_id": 724586,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Also rips out some dangling sharp references and sanifies the control flow a bit. Allows us to rip out about 75 lines of fiddly C string manipulation. There is still more to do here before this code path is sane enough to replace the hash table.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "The extra changes I suggest probably orphan a few variables -- make sure to check for unused warnings before committing a patch with changes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "if (comma && !buf.append(comma, 2)) goto overflow; Or, since I think you said comma's either NULL or \", \", make comma a bool, then buf.append(\", \") -- much clearer.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "if (!buf.append(gsop[j]) || !buf.append(' ')) goto overflow; Goodbye raw char* references!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "finishString would have reported an error if it failed, so this extra report is unnecessary (bad, even, see below).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "if (!buf.append(idstr)) goto overflow;",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "If we can make all goto-overflows be the result of append failures, then Vector::append (whichever overload) would have reported an error, so this is unnecessary (bad, even, since we have assertions that errors aren't multiply-reported). And at that point error/overflow are identical, so they can be unified. And at that point, we can just make the js_LeaveSharpObject happen through a one-off RAII object. I don't think it matters if we leave before finishing the string and setting it in the success case. And at that point, all the error-y gotos become return false! And at that point we declare victory!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Worked like a charm. Rerunning try to ensure I didn't break anything. https://tbpl.mozilla.org/?tree=Try&rev=3eb0895f9745",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1121826",
        "issue_id": 1121826,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I tried to find the relevant spec bits for this. Reading https://url.spec.whatwg.org/#url-writing , it seems it says that a query string must consist of URL units, which are either percent-encoded bytes or in the set of url code points: https://url.spec.whatwg.org/#url-code-points which don't include [ or ] , leading me to think that they should therefore be encoded. However, (a) my success rate when trying to read specs is not great, and (b) the cross-browser inconsistency is not a good sign here.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Anne/bz/valentin, you probably know more than me, can (one of) you comment?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "That change was made in bug 473822.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 4,
                "quote": ":annevk would know which is the right thing to do here.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Per https://url.spec.whatwg.org/#query-state it appears these are not to be escaped when found in a URL. It seems they are non-conforming to appear as such (they are not URL code points), but at the moment they do not get escaped by the parser and therefore what I suggested in bug 473822 is wrong. Testing other browsers using http://intertwingly.net/projects/pegurl/liveview.html shows that none of them escape either \"[\" or \"]\", but that does not explain the behavior people are talking about in the other bug. Perhaps the only problem was that we removed percent-encoding rather than leaving it in place? I'm really sorry about not having done due diligence the last time.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "The relevant spec is RFC 3986. \"pchar\" does not allow \"[\" nor \"]\", thus Firefox is correct in percent-encoding these characters. A recipient that trips over percent-encoding like this is broken and should be fixed.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Thanks Anthony, I agree that we should stop doing that. (I suppose that for display purposes we still might want to show [ and ], but we should not give an altered URL when you start to manipulate or copy it. Same as with Unicode <> ASCII.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Try is green: https://treeherder.mozilla.org/#/jobs?repo=try&revision=b7bb9b8fe50b https://hg.mozilla.org/integration/mozilla-inbound/rev/9124cbf3e75f",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "I reverted the change in nsEscape.cpp and changed the unit test. This should probably be uplifted so users don't get stuck with the bug for too long",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1130065",
        "issue_id": 1130065,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Main changes are to not assert active worker in ::FinishActivate and to finish the RegistrationJob before attempting to activate. Tests are enabled on everything except b2g since they've passed successive retriggers https://treeherder.mozilla.org/#/jobs?repo=try&revision=083037922056 https://treeherder.mozilla.org/#/jobs?repo=try&revision=ee099f65016c2 - this one enables workerUnregister and workerUpdate. Folds: Enable most SW tests Cannot rely on controllerchange firing in an already controlled window. The AbortError case is no longer relevant due to FIFO ordering Too bad we have to use timeouts",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "can you tell me more about the tests commented out?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "You didn't remove this variable from Manager.h",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "why this change?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "indent this line.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "MOZ_ALWAYS_TRUE(NS_SUCCEEDED(NS_DispatchToMainThread(r));",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "#ifdef DEBUG ... You don't use this method in prod builds.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "make Dump() to receive a format string and you can remove the fprintf here. Plus... this debug messages are not really part of this bug. I would like to remove it and add it in a separate bug/patch.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Plus... this debug messages are not really part of this bug. I would like to remove it and add it in a separate bug/patch.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 10,
                "quote": "same here.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 11,
                "quote": "same here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "why this code is comment out?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "same here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "info?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "I'm not really happy about this dump calls :) What about info?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Revert all the test changes. If you really need the Dump() method, can you write it in a separate patch?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "sorry i had to to back this out in https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&revision=491e81cd9cf8 - seems one of this changes was causing on multiple desktop platforms test failures like https://treeherder.mozilla.org/logviewer.html#?job_id=6670670&repo=mozilla-inbound that became frequent to perma failures starting with this csets. Could you take a look at this, thanks!",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 18,
                "quote": "test_workerUpdate.html was failing nearly across the board, so I disabled it.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1130253",
        "issue_id": 1130253,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Sounds similar to bug 1129877. We crash due the promise not being detached when shutting down",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "The problem here is that MediaDecoderReader::Shutdown() returns a promise, but TrackBuffer::RemoveDecoder assumes that it happens synchronously.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "Oh no, that's not it, because MP4Reader::Shutdown does AwaitIdle while shutting down its task queues, and so it's effectively synchronous.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "The problem here is basically that task queue flushing is totally insane and needs to go away. We get ourselves into shutdown state, so we invoke MDSM::FlushDecoding, which flushes the task queue. This destroys a DelayedDispatchToMainThread (on the calling thread!) without giving it a chance to run, which means that it release the subdecoder on the wrong thread and without having called shutdown, and stuff break. The solution is to get rid of flushing. I'm going to try to do bug 1125970 and pick up where cpearce left off.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "This should be fixed by bug 1125970.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1184282",
        "issue_id": 1184282,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The associated comment: > // This can happen ... there is no guarantee that our linebreaking rules > // align with the platform's idea of what constitutes a cluster. seems to indicate that this is unfortunate, yet expected behavior. Perhaps we should just remove the warning.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Perhaps we should just remove the warning.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Remove break suggested inside cluster warning \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Hmmm, given that we're now using harfbuzz in most cases (OSX being the notable exception), I'm sort of surprised that this is happening so much. I think removing the warning is fine but we should probably investigate why this happens so much as it may indicate other bugs.",
                "code": "SOLUTION_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1187056",
        "issue_id": 1187056,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Ok, I can reproduce this manually too, when you after the Gallery is open, you quickly tap on the image to open it as a fullscreen image.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "So this looks like a regression to me. We should find out when this regressed.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Confirmed comment 1. It seems that the bug will only reproduce if I tap into a picture while Gallery is still loading. Flame 2.2 prevented this behavior. If a certain picture is not ready to enter Edit mode, Edit button is grayed out until it's ready. Working on getting the window.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "I cannot reproduce this issue using shallow flashing whatsoever. That means I'll have to full flash to find the window and won't be able to do swaps to find out whether it's Gecko or Gaia issue.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "This is also a problem with test_gallery_delete_image.py.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "And test_gallery_switch_to_camera.py.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I don't understand why ./flash_pvt.py makes this reproduce, but when I do ./flash_pvt.py -d flame-kk -v mozilla-central --eng -g -G -b 20150624080416 it doesn't.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 8,
                "quote": "Fortunately I don't have to do swaps for this one. mozilla-inbound regression window: Last Working Device: Flame BuildID: 20150721075041 Gaia: 4fe0507781f3ed56c8ae5e66dd9489165d1ff68e Gecko: 49ae0961591e Gonk: 41d3e221039d1c4486fc13ff26793a7a39226423 Version: 42.0a1 (2.5 Master) Firmware Version: v18D User Agent: Mozilla/5.0 (Mobile; rv:42.0) Gecko/42.0 Firefox/42.0 First Broken Device: Flame BuildID: 20150721075241 Gaia: 4fe0507781f3ed56c8ae5e66dd9489165d1ff68e Gecko: fee45cd9a4d9 Gonk: 41d3e221039d1c4486fc13ff26793a7a39226423 Version: 42.0a1 (2.5 Master) Firmware Version: v18D User Agent: Mozilla/5.0 (Mobile; rv:42.0) Gecko/42.0 Firefox/42.0 Gaia is the same so it's a Gecko issue. Gecko pushlog: http://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=49ae0961591e&tochange=fee45cd9a4d9",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 9,
                "quote": "This issue is likely caused by changes made in Bug 1178847.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 10,
                "quote": "I can reproduce this behaviour very intermittently. When I do, I see in WebIDE that the buttons in question don't have their onclick listeners registered, which seems very odd. I don't see how my change could have caused that behaviour, since the onclick listeners are registered unconditionally in frames.js. I'll keep digging.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "I can reproduce this behaviour very intermittently.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 12,
                "quote": "So I'm unable to reproduce the problem manually any more. I also can't reproduce it while running test_gallery_edit_photo.py; instead it just times out while waiting for files to load, even though visually I can see on the device that the files are done loading. This is the command I tried: GAIATEST_SKIP_WARNING=1 GAIATEST_ACKNOWLEDGED_RISKS=1 $MARIONETTE_ENV/bin/gaiatest --address=localhost:2828 --testvars gaiatest/testvars_template.json --restart --timeout 120000 gaiatest/tests/functional/gallery/test_gallery_edit_photo.py Without a way to reproduce this problem I can't really do much else. I don't think this test/suite has enough documentation on how to properly run it on a local dev machine.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 13,
                "quote": "So I locally ran the test using today's nightly build, and I can repro the error. Basically it times out after tapping the edit button, and waiting for the canvas view. (Because canvas view doesn't come up). I tapped the edit button manually after the test failed, and it was still unresponsive. Kats, if you need me to try something out here, let me know. It's strange that this happens with low repro rate when I do it manually.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 14,
                "quote": "Oh, I see. That sounds like a bug in the framework. It should actually delete those pictures and only use the picture that was added in the test.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 15,
                "quote": "So what I found out was that I can only repro the bug once for each cold startup. I have to shutdown and power up the phone and run the script to repro the bug, and after that, I cannot reproduce this unless I turn off the phone again. Also I am on 319MB config as well. mwargers is investigating 512MB setup.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 16,
                "quote": "Yeah, I couldn't reproduce after 20 retries, but I could reproduce it 2 times out of 10 using 319MB. If one would want to reproduce manually, I would recommend trying with 256MB.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 17,
                "quote": "It's actually strange that it doesn't do that, because in bug 1044019 this was done supposedly.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Ok, I tried on a flame-kk and I can reproduce the test failure there. For some reason it doesn't repro on Aries. Anyway I can flash a local gecko build on top of a stock pvtbuild and still repro so I do have a chance at debugging this now. I tried flashing a full local build but that made the issue go away. Haven't tried flashing just gaia yet.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 19,
                "quote": "So what appears to be happening is that the gallery.js code is loaded before the meta-viewport tag has taken effect. This results in ScreenLayout.getCurrentLayout('tiny') returning false (because the innerWidth is 980) and so the fullscreenButtons array gets populated with empty things. This causes the test to fail later on. I'm not really sure why the meta-viewport tag is getting processed so late, since it's right at the top of the HTML file, before the <script> tags. Need to dig some more.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 20,
                "quote": "Ok, so the problem is the async-ness of the DOMMetaAdded dispatch at [1]. The meta viewport tag is parsed before the JS is run, but the DOMMetaAdded event itself isn't dispatched until after, so the MobileViewportManager doesn't update the viewport until after. I'm not entirely sure how this was working prior to bug 1178847 since it seems like it should have had the same problem. Nonetheless I think the correct fix is to add a synchronous notification of the meta-viewport tag so that we can update the screen properties immediately. The patch also has the side benefit of not running MobileViewportManager code with random non-viewport meta tags are added, which is nice. However I'm not entirely sure it's ok to be running a reflow synchronously from the DOM building code, if it isn't then I don't see a way to fix this in gecko and it will have to be fixed in the gallery app. Smaug, do you know if this is ok?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "Ok, so the problem is the async-ness of the DOMMetaAdded dispatch at [1]. The meta viewport tag is parsed before the JS is run, but the DOMMetaAdded event itself isn't dispatched until after, so the MobileViewportManager doesn't update the viewport until after.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 22,
                "quote": "However I'm not entirely sure it's ok to be running a reflow synchronously from the DOM building code, if it isn't then I don't see a way to fix this in gecko and it will have to be fixed in the gallery app. Smaug, do you know if this is ok?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 23,
                "quote": "This is unfortunately most probably not safe. We won't reflow at that point, since there are script blockers on stack, but doing anything like MetaViewportChanged() during BindToTree looks scary to me. One would need to explicitly prove that MetaViewportChanged call may not run scripts. So either prove that and assert somewhere hard (RELEASE_ASSERT) that script aren't run, nor events dispatched etc. or Would it help if HTMLMetaElement::CreateAndDispatchEvent didn't use asyncDispatcher->PostDOMEvent(); but asyncDispatcher->RunDOMEventWhenSafe() ?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Yeah using RunDOMEventWhenSafe also fixes it, thanks for the tip! Try push at",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 25,
                "quote": "r+, naturally assuming tryserver results look good",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "Try looks good. There's a frequent M-3 failure on B2G but looking at the \"similar jobs\" pane shows a lot of other pushes from the same time hit that too. More retriggers on it are coming up green, so I assume some glitch in the environment caused those. I'll land it once inbound reopens.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "I just tested locally test_gallery_edit_photo.py and repeated 10 times. I didn't get any failure. Normally, I would definitely see this failure within 5 times, so I think this is really fixed. Thanks for fixing this, Kats!",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 28,
                "quote": "This issue is verified as fixed on Flame and Aries. Ran the 'test_gallery_edit_photo.py' locally 10 times on each device/branch and they all passed without issue. Device: Aries 2.6 BuildID: 20151210122424 Gaia: 7e962276913bd4da7ce5fa7540767107ce322c78 Gecko: 412e4d7ce98ca4dbc37de133d0f26d7e1a59946f Gonk: a19052e4389c3ae2d8fc3e7a74a475401baacc56 Version: 45.0a1 (2.6) Firmware Version: D5803_23.1.A.1.28_NCB.ftf User Agent: Mozilla/5.0 (Mobile; rv:45.0) Gecko/45.0 Firefox/45.0 Device: Flame 2.6 BuildID: 20151210030222 Gaia: 961528f4391668bc89ec0be14fa367cea099b588 Gecko: b40ba117fa757861c9caa660ae989122718b494b Gonk: 205ac4204bbbb2098a8046444acba551ba5dc75a Version: 45.0a1 (2.6) Firmware Version: v18Dv4 User Agent: Mozilla/5.0 (Mobile; rv:45.0) Gecko/45.0 Firefox/45.0 Device: Flame 2.5 BuildID: 20151209170211 Gaia: 7ca639a7bb0bacf27f548841c52617bfc0e3b21f Gecko: a35e8eb98969970d1af28b265bf99a9edd11e9c2 Gonk: 205ac4204bbbb2098a8046444acba551ba5dc75a Version: 44.0a2 (2.5) Firmware Version: v18Dv4 User Agent: Mozilla/5.0 (Mobile; rv:44.0) Gecko/44.0 Firefox/44.0",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1111046",
        "issue_id": 1111046,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1189924",
        "issue_id": 1189924,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Add a background color to the APZ minimap. r=kats",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Ship It!",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1184945",
        "issue_id": 1184945,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In octane-regexp we often miss our fastpath to go from ion jit -> irregexp jit because we need more space in the MatchResultTemplateObject. As a result we take the slow path and do \"ion jit\" -> c++ -> \"irregexp jit\". We allow up to 6 submatches in the fast case. In the benchmark we see cases up to 11 submatches. For these we take a slow path. I doubled the size of the TemplateObject to be a (8 to 16), which allows 14 submatches. This gives me an improvement from 2950 to 3450 on regexp.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Nice! How often are we still taking a slow path because of an undersized template object? It would be nifty to be able to size the result object's array based on the number of matches needed, for better memory utilization and robustness.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Preexisting, but it would be nice if this constant was in a header file that could be referenced by createMatchResultTemplateObject when sizing the template array.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1132780",
        "issue_id": 1132780,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Fix build errors in non-unified build.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "wrong file...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "fix build errors in non-unified build.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Patch for beta branch as part of EME platform uplift.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 5,
                "quote": "Patch for beta branch as part of EME platform uplift.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1080574",
        "issue_id": 1080574,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The change for bug #1218627 has landed, hence I this should be de-facto fixed as geo isn't using the MozSettings API anymore. If you're ok I guess we can just close this.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1055843",
        "issue_id": 1055843,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Fix to existing mochitest to make it fail properly (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "What is the purpose to call play() again?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "It is muted because the playback rate is beyond the valid range.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "It looks like HTMLMediaElement::CheckAutoplayDataReady() doesn't respect playback rate and starts playing despite the playback rate is 0.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Do not pause when playbackRate = 0. Instead don't play anything",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "It is my understand that when playback rate is 0, it should play. E.g. it is not in pause state but in play state. It just happens to play nothing as the rate is 0. As such, the control bar appears to be playing, showing the pause button. This is how chrome handles it as well",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Can we remove |mPausedForPlaybackRateNull| by keeping |mPlaybackRate| only? I think checking |mPlaybackRate == 0| should be equivalent to |mPausedForPlaybackRateNull|. Then we will have fewer state variables to maintain.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Why removing the early return here? Passing playbackRate=0 to MediaDecoderStateMachine will cause assertion.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Why move this line up? I guess it doesn't make a difference.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Do not pause when playbackRate = 0. Instead don't play anything",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "I've changed the logic so HTMLMediaElement has ownership should the decoder play or not. Seems more logical to me, instead of having MediaDecoder::Play() do nothing",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 12,
                "quote": "The playbackRate of the media element should not affect the play/pause state. This is also the reason MediaDecoder have its own play state which could be different from the one of the media element. Therefore, it is possible for an media element to be in play state with its media decoder in pause state.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "But the previous patch seems simpler where MediaDecoder::Play() just returns when |mPausedForPlaybackRateNull| is true.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Include comments from jwwang. Simplify code. Also remove all ambiguities in testing a double as 0",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Revert earlier changes. The initial playrate value would be lost should the user pause then play, breaking the specs",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "test_playback_rate.html timed out on both Android and B2G. Can you check if it is so even without this patch?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 17,
                "quote": "Can you remove the patch https://hg.mozilla.org/try/rev/7ceea5a3497f and Try again? Calling play() again is suspicious to me and might defeat the test of null-playback-rate shouldn't pause.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 18,
                "quote": "This actually reset playbackRate to defaultPlaybackRate, per spec, so it's wrong.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Looks good, sorry for the slow review.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "This should not be necessary, because if we are pausing (internally, while showing that we are in playing state) the media, no sound will be output anyways.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "nit: always use braces, even for single line statements.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "Follow r+",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "Follow r+",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1252039",
        "issue_id": 1252039,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/37115/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/37115/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "https://reviewboard.mozilla.org/r/37115/#review33665",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1217663",
        "issue_id": 1217663,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I420VideoFrame::CreateFrame (media\\webrtc\\trunk\\webrtc\\common_video\\i420_video_frame.cc) doesn't check (or propagate) the return code from its calls to Plane::Copy. In consequence, if Plane::Copy fails due to OOM (which could be intermittent), CreateFrame still sets its |width_| and |height_| members. If the new height and/or width are larger than the old one(s), this causes other code (such as ViEExternalRendererImpl::RenderFrame) to use the larger height and/or width when reading the frame's plane buffers, which causes that code to read memory to which it has no right.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "The bug is in lines 57-9: 48: int I420VideoFrame::CreateFrame(int size_y, const uint8_t* buffer_y, 49: int size_u, const uint8_t* buffer_u, 50: int size_v, const uint8_t* buffer_v, 51: int width, int height, 52: int stride_y, int stride_u, int stride_v) { 53: if (size_y < 1 || size_u < 1 || size_v < 1) 54: return -1; 55: if (CheckDimensions(width, height, stride_y, stride_u, stride_v) < 0) 56: return -1; 57: y_plane_.Copy(size_y, stride_y, buffer_y); 58: u_plane_.Copy(size_u, stride_u, buffer_u); 59: v_plane_.Copy(size_v, stride_v, buffer_v); 60: width_ = width; 61: height_ = height; 62: return 0; 63: } The definition of Plane::Copy (from media\\webrtc\\trunk\\webrtc\\common_video\\plane.cc) is thus: 69: int Plane::Copy(int size, int stride, const uint8_t* buffer) { 70: if (MaybeResize(size) < 0) 71: return -1; 72: memcpy(buffer_.get(), buffer, size); 73: plane_size_ = size; 74: stride_ = stride; 75: return 0; 76: }",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Tentatively sec-high. The allocation (in AlignedMalloc()) is using malloc(), and so is fallible (unlike new). We should check all other derivatives of AlignedMalloc and Plane::Copy, this may well have more duplicates. Pretty hard to do anything with as it's predicated on an OOM, but using very large planes may allow you to OOM \"early\" with the system still largely usable. The update to webrtc.org 43 under way rewrites this code such that it's based on new (and gets rid of the independently-allocated Planes as well). A related bug: bug 881742, which landed in 41. Bug from upstream; since fixed (between upstream branch 40 and 43) by rewrite",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Fixed by landing upstream update to branch 43 in bug 1198458",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1207931",
        "issue_id": 1207931,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "billm, is this expected?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "It seems weird to me. Though maybe this message doesn't matter and can be excised on both the child and the parent sides.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Patch demonstrating the situation.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "It looks like the use of the variable was added in bug 694706 and removed in bug 1056427. Just a bit of dead code that was missed.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "So I think it is okay to remove the message.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Yeah, I think we can get rid of this entirely.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This seems to work.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Nice. This is the code that was fixed in bug 1199534 because it was spamming messages constantly. Turns out it wasn't needed at all!",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1248726",
        "issue_id": 1248726,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The memory management of this structure is quite weird, so add a comment and assertions detailing how it is all supposed to work.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Thanks!",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1424993",
        "issue_id": 1424993,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I'm working on enabling ESLint for dom/presentation. As part of this, I found some undefined variables in PresentationDataChannelSessionTransport.js, along the lines of: throw NS_ERROR_NOT_AVAILABLE; This is meant to be: throw Cr.NS_ERROR_NOT_AVAILABLE; I'm not sure if there's any actual bugs caused by this, a brief look makes me think it would just be broken developer debug information.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/207308/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/207308/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/207308/#review213110",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=734506",
        "issue_id": 734506,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Fix bad throwing code v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Add the types for nameSetters and make the code more robust.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=874258",
        "issue_id": 874258,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Let's see if it fails as an assertion. https://tbpl.mozilla.org/?tree=Try&rev=847064a62b8f",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch warn \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1363344",
        "issue_id": 1363344,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This patch affects the following linux64-qr test jobs (for both opt and debug): - Stops running reftest-no-accel on central, since they don't seem to provide much value over regular reftests. - Starts running mochitest-gpu on central. - Starts running crashtests, reftests, jsreftests, mochitest-gpu and mochitest-webgl on mozilla-inbound and autoland (this matches the set of tests on central). - Promotes all the tests running on central/autoland/inbound to tier-1. Review commit: https://reviewboard.mozilla.org/r/137478/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/137478/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "r? to dustin for the actual config file changes, r? to catlee for the fact that this will increase load on AWS and that we're ok with doing this. I talked with Milan about this yesterday and he said to flag you for review on this.",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I like it -- it's nice to see some of the special-cases going away",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Based on an estimated 23h of additional test load per push, about 3200 pushes on inbound/autoland per month = 73,600h. We pay about $0.02/hr, so that's about an extra $1500 per month, which is fine.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Based on an estimated 23h of additional test load per push, about 3200 pushes on inbound/autoland per month = 73,600h. We pay about $0.02/hr, so that's about an extra $1500 per month, which is fine.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=900384",
        "issue_id": 900384,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is now mappable only on GTK build. Qt doesn't have this key name. And also we need more work on Windows (bug 865561). https://dvcs.w3.org/hg/dom3events/raw-file/tip/html/DOM3Events-key.html#key-Redo",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1024256",
        "issue_id": 1024256,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Blacklist S3TC extension on OSX 10.9 Intel HD 3000 driver because of buggy glCompressedTexSubImage2D with sub-image update \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=587434",
        "issue_id": 587434,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Slow push thisv on CALLXMLNAME checks to make sure we're not pushing a call object onto the stack, sets |this| to NULL.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Testcases have been landed by virtue of being marked in-testsuite+ -> VERIFIED as well.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1395751",
        "issue_id": 1395751,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Bug 1395322 is filed for the real fix.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/175180/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/175180/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/175180/#review180212",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=759033",
        "issue_id": 759033,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I just ran for i in accessible/public/* accessible/src/**/*.cpp accessible/src/**/*.h layout/**/*.h layout/**/*.cpp widget/**/*.cpp widget/**/*.h; do sed -f rename.sed -i $i; done with the sed script I'll attach in a minute and then hit makefiles and a few things my regexs caught by accident with a hammer till it built. I'll push this to try now and see how much I broke on other platforms than linxu64.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached file rename sed script \u2014 Details",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "nit: wrong indent",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "nit: wrong indent",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "ok, not related though",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "would you please indent it properly?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "indent it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "void on new line please",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "indent it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "return type on own line pls, here and below in this file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "indent it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "indent it and no empty line between them?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "indent pls?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "indent pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "same and type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "nit: space before :",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "wrong indent and below too",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "indent pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "space before :",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "indent pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "samer",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 31,
                "quote": "indent pls?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "indent?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 33,
                "quote": "same?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 34,
                "quote": "wrong indent",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 35,
                "quote": "indent pls?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "same?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "same? and below in this file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 38,
                "quote": "indent them? and below in the file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "indent here and below?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 40,
                "quote": "indent here and below in the file?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 41,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "indent here and below in the file?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "same in this file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 44,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "type& name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 46,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 47,
                "quote": "nit: remove inline pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 48,
                "quote": "extra space before method name and wrong indentation of second arg",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 49,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 50,
                "quote": "AccessNode",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 51,
                "quote": "space at the end of line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 52,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 53,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 54,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 55,
                "quote": "space at the end of line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 56,
                "quote": "space at the end of line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 57,
                "quote": "space at the end of line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 58,
                "quote": "space at the end of line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 59,
                "quote": "space at the end of line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 60,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 61,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 62,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 63,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 64,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 65,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 66,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 67,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 68,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 69,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 70,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 71,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 72,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 73,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 74,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 75,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 76,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 77,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 78,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 79,
                "quote": "= nsnull pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 80,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 81,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 82,
                "quote": "space before : pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 83,
                "quote": "btw, you rename the class but you don't rename the file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 84,
                "quote": "pls add const",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 85,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 86,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 87,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 88,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 89,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 90,
                "quote": "return type on new line pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 91,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 92,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 93,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 94,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 95,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 96,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 97,
                "quote": "same and below in this file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 98,
                "quote": "remove this comment pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 99,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 100,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 101,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 102,
                "quote": "return type on own line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 103,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 104,
                "quote": "ret type on own line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 105,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 106,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 107,
                "quote": "return type on own line, name -> aName pls (btw please file gfb bug to remove this method)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 108,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 109,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 110,
                "quote": "ret type on own line",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 111,
                "quote": "ret type on own line, here and below",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 112,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 113,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 114,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 115,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 116,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 117,
                "quote": "nit: space before :",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 118,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 119,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 120,
                "quote": "remove that, we aren't in conflict now",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 121,
                "quote": "pls remove inlines here and below",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 122,
                "quote": "two spaces indentation as above?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 123,
                "quote": "wrong indentation",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 124,
                "quote": "nit: wrong indent",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 125,
                "quote": "nit: wrong indent",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 126,
                "quote": "ok, not related though",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 127,
                "quote": "would you please indent it properly?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 128,
                "quote": "indent it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 129,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 130,
                "quote": "void on new line please",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 131,
                "quote": "indent it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 132,
                "quote": "return type on own line pls, here and below in this file",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 133,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 134,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 135,
                "quote": "indent it?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 136,
                "quote": "indent it and no empty line between them?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 137,
                "quote": "indent pls?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 138,
                "quote": "type* name",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 139,
                "quote": "indent pls",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 140,
                "quote": "same",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 141,
                "quote": "landed https://hg.mozilla.org/integration/mozilla-inbound/rev/ee5b6efa9bda",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=713597",
        "issue_id": 713597,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Null deref crash [@ nsDocument::RequestFullScreen], but only in debug builds?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "This crash only occurs in debug builds.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "In nsDocument::RequestFullScreen My assertions need to be before the call to SetWindowFullScreen(), as that can run script which cancels full-screen, invalidating the assertions.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Patch - move assertions \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1685379",
        "issue_id": 1685379,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This was fixed by Bug 1686384",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 2,
                "quote": "Marking this as Resolved based on Robert's comment from bug 1686384.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1670911",
        "issue_id": 1670911,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This breakage can be fixed by adding connect.facebook.net to urlclassifier.features.socialtracking.skipURLs and urlclassifier.trackingSkipURLs",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "The issue still occurs, with ETP - Strict, Facebook login page is not triggered. Tested with: Browser / Version: Firefox Nightly 210221 (\ud83e\udd8e 87.0a1-20210218092411) Operating System: Samsung Galaxy S8 (Android 9) - 1440 x 2960 pixels, 18.5:9 ratio (~570 ppi density)",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Fixed by our Facebook login shim (riding the release trains on desktop Firefox as of bug 1703829).",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=686900",
        "issue_id": 686900,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch 2 - Move js_InitFunctionClass to GlobalObject code \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch 3 - Rewrite js_InitFunctionAndObjectClasses \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "All this stuff will live in vm/GlobalObject.cpp, so first I'm moving the sub-bits of this to there.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Or: \"Object initialization shouldn't involve a fixed-point computation\" :)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "Looks great. The new code is a little longer but the strange loops in the old code were far from obvious.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "I don't suppose we can rip out the protection around resolve hooks now, can we?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Filed bug 687113 for simplifying that stuff. Someone take it--it's a nice opportunity to improve behavior and delete code at the same time!",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1347860",
        "issue_id": 1347860,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Sotaro: could you take a look at this ? Thanks",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "From the source, returned pointer of HTMLMediaElement::GetCurrentImage() seems not safe. https://dxr.mozilla.org/mozilla-central/source/dom/html/HTMLMediaElement.cpp#1531",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "It seems like a regression of Bug 1345403.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": ":kaku, can you take a look?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Image is locked only within GetCurrentImage().",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "It might be better to return already_AddRefed<>.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "Bug 1347836 handled this issue and has already landed into m-c few hours ago, let's seek if Bug 1347836 solves this crash.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 8,
                "quote": "This does not happen for 1 week. https://brasstacks.mozilla.com/orangefactor/?display=Bug&bugid=1347860&startday=2017-03-13&endday=2017-03-24&tree=all Bug 1347836 should already fix this bug.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=852135",
        "issue_id": 852135,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch v1 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Patch v1.1 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Patch v1.2 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Part a: Reindent some code in nsDOMAttributeMap \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch Part a -w \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch Part b: Get rid of some explicit namespace qualifications \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Part c: Implement the remainder of the WebIDL API \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Attached patch Part d: Move to WebIDL bindings, remove CI and QS \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Part a: Reindent some code in nsDOMAttributeMap",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Part b: Get rid of some explicit namespace qualifications",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Part c: Implement the remainder of the WebIDL API",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Part d: Move to WebIDL bindings, remove CI and QS WrapObject takes a handle for the scope now.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/0fa3623e2a71 https://hg.mozilla.org/mozilla-central/rev/61e10c9a711f https://hg.mozilla.org/mozilla-central/rev/e0b3fa32b67a https://hg.mozilla.org/mozilla-central/rev/12e5adcc5511",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=869069",
        "issue_id": 869069,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "How's my driving?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Siri, please call 1-800-SAF-DRVR. ** Calling 1-800-SAF-DRVR ** \"Hello, welcome to the safe driver hotline. How can I help you?\" I'd like to report that :mconley is a safe driver. That is all. \"Thank you, have a nice day\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Woo! Thanks for the quick turnaround time! https://hg.mozilla.org/projects/jamun/rev/8791cdcd0758",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=585832",
        "issue_id": 585832,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I tested this on my HP TouchSmart tx2 laptop which runs Windows 7 and that machine loads the sites such as https://cvs.khronos.org/svn/repos/registry/trunk/public/webgl/sdk/demos/google/particles/index.html fine.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Since 20100917 build, I have the same issue with a new profile. I checked that webgl.enabled_for_all_site is set to true. It seems to be linked to bug 594874 fix.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Every Intel card as been declared as \"Webgl not recommended\", so webgl is not enabled.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Either, \"webgl not recommended\" status must not disabled webgl, or at least some recent graphic cards must have \"webgl available\" status.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "OK, indeed our feature tests were too strict in that \"not recommended\" ended up blocking. This patch relaxes them so we only block when the feature is really blocked or not available.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "ok, let's play safe and only do this for WebGl.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Regenerated the patch (line ending issue)",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=855335",
        "issue_id": 855335,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I would propose that the first step is to run debugging all the way up to 9, run a text call, and then fix the first message that causes a segfault. Repeat as necessary.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Patch for testing only. Sends logging to printf \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Signaling - fix Wformat warnings in logging (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Signaling - fix Wformat warnings in logging \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "This should fix all of the -Wformat warnings, but not the -Wformat-extra-args or -Wformat-security ones. You can now run with NSPR_LOG_MODULES=signaling:9 without crashing. There is a test patch above that redefines the logging to printf if you want to check the warnings on your build.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/146c6ca0aa6d",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Patch 2 - Signaling fix warnings format-extra-args and format-security \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "This fixes all of the -Wformat-extra-args warnings and all of the -Wformat-security warnings except the ones in fsmcnf.c and fsmdef.c which are caused by the format parameter being the return of another function (get_debug_string). I chose not to address those since that would entail getting replacing all of the get_debug_string calls with literals. I don't think this patch fixes anything that would cause a crash, those were fixed in the first patch.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1340967",
        "issue_id": 1340967,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/113800/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/113800/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Gijs, Fix to align \"Search\" input label. Please see [1], thanks. [1] attachment 8839051 [details]: aligned_search_label.png",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I wonder if this should use 'baseline' instead. Can you check and use either that or 'center' as makes sense? (see docs at https://developer.mozilla.org/en-US/docs/Web/CSS/box-align )",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Tried 'baseline' and it turned out that the position is not centered but slightly upward shifted. TRY: https://treeherder.mozilla.org/#/jobs?repo=try&revision=f9bf47b562e2951855bcd67943bb3dc8936f2200",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "I think it would be better to have the \"search\" as placeholder text like it has been done in bug 1324171.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Fischer, can you check with UX and file a followup for this? Thanks.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Mark, It seems there is a rule for the search label of a search input box.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Could you please check, thanks.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "Just check with UX: Mark. The spec will be updated.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I have reproduced this bug with Nightly 54.0a1 (2017-02-19) on Windows 10, 64 bit! The Bug's fix is now verified on Latest Nightly 54.0a1 Build ID 20170228030203 User Agent Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:54.0) Gecko/20100101 Firefox/54.0 [bugday-20170301]",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "While verifying the fix of this bug with Latest Nightly 54.0a1 (2017-02-28) on Windows 8.1, 64 bit, I felt that the \"search\" is still less center aligned. I have attached a screenshot of the fix that I saw. But this doesn't resemble to the one of comment 1. Is the current fix (attached in the attachment) should be expected as the fix?",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "While testing with 54.0a1 (2017-03-01) (32-bit) i see the same issue as Azmina : label is under aligned",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "This is going away in bug 1343477 anyway",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 14,
                "quote": "I expect what you're comparing is the end of the label only, which is obviously shorter, rather than taking into account the rest of the label, with the top of the S and h. If you measure those distances, this looks centered to me (plus, if align=center didn't do its job here, that wouldn't be this bug's fault but a separate bug in XUL or Layout land).",
                "code": "SOLUTION_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1179123",
        "issue_id": 1179123,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I cannot reproduce this in release channel, hence likely a regression.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "I just reproduced it and submit one: bp-e2b8091e-7f3d-4167-8bf1-121152150701",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "I can repro on windows on 42, but not on 39.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Confirmed it is a regression since bug 947854.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "This bug happened at the end of nsINode::doRemoveChildAt(). That method calls nsXULElement::UnbindFromTree() there, which calls nsFrameLoader::Destroy() -> nsDocument::SetSubDocumentFor() to remove the child document from the XUL document, then calls nsElement::UnbindFromTree() -> nsDocument::ExitFullscreen() to exit fullscreen on the root document. Since the child document has been detached at this point, we won't be able to visit that document to exit fullscreen there. Then the method calls the destructor of mozAutoDocUpdate, which eventually calls nsDocument::OnPageHide() which again tries to exit fullscreen, but finds the root has exited fullscreen.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "Not sure how this is fixed in the current m-i. I thought about replacing FullscreenRoots with FullscreenLeaves to track the leaf documents instead of roots. That could work now, but once the Fullscreen API spec is updated so that the fullscreen element is no longer necessarily in the same containing chain, maintaining the list of leaf documents could be more tricky.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch mochitest patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "So I don't know how we could then land this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "And in fact, this feels like a valid case, so I don't see need for NS_NOTREACHED. Just return. With that, r+",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "One day I'll learn why people like Promises so much. This took about 10x more time to read than if this hadn't been so Promise heavy ;) I can perhaps blame myself, since I write so little JS.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/aba278798298 https://hg.mozilla.org/integration/mozilla-inbound/rev/1d669992e0da",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Seems like a pretty safe fix for a crash and has been on m-c for a few days. Let's get this into beta3. Beta+ Aurora+",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1421905",
        "issue_id": 1421905,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Regression range: https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=5043401c5447ab8cfb6edef4b806e1ad52e53ddc&tochange=8696159a170c286813795dba1fe1cebb623e3410",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "What I'm seeing here is a good ol' race: in the sidebar initialization code, in some rare cases we might update the UI before we are done initializing Weave.Service [0][1][2]. That means we show a blank screen. From there it all goes downhill: since the tab engine is disabled, SyncedTabs.jsm never triggers a UI update since it only listens to \"tab engine sync finished\" events [3]. So we stay on that blank screen forever.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "A simple fix is to listen to \"weave:service:ready\", so we can update the UI one last time. Ultimately, I don't think isConfiguredToSyncTabs is the right abstraction because it assumes that the tab engine is enabled if Service is not ready. We should refactor that to explicitly make the distinction between these states, but it is a bit more work.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/204290/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/204290/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "please comment that this is an intended fallthrough.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/204290/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "This bug fix has verified in Nightly build (20180104220114). Thanks!",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1401249",
        "issue_id": 1401249,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In bug 1357517, Preferences.get was replaced by getStringPref. In bug 1397379, we added an `undefined` parameter to it as the default return value, to avoid it throwing an error. That worked in preventing the error from being thrown, but turns out that the value returned is actually `null` instead of `undefined` (as documented in bug 1357517 comment 63), but the switch statement below only checks for `undefined`.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/181366/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/181366/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/181366/#review186590",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Fix for click to play system addon, so that new users will get this option. This should be in the 56 RC2 later on this week.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 5,
                "quote": "I managed to verify this issue on Firefox 57.0a1 (2017-09-19) (64-bit), under Windows 10x64. Click-to-Play staged rollout is set to 1.4 by default and Shockwave Flash is set to 'Ask to Activate' by default. I'm not marking this issue Verified Fix until I can confirm the fix also on Firefox 56.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "I managed to verify this issue also on Firefox 56.0-build3, under Windows 10x64, macOS 10.12 and under Ubuntu 16.04x64. Shockwave Flash is set by default to 'Ask to Activate' and Click-to-Play staged rollout is set to 1.4.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1357049",
        "issue_id": 1357049,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I'd still like to use the <script> method of running the script in the webpage, it will ensure that we're using the webpage's privileges to run it safely. Have you tried using a resource URI instead of a chrome one. Both should work from the content process in theory but maybe because we're loading from chrome we're getting the wrong privileges.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I think we don't need to include the full UITour-lib into onboarding. Since the only function we use in UITour is `showHighlight`, we can pick the message sending portion from UITour and do it in onboarding. I tested the following script on about:home, about:newtab, and activity-stream, they all works fine. Put `_sendEvent` as one of the onboarding method ``` _sendEvent(action, data) { var event = new this._window.CustomEvent(\"mozUITour\", { bubbles: true, detail: { action, data: data || {} } }); this._window.document.dispatchEvent(event); } ``` Embed this in button action (this might be too simple to not worth wrap another layer) ``` this._sendEvent(\"showHighlight\", { target: \"addons\" }); ```",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Just discussed this offline and we think we're not sure if it's an API that keep unchanged, and there's no similar way of using the library like that. So maybe we should try using UI-Tourlib.js as a whole first.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/147540/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/147540/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "I tried to move UITour-lib.js as resource:// but the result is the same. I can't access Mozilla.UITour created from content window from framescript. But scripts inside content window can access it. I was told it's blocked intentionally for content window (but I didn't remember the detail for now, I'll put the corresponding details if needed). So some solutions came to me are to move some code to content window altogether. The selections may be like 1. Just move the event listener out to content window. And when we need to communicate something between listener and framescript we just dispatch a new CustomEvent. 2. Move almost all the code out to the content window, but we're not able to move them out completely since we still need some code from framescript for jobs like accessing properties in the future. 3. other possibility?",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "I personally more prefer the 1st choice and just made a sample patch based on that.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Mossop how do you think about it?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "Oh I didn't realise you were trying to access it from the framescript. You'd need to bypass the X-ray wrappers to get at the object in the content window.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "This sounds like a sane approach to me. I'll review the patch now.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "This looks good, please just double check the button wording before landing.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "This prototype suggests the button should be \"Show Me Where To Find Private Browsing\". Is there a more up to date spec?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Nit: please use `.onboarding-no-button` since we are scoping our selectors and have doen this with other selectors, thanks.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "To make a correct button action I think we should also take `setCompleted` into consideration",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "let's organize with alphabet order",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Though `setCompleted` is now a placeholder, we still need to call `setCompleted` from the target tour to mark the call-to-action as completed (and implement the action later). So to complete a button action, we need find a way to access `tour.setCompleted` in this script.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "a redundant line here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "put button in grid can't fulfill the spec position requirement. I suggest use `position: absolute` (as close button) instead. With this way we don't need to add `onboarding-no-button` class as well. Here's the style I've tested ``` .onboarding-tour-button > button { position: absolute; bottom: 30px; offset-inline-end: 26px; padding: 10px 20px; font-size: 15px; font-weight: 600; line-height: 21px; background: #0d96ff; border: none; border-radius: 3px; color: #fff; box-shadow: 0 1px 0 rgba(0,0,0,0.23); cursor: pointer; } ```",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/147540/diff/2-3/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "https://reviewboard.mozilla.org/r/147540/#review152846",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/147540/diff/3-4/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/147540/diff/4-5/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "The easiest solution for me is to stretch the range of the page grid to the bottom of the page, see the patch. Although page grid overlaps footer, but as long as we don't write page description and footer super long it should be fine, and we can place button near the bottom to met the latest spec.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 23,
                "quote": "please make sure other tests green before landing",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "don't need this now",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/147540/diff/5-6/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 26,
                "quote": "I have seen the feature being implemented with latest Nightly 56.0a1 on Windows 10 (64 bit). This bug's fix is now verified in Latest Nightly. Build ID : 20170616030207 User Agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 [bugday 20170614]",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 27,
                "quote": "This issue has been verified on Win 10 x64.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1355481",
        "issue_id": 1355481,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It looks like this should be referencing this.weaveService.ready, as already done a few lines up in that function.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/130904/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/130904/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/130904/#review133636",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Backed out for breaking many tests: https://hg.mozilla.org/integration/autoland/rev/b708d01388e3862be454e28985755687fe2bb0d4 Push with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&revision=e5e754f197cd5f1f0bc3c4179c9f1236b3b43c48&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable Failure log: https://treeherder.mozilla.org/logviewer.html#?job_id=92380435&repo=autoland",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 5,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/130904/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1353954",
        "issue_id": 1353954,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/148814/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/148814/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/148814/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://reviewboard.mozilla.org/r/148814/#review153536",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "This feature \"Enable the browser.preferences.search preference to turn on in-content filtering of the preferences\" has been implemented with Latest Nightly 56.0a1 on Windows 10 (64 Bit). Build ID: 20170615030208 User Agent : Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0 [bugday-20170614]",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Build ID: 20170618030207 User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 \"browser.preferences.search\" pref is turned on by default on Firefox Nightly 56.0a1 on Windows 10 x 64, Mac OS X 10.12 and Ubuntu 16.04 x64.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1265066",
        "issue_id": 1265066,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached file MozReview Request: Bug 1265066 - Hide the separator em dash in bookmark keyword awesomebar results. r?mak \u2014 Details Review commit: https://reviewboard.mozilla.org/r/46849/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/46849/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/46849/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Test fixes due to re-setting the type attribute: https://treeherder.mozilla.org/#/jobs?repo=try&revision=7058cf4d38c7",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "https://reviewboard.mozilla.org/r/46849/#review44185",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I have reproduced this with Nightly 48.0a1 (2016-04-16) on Elementary OS 64bit. This fix is now verified on Firefox release 48.0 Build ID 20160726073904 User Agent Mozilla/5.0 (X11; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0 [bugday-20160803]",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1249818",
        "issue_id": 1249818,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is regression from bug 1219215 (presumably). Regression range: > https://hg.mozilla.org/integration/fx-team/pushloghtml?fromchange=be27e36ce427df475b3ff827d8c0258c1c34c5b5&tochange=a67a25a5af7446d8ae9beb453bcfa12be368fcef",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "I'm pretty sure we'd want to fix this and wontfix bug 1200877, see: https://dxr.mozilla.org/mozilla-central/rev/af6356a3e8c56036b74ba097395356d9c6e6c5a3/browser/themes/windows/browser.css#2007-2015 and bug 987067 / bug 887397. It looks like this regression has affected OS X ever since they made the switch away from mozmousehittest, but nobody noticed. Since bug 1219215 it will have affected Windows as well. The cause is that the entire tab element is marked as \"no-drag\", and we use the clip-path only on the background of the tab. So we should probably tweak the drag region for these items in Firefox's theme code...",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Philipp is out, moving to Stephen - Stephen, can you take a look at comment #3 and let me know your thoughts? Thanks!",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "I'd like to sum up _facts_ about this whole thing: 1) It started in bug 887397 where _firefox_developers_ (who of course were using MacOS) decided to fix their flaw in Australis theme (on MacOS). There're also 2 duplicates reported for MacOS. 2) Bug 887397 was fixed in a very unusual way: instead of increasing margin (or height of empty area) it was decided to \"sometimes ignore mouse actions applied to background tab\" Firefox is the only application in my lifetime which does such malicious thing. 3) As a response to bug 887397 (MacOS-only issue, remember?) there were several reports from Windows users. It's a real breakage on Windows (let's forget about Australis itself for now). 4) All users in CC list in bug 887397 are familiar to Nightly, except for arminwagner2008, but still there're no reports about this issue, and most of those people aren't even in CC list in this bug. I conclude that they just wanted that fancy breakage for one moment, and now they forgot about it. 5)(minor) On Windows (if you ever used it), it's really convenient to drag window using area around caption buttons (minimize,resize,close).",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "It'd be a great idea (at least on Windows) to remove the bug implemented in bug 887397 and instead create/improve a special empty area preserved for dragging OR increase draggable area above tabs as said in (2). OR compress background tabs in height (also a bad option), to avoid 'dead areas' and 'magic buttons' occurrences. OR just remove the bug 887397, because there were no such bug on Windows.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "While this is a recent regression in 47, it seems polishy to me. If the end-users happen to click on the top 5 pixels and are unable to switch tabs, they can workaround by using the other areas of the background tab header area and switch tabs. I think it might be too late to fix this in 47 and would not consider it a release blocker.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "In that case we should just go ahead and remove the clip-path without waiting for UX input, since the current behavior is clearly broken and the worst of all available options.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Well, removing the clip-path is one option to \"fix\" the regression instance. I am not sure whether or not there are (immediate/easy/upliftable) others, which is why I asked - I don't know that there's a way to restrict the drag stuff without e.g. applying the clip path to the tabstrip (and even then... not 100% that would fix it) which I'd expect to cause other issues (e.g. with dnd on the tabstrip). However, I disagree that the current state is necessarily worse than the result of removing the clip path. If we accept the original reason for having the clip path, which was to avoid misclicks/drags on tabs when trying to interact with the titlebar, then the failure mode that results from removing the clip path is worse than having the clip path be dead space. That is, if you try and move a window or otherwise interact with the titlebar and \"miss\" and hit the tabs instead, \"nothing happens\" is better than \"you detach a tab into a window\" or \"you change tab selection and lose your context\". As a result I don't think this bug warrants doing anything right now. We can ping Stephen when he's awake and see if we can make progress that way.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I think the decision in bug 887397 was the wrong one. On OS X you can drag the entire window by using any visible chrome surface and on Windows the window drag area is not very short.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "What we currently have due to this bug is dead space. We should make the tab area manipulate the tab and the window area manipulate the window.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "Attached patch patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "This patch fixes a regression. Take it in beta 7 and aurora.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 13,
                "quote": "I managed to reproduce this bug on Nightly 47.0a1 (2016-02-19). I also investigated it using - Windows 10 x64 - Ubuntu 14.04 x86 - Mac OS X 10.11.1 There are some problems with latest Nightly 50.0a1 (2016-07-10) build on Mac - there is a narrow area for which two actions are overlapping: window dragging and tab dragging (see the screencast https://drive.google.com/file/d/0B0nYKG6PRiCcVFdNMEh2a21NVnc/view?usp=sharing). Also, it seems that on Windows and Mac the fix didn't land yet for Aurora and Beta. I will continue the verification process when the fix will land.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 14,
                "quote": "Could you please check if it was reproducible before bug 887397, e.g. on Nightly from 2014-03-06 ?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "I tested this on Nightly 2014-03-06 and also on Nightly 2014-03-08 and I couldn't reproduce the overlapping. Besides this, this problem is encountered on Nightly 2016-07-06 (before Bug 1249818 fix landed to mozilla-central). I will further investigate this as soon as possible.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 16,
                "quote": "I managed to verify this bug on - latest Nightly 50.0a1 (2016-07-13) - latest Aurora 49.0a2 (2016-07-13) - 48.0b7 build1 (20160711002726) using - Windows 10 x64 - Ubuntu 14.04 x86 - Mac OS X 10.11 The fix landed and it works as expected. I didn't notice any misbehaviour, except the issue mentioned in comment 19, but it seems that this is an old regression and so, I logged Bug 1286545 for it. I will set the corresponding flags.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1097236",
        "issue_id": 1097236,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I also see this.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Patch v1.1 (obsolete) \u2014 Details \u2014 Splinter Review Fixed error in commit message",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "This image is only swapped out in the dark theme, so this makes sense (although it's a bit weird, so please add a comment explaining this).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Reassigning the review to someone who can do it.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "As a browser peer, I will delegate review for this to bgrins.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "We normally use #main-window instead of :root for some but I don't know why.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Added comment explaining the selector.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Well, looks like the comment didn't get added.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1073339",
        "issue_id": 1073339,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "My assumption is that this is due to focus issues around popups on Linux, which we've had troubles with in the past.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Also browser_search_favicon.js. I can see the same problem intermittently with e10s on Windows, and see no reason to believe they are different",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "so I'm opening a new bug to also disable these tests with e10s keeping this bug number as the reason.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 4,
                "quote": "As to the reason: I'm seeing that the failure in e10s is caused due to detachController in autocomplete.xml being called during the test, causing the search to stop before we've got the results we expect. detachController is called via: _adjustFocusAfterTabSwitch@chrome://browser/content/tabbrowser.xml:1251:9 _finalizeTabSwitch@chrome://browser/content/tabbrowser.xml:3273:11 set_selectedIndex/<@chrome://browser/content/tabbrowser.xml:5252:15 Handler.prototype.process@resource://gre/modules/Promise.jsm -> resource://gre/modules/Promise-backend.js:865:23 this.PromiseWalker.walkerLoop@resource://gre/modules/Promise.jsm -> resource://gre/modules/Promise-backend.js:744:7 which is tabbrowser focusing the new tab asynchronously.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Attached patch 0001-Bug-1073339-Enable-autocomplete-tests-for-Linux-and-.patch (obsolete) \u2014 Details \u2014 Splinter Review This is based off of the patches from bug 1075450.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch 0002-Bug-1073339-Convert-from-CRLF-to-LF-for-browser_acti.patch (obsolete) \u2014 Details \u2014 Splinter Review Windows -> Unix line endings.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Thanks for looking into this :) It's been driving me batty. Will also need to deal with browser_autocomplete_autoselect.js, added in bug 1067903.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Will also need to deal with browser_autocomplete_autoselect.js, added in bug 1067903.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 9,
                "quote": "Nit: Rename, so we don't accidentally assume it's a global?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Attached patch 0001-Bug-1073339-Enable-autocomplete-tests-for-Linux-and-.patch, v2 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Attached patch 0002-Bug-1073339-Convert-from-CRLF-to-LF-for-autocomplete.patch, v2 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Try push with unifiedcomplete=false: https://tbpl.mozilla.org/?tree=Try&rev=3ee73b9c370d Try push with unifiedcomplete=true: https://tbpl.mozilla.org/?tree=Try&rev=2d7106bda22e",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Doesn't look great with e10s and unifiedcomplete enabled. If only I could run e10s tests locally...",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 14,
                "quote": "you can by passing --e10s to mach mochitest-browser?",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 15,
                "quote": "Currently broken due to bug 1103159 unfortunately.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 16,
                "quote": "I don't see any obvious reason why this is failing on Try :\\",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Updated due to test changes.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Attached patch 0001-Bug-1073339-Enable-autocomplete-tests-for-Linux-and-.patch, v3 (obsolete) \u2014 Details \u2014 Splinter Review This is looking better: https://tbpl.mozilla.org/?tree=Try&rev=497aac59ca3a https://tbpl.mozilla.org/?tree=Try&rev=d98d73126544",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Look like browser_action_keyword.js should get updated too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Attached patch 0001-Bug-1073339-Enable-autocomplete-tests-for-Linux-and-.patch, v4 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=948882",
        "issue_id": 948882,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Yes, the inline style should be moved to an external file. I haven't checked dirListing.css, but it looks like we should create a new file for this (crashes.css or so). Please also move the inline JavaScript in line 77 (onclick=...) to crashes.js.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch bug-948882.patch (obsolete) \u2014 Details \u2014 Splinter Review I am noob here.This is my first patch .",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "This looks good, aside from the small nits below :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Nit: Change the extra space here at the end to a /> (instead of `...crashes.css\" >`, have `...crashes.css\"/>`)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Nit: There's an extra space, try to align the parentheses.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch bug.patch (obsolete) \u2014 Details \u2014 Splinter Review Hi Manish Added !",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "This looks good :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "OK, looking good for a first start :-) This removes the inline styles but leaves inline scripts. Can you modify crashes.xhtml so that \"onclick\" and \"onload\" attributes are replaced by JavaScript that adds event handlers (in crashes.js)? You can look how other volunteers have fixed this (In bug 948881 for example). See also our project wiki page! https://wiki.mozilla.org/Security/Inline_Scripts_and_Styles",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Can you modify crashes.xhtml so that \"onclick\" and \"onload\" attributes are replaced by JavaScript that adds event handlers (in crashes.js)? You can look how other volunteers have fixed this (In bug 948881 for example). See also our project wiki page! https://wiki.mozilla.org/Security/Inline_Scripts_and_Styles",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 10,
                "quote": "Attached patch bug_final.patch (obsolete) \u2014 Details \u2014 Splinter Review Hello Frederik Done ! I have attached here also.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "This looks good. Some indentation may be called for (split the handlers across multiple lines), but otherwise it should work.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "This looks good. Can you use DOMContentLoaded instead of window's onload?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Attached patch bug_final.patch (obsolete) \u2014 Details \u2014 Splinter Review Done !",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "One small fix, and then I think you're all set :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Nit: There's an extra space right before \"DomContentLoaded\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Attached patch bug_final.patch (obsolete) \u2014 Details \u2014 Splinter Review Sorry ! Thanks for pointing out",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "Good progress!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Sorry I *just* noticed this: The tag with the 'clear-reports' Id is only available after the page has loaded, not when the script is executed. You could add some newlines about the following DOMContentLoaded handler and add this click event handler in there! Would you please test your next patch? I know it's a steep curve, but it's not that hard: https://developer.mozilla.org/en-US/docs/Simple_Firefox_build",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Would you please test your next patch? I know it's a steep curve, but it's not that hard: https://developer.mozilla.org/en-US/docs/Simple_Firefox_build",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 20,
                "quote": "Biraj, can you address my recent comments? This patch is nearly ready!",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 21,
                "quote": "Attached patch bug_final.patch (obsolete) \u2014 Details \u2014 Splinter Review sorry for late reply. I was busy with my project. I have attached the patch here.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 22,
                "quote": "Looks good. One more thing though:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "Adding the event listener for clear-reports has to be placed in the event handler for DOMContentLoaded, otherwise JavaScript doesn't see the button yet. Can you please address this and test your next patch?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Can you please address this and test your next patch?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 25,
                "quote": "Attached patch bug_final.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 26,
                "quote": "Closer and closer :) Please address the following comments:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "I just noticed your querySelector is not working. It is also better for performance if you use document.getElementById() instead. You can wrap all your DOMContentLoaded things into one function. Please introduce line breaks after { and } and use indentation as discussed in our style guides (https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Coding_Style#JavaScript_practices) You may start with something like this:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 28,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/140048/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/140048/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 29,
                "quote": "Looks good! Note, that I am not a browser peer, so we need another reviewer here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "I happened to come across this bug, so rs=me on the patch from Santiago, and I landed it: https://hg.mozilla.org/integration/mozilla-inbound/rev/1034f8be097fd6d2f8eda8f7f7d277b92d91ff41",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 31,
                "quote": "Backed out for ESlint failures on /toolkit/crashreporter/content/crashes.js backout: https://hg.mozilla.org/integration/mozilla-inbound/rev/dfff9e92ca9710b2e56e0a38f86362b7a8903049 push with failures: https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&revision=1034f8be097fd6d2f8eda8f7f7d277b92d91ff41&selectedJob=183762018 failure log: https://treeherder.mozilla.org/logviewer.html#?job_id=183762018&repo=mozilla-inbound&lineNumber=245",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 32,
                "quote": "Pushed by gijskruitbosch@gmail.com: https://hg.mozilla.org/integration/mozilla-inbound/rev/75df8c6facf7 Move inline scripts and styles into separate file for toolkit/crashreporter/content/crashes.xhtml (about:crashes). r=freddyb,gijs",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=794101",
        "issue_id": 794101,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Changes since the last update: #2089 Removes unnecessary ctx.mozCurrentTransformInverse transforms #2091 Refresh the zoom settings after rotating the pages #2102 Fix regression from #2087. #2107 Fix gh-pages bloat #2106 Adds text layer testing #2111 Move font translation to the worker #2100 Fix zoom out keyboard shortcut for mac. #2115 Refactor text extraction / font loading logic #2122 Update index template. #2123 Fixes RTL text extraction #2125 Add 'text' test coverage for simpletype3font + arabiccidtruetype-pdf test PDF #2130 Update Japanese l10n #2132 Update zh-TW translation #2136 Fix l10n labels ids for rotation menu items #2124 Provides right fallback fonts for text layer #2116 Mozilla central change for metro. #2118 Removing font loading hack from MOZCENTRAL #2110 Use document fragment in text layer #2143 Fix current.x for type3 font word break #2131 Metadata optimization #2058 Small fixes for normal and potential post-compilation bugs #2145 Renaming export to exportData #2155 Fix issue #2141 #2144 Update the Arabic translation #2160 Handle Arabic Ligatures in issue #2141 #2162 Fullscreen updates for latest (unprefixed) spec. #2146 Workaround for android gb browser bug #2153 Renames fullscreen to presentation mode #2127 Use the text extracted in the getTextContent function for the divs of the textLayer.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Update pdf.js to version 0.5.184 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Dave, mind taking a look?",
                "code": "CODE_REVIEW_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=682449",
        "issue_id": 682449,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Caused by: JS Component Loader: ERROR resource://services-sync/resource.js:412 SyntaxError: redefining delete is deprecated",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "I love how something that's \"deprecated\" throws a SyntaxError.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=667586",
        "issue_id": 667586,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "On a non-verified page, typing in the URL bar makes the identity box revert to default favicon, no text, and gray background. This simply makes it work the same way for verified pages to avoid mode errors.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "On a non-verified page, typing in the URL bar makes the identity box revert to default favicon, no text, and gray background. This simply makes it work the same way for verified pages to avoid mode errors.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "This seems less than ideal when editing a URL rather than replacing it, which could be the reason why it wasn't done this way in the first place.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "We're already clearing the favicon. If you're concerned about the shifting of the input text, how about setting visibility: hidden on #identity-icon-labels, instead of visibility: collapse? The main thing is that we don't want the browser to look like it's in a domain-specific mode, because it's not.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "Might look weird, but that's the only compromise I could think of as well.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Maybe the label could be really faint instead of hidden to prevent the identity box from looking broken.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Making that entire region blank felt weird, since it left the text floating in space, so I removed the text & icons while leaving the block's background and border.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Here's the alternate approach of hiding the entire identity block (and the arrow panel icons to the left of it) including its border. Feels weird, since it leaves the URL bar text floating a large number of pixels away from the left border of the URL bar.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "s/visibility: hidden/opacity: 0/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "This breaks the autocomplete activity icon. Also, clicking the identity block is supposed to restore the page's URL.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "If it is easy enough to clear the identity block out of the ui, without shifting the text of the URL (just having it turn invible), then I'm fine with us doing this now. It does bother me that it looks like you are sending information to the identity of the site that you are currently on. If it isn't easy, we can just try to fix this with a bunch of proposed changes later on.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 12,
                "quote": "It's not clear to me that this bug even started with the right premise. While the identity box doesn't correspond to the location bar value anymore when editing it, which can hardly be a surprise to someone editing the value, it does correspond to the page. I see no reason to give this away when all proposed solutions are somehow weird in their own way.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "We hide the bookmark star while the location bar value is being edited exactly because this UI is confusing. If we end up moving the identity block as part with the changes for bug 674744, then this problem will also be fixed. I won't be working on this anymore until there's a clear direction following those changes.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 14,
                "quote": "This reverts the identity block to the generic state when the pageproxystate is invalid.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "This patch moves the attribute selector to the right-most selector so it will be a little more efficient, as well as removes the need to reset properties since it will now only apply the elevated identity states if the pageproxystate is valid.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "As mentioned here before, shifting the input text via hiding #identity-icon-labels is undesirable. I have no good proposal what to do about this, other than not worrying about this bug; the icon always and reliably reflecting the current page's security status can easily be seen as a feature.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "I helped Jared produce this version of the patch and approve of it from a UX standpoint. This keeps the identity block consistent with the rest of the URL bar's state, especially when the URL bar is not focused.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "It's not as consistent as you may think. The globe icon has a meaning as well, one that doesn't really make sense here. Chrome changes the icon to a search glass and blocks clicks on it, whereas we revert the location bar value and show the identity popup.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "It changes to a search glass to reflect that the current entered value will navigate to a search result page upon submission. We should do that (and blocking clicks) too, but our uriFixup code is currently non-deterministic (i.e. we don't know whether we will end up on a search results page b/c we try unqualified host lookup first), so we need to fix that first.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 20,
                "quote": "This version of the patch removes the ability to click on the identity block to revert the URL bar values. If we land this patch, then I'll update bug 406779 to state that we have dropped this ability.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "We already null-check for gURLBar, so remove this `if` condition.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "I kind of wish we could avoid spreading the use of the horribly-named \"pageproxystate\" attribute and use some other name, but I guess inconsistency with the URL bar attribute name would be a worse problem (and I can't really think of a better name).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "I wish the boolean attribute didn't use \"valid\"/\"invalid\", making it not 100% clear that it's boolean, resulting in unnecessary `else if` conditions: https://mxr.mozilla.org/mozilla-central/source/browser/base/content/browser.js#2657 And also makes it not obviously clear that the following states are the same: `if (element.getAttribute(\"pageproxystate\") != \"valid\")` `element[pageproxystate=\"invalid\"]`",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "This isn't actually needed. You can just write #urlbar[pageproxystate=invalid] > #identity-box.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "Why this change?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "Don't put this in theme code.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "I made this change for consistency between the three themes. - Winstripe was set to 0.5 opacity when the blank favicon was updated to the dotted outline. - Pinstripe was set to 0.5 opacity somewhere around Bug 587901 (which was backed out). The history is a little cloudy here because a lot of lines got moved around so I couldn't find a more definitive answer. - Gnomestripe was set to 0.3 opacity by the patch for bug 621091, which switched Linux to using the stock icon for gtk files for blank documents instead of the default favicon. Now that all platforms use the same icon for generic documents, I think we should standardize on the opacity of the icon for its disabled state.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "The comment doesn't match the code anymore. Maybe you should mention why the pageproxystate check is needed even though you already set pointer-events: none. You could also make this a separate if (...) return; block or add it to if (this._mode == this.IDENTITY_MODE_CHROMEUI) for the sake of the above block's readability.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Since the globe icon doesn't represent an identity state anymore and since the icon isn't clickable anymore, making winstripe and pinstripe follow gnomestripe might make more sense.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "Addressed feedback. Yeah, I think we can use the more transparent 0.3 value.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 31,
                "quote": "In the case of IDENTITY_MODE_CHROMEUI, this covers left clicks as well as enter or space.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1742664",
        "issue_id": 1742664,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The tested behavior got corrected in bug 1742411.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1033283",
        "issue_id": 1033283,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "One-line fix, and I added tests for the role and states.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "nit: two spaces between 'button' and 'menus', dot in the end",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "nit: it'd bet good to keep it more generic",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Landed with nits addressed: https://hg.mozilla.org/integration/mozilla-inbound/rev/62eec1dede89",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1023280",
        "issue_id": 1023280,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I may have missed some b2g stuff. https://tbpl.mozilla.org/?tree=Try&rev=0210eba6ac04",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Please do the try run on b2g and update the webidl docs?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Please do the try run on b2g and update the webidl docs?",
                "code": "VERIFICATION_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=989204",
        "issue_id": 989204,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Some tests I wrote for issues I ran into, also a test for bug 889158.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Requesting review from bhackett for the JIT changes, jorendorff for everything else. Passes jit_test.py --tbpl. Pushed to Try: https://tbpl.mozilla.org/?tree=Try&rev=acbba33d927c Fortunately the browser uses a ton of arrow functions; let's see how this turns out.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Requesting review from bhackett for the JIT changes, jorendorff for everything else.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "The browser was crashing on startup due to some XDR/cloning issue. Everything looks green now (so far): https://tbpl.mozilla.org/?tree=Try&rev=7d2cfcf45e9c Only need review for the non-JIT changes.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "The caller is responsible for populating this slot, right? If so, populating it with a different value here seems like a bit of a red herring. Delete this block?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Can we name this offsetOfArrowThisSlot()? Otherwise each caller has a magic constant 0 in it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Pushed with comments addressed: https://hg.mozilla.org/integration/mozilla-inbound/rev/8cef7a6e9f79 https://hg.mozilla.org/integration/mozilla-inbound/rev/9517fe15e2c2 (Comment 3 has a green Try run.)",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=978610",
        "issue_id": 978610,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I mostly just copies what we do in non-e10s code. See the DOMWindowClose event.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "We need to coordinate this kind of changes with b2g. And have some tests.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "And DOMTabClose is, well, tab specific. We will use remote stuff for other remote browsers too. So perhaps DOMRemoteBrowserClose. Also, isn't that this.tabs.length thing doing the wrong thing here. It prevent us to close the last tab/window. DOMWindowClose doesn't call event.preventDefault which means nsGlobalWindow doesn't try to close itself. I think it would be better to mimic the non-OOP behavior. TabChild could catch DOMWindowClose and forward it synchronously to parent and parent then deals it the same way as it does local DOMWindowClose.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Does this look right?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Null check mFrameElement. But this needs a toolkit/ review, since I'm not sure whether calling window.close() is the right thing. I believe BrowserTryToCloseWindow() or closeWindow(some params) should be used. Also, I don't know how b2g app closing works.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "It turns out this patch does break b2g, so I added a branch to avoid that.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Oops, wrong patch.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Getting this patch to work on b2g has really been painful. The IsBrowserOrApp checks didn't work and I don't know why. Anyway, this patch does everything in frontend code. Sorry for the churn, Felipe.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Never mind. This one doesn't work either.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "This one is really conservative. I don't think there's any way it should affect b2g.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "do you think bug 924260 needs to be addressed together?",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=957093",
        "issue_id": 957093,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch namespace consistency for netwerk/protocol/http \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Looks good. Couple of really minor nits about indentation. I won't mind if you want to ignore them ;) r=me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "indentation.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "indentation to match mCriticalRequestPrioritization?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "nits addressed",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=939475",
        "issue_id": 939475,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I assume sliceTimeBudget also needs to be included.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "The parameters listed still don't seem to match the list: http://mxr.mozilla.org/mozilla-central/source/js/src/builtin/TestingFunctions.cpp#259 Instead of duplicating this list in several places (which are sure to go stale before long), can you have a #define GC_PARAMETER_ARGS_LIST \"maxBytes, maxMallocBytes, ...\" right above/below the paramMap and used twice below?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Patch (v2) (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Great!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Could you add a \\n after this line? Also, could you insert \" or \" before markStackLimit?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Also, could you insert \" or \" before markStackLimit?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Patch with review comments addressed. r=luke \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=937475",
        "issue_id": 937475,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Ah, I don't know why but I seem to remember that I once wrote a patch to fix this. I thought that I had gotten reviews and landed it but now I can't even find a bug, which tells me that I must have forgotten to even file the bug. :(",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch change DURATION from end-offset to duration and compare buffer length using integer sample count \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch separate stream position from buffer position so that stop time can use stream position \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Patches here are helpful in fixing bug 937057.",
                "code": "ISSUE_IMPACT"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=919434",
        "issue_id": 919434,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "With these prefs: user_pref(\"layers.acceleration.disabled\", true); user_pref(\"layers.force-active\", true); the testcase makes Firefox infinitely recurse due to a cyclic layer tree.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Caught that cycle being created. This presumably has something to do with how we process all descendants of a fixed position layer specially, and a bad interaction of that with sticky position layers.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "It seems like this should block bug 916315, no?",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 4,
                "quote": "I don't reproduce either this or bug 931450 in the latest Nightly. Discussion on bug 919156 suggests that they could have been fixed in bug 919144?",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "I verified that bug 919144 did indeed fix this, using targeted builds. (Its parent cset, 21df28ade757, reproduces this bug for me -- whereas the cset for the last patch in bug 919144 does not reproduce this bug for me.)",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 6,
                "quote": "Reproduced in Nightly 2013-09-25. Verified fixed 28.0a1 (2013-12-05), Win 7 x64",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Pretty sure this test never actually tested the correct configuration. The layers.acceleration.disabled preference is queried once and the value reused, so setting it for a particular test is just ignored.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "I can't build this far back, but certainly in today's builds, this does not run the test with layers.acceleration.disabled actually set, as the pref() line in crashtests.list sets it too late to get picked up. And if it was getting picked up, it would mean that the value of that preference changes mid execution, which is at best scary and certainly not supported.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=912496",
        "issue_id": 912496,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Store source file names only once in tracelogging.log and refer to them by auto-incrementing id after that. (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Looks good. Can I make an additional cosmetic request. Could you change void TraceLogging::log(Type type, const char* file, unsigned int lineno); to void TraceLogging::log(Type type, const char* text = NULL, unsigned int number = 0) And change sourceMap to textMap, sourceId to textId. And also the entry names.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Can I make an additional cosmetic request. Could you change void TraceLogging::log(Type type, const char* file, unsigned int lineno); to void TraceLogging::log(Type type, const char* text = NULL, unsigned int number = 0) And change sourceMap to textMap, sourceId to textId. And also the entry names.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Since we don't care about order. Please use unordered map like hashmap. That's faster. I'm not sure what we use in firefox for this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "nextSourceId(1), and use 0 when there is no text",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Could this be fallible? Please add checks for OOM situations.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Remove this boolean and use sourceId_ == 0 to know if there is information",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "This can get removed too? We can get the name back by doing sourceMap[sourceId_]",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I addressed all feedback except for:",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "(In reply to Till Schneidereit [:till] from comment #3)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "I think we don't need to output the string in between the logs. Before logging everything, we can output a textmap linking the numbers with the output. (Can you open a follow-up bug for this?)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "(Can you open a follow-up bug for this?)",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 13,
                "quote": "Adjust comment to use \"text\" instead of \"file\"",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Adjust comment to use \"text\" instead of \"file\"",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 15,
                "quote": "Good call. I indeed forget to check the result of strdup. Can you add check for strdup and textMap failures and just return for now?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "I agree on the text map, filing a bug now.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=906912",
        "issue_id": 906912,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "You can get a raw ref out of a MoveRef with operator*, but there's no easy way to get a raw pointer out of a MoveRef. |&*movePtr| is pretty inscrutable. I considered calling this rawPtr() or overriding operator&. I don't feel strongly that this is better than the alternatives, but operator& was confusing (operator& is not commonly overridden, so it appears to me that we're taking the address of the MoveRef itself), and I didn't think rawPtr() was worth the extra chars.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Part 2, v1: Add move constructors to mozilla::LinkedList and mozilla::LinkedListElement. (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "It would be great if you could use C++11 move constructors instead. The fewer usages of mozilla::Move we add, the better.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Do you really think it's better to start using C++11's move() before we've gotten rid of mfbt/Move.h? I'm not sure that switching to a new interface before we've deprecated the old one is a good idea; that just makes it confusing for consumers (which move() do I use?).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Actually...if C++11 move constructors handle superclasses properly, that would be a strong reason to use them here. Right now if I have class Foo : LinkedListElement<Foo> then I can't do Foo::Foo(MoveRef<Foo> other) : LinkedListElement(other) because MoveRef<Foo> doesn't cast to MoveRef<LinkedListElement<Foo> >. I haven't figured out a clean way of working around this. Given that essentially the only time you're going to be calling the LinkedListElement move constructor is from a subclass's move constructor, if C++11 move constructors work better here, we should probably use them.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Yeah, this is much better using proper C++11.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Patch, v2 (now with C++11 move) (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Also, note that migrating mozilla::Move to C++11 move() is not going to be an automatic process, and cannot be done very easily unless you know the exact semantics of the code involved.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Well, this is assuming that this overload >+inline typename RemoveReference<T>::Type&& >+Move(T&& t) plays well with our current definition of mozilla::Move. If we ever call mozilla::Move() with an rvalue, this new overload will be hit, and then things won't compile. Given that this new Move and the existing mozilla::Move are completely different idioms, I'm not sure it makes sense for them to be overloads of each other...",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 10,
                "quote": "Yeah, I don't think they should be either. I would rather call this new function something completely different (mozilla::StdMove/etc? I'm terrible at naming things.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "Rename the existing one to DeprecatedMove or something, then. It's going away, make it ugly and obvious that no one should use it.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 12,
                "quote": "Something I'm discovering as I try to use std::move instead of mozilla::Move is that a mozilla::MoveRef<T> can be passed to a constructor that takes T&, while a T&& can be cast only to |const T&|, not |T&|. This is causing some cascading sets of changes.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "The only difference between this and v2 is that this one uses mozilla::move(). I'm in the process of renaming this to mozilla::Move() in my queue, but I figure that doesn't need to stand in our way.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "This'll want to use mozilla::Move as std::move isn't omnipresent yet, I assume.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Blank line before this.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "I'd move this above the next/prev assignments. Also, before the next/prev/next->prev/prev->next assignments, I'd put a comment like so: /* Initialize this with |other|'s pointers, and adjust those elements to point to this one. */",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "I'd do next->prev = this; prev->next = this; instead, as you're really mutating fields in *this* element's next/prev to connect up to this -- reads slightly conceptually more clearly to me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Before this, I'd do a symmetric comment to the one above: /* Adjust |other| to destructible, not-in-list status. */",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Mm, Bugzilla fail when toggling flags on an obsoleted patch. Looks like comments transfer over trivially, so no big deal here.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=904571",
        "issue_id": 904571,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Could be related to bug 904559.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "When there is no activeRedirectingChannel QI'ed out of mActiveChannel, we should turn succeeded to false and bypass call on the null activeRedirectingChannel. I think there is nothing more to do here. We will just show the content of the 30X response page and not crash.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "My recent re-experience with this code tells me there is nothing more to do.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "According https://bugzilla.mozilla.org/show_bug.cgi?id=904559#c4 we may want to remove the assert as well, what do you thing Jason?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "According https://bugzilla.mozilla.org/show_bug.cgi?id=904559#c4 we may want to remove the assert as well, what do you thing Jason?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "I can see that this patch probably removes the crash, but it still seems we have an underlying bug that we're not dealing with yet? The issue here is that mActiveChannel is somehow not a nsIParentRedirectingChannel (in other words, it's not an HttpChannelParent--nothing else implements it AFAICT). HttpChannelParentListener is *always* created with an initial mActiveListener == HttpChannelParent, and the only way that can change is in OnRedirectResult, if we're redirected to FTP (that's the only case so far, right). That can happen, of course--but then how exactly does an HttpChannelParentListener with a FTPChannelParent mActiveListener ever run across AsyncOnChannelRedirect and/or OnRedirectResult again? FTP doesn't do redirects. So it seems to me that we're getting an \"extra\" call to OnRedirectResult here. The mostly likely cause could be that we accidentally have 2 AutoRedirectVetoNotifier's on the stack somehow? The nsHttpChannel code here is not easy to follow--seems like we could maybe try to do something stupid like add a nsHttpChannel.mHasHadVetoNotifier member variable, set it when we use an AutoRedirectVetoNotifier, and ASSERT that it's false? Then maybe we can catch the stack trace if we somehow call OnRedirectResult twice. Maybe I'm totally wrong here--but I can't think of how else OnRedirectResult is getting called when mActiveChannel isn't an HTTP channel. If we somehow can't figure this out, or there's a valid reason why mActiveChannel could be something else here, I'm ok with this patch. And it looks like bug 904559 is the same thing, except we're seeing AsyncOnChannelRedirect() get called, which seems even stranger--how can it get called again after we've switched mActiveChannel to an FTP channel? BTW there are two asserts that you'd need to remove for this patch--one in AsyncOnChannelRedirect and one in OnRedirectResult.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "xpcshells locally passing.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=897027",
        "issue_id": 897027,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Somewhat related to bug 896264, also see bug 896264 comment 4 for an explanation why ToNumber needs to be executed.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Apologies for the delay to get back to this. Please find a proposed fix attached, which should fix the bug. The Math methods reported by Andr\u00e9 are the only ones having this problem (performed a check over the rest) Any further comment or feedback would be appreciated.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Looks good, but I think we should have tests added for this. Can you create them from Andr\u00e9's initial report? Ask me for review with those.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "This new patch includes the requested test cases.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "r=me with a license header added to the test. Not all tests have them, but all should. Personally, I'd go with // Any copyright is dedicated to the Public Domain. // http://creativecommons.org/licenses/publicdomain/",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Nice!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Nit: remove stray spaces at the last three lines' ends.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "New version with requested corrections.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Perfect, thanks. Do you have checkin rights? If not, just add the checkin-needed keyword on the bug and the sheriffs will do their magic. (Just for future reference, if you get an r+ with a request to do some small changes, you can set the r+ yourself on the new version and add something like \"carrying r+ from tschneidereit\" to the comment.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "In the future, please make sure your commit message has the bug number and a brief description of what the patch is doing (preferably not just the bug title). Thanks!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Backed out for assertions: eg https://tbpl.mozilla.org/php/getParsedLog.php?id=28934657&tree=Mozilla-Inbound https://hg.mozilla.org/integration/mozilla-inbound/rev/45f35cc52ceb Were the jit-tests run locally on a debug build before requesting checkin-needed..? :-)",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 12,
                "quote": "Can you debug things and attach a new version of the patch?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 13,
                "quote": "`ToNumber(cx, args[1], &y)` asserts when args.length() == 1.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 14,
                "quote": "Thanks everyone for the comments. This update will hopefully fix the previous issue (tested it on my platform's debug and release builds) Please note the local variables assignments: double x = GenericNaN(); This should handle (and hopefully not introduce new bugs) the cases where less arguments are being passed (thus being undefined) according to my understanding of the draft. Otherwise please feel free to advise me of better alternatives.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Would you mind taking a look and let me know if this looks ok?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 16,
                "quote": "Looks great. And thank you so much for the thorough tests of Number functions.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "this hasDefined isn't necessary, as we'll have returned above if it were false",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Same here about hasDefined",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Nit: can you add the date of the spec draft this numbering refers to. It will get outdated at some point, otherwise.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Please just remove this entire paragraph: the EcmaScript spec's license isn't compatible with Public Domain. While this is very likely to fall under fair use, no need to go anywhere near the boundaries of that.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Evilpie had a few comments on IRC that are very helpful: You can just use args.get(0) and args.get(1) without checking the arg count. args.get returns undefined if fewer args were provided, and ToNumber returns GenericNaN for undefined. Doing this makes the function a lot simpler. I don't think it's worth it to return early for the 0-args case. Canceling the review based on that, sorry for the churn.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "Thanks for the comments and the last-minute help on IRC, much appreciated! Here's the latest version containing the requested changes.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 23,
                "quote": "This looks great, thank you! Can you do a final try run (just one platform, with only the reftests is ok)? If that turns out green, set checkin-needed on the bug.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Can you do a final try run (just one platform, with only the reftests is ok)?",
                "code": "VERIFICATION_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=894646",
        "issue_id": 894646,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "A few bugs and crashes... Please attach an interdiff when you address the comments.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Let's just cast here, and make this an nsRefPtr<Attr>",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "You're shadowing the rv argument here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Followup to fix SetFocus?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "This is crashy if mParent->mElement is null.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "One space is sufficient",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Crash",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Element",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "nullptr while you're here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Crash",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Get rid of this nonsense, please.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Element",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Ditto",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Unused variable",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Double-check if you need to hold a ref here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Ask someone if those are perf-sensitive",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "AttrValueIs",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "Let's keep this a strong pointer",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Followup",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "Can mFrameElement change from under us?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "Followup",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 23,
                "quote": "const",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 24,
                "quote": "Uh, I don't think so",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 25,
                "quote": "* to the left",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 26,
                "quote": "{}",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 27,
                "quote": "Attached patch Addressing review comments \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 28,
                "quote": "Does this compile?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 29,
                "quote": "Does this compile? pwindow is not an EventTarget...",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 30,
                "quote": "You also need to revert these three.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 31,
                "quote": "You also need to revert these three.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 32,
                "quote": "Sorry, I could have sworn I tried compiling before posting the last interdiff, but apparently not.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 33,
                "quote": "Attached patch Rebased patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 34,
                "quote": "mOwnerContent is a dom::Element*. Drop the QI, but keep the ref.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 35,
                "quote": "mOwnerContent is a dom::Element*. Drop the QI, but keep the ref.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 36,
                "quote": "Ditto",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 37,
                "quote": "mozilla/d before mozilla/u",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 38,
                "quote": "mozilla/d before mozilla/u",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 39,
                "quote": "Nit: 80 columns",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 40,
                "quote": "Since you're not actually changing anything here, let's drop this change.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 41,
                "quote": "Since you're not actually changing anything here, let's drop this change.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 42,
                "quote": "This can be 'return doc->...'. Up to you.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 43,
                "quote": "Nit: add 'static', so we notice if it ever becomes unused.",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 44,
                "quote": "Nit: add 'static', so we notice if it ever becomes unused.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 45,
                "quote": "{}",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 46,
                "quote": "{}",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 47,
                "quote": "(What a mess.)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 48,
                "quote": "Can you make this an nsCOMPtr<EventTarget>? And try to drop the .get().",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 49,
                "quote": "Is this necessarily non-null?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 50,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/d9dbb5dbb96a",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 51,
                "quote": "Backed out the changes to nsDeviceSensors for not building on Windows.",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 52,
                "quote": "https://hg.mozilla.org/mozilla-central/rev/d9dbb5dbb96a",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=888630",
        "issue_id": 888630,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "On the other hand, if there is a specific reason why the BOM should not be considered as white space, trim() should follow suit and leave it intact (same goes for trimLeft() and trimRight()).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "The BOM should be treated as whitespace by regexps, indeed.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Fixed by bug 888673",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=601999",
        "issue_id": 601999,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Hm, I take that back -- a targeted build at that push is unaffected. Now I'm suspecting this cset: http://hg.mozilla.org/mozilla-central/rev/1bf9a4c8c8b4 Bug 572689 - Make nsSVGRenderingObservers observe elements instead of frames I think something like this is going on: we reflow our scrollframe, and that invalidates the filter (which the scrollframe is a part of), and that triggers a reflow of the frames to which the filter is applied (including the scrollframe). This continues in a death-spiral.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "OK -- the first affected changeset is 4a50f3c34d5a, and the crash goes away if I comment out this line that was added in that changeset:",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "A. Remove the line mentioned in Comment 6.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "B. Check for cycles in nsSVGRenderingObserver::InvalidateViaReferencedElement",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "C. Check for cycles in nsSVGEffects::AddRenderingObserver",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "I just tried (A) -- removing the regressing line -- on TryServer, and it doesn't actually break any unit tests, which is encouraging. I'm guessing it'd be possible to construct a -moz-element testcase that would end up painting stale data as a result of that change, but I'm not immediately sure what that testcase would look like. (B) and (C) might be better for correctness, but I'm not entirely sure how to best check for cycles there. Maybe we'd disallow rendering-observer-notifications being sent to an element from any of its ancestors? And even if that's the right thing to do, it could still be undesirable perf-wise (it'd make us walk the DOM tree on every InvalidateViaReferencedElement or AddRenderingObserver call). Also: I'm not sure that (C) would work after tree-surgery -- i.e. when we re-parent an element, do we un-register and then re-register it as a rendering observer? If not, then you could still construct testcases that fail here, if they just do some node-reparenting at the last minute. I tend to lean towards strategy (A), but I'm open to suggestions/advice. (Maybe there's another obvious solution I'm missing?)",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "This is \"Strategy A\" from comment 8. (delete the regressing line) Includes a crashtest from this bug & one from related bug 587336, both of which fail (hang or crash) pre-patching but pass post-patching.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "mstange, I'd appreciate any thoughts you have on this, if you get a chance (in particular, what it might break, & if any better fix-strategies jump out at you).",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "I think we need that wherever -moz-element needs to observe changes in the rendering of an HTML element.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 10,
                "quote": "OK, the reason we're doing that is to ensure that the ancestors' overflow areas are updated. But during reflow that's going to happen anyway. So we need to suppress that additional reflow request when the frame affected is currently being reflowed. I think you can just check FRAME_IN_REFLOW somewhere.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "Here's a fix along the lines of comment 15 (just guarding the NS_UpdateHint call with a NS_FRAME_IN_REFLOW state-check.) This fixes this bug's testcases, but not Bug 587336's testcases -- Bug 587336 is going to need its own patch.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Maybe we should split rendering observers into two types? One \"visual\" type for -moz-element and another for filters, masks, etc. Then we'd only invalidate visual observers from nsIFrame::InvalidateInternal, which must not cause reflows, and the problem is gone.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 13,
                "quote": "That would work, and I'd definitely take a patch for that.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "However, one of our post-FF4 priorities is to rework invalidation to compare \"before\" and \"after\" display lists instead of using the nsIFrame::Invalidate machinery. That will make all these issues go away, or at least behave very differently.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 15,
                "quote": "Thanks for the feedback, Markus! Your suggestion sounds promising, but I personally am a little hesitant to implement that change, when there's a more targeted fix available, primarily because: - it sounds like it could be somewhat risky, this late in the game (for the potential benefit) - any other as-yet-undetected bugs of this sort are likely to be sg:dos at worst (infinite loops) - as roc pointed out, the situation here will change post-Firefox 4 - there are other blockers that need my attention :)",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "So, I'd lean towards sticking with the fix strategies in the patches attached here and on bug 587336, and then perhaps implementing Markus's suggestion in a separate bug if anyone can get to it, but probably not blocking the Firefox 4 release on that.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 17,
                "quote": "Does that sound reasonable?",
                "code": "SOLUTION_REVIEW_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=601912",
        "issue_id": 601912,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I hope that you have tested this with FF4beta and not only with 3.6.x ?",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "I'm not crazy about this feature; we'd need to extend the CSS counter model to do this, and it's complicated enough already.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Confirming: not implemented in FF4b10.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Implement <ol reversed>. (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Boris, could you update content/html/content/test/test_ol_attributes_reflection.html?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "Is this a typo?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch With a test for appending (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Attached patch With some assertions also fixed so this passes tests (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch Implement <ol reversed>. (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "Hoping it's ok if I transfer this review request to you; if not, send it back.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "bz, would you mind posting an unbitrotted version of this?",
                "code": "CODE_UPDATE_REQUEST"
            },
            {
                "annotation_id": 12,
                "quote": "Sure thing!",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "This probably wants to check Tag(), too, something like this: if (nsGkAtoms::start == aAttribute || (nsGkAtoms::reversed == aAttribute && nsGkAtoms::ol == mContent->Tag()) { since reversed only has an effect on <ol> elements -- right? (Later in this patch, you check Tag() in the same spot where you check for reversed) (I don't imagine this will affect behavior, but it should just save us some unnecessary notifications)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Maybe add a MOZ_ASSERT(hc, ...) there to document what that comment's claiming? Then if FrameStartsCounterScope() gets a bug at some point, we'll get a helpful assertion-failure instead of a mysterious segfault.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "s/lis/list/",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "I wonder if we might even want to make this \"ordinal -= increment\" instead of \"++ordinal\"? (and check \"increment < 0\" instead of \"== -1\" in the \"else if\" check above it) That way, abritrary increment values should Just Work (e.g. if the WHATWG introduces \"<ol increment=\"3\" reversed>\" at some point in the future) That could be premature generalization, though -- the existing code is good too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Might be worth asserting that aIncrement is either 1 or -1 here, just as a sanity-check, since (for now) those are the only values that we're expecting to add.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "It's probably worth having a test where we wrap past 0 into negative territory, too -- like this test, but with start=\"1\" maybe? Also, since this is actual feature-work (rather than a random-bugfix), these tests probably deserve \"real\" names instead of \"601912-*\", and they probably want to live in layout/reftests/list-item/ instead of layout/reftests/bugs. Also: I noticed that http://blog.whatwg.org/reverse-ordered-lists mentions that XHTML needs this to be specified as <ol reversed=\"reversed\"> -- does that work right now? (and do we reject other values for the \"reversed\" attribute in XHTML, as it sounds like we should?) It'd probably be good to add XHTML reftests showing that reversed=\"reversed\" works and reversed=\"anything_else\" is ignored. r=me with the above addressed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/f083c0a666d3",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=577462",
        "issue_id": 577462,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "For opaque SYSTEMMEM textures we can call the GetDC method on the primary surface to draw directly to a DC. We should use this for layers where mIsOpaqueContent is true.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Updated to use a UseOpaqueSurface function taken from the BasicLayers code.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Someplace you should put a comment that says that GetDC is not supported on surfaces of D3DFMT_A8R8G8B8 format and that that's the motivation for splitting things out here.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=558970",
        "issue_id": 558970,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "There are some random thought. 1. nsEditorEventListener::KeyPress() still QIs nsIPlaintextEditor. nsEditorEventListener is for nsEditor, so, we shouldn't store the editor as nsPlaintextEditor I think. I think that we should move HandleKeyPress() from nsIPlaintextEditor to nsIEditor. Besides, nsIPlaintextEditor should inherit nsIEditor. Then, we don't change the interfaces actually. (And also we can move the flags of nsIPlaintextEditor to nsIEditor too) If we do so, we can move the contents of nsEditorEventListener::KeyPress() to nsEditor::HandleKeyPress() and nsPlaintextEditor::HandleKeyPress(). # But I'm not sure whether the method should be defined in idl because there are not merits of it being scriptable. 2. nsEditorEventListener::MouseClick() still QIs nsIEditorMailSupport. nsIEditorMailSupport is implemented nsPlaintextEditor, so, the contents of nsEditorEventListener can be moved to nsEditor::HandleMouseClick() and nsPlaintextEditor::HandleMouseClick() like HandleKeyPress().",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "1. nsEditorEventListener::KeyPress() still QIs nsIPlaintextEditor. nsEditorEventListener is for nsEditor, so, we shouldn't store the editor as nsPlaintextEditor I think. I think that we should move HandleKeyPress() from nsIPlaintextEditor to nsIEditor. Besides, nsIPlaintextEditor should inherit nsIEditor. Then, we don't change the interfaces actually. (And also we can move the flags of nsIPlaintextEditor to nsIEditor too) If we do so, we can move the contents of nsEditorEventListener::KeyPress() to nsEditor::HandleKeyPress() and nsPlaintextEditor::HandleKeyPress(). # But I'm not sure whether the method should be defined in idl because there are not merits of it being scriptable. 2. nsEditorEventListener::MouseClick() still QIs nsIEditorMailSupport. nsIEditorMailSupport is implemented nsPlaintextEditor, so, the contents of nsEditorEventListener can be moved to nsEditor::HandleMouseClick() and nsPlaintextEditor::HandleMouseClick() like HandleKeyPress().",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch Patch v1.0 (-w) (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "I'm hoping to get a bit different patch. Ping me on IRC if you have any questions.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "nsEditorEventListener can connect/disconect to editor now. All public methods should check whether mEditor is null or not, but protected/private methods should check as assertion. The listener installation code and uninstallation code are moved to nsEditorEventListener, by this change, we can uninstall the listener certainly when it's discorrected.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Just return early if !sysGroup || !elmP. NS_ENSURE_STATE(sysGroup && elmP);",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Same here. Just return some error code if !target",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "No need for NS_ENSURE_TRUE check here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "No need for NS_ENSURE_TRUE check here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "No need for NS_ENSURE_TRUE check here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "No need for NS_ENSURE_TRUE check here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "No need for NS_ENSURE_TRUE check here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "No need for NS_ENSURE_TRUE check here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Could you file a followup for this.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 15,
                "quote": "Could you file a followup for this. I think HTMLEditor should be listening for contextmenu event.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "I don't understand this. why you need ConnectToHTMLEditor? r+ if you fix all the comments and either explain or fix ConnectToHTMLEditor handling.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Perhaps you could just add an ifdef DEBUG block to somewhere to check that nsHTMLEditorEventListener is connected to HTMLEditor? That should be enough to capture possible problems in the future.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 18,
                "quote": "Attached patch Patch v2.1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "I don't understand this well. Looks like nsHTMLEditorEventListener can listen \"contextmenu\" event by nsIDOMContextMenuListener. The argument of nsIDOMContextMenuListener::ContextMenu() is the cause of opening the context menu, right? I'm not sure the event comes before or after the event. If it comes before the event, it should prevent the default of the mouse event. But if it comes after the event, looks like mouse down handler still needs to check the event is opening context menu or not for Mac. So, I don't understand if latter is correct.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Well, just file a followup bug \"Sort out editor's contextmenu/mouse event handling\" or something like that.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 21,
                "quote": "I filed bug 560201.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=552914",
        "issue_id": 552914,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "nsEditor::mFlags is set only when nsEditor::Init() is called. nsPlaintextEditor::SetFlags() and nsHTMLEditor::SetFlags() don't call nsEditor::SetFlags(), so, nsEditor::mFlags are not modified forever. I guess that this makes a problem after type attribute or readonly attribute of <input> element is modified and some code path which refer nsEditor::mFlags run. However, I'm not sure there are actual problems.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "My patch removes nsEditor::mFlags. It's not needed. And the code should check the flags via GetFlags() method. My patch also removes a special code for unix password editor in ForceCompositionEnd() which has never needed right now because we support ime-mode CSS property. So, even if the editor is password field, nsIWidget::ResetInputState() should be called at that time.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "smaug, can you review this? I requested to perterv, but there are no replies...",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "I don't understand this method. Nothing seems to call it ever.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "So you are, at least in theory, changing the behavior here. Have you tested password fields with IME? I think I would do this in different way. Really start use nsEditor::mFlags always, and remove mFlags from nsTextEditRules. nsTextEditRules can always access nsEditor::mFlags when needed. Or is there some reason to not use nsEditor::mFlags, but nsTextEditRules::mFlags?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "The condition is always false, but the comment doesn't expect so, of course. I replaced all flag checking to the new accessor methods for suppressing the mistake.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Perhaps this could be called PRBool UseAsyncUpdate() const",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Maybe just PRBool NoCSS() const",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Maybe just PRBool DontEchoPassword() const",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "I think you could make nsEditorListener::mEditor to be type nsEditor. Currently it is nsIEditor. That way you wouldn't need the static_cast. Though, it is possible that you'd need a static_cast then elsewhere. But try and see what leads to easiest-to-read code.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "If mEditor was nsEditor, this QI wouldn't be needed.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "DontEchoPassword()?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Attached patch Patch v3.0 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "I'll file a bug for the previous comment.",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=551837",
        "issue_id": 551837,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I should add that the 5% improvement is on SunSpider on the JS shell, using Trace Monkey.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "No such luck; I get some failing trace-tests with this, so there must be something non-portable in the i386 code. I will investigate and provide something similar for ARM.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "* I don't like using assembly in this way, particularly outside the back-ends, but I couldn't get close to the performance of this routine using pure C. I do have a C version which still provides an excellent improvement over the slow path, and it should also work for any little-endian IEEE-754 system. * I've added many comments to my assembly to try to explain what's going on, but this does make the code look somewhat long (even though the output is tiny). Suggestions are welcome! The comments are important; I don't want this to be a write-only routine, and this kind of assembly algorithm can get unreadable pretty quickly.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "* I get a 5.5% performance improvement on A8 with this patch. That's rather surprising, considering that it's only one function, but I won't complain! (My pure C implementation is 3.9% faster than the slow-path on A8.) * I tested the routine in a standalone harness to ensure that all the code-paths were exercised. It appears functionally equivalent to the slow path.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Very nice. Do you think we should use your C version on Intel as well?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "It's unlikely to outperform the optimized i386 version, but it might be worth a try. I've attached it for reference, but note that it isn't at all polished in its current state, and it's in the form of a C function, not a patch. (I didn't generate a patch when I tested it in the JS engine, but the code is the same.)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Looks great to me -- should figure out what to do with the C version, since it sounds like that could be useful on non-x86 platforms where we don't have an optimized version.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "In any case, that's a subject for another bug",
                "code": "NEW_ISSUE_FILING"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=538721",
        "issue_id": 538721,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It is probably a typo for bug 436276 but that's wrong too as strokeWidth is a length.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "I'd say bug 534028 makes more sense as a dependency.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Thanks for the report, Jesse! Robert is correct on both counts. (FWIW, in bug 436276, I intended \"non-length\" to mean \"non-nsSVGLength2\" -- and strokeWidth is non-nsSVGLength2. Hence the dependency on that bug). In any case, bug 534028 is more granular, and when it's fixed, this test will pass. So that's indeed a better bug # to reference there.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Fixed: http://hg.mozilla.org/mozilla-central/rev/2ac64027f304",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=696748",
        "issue_id": 696748,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Given that this is in the guts of the assembler I'm guessing at sg:critical here, but if that turns out to not be the case we can re-label this one.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Marty, can you take a look at this--see if it is in fact exploitable?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "It looks to me like it may not be, but it seems like a codegen bug at least.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "oy. Not horribly unexpected, the issue is with pools. More specifically, with pools and the repatcher. For repatchable stub calls (well all calls, but specifically, repatchable calls) we generate the sequence ldr r12, [pc, pool_dest] ldr r8, [pc, pool_jaeger_stub_veneer] blx r8 ... pool: ... pool_dest: .word function_to_call pool_jaeger_stub_veneer .word jaeger_stub_veneer which will load the address of a function out of pool_dest, into register 12, then load the address of the jaeger stub veneer into r8, and call the jaeger stub veneer. The repatcher gets the address of |ldr r8, ...|, then looks back at the previous instruction, decodes enough of the instruction to find the address of pool_dest, and finally writes over the |.word function_to_call| with the new value. In this case, however, immediately after emitting |ldr r12, [pc, pool_dest]|, we determined the pool needed to be flushed, and flushed the pool, thus the sequence we actually got was: ldr r12, [pc, pool_dest] b after_pool pool1: ... pool_dest: .word function_to_call after_pool ldr r8, [pc, pool_jaeger_stub_veneer] blx r8 ... pool2 pool_jaeger_stub_veneer .word jaeger_stub_veneer so when the instruction that the re-patcher gets is still |ldr r8, [pc,pool_jaeger_stub_veneer]|. However, the \"instruction\" before it is now .word function_to_call rather than |ldr r12, [pc, pool_dest]|. This is why the assertion is thrown. The result of calling the patcher on this is: we read the bottom 12 bits of the function that we're attempting to patch from, add it to the address of the patch (two before the actuall call to jaeger_stub_veneer), get a memory location, and write over that memory location with a single word of data that any possible attackers most likely won't get to control (We are writing over the value with the address of a C function). More likely than not, the address that we write over will *not* be word aligned, whereas any instructions (or other data) that we generate will likely be word aligned, so it is likely going to write over parts of two different values. I would say that this is in fact exploitable, but would be hard pressed to generate a reasonable exploit.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I can think of two possible solutions: 1) rather than storing the address of the second instruction, store the address of the *first* instruction, so we'll be able to walk forwards and get to the other two, possibly following pool guards. 2) mark those three instructions as a no-pool zone. no-pool zones have always felt like a hack. I'll need to find out why we carry the address of the second instruction to begin with.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Have not pushed to try, nor run jit-tests locally yet.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Marty, is this patch appropriate for aurora? If so, please request aurora approval on the patch!",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "[Approval Request Comment] Regression caused by (bug #): User impact if declined: This bug has been in the assembler since arm support for JM landed Testing completed (on m-c, etc.): Risk to taking this patch (and alternatives if risky): It has been pretty thoroughly tested on aurora, and the fix is pretty foolproof",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=691184",
        "issue_id": 691184,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch v1 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Tests I promised.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "https://tbpl.mozilla.org/?tree=Try&rev=19fdc5b8499f (with Ms2ger's test changeset this time)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "The spec is bad, but I don't care enough to complain.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=687929",
        "issue_id": 687929,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Almost certainly a regression from the workers rewrite.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This one is simple, just need to make sure ResumeWorkersForWindow can handle a null context. It's not really needed, but if we have one we need a request.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "I hafve someone here who encountered this after upgrading to 8.0. Crash report: https://crash-stats.mozilla.com/report/index/bp-0eef12a6-2e84-49c5-949f-8a1102111119",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "In regards to comment #3, the user is reliably able to reproduce this on http://www.cuetools.net/wiki/Main_Page. When he opens a link in a new window, he gets this crash. Latest report: https://crash-stats.mozilla.com/report/index/bp-f23cf359-d6cf-4dc3-af1a-5d2ab2111122",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "The same person reports this crash still being present in Aurora for him. Latest report: https://crash-stats.mozilla.com/report/index/bp-ab204c45-08b7-4cb4-a2e0-864822111205.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "Attached patch Patch. v1 \u2014 Details \u2014 Splinter Review Simple.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "This patch is very simple (low risk) and fixes a reproducible crash currently being tracked for FF 9 and FF 10 (high reward).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Minusing for beta because of how late we are in the cycle, but let's land this on aurora.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I see no crashes on Firefox 10b1: Mozilla/5.0 (Windows NT 6.1; rv:10.0) Gecko/20100101 Firefox/10.0 Mozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0) Gecko/20100101 Firefox/10.0 Mozilla/5.0 (X11; Linux i686; rv:10.0) Gecko/20100101 Firefox/10.0 Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20100101 Firefox/10.0 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:10.0) Gecko/20100101 Firefox/10.0 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:10.0) Gecko/20100101 Firefox/10.0 ftp://ftp.mozilla.org/pub/firefox/nightly/2011/12/2011-12-28-mozilla-beta-debug/firefox-10.0.en-US.debug-mac.dmg ftp://ftp.mozilla.org/pub/firefox/nightly/2011/12/2011-12-28-mozilla-beta-debug/firefox-10.0.en-US.debug-linux-i686.tar.bz2 This is verified fixed on 10b1.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=677173",
        "issue_id": 677173,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "From http://dev.openclic.fr/css/all.css: html.no-csstransforms .slideshow.horizontal > ol.slides > li.current { left:0; } html.csstransforms.no-csstransforms3d .slideshow.horizontal > ol.slides > li.current { -moz-transform:translateX(0); -webkit-transform:translateX(0); -o-transform:translateX(0); -ms-transform:translateX(0); transform:translateX(0); } html.csstransforms3d .slideshow.horizontal > ol.slides > li.current { -webkit-transform:translate3d(0, 0, 0); transform:translate3d(0, 0, 0); } So the site assumes that if .csstransforms3d is set then the browser must be either WebKit or implement unprefixed 3D transforms. Unfortunately, that class _is_ set in a current nightly, because the site is using Modernizr, which looks for a \"MozPerspective\" property, which we now have as a result of the patches in bug 505115.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "I suspect that just adding a -moz-transform:translate3d to that last CSS block from comment 2 and likewise for the other several places this selector pattern appears should help. You should probably add the -o- and -ms- versions too.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "I added the rules to the css : html.csstransforms3d .slideshow.horizontal > ol.slides > li.current { -webkit-transform:translate3d(0, 0, 0); -moz-transform:translate3d(0, 0, 0); -o-transform:translate3d(0, 0, 0); -ms-transform:translate3d(0, 0, 0); transform:translate3d(0, 0, 0); }",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Nothing changed... The slides don't move. And firebug doesn't show the rule. Let's be patient!",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Hmm. That's a problem on our end. It looks like all.js has: pref(\"layout.3d-transforms.enabled, false); (ignoring for the moment that it's missing a '\"' there) but the IDL properties are added unconditionally. That's not good.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "I added it via about:config. There is no animation but the photos move. If I change too much times, ffx chrashes.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Remove the IDL properties for now \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "Sorry for the delay getting to this. We need to get this in on aurora to fix the fact that something that was supposed to be disabled wasn't fully disabled.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Backed on Aurora and Inbound because of test failures: hg.mozilla.org/releases/mozilla-aurora/rev/ebe4b5370436 https://hg.mozilla.org/integration/mozilla-inbound/rev/2586082fbd94",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "This is failing lots of tests because the properties still exist in property_database.js.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 11,
                "quote": "I've tried removing those too,",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 12,
                "quote": "but multiple tests also check css_properties.js and fail there.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 13,
                "quote": "Does it work if you: * comment out the bits of property_database.js * hack ListCSSProperties.cpp to exclude them?",
                "code": "COLLATERAL_POTENTIAL_SOLUTION"
            },
            {
                "annotation_id": 14,
                "quote": "Looks like it does, yes. Thanks! Try push: http://tbpl.allizom.org/?tree=Try&usebuildbot=1&pusher=mwoodrow@mozilla.com",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Also remove the -moz-transform-style properties on mozilla-central",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "r=dbaron",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "r=dbaron",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Cannot reproduce on Firefox 6.0.2 Linux using the testcase in the original comment. Based on check-ins I don't think this should be fixed in 6.0.2.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 19,
                "quote": "Can someone please either confirm that 6.0.2 is fixed or provide a test case which reproduces this bug so that QA can verify? Thanks.",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 20,
                "quote": "The CSS 3d-transforms patches that caused this bug never landed on 6.",
                "code": "COLLATERAL_PROBLEM_ANALYSIS"
            },
            {
                "annotation_id": 21,
                "quote": "Mozilla/5.0 (X11; Linux i686; rv:8.0) Gecko/20100101 Firefox/8.0 Mozilla/5.0 (X11; Linux i686; rv:9.0a2) Gecko/20111007 Firefox/9.0a2 Mozilla/5.0 (X11; Linux i686; rv:10.0a1) Gecko/20111007 Firefox/10.0a1 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:8.0) Gecko/20100101 Firefox/8.0 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:9.0a2) Gecko/20111004 Firefox/9.0a2 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:10.0a1) Gecko/20111005 Firefox/10.0a1 Mozilla/5.0 (Windows NT 5.1; rv:8.0) Gecko/20100101 Firefox/8.0 Mozilla/5.0 (Windows NT 5.1; rv:9.0a2) Gecko/20111006 Firefox/9.0a2 Mozilla/5.0 (Windows NT 5.1; rv:10.0a1) Gecko/20111006 Firefox/10.0a1 Mozilla/5.0 (Windows NT 6.1; rv:8.0) Gecko/20100101 Firefox/8.0 Mozilla/5.0 (Windows NT 6.1; rv:9.0a2) Gecko/20111006 Firefox/9.0a2 Mozilla/5.0 (Windows NT 6.1; rv:10.0a1) Gecko/20111006 Firefox/10.0a1 Photos at link mentioned in bug description slide using the -moz-transition properties; Firebug shows the following rules: -moz-transition-duration: 0.3s -moz-transition-property: margin",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=676248",
        "issue_id": 676248,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We can work around that by moving our GL repaints away from setNeedsDisplay and drawRect. Then we'll no longer redraw the window background unnecessarily and we'll no longer block on anything.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch make it transparent (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "No idea who to ask for review but since I'm making Josh review the rest of the work for bug 675410, he gets this one too.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "I'm ok with this patch if it doesn't regress performance. If it does regress performance we should quantify it first. Have you had a chance to compare some profiles before or after for operations like 60Hz compositing and resizing? I find them very informative when we're changing a significant code paths.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I've de-bitrotted this patch, and I ran some profiles with and without the patch. I ran this demo: https://developer.mozilla.org/en-US/demos/detail/kai-opua And rotated the camera around a bit, and then resized the window. Here's the profile without the patch: http://people.mozilla.com/~bgirard/cleopatra/#report=712ceb292adfe496b85233e2b88d1a1773083593 and here's the profile with the patch: http://people.mozilla.com/~bgirard/cleopatra/#report=dc05af436747e583332d9dcb5cfa33245ab9e2da Does anything in there strike you as particularly worrying in terms of performance?",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=675961",
        "issue_id": 675961,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "problem is in removing the ping from the fragment frame, length reset to 0 before a calculation was made.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "This fixes tests 3.6 and 3.7 from https://github.com/oberstet/Autobahn",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=674446",
        "issue_id": 674446,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The attached patch helped me debug why my build was not starting on 10.5. I tried to change fprintf to PR_LOG, but got undefined references to _PR_LogPrint.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "While you're here, I'd suggest to add similar logging to nsGlueLinkingDlopen.cpp and nsGlueLinkingWin.cpp. (And it's expected you can't use PR_LOG: nspr is not available from the xpcom standalone glue).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "The Windows file already has error handling, this adding logging to OS X and dlopen.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Mike, Benjamin r+ the previous patch. The current one adds the extra logging you asked for. Is it OK?",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Pushed to inbound.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=670853",
        "issue_id": 670853,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "After chat with Jamie we agreed that it's worth to use mixed state for undetermined progressmeters (both HTML and XUL) to allow AT distinguish determined vs undetermined progressmeters.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Any thoughts?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "For ARIA indeterminate progressbars (where no aria-valuetext or aria-valuenow is set), Firefox returns S_FALSE from IAccessible::get_accValue instead of S_OK. XUL/HTML progressbars should probably do the same thing for consistency.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "Everything works except one of the mochitests fails because it checks for a mixed element being checkable.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Everything works except one of the mochitests fails because it checks for a mixed element being checkable. Since that doesn't appear to make sense if we add this patch, should I remove that from states.js?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Looks good. I would just add some comments explaining what is happening and why. And as Alex says the \"MIXED is CHECKABLE\" test should also check for appropriate roles.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "I think a comment here explaining the rationale makes sense.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Human-readable comments before each test of what state we are expecting, and why.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I added the comments, but I wasn't sure how to go about checking for the role when testing the state.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "All tests updated.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "you know, just remove this ARIA thing (sorry for saying before to do that). ARIA part should take care about accessible state (bug 740851). In either case NativeState() is about markup, not about ARIA.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "please comment out \"progress3\" test and add todo like todo(false, \"we should respect ARIA\");",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "ARIA value removed",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Looks right. It is unfortunate that for 2 lines you need to pull in role.js every time you use states.js. Maybe the simple role stuff could go in common.js? But that is not related to this bug.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "if js would have #include option :) then I would include role.js and states.js into common.js.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=634654",
        "issue_id": 634654,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "So with the tabs: GMail, GReader, Tech Crunch, Twitter, and CAD comic I get the following stats: RegExpCache stats: hits: 2244 flagMisses: 34 constructs: 24 lookups: 3979 removals: 23 puts: 1759 Which is a hearty 56% hit rate. When I switch the protocol to only put cache entries that are atomized (and only do lookups for atomized strings) I get: RegExpCache stats: hits: 72 flagMisses: 0 constructs: 19 lookups: 112 removals: 3 puts: 59 So atomizing the strings makes this cache useful. I'll rdtsc the atomization overhead.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "An interesting observation: when we create regexps from literals in the source text the parser creates a regexp from the jschar token buffer. The string generated from this jschar run is not atomized! I'll try to re-run the measurements with those literal-derived strings atomized and see how things change.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "RegExpCache stats: hits: 1804 flagMisses: 34 constructs: 36 lookups: 3572 removals: 4 puts: 1804 nonAtoms: 2443 We get a nice hit rate among the atoms, but there is a large number of non-atoms we may be missing. Here is a map from patterns to hits-that-we-miss-out-on: {'#((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '&amp;': 19, '(^(?:.|\\\\r|\\\\n)*?)#((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '(^(?:.|\\\\r|\\\\n)*?):((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)(?:\\\\(([\\'\"]?)((?:\\\\([^\\\\)]+\\\\)|[^\\\\(\\\\)]*)+)\\\\3\\\\))?(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '(^(?:.|\\\\r|\\\\n)*?):(nth|eq|gt|lt|first|last|even|odd)(?:\\\\((\\\\d*)\\\\))?(?=[^\\\\-]|$)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '(^(?:.|\\\\r|\\\\n)*?)\\\\.((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '(^(?:.|\\\\r|\\\\n)*?)\\\\[name=[\\'\"]*((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)[\\'\"]*\\\\](?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '(^(?:.|\\\\r|\\\\n)*?)^((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\*\\\\-]|\\\\\\\\.)+)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '(^|.)facebook.(com)([^.]*)$': 19, '(^|\\\\.)(\\\\.|$)': 421, '(^|\\\\s)addthis_counter(\\\\s|$)': 1, '(^|\\\\s)hidden_elem(?:\\\\s|$)': 1, ':((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)(?:\\\\(([\\'\"]?)((?:\\\\([^\\\\)]+\\\\)|[^\\\\(\\\\)]*)+)\\\\2\\\\))?(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, ':(nth|eq|gt|lt|first|last|even|odd)(?:\\\\((\\\\d*)\\\\))?(?=[^-]|$)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, ':(nth|eq|gt|lt|first|last|even|odd)(?:\\\\((\\\\d*)\\\\))?(?=[^\\\\-]|$)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, ':(only|nth|last|first)-child(?:\\\\((even|odd|[\\\\dn+-]*)\\\\))?(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '\\\\%\\\\{tweets\\\\}': 20, '\\\\%\\\\{url\\\\}': 41, '\\\\+': 39, '\\\\.((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '\\\\[name=[\\'\"]*((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\-]|\\\\\\\\.)+)[\\'\"]*\\\\](?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '\\\\bgbg0l\\\\b': 20, '\\\\bgbgt\\\\b': 23, '\\\\bgbgtd\\\\b': 20, '\\\\bgbkc\\\\b': 2, '\\\\bgbmt\\\\b': 20, '\\\\bgbzt\\\\b': 29, '\\\\s*[,;]$': 1, '^((?:[\\\\w\\\\u00c0-\\\\uFFFF\\\\*\\\\-]|\\\\\\\\.)+)(?![^\\\\[]*\\\\])(?![^\\\\(]*\\\\))': 1, '^(?:([^:\\\\/?#.]+):)?(?:\\\\/\\\\/(?:([^\\\\/?#]*)@)?([\\\\w\\\\d\\\\-\\\\u0100-\\\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\\\?([^#]*))?(?:#(.*))?$': 2, '^([\\\\[\\\\]])$': 119, '^,': 20, '^Yahoo Application State Plugin$': 1, '^[\\\\s]+|[\\\\s]+$': 2} What's interesting about this set is that we can get 796 of the 834 potential non-atom hits if we only atomize strings of length 16-or-less. That may be a decent compromise to avoid atomization overheads.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Puts a RegExpPrivate cache on the ThreadData for JSAtom sources only. Hurray immutability! I want to do a little bit of browsing-in-the-name-of-science before I put it up for review. Particularly, I want to see how many non-atom sources we \"could have hit on if we cached those\" and how much memory overhead that produces.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "My benchmark was to run an already-atomized-only cache and instrument RegExpPrivate creation. I was a lot more scientific this time, and it had very interesting results. Opening the following 6 sites from session restore: Twitter, GReader, GMail, TechCrunch, Facebook, and Delicious, the hit rate was miserable. 22112 events 62 hits, 22050 misses (0.28 % hit ratio) As the text file shows, we get nice contributions from GMail, Twitter's pheonix-core thing and even our own nsSessionStore. The nsSessionStore is due to not atomizing regexp sources out of XDR, which (NOTE REVIEWER! :-) I will fix in this bug. All of these top offenders were uncacheable due to being non-atoms. If we atomize all of these patterns that are less than 16 chars. If we atomize strings we see with <= 16 chars we should hit a nice speed/usage tradeoff at a 98.3% hit rate for this workload.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 6,
                "quote": "Also, (for verification) inspecting the GMail js file by hand I see 31 instances where RegExp is called directly (despite minification), at least in a handful of cases with tiny literal strings.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "I made the chars we read out of the token stream and the strings we XDR decode into atoms and we look good hit rate wise: 21787 events 20526 hits, 1261 misses (94.21% hit ratio) kind | count ------------+------ cold | 648 hit | 20526 eviction | 22 uncacheable | 591 Since we were be creating fresh JSStrings for those token-stream-read creations the atomizing should have added very little overhead, but I'll make an opt build to time it just to be sure. Without any purging we keep a ~2.5K hash table around to cache all the values. Half the RegExpPrivates that exist are there because they're non-atom sources, so I still need more memory usage and execution time data -- maybe atomizing more things would be worth it to reduce the duplication.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "This is close to done, but I have to fix a few things that are bothering me: 1) I'm pretty sure this assertion method doesn't work with background sweeping. I *could* deallocate the cache pre-mark and assume refcounting correctness, but the debug refcounting assertions are nice. I either have to figure out a way to do it in JS_THREADSAFE that doesn't make your eyes bleed, or only perform the assertions when !JS_THREADSAFE (which seems undesirable). 2) The string regexp methods are violating the RegExpPrivate boundary quite heavily in order to avoid creating a RegExpObject. This leads to more annoying problems in the refcount assertions where I have to say, \"check that the string regexp methods are appropriate messing around with RegExpPrivates behind our back,\" which is gross. 3) Switch the RegExpPrivates from taking JSContext parameters to JSRuntime parameters now that they live in the ThreadData. 4) There's too many scary verbs on the RegExp data structures... purge, finalize, reset, decref. If I can't consolidate any of those verbs they at least need a big comment at the top of RegExpObject.h to say how they all work together with the ThreadData cache.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "(Oh, and it passes shell tests in that form.)",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "Looks like this is passing jsreftests. Interesting note to self: you can't legitimately free up memory from a thread-data level cache when you're doing compartmental GCs. Pushed to try.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 11,
                "quote": "Looks good on try. Will post for review this afternoon.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 12,
                "quote": "Attached patch Cache |RegExpPrivate|s, purge cache on global GC. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "The RegExpObjectBuilder idiom feels weird to me. Maybe it's the name that feels strange. I don't know. My concerns about it are not coherent enough to suggest something better.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "If delete_ is null-safe I'd remove the null-check.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "{ on new line.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "File a bug to remove JS_THREAD_DATA in favor of this? I've wanted to do this for a long time, never was touching close enough code to actually do it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "An overview comment for why this class exists would be nice. It's not entirely obvious to me, at a skim of its uses.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "Wouldn't operator bool be worth adding to DebugOnly as well?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 19,
                "quote": "If this is a RegExpObject, shouldn't we have a method to do this, that takes in an AIR<>, rather than do it all manually here? The free-floating decrefs here (and increfs in callers) are not happy-making. I assume the semantics here are that the caller passes ownership of his reference to this function, which is then responsible for decrementing it at the appropriate time (either now, in case of error, or later when the reobj dies)? I suspect based on the name this is what WebKit's PassRefPtr (?) templates are for; maybe we should have something similar.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "if (RegExpPrivate *...)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 21,
                "quote": "If you're renaming arguments, ts here should be tokenStream. That said, why are you removing the line break between return type and methodname? I find the other alignment more readable given how many different arguments this function takes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 22,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/366d80e91816 The small V8 regression was due to some regexp compilation being duplicated in v8-regexp. The cache largely fixes that issue, but it still gets cleared out and recompiles regexps about 6 times during v8-regexp. This at least gets our regexp score back where it was, but there's followup work we can do by only purging on a GC_SHRINK (thereby not clearing out compiled regexps during v8-regexp). That'll be left to the v8-regexp investigation bug.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=576837",
        "issue_id": 576837,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "/[C-\\s]/; YARR: accepts it OLD: \"invalid range in character class\"",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Same with /[f-\\d]/",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "YARR treats the dash as being a member of the character class (brackets) when it precedes a built-in character class (like \\s). js> /[C-\\s]/.exec(' ') [\" \"] js> /[C-\\s]/.exec('-') [\"-\"] This string is accepted by the grammar by the following derivation, so it's not a syntax error due to the grammar: ... -> Atom -> CharacterClass -> \"[\" ClassRanges \"]\" (remaining: \"C-\\s\") -> NonEmptyClassRanges -> ClassAtom \"-\" ClassAtom ClassRanges -> ClassAtom \"-\" ClassAtom [empty] -> ClassAtomNoDash \"-\" ClassAtomNoDash -> SourceCharacter \"-\" \"\\\" ClassEscape -> \"C\" \"-\" \"\\\" CharacterClassEscape -> \"C\" \"-\" \"\\\" \"s\" (accepted) However, 15.10 tacks additional restrictions onto the grammar; namely, ECMAScriptv5 15.10.2.15 production NonemptyClassRanges :: ClassAtom - ClassAtom ClassRanges calls the abstract operation CharacterRange(A, B) in step 4, and CharacterRange step 1 says that if B does not contain exactly one character then a SyntaxError must be thrown, and all the builtin character classes contain more than one character.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Produces the same error message for us as the rest of the character class badnesses, but I added a new error code for upstreamy goodness.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "[jwalden@find-waldo-now src]$ dbg/js js> /[C-\\s]/.exec(\"-\") invalid range in character class js> /[\\s-C]/.exec(\"-\") [\"-\"] Test needs to make sure to address the reversed cases, too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "No need to cache/flush the character class like we do the unescaped characters, since a range with a builtin character class in it is always a syntax error.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Hmm, I think /\\s\\w-\\W/ should be failing as well.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Plain true/false don't do it for me for readability, suggest checkRangeValid/checkRangeInvalid methods forwarding to one common method. Add in some tests with \\b and \\B since those aren't treated as character class escapes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Good style appears to suggest m_sawCharacterClass, to make upstreaming easier.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "As far as good style goes, it appears that this code parenthesizes equality expressions that aren't the whole of conditions -- so |((m_character == '-') && m_sawCharacterClass)|. I think this would be more readable if you didn't put the sawCharacterClass in the else-block. It makes more sense (even if one doesn't subscribe to else-after-return being evil) to say that *if* the just-passed character class starts a range, *then* it's an error and you exit. But the sawCharacterClass assignment applies to both arms of the if below, so it seems it makes more sense to something like this:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "(Add parentheses per the earlier comment.) I had trouble understanding both parts of your condition here -- suggest adding something noting that the first part handles things like [a-\\d] and the second part handles things like [\\w-\\s]. For that matter, the most obvious place for any of these checks, in |case cachedCharacter|, is only hit (I think) in the case of [\\w-a] or [\\w-\\b] -- may as well add a comment to that effect there, too.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "For what it's worth, I found the intricate handoffs between parsing escapes, parsing non-escapes, and the state of CharacterClassDelegate to be way too confusing. But I am loath to suggest significant adjustment as it seems likely to complicate the maintenance burden upstream updates would cause in concert with such changes.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "http://hg.mozilla.org/tracemonkey/rev/8ae5fce0f19b",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Backout: http://hg.mozilla.org/tracemonkey/rev/f4444a398ec1 Somehow I missed bug 351463: with a hyphen between two character classes we are intentionally not compliant to the spec.",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 15,
                "quote": "http://hg.mozilla.org/mozilla-central/rev/8ae5fce0f19b",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "I made us conform to our old, 1.9.2 behavior, so the m_sawCharacterClass was unnecessary after all.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1191113",
        "issue_id": 1191113,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Ah, sorry I missed that. We should uplift that patch as well. I will prepare a patch for dev edition and beta.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "This is an FYI, not a request for change: You could also do: return context.createView({ html: \"<table class='gcli-csp-detail' ... valign='top'>\" + \" <tr>\" + \" <td><img src='.../gcli_sec_bad.svg' .../> </td> \" + \" <td>${l10n.securityCSPNoCSPOnPage} ...</td>\" + \" </tr>\" + \"</table>\", data: { l10n: l10n.propertyLookup } }); Using l10n.propertyLookup means you don't need to get the NO_CSP_ON_PAGE_MSG const",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Thanks - I will incorporate that change in the next iteration of the devtool when we are going to extend the functionality of it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Joe, once r+ed I will fold that patch into the other one. Those are just the new changes on top. I figured it makes sense to have a unified behavior whenever we encounter a CSP or not. For that reason, I also removed the \":\" after \"for:\". Sorry I missed those hardcoded strings the first time around when we landed the devtool.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Folded patches together into one. Carrying over r+ from jwalker.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1190676",
        "issue_id": 1190676,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Another instance of the same problem as last time.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Hopefully this will prevent cross-graph connections and other madness.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Hopefully this wil also prevent getting the wrong graph.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Part 1 - Use the right MediaStreamGraph when setting a MediaStream as mozSrcStream on an HTMLMediaElement. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Hopefully this will prevent cross-graph connections.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Hopefully this wil also prevent getting the wrong graph.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Part 4 - Fix consumers: CanvasCaptureMediaStream. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "I needed to stub a number of things to make this work, but I have mostly no idea what I'm doing in the FakeMediaStream file.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Attached patch Part 6 - Fix consumers: MediaManager. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 10,
                "quote": "James, it appears that you wrote this code initially, care to have a look at this? I mostly need to know if there is a way to know whether the graph will need audio when you call GetInstance.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 11,
                "quote": "James, it appears that you wrote this code initially, care to have a look at this? I mostly need to know if there is a way to know whether the graph will need audio when you call GetInstance.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Attached patch Part 8 - Fix consumers: CameraPreviewMediaStream. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 13,
                "quote": "Attached patch Part 9 - Fix consumers: AudioCapture. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Attached patch Part 10 - Fix consumers: AudioDestinationNode. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Attached patch Part 11 - Fix consumers: Web Speech. r= \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Part 10 - Fix consumers: AudioDestinationNode. r= Please fold this into attachment 8643091 [details] [diff] [review], as I hope that won't compile without this change.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "This looks good to me, but I'd like to ask eeejay to please double check since he's more familiar with Synthesis",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 18,
                "quote": "I'd like to ask eeejay to please double check since he's more familiar with Synthesis",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 19,
                "quote": "Looks good. I'm not sure which AudioChannel we want to be on. But I assume we were on Normal before, so this is fine.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 20,
                "quote": "Hrm, I forgot that I had added this after asking for all the reviews.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 21,
                "quote": "One of these in CaptureStreamInternal() should suffice.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1176028",
        "issue_id": 1176028,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I added a wrapper to the generators so that we could land the unix and windows parts independently. Now we're ready to rip out the shim.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1118599",
        "issue_id": 1118599,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It seems like the GCC compiler bug that I worked around in bug 1077887 is no long relevant. This patch undoes that workaround. It also renames some things that were named not-so-well do to the need to support non-scoped enums (without \"enum class\", multiple enums defined in the same scope cannot have the same labels like \"No\" and \"Yes\").",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Thanks for cleaning that up.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch remove-MOZILLA_PKIX_ENUM_CLASS.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=735312",
        "issue_id": 735312,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "we try to import bookmarks.html from the profile folder, but looks like now that file is inside the omni.jar (my guess is this happens from Bug 556644). In debug builds we commonly use, we don't use the omni.jar, so when ProfDef gets copied, bookmarks.html is, and ends up in the profile folder, then everything works fine. nsBrowserGlue was updated to import from resource:///defaults/profile/bookmarks.html but the migrators code was not, it still tries to directly read from the profile folder.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "Importing a separate bookmarks.html file in the test ended up covering this issue, so I removed it. The resource address automatically resolves to the right destination, depending on whether omni.ja exists. Will likely make a try to help testing.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Looks like this is getting rid of the only caller of ImportHTMLFromFileToFolder. Can we remove that too?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Try run for c4cd8ee2197e is complete. Detailed breakdown of the results available here: https://tbpl.mozilla.org/?tree=Try&rev=c4cd8ee2197e Results (out of 25 total builds): success: 21 warnings: 1 failure: 3 Builds (or logs if builds failed) available at: http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/mak77@bonardo.net-c4cd8ee2197e",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "Vlad, could you preventive check the Windows try builds and tell me if now they correctly import for you?",
                "code": "VERIFICATION_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "CC'ed Mano as I'm not sure if he was using ImportBookmarksHTML in his refactoring",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "With this check, the NS_ENSURE_SUCCESS(rv, rv) in ImportDefaultBookmarks seems redundant. You could just `return rv` there and keep this check here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "tbpl showed that we'll need to include mozilla/Util.h for DebugOnly here",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Unrelated to this fix, but worth following up later is to take a look at tests that are referring to bookmarks.html or these functions: http://mxr.mozilla.org/mozilla-central/source/toolkit/components/places/tests/head_common.js#413 Some of them might be relying in not using omni.ja{r} for tests which means other things might be broken but passing tests.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 10,
                "quote": "I've tested using the try build and the favorites from IE9 are imported in Bookmarks Menu but items are not present in a new directory and also are not in the same order as in IE9. See the screenshot.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 11,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/a10f5ab758b4",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "and a follow-up, since I forgot a namespace + minor cleanup. https://hg.mozilla.org/integration/mozilla-inbound/rev/88112eb6a1f5",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 13,
                "quote": "coalesced patch for approval, once we get positive testing in Nightly.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 14,
                "quote": "Given that, approving for Aurora 13 and Beta 12.",
                "code": "UPLIFT_APPROVAL"
            },
            {
                "annotation_id": 15,
                "quote": "Attached patch (AAv1) Remove MIGRATION_BUNDLE leftover [Checked in: Comment 27] \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "the patch is technically correct, though note that we are about to kill these files really shortly (As soon as the new Safari and IE js migrators land), so I'd not spend time in cleaning them up perfectly.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 17,
                "quote": "Changing the flag to verified on: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0 beta 3 All the favorites are imported in alphabetical order from IE9.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 18,
                "quote": "Mozilla/5.0 (Windows NT 6.1; rv:14.0) Gecko/20120426 Firefox/14.0a2 Built from http://hg.mozilla.org/releases/mozilla-aurora/rev/7525533b3e42 Verified that the Favorites are imported from IE9, but the folder \"Websites for United States\" (which is a default Favorites folder) is imported as \"Links for United States\" in Firefox",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 19,
                "quote": "I don't see any favorite folder called \"Websites for United States\" in my IE 9.0.8112.16421. All bookmarks are successfully imported in FF 13b3: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0 Verified fixed",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=916390",
        "issue_id": 916390,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In any case, it would be nice if we could just eliminate this field. Now that we have the TabStateCache, I doubt that it saves us much work.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "What do you guys think?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I think that in its current state we might even be losing form data when: 1) form data is saved and formDataSaved=true 2) something calls TabStateCache.delete(tab) 3) we re-collect all data except form data Boom, lost.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "This flag assumes that the tabData is re-used in _collectBaseTabData() which is only the case if the session history didn't change.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "The tab should still have the same form data but the number of session history entries changed and that makes us re-collect session history entries (and form data). Due to formDataSaved still being true we skip form data collection though.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Removing __SS_formDataSaved shouldn't really hurt as well because MozStorageChanged seems to be the only event where we call TabStateCache.delete() without at the same time setting formDataSaved=false. There shouldn't be a lot more overhead now when always collecting form data.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Attached patch Remove __SS_formDataSaved \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "I don't quite understand why there was a |if (aIncludePrivateData)|, but then, I'm not sure why you have removed it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Couldn't we take an opportunity to give a better name to the test?",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1079905",
        "issue_id": 1079905,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached image loop-button-options.png \u2014 Details",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Philipp, not sure if you have any comments here or if we should get legal involved? Do you think changing the color is best?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I personally find option A most appealing, the only drawback is that the green/action buttons get lost with all the other blue buttons we have.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Would love to also get shorlander and mmaslaney's thoughts here.",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 5,
                "quote": "Couple options to consider Version 1: Normal style button + green icon Version 2: Default style button Version 3: Teal Version 4: Teal Gradient http://people.mozilla.org/~mmaslaney/hello/Hello-button-variations.png",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "I think the blue version works best. We'll also use it in the permissions UI for device sharing, so it's consistent with that. Teal also looks very nice, but I'm afraid it wouldn't solve the possible legal issues.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "By the way: another way to work around this besides the color would be changing the icon itself significantly. I took a stab at this once, but didn't really get to a good solution.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Something I haven't seen considered is green on green or teal on teal \u2014 http://cl.ly/image/351M2k0o370o I like the teal but I prefer the green in this case because it is farther away from the blue we are using in other places. Alternative Icon ideas \u2014 http://cl.ly/image/2h3s093H263i",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "Ok, I'm leaning towards the teal background with white text/icon. Same icon as we currently have.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 10,
                "quote": "Stephen, I love the idea of using green, but I think we face a bit of a challenge trying to define an alternative video icon.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Ok, so going with replacing all green buttons in the Hello UI with Summit Teal vibrant (#5BC0A4) and white foreground (text + icons). Also shifting the pill button in the contacts UI to a shorter, rounded rect, in line with our other Hello buttons (see bug 1075203). Thanks everyone!",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1339619",
        "issue_id": 1339619,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It should just use a keyword table, for consistency. (It's a keyword-valued property; might as well just use our standard keyword-valued-property codepaths, rather than trying to be tricky and hardcoding something more direct and more verbose/error-prone than the normal codepath.)",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "I think the files to change here are nsCSSPropList.h, nsRuleNode.cpp, and nsComputedDOMStyle.cpp, and nsCSSProps.*",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "I suspect the code exists in its current state (eschewing a keyword table) because it's probably a bit faster this way.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "I claim the perf benefit here doesn't matter too much, since this is a prefixed property which likely doesn't get much usage. So, better IMO to optimize for code-comprehensibility & maintainability in this case. (Particularly in the nsComputedDOMStyle::DoGetTextSizeAdjust[1] impl -- we can make that a nsCSSProps::ValueToKeywordEnum() invocation, rather than needing a switch statement. And particularly because this seems to be the *only* strictly-keyword-valued-property that does not use a keyword table.[2])",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "dbaron: are you OK with this change? If you'd prefer to leave this as-is, I'll defer to your judgement. (It looks like this is code that you originally wrote back in bug 627842.)",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 6,
                "quote": "So: in the interests of avoiding similar pitfalls in the future, I'd like to either: (1) bring us into alignment with all the other keyword-valued properties here ...OR (2) add a comment to the -moz-text-size-adjust section in nsCSSPropList.h to explicitly call out that it's different & hint at why.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 7,
                "quote": "I lean towards (1) but we could do (2) instead if you prefer -- dbaron, what do you recommend?",
                "code": "SOLUTION_REVIEW_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "I lean towards (1) but we could do (2) instead if you prefer",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "I'm fine with (1); I don't think I have particularly strong preferences here (but in the past I've tried to avoid mixing VARIANT_AUTO and VARIANT_NONE with things that have keyword tables).",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Agreed that that's desirable, and the end result of (1) will still adhere to that. (We'll shift from VARIANT_AUTO|VARIANT_NONE to VARIANT_HK, with eCSSKeyword_None & eCSSKeyword_Auto being the two keywords in the keyword table.)",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/113180/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/113180/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "Thanks! Looks good -- r=me with 2 nits addressed:",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Nit: move this a few lines further down, to be just after DoGetTextShadow. That way, it'll be in alphabetical order, & it'll be consistent with the ordering you've used in the nsComputedDOMStyle.cpp file.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Comment here needs updating. It should now say \"enum, inherit, initial\" I guess (matching the comments for the neighboring SetValue calls).",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/113180/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1329110",
        "issue_id": 1329110,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "We will split HandleAudioNotDecoded into: 1. HandleWaitingForAudio when the error code is NS_ERROR_DOM_MEDIA_WAITING_FOR_DATA. 2. HandleAudioCanceled when the error code is NS_ERROR_DOM_MEDIA_CANCELED. 3. HandleEndOfAudio when the error code is NS_ERROR_DOM_MEDIA_END_OF_STREAM.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/103430/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103430/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/103432/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103432/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/103434/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103434/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/103436/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103436/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/103438/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103438/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Since DecodingState is the only one that overrides the function, we will let it just override HandleWaitingFor{Audio,Video}. We also reduce the code complexity because it is hard to trace the code when one virtual function calls another virtual function. Review commit: https://reviewboard.mozilla.org/r/103440/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103440/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "The same reason as P6. We would like to avoid virtual functions calls inside a virtual function. Review commit: https://reviewboard.mozilla.org/r/103442/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/103442/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Also copy this assertion into AccurateSeekingState::HandleWaitingForAudio() ?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "Same here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "Here again.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 12,
                "quote": "Shouldn't we implement HandleWaitingForAudio(), HandleAudioCanceled() and HandleEndOfAudio() for the ShutdownState? We can put an assertion there or at least do nothing. Same fo the video case.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 13,
                "quote": "Same issue here.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103430/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 15,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103432/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 16,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103434/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 17,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103436/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 18,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103438/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 19,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103440/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 20,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/103442/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1328511",
        "issue_id": 1328511,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It seems all tests mentioned here has been enabled in bug 1328509.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1325297",
        "issue_id": 1325297,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch create StartDecodingWithResult \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Use the result of StartDecodingWithResult during painting \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "nit: extra whitespace at end of line",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1316964",
        "issue_id": 1316964,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is done by making them accept a `&T` where `T: AsRef<[$char_t]>` instead of a `&nsA[C]String`.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Make the append and assign methods on the rust nsstring types more generic \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1297315",
        "issue_id": 1297315,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/73496/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/73496/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Please help to review this patch for fixing those warnings.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "Bug 1297276 will rename the unused.h to Unused.h, so set the dependency.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 4,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/73496/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "`while (false)`",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "This doesn't need {}s. Don't change it.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "If I use |while (false)|, it will break the loop without continuing, the logic is not as expectation.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "You're right about do{}while(false). We need while(true) for continue. In this module, we want {} for single lines unless they are control flow statements. (return, break, continue)",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1287522",
        "issue_id": 1287522,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "ToString needs to be applied before retrieving the \"flags\" property.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Added explicit ToString call to pattern and flags, in correct order, and renumbered the spec steps.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1268252",
        "issue_id": 1268252,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch runnable3.patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1261576",
        "issue_id": 1261576,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Actually they are blue when selected, but as soon as you slide it even a pixel the blue goes away.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "OK. Just to clarify further the difference between the old behavior and the behavior under Gtk3 with the pending patch for bug 1234158 applied. With this patch applied under Gtk3, the scrollbar handle is light gray normally, dark gray when hovered and blue when selected (all of which are correct and agree with the old behavior) What is wrong is that if you keep the scrollbar selected and drag it to actually scroll it reverts to the default light gray instead of remaining blue as expected.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "One other issue i notices is that clicking and holding in the scrollbar outside the handle are should move the handle to that area and it should be clue as long as selected. It is also light gray in that scenario, but that is probably the same sase as the other issue selected and moved. I am also removing the regression keyword because I think have a regression keyword on a regression that cannot be seen without adding a wip patch is kind of lame.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Yes, I see that now. I should not have been trying to go from memory.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "I can confirm this on Gnome 3.20 with GTK+3 3.20 using Adwaita theme. Unfortunately I can't see the scrollbar when hovered/selected/dragged either...",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 6,
                "quote": "Lubuntu 16.04 x64, GTK 3.18, Firefox 46.0. Same situation. Screencast attached.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 7,
                "quote": "There's a simple fix for that. Need to check if we need that for pre-3.20 too.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 8,
                "quote": "This fixes it for me on gtk+ 3.20.6",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 9,
                "quote": "I can verify that this fixes the issue for me under both gtk 3.20 and gtk 3.18.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 10,
                "quote": "I'm unable to find exact commit but indicator_set_over() (from gtkscrolledwindow.c) which sets the \"hovering\" style to thumb was introduced in Gtk 3.16 so I guess it's safe to enable that for gtk3.16+.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 11,
                "quote": "I'm unable to find exact commit but indicator_set_over() (from gtkscrolledwindow.c) which sets the \"hovering\" style to thumb was introduced in Gtk 3.16 so I guess it's safe to enable that for gtk3.16+.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 12,
                "quote": "I also verified that this compiles and does not seem to cause any issues if you build using the cairo-gtk2 toolkit.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 13,
                "quote": "inHover corresponds to GTK_STATE_FLAG_PRELIGHT which I assume is the :prelight (and :hover) pseudoclass. The .hovering class from indicator_set_over() is different and for overlay scrollbars. I assume this is the Adwaita rule involved: .scrollbar .slider:prelight:active { background-color: #2a76c6; } The reason why gtkrange sets prelight as if in hover is that the mouse location is set to the grab location when the pointer is grabbed during mouse down: https://git.gnome.org/browse/gtk+/tree/gtk/gtkrange.c?h=3.20.6#n3437 This is the same in older versions: https://git.gnome.org/browse/gtk+/tree/gtk/gtkrange.c?h=3.4.4#n3349 I'm a little surprised that Gecko's scrollbar implementation is not similar.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 14,
                "quote": "Not this patch, because this bug is unrelated to 3.16 and \"hovering\" is a different concept.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 15,
                "quote": "But this patch is good, thanks, with the commit message from the other.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 16,
                "quote": "Attached patch patch for check-in \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1247539",
        "issue_id": 1247539,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This 'works' but anyone encountering a problem is still unlikely to observe it: (1) gfxCriticalNote messages in the child process don't show in about:support (2) On Windows, child process stdout/stderr is broken unless you pipe to file (3) The histogram value - which is definitely getting recorded - does not appear in any ping. I'm not sure how Telemetry in content processes is supposed to work.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Inside of this branch, \"hr\" is not initialized, so no point in showing the value, right?",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Yeah, this is completely not in place.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "They should show up in the crash reports though, except for the case where we're messaging from a non-main thread on the child process, but I'd like to confirm that.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "Does this resolve #1?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "I realize it'd have trouble for non-main thread content messages.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Yeah, indeed.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1217192",
        "issue_id": 1217192,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Use gfxCriticalNote where appropriate for brevity. (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch Use gfxCriticalNote where appropriate for brevity. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Pre rebase try run seems to be ok - https://treeherder.mozilla.org/#/jobs?repo=try&revision=6e68d6da0c62",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1469362",
        "issue_id": 1469362,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Changes since last update: #9595 Disable ftp support in Chrome 59+, add file chooser at file #9819 Fix regression affecting the horizontal `viewerContainer` offset for small window widths (PR 9816 follow-up) #9809 Allow `FontFaceObject.getPathGenerator` to ignore non-embedded fonts during rendering #9802 Update `ColorSpace` and `PDFImage` to use `Uint8ClampedArray`s and remove manual clamping/rounding #9821 Set the correct document title when opening a new file in the `GENERIC` default viewer",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Pushed by ryanvm@gmail.com: https://hg.mozilla.org/integration/mozilla-inbound/rev/280327567bdf Update pdf.js to version 2.0.602. r=bdahl",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1465254",
        "issue_id": 1465254,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/247816/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/247816/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "https://reviewboard.mozilla.org/r/247816/#review253912",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1458856",
        "issue_id": 1458856,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/241560/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/241560/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Code analysis found 1 defect in this patch: - 1 defect found by mozlint You can run this analysis locally with: - `./mach lint path/to/file` (JS/Python) If you see a problem in this automated review, please report it here: http://bit.ly/2y9N9Vx",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Error: Unnecessary 'else' after 'return'. [eslint: no-else-return]",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/241560/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "https://reviewboard.mozilla.org/r/241560/#review247516",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Verified as fixed on the following builds: Beta 61.0b6(20180517141400) and Nightly 62.0a1(20180520220103). No error is displayed in browser console when a rollout is performed on a new non-existent preference.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1455735",
        "issue_id": 1455735,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In my testing,. Fx60 is not affected by this.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Chutten: I'm having trouble reproducing this on a fresh profile with a build from mozilla-central (cset 5d73549d363f, if it matters). I'm using the STR from bug 1450690, and everything seems to be working fine. An easier way to exercise the code path in question is something like this in the console: ChromeUtils.import(\"resource://normandy/lib/AddonStudies\"); AddonStudies.start({recipeId: 1, name: \"test\", description: \"test test\", addonUrl: \"https://net-mozaws-prod-us-west-2-normandy.s3.amazonaws.com/extensions/taarexpv2@shield.mozilla.org-1.0.13-signed.xpi\"})",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 3,
                "quote": "Can you get some situation where you can reproduce the error? Either with the stage server, or with the snippet above? I'm starting to wonder if this is an intermittent bug, or if there is something else going on that we haven't noticed.",
                "code": "REPRODUCTION_REQUEST"
            },
            {
                "annotation_id": 4,
                "quote": "Using the default settings in a prefs.js as follows with a new profile: user_pref(\"security.content.signature.root_hash\", \"DB:74:CE:58:E4:F9:D0:9E:E0:42:36:BE:6C:C5:C4:F6:6A:E7:74:7D:C0:21:42:7A:03:BC:2F:57:0C:8B:9B:90\"); user_pref(\"extensions.shield-recipe-client.api_url\", \"https://normandy.stage.mozaws.net/api/v1\"); user_pref(\"app.normandy.dev_mode\", true); user_pref(\"app.normandy.logging.level\", 0); I'm getting 8 addons installed currently from staging, nothing in about:studies, no enrollment in about:telemetry. Also browser console logs: 1524573762197 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 329 1524573762200 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 309 1524573762201 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 308 1524573762202 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 304 1524573762203 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 302 1524573762204 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 298 1524573762205 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 269 1524573762205 app.normandy.normandy-driver.actions DEBUG Starting study for recipe 268",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 5,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/239412/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/239412/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "My reduced test case in 2 bypassed the actual problem. I was able to reproduce the problem today, and the attached patch fixes the problem for me. The problem I fixed here was a regression caused by the changes in bug 1436113.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 7,
                "quote": "Marking this as verified per https://bugzilla.mozilla.org/show_bug.cgi?id=1450690#c54.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1407435",
        "issue_id": 1407435,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "It seems like the animate-out class is not properly removed.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "Regression of bug 1390313",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/188470/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/188470/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Thanks, I was able to reproduce the bug (aNode.parentNode is null) as well as confirm that the patch fixed it.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 5,
                "quote": "I was able to reproduce the issue on Nightly build (2017-10-10) using Windows 7 x64. Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:58.0) Gecko/20100101 Firefox/58.0 Verified fixed on latest Nightly 58.0a1 (2017-10-16) across platforms: Windows 10 x64, Windows 7 x64, Mac OS X 10.13 and Ubuntu 16.04 x64.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1183934",
        "issue_id": 1183934,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Sync logs may include an entry similar to: 1436815520239 Sync.Engine.History ERROR null This is more of a problem since bug 1148980 landed as any \"error\" entry in the logs cause Sync to generate an error log and note the error in the browser console. Although I haven't yet reproduced this, I'm confident the problem is https://hg.mozilla.org/mozilla-central/file/e7e69cc8c07b/services/sync/modules/engines.js#l786. This is the callback from Utils.jsonSave, which is at https://hg.mozilla.org/mozilla-central/file/e7e69cc8c07b/services/sync/modules/util.js#l369, and as you can see, the callback is made with null when there's no error - but we still log it.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Although I haven't yet reproduced this, I'm confident the problem is https://hg.mozilla.org/mozilla-central/file/e7e69cc8c07b/services/sync/modules/engines.js#l786. This is the callback from Utils.jsonSave, which is at https://hg.mozilla.org/mozilla-central/file/e7e69cc8c07b/services/sync/modules/util.js#l369, and as you can see, the callback is made with null when there's no error - but we still log it.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Actually, let's make the error more descriptive while we are at it.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1132964",
        "issue_id": 1132964,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Regressed somewhere in here, bisecting now https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=2cb22c058add&tochange=ee093ca70666",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "I have a workaround for my test now, turns out this was actually cause by bug 1047603. Not sure how important this is to fix in Firefox",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 3,
                "quote": "Can we close this? It appears to be working as desired: Name Firefox Version 46.0a2 Build ID 20160205004003 User Agent Mozilla/5.0 (Windows NT 6.1; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1092808",
        "issue_id": 1092808,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I confirmed this on a new profile. Either https://bugzilla.mozilla.org/show_bug.cgi?id=1031033 is wrong or we are getting a pref changed event for polaris that is resetting related prefs in https://bugzilla.mozilla.org/show_bug.cgi?id=1081343.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "Hello Gavin and Tomasz, We are getting a pref-changed event on startup in https://hg.mozilla.org/mozilla-central/rev/54fab44be5f3#l2.30 that is causing tracking protection to be enabled on restart if polaris is enabled. What's the right thing to do here? Monica",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "I didn't think reading the user pref file triggered preference change observers, but apparently it does if you register your observer early enough. So let's just register the observer later during startup.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 4,
                "quote": "This adds the observer during finalUIStartup (shortly before first window open), which is late enough that it isn't triggered while reading user prefs in my testing. This seems like a prefs API foot gun in general, and this is just dodging it.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Verified on Windows 7 64bit, Ubuntu 13.10 32bit and Mac OSX 10.9.5: - using latest Aurora 36.0a2 (07-01-2015) : the UI for tracking protection is not uplifted yet to Aurora - using latest Nightly 37.0a1 (07-01-2015) : the issue is fixed.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=597071",
        "issue_id": 597071,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Fix it all up and it even includes a test (win/linux only). I didn't have a windows machine handy, but Sean has run this and says it passes with the fix, and fails without.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Sean has run this and says it passes with the fix, and fails without.",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "Alas, I think dietrich should do the review here, I don't know session restore well enough to judge the impact of this. Even though it's a 1-line change.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Really? :)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I pushed a workaround for this in bug 596592: http://hg.mozilla.org/mozilla-central/rev/f1eec85dcfdc It should be backed out when this bug is fixed.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            },
            {
                "annotation_id": 6,
                "quote": "This makes sense, makes the API more consistent. To make the test only run for Win/Linux, move the check to the makefile so that it doesn't run at all. r=me w/ that change.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 7,
                "quote": "Try server failed this bug's test (timeout) on linux, see try build http://hg.mozilla.org/try/rev/617debdc2f5e",
                "code": "SOLUTION_VERIFICATION"
            },
            {
                "annotation_id": 8,
                "quote": "Used #ifndef XP_MACOSX in the Makefile to target win/linux. Also moved the listener off the tabContainer to gBrowser, since that's what was most likely causing the timeout (tabContainer doesn't capture page loads, just favicons)",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "Pushed http://hg.mozilla.org/mozilla-central/rev/7b85cdce3ea6 to followup on the bustage. I can't do what I had done in the Makefile (don't know why it worked locally!)",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1479309",
        "issue_id": 1479309,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "the quickest path to getting rid of it it is just loading it when we get a \"ShieldPageEvent\" event in a frame script.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/260166/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/260166/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/260166/diff/1-2/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Thanks! Also, since this is blocking the memshrink bug, I'm curious if you've profiled how much memory these changes save? If you haven't already profiled it, don't worry about. I'm sure the the changes are worth it, I'm just curious.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/2d46e1fe31214d36d1e11218deb44423baee2c26 Bug 1479309: Don't load shield-content-frame.js until needed. r=mythmon",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Backout by csabou@mozilla.com: https://hg.mozilla.org/mozilla-central/rev/fe6020e5c9d9 Backed out 12 changesets (bug 1479309, bug 1479312, bug 1479313, bug 1479310, bug 1479235, bug 1479945, bug 1479241, bug 1479318) for causing a big performance regression on OS X. a=backout",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 7,
                "quote": "Backed out for causing a big performance regression on OS X and as request by igoldan. https://hg.mozilla.org/mozilla-central/rev/fe6020e5c9d901a40fa2e7ea2f1ab2a36bf6d856",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 8,
                "quote": "https://hg.mozilla.org/integration/mozilla-inbound/rev/a396e7027858121f002ff1544fd28fabe5996685 Bug 1479309: Don't load shield-content-frame.js until needed. r=mythmon",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=658675",
        "issue_id": 658675,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The solution that I'm proposing is to preload the captcha as soon as the user decides to create a new sync account rather than connect to an existing one.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "Tricky bit is custom servers, each server has a separate captcha keypair, so I wouldn't prefetch then. There's definitely room for prefetching though, maybe once we have a validated username?",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch v1 (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "OK, this looks good to me. Really need a way of testing with a 404 captcha page, though.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 5,
                "quote": "I tested with server-full running on localhost (it has captchas disabled by default), but I've just noticed a small problem with the last wizard page, it doesn't always close properly, probably because of my wizard.pageIndex hackery. New patch coming up.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 6,
                "quote": "Use wizard.advance() instead of manipulating wizard.pageIndex and move this piece of code from onWizardAdvance to onPageShow to avoid infinite recursion. Also don't call Service.login(). It made closing the wizard kind of slow and jerky and it's so not needed anymore. Asking for review again for those two changes.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "Asking for review again for those two changes.",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "Looks good to me.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 9,
                "quote": "verified with latest s-c builds",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1751268",
        "issue_id": 1751268,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "In analyzing the backtrace, the regression may have been introduced by patch [1] to fix bug 1748878.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "I'm pretty sure this is due to bug 1748450, not bug 1748878.",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 3,
                "quote": "Not sure if this is helpful, but I'm getting this crash 100% consistently when I open a message in ProtonMail.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 4,
                "quote": "Note that bug 1748450 has been backed out, which should fix this.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=924397",
        "issue_id": 924397,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Here is the error message that gets printed: 0:28.12 WebIDL.WebIDLError: error: Syntax Error at end of file. Possibly due to missing semicolon(;), braces(}) or both, WorkerNavigator.webidl",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "According to hg log, Kyle is a better choice of reviewer here.",
                "code": "CODE_REVIEW_REQUEST"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=857034",
        "issue_id": 857034,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch patch \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "The DisplayBorderBackgroundOutline() call should be inside the |if| block, obviously. I've moved that locally.",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1625850",
        "issue_id": 1625850,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Another Fedora user here, I can confirm that I'm having Firefox crash sometimes when using Gnome search quickly and making a typo, as odd as it sounds.",
                "code": "REPRODUCTION_ATTEMPT"
            },
            {
                "annotation_id": 2,
                "quote": "I guess it's because keyIndex at nsGNOMEShellSearchProvider::LaunchWithID() is invalid so we get null nsCOMPtr<nsINavHistoryResultNode> child and then crash at child->GetUri(uri);",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 3,
                "quote": "Should be fixed by Bug 1239694.",
                "code": "SOLVED_BY_OTHER_ISSUE"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1025075",
        "issue_id": 1025075,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "So i think a static connect stream priority makes more sense.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 2,
                "quote": "https://tbpl.mozilla.org/?tree=Try&rev=9b550ab71ca6",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1074012",
        "issue_id": 1074012,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch part 1 - Temporarily expose some gfxContext fill/stroke API to help with porting to Moz2D (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Attached patch part 2 - Mark gfxPattern::GetPattern's DrawTarget parameter as const \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Attached patch part 1 - Temporarily expose some gfxContext fill/stroke API to help with porting to Moz2D \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch part 3 - Make nsSVGUtils::MakeFillPatternFor/MakeStrokePatternFor return using a Moz2D GeneralPattern out-param rather than a Thebes gfxPattern \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1390087",
        "issue_id": 1390087,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: https://hg.mozilla.org/mozilla-central/rev/e33e38d61829 user: Jon Coppeard date: Tue Jul 25 11:28:41 2017 +0100 summary: Bug 1374797 - Fix logic around triggering atoms GCs r=sfink",
                "code": "PROBLEM_LOCALIZATION"
            },
            {
                "annotation_id": 2,
                "quote": "The problem here is that when we're scheduling zones for GC and checking the GC budget we look at all zones, even those used by helper threads that we can't collect anyway. So let's ignore these.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 3,
                "quote": "Fix an assertion. Looks low risk. Beta56+.",
                "code": "UPLIFT_APPROVAL"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=738759",
        "issue_id": 738759,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Quite a few callers want an nsINode anyway.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "- case nsIDOMNode::ENTITY_NODE: - case nsIDOMNode::ENTITY_REFERENCE_NODE: - case nsIDOMNode::NOTATION_NODE: - { - return NS_ERROR_NOT_IMPLEMENTED; - } default: { NS_WARNING(\"Don't know how to clone this nodetype for importNode.\"); return NS_ERROR_DOM_NOT_SUPPORTED_ERR; } This is of course an observable change in behavior here. Correct as it is, we should keep an eye out for odd fallout from this. r=jst",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1467403",
        "issue_id": 1467403,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "mostly just removed the code that handles when prologue have source notes. BytecodeEmitter::finishTakingSrcNotes's else-clause is necessary since the delta of the source note in the main section has to be updated to reflect the prologue bytecode length.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Nice!",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Nit: we usually have a blank line before comments like this, if not at the start of a block?",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1048721",
        "issue_id": 1048721,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Implement WebGL2Sync. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "I'd rather make this RAII, instead of passing some externally-created GLsync in. (Also, `explicit` is only for single-arg ctors, IIRC)",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "We can do that. I think I changed to this why because of how we pass in the glname for other objects, such as textures, render buffers, frame buffers, etc. Good spot on explicit. This function used to be single-arg ctor.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Attached patch Address review comments. \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1421170",
        "issue_id": 1421170,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "The CustomElementUpgradeReaction and CustomElementCallbackReaction are only used inside CustomElementRegistry.cpp, so we don't need to expose them in header file. Review commit: https://reviewboard.mozilla.org/r/203378/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/203378/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "https://reviewboard.mozilla.org/r/203378/#review210552",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1405027",
        "issue_id": 1405027,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Avoid using nsINode::GetChildAt() in HTMLEditor::GetElementOrParentByTagName() \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1401299",
        "issue_id": 1401299,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/181408/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/181408/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "https://reviewboard.mozilla.org/r/181408/#review187030",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1357386",
        "issue_id": 1357386,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I am happy to modify the patch if we can think of any other information we could gather, but I think that's pretty much the best we can do, right?",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "datareview+",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Is this all the information we need? I suspect we're going to find out that compared to the number of documents and frames loaded data: urls are a very small fraction. What then? Are there types of data documents we can carve out to get a better sense of what we might break? My first thought was to count sandboxed data: documents because clearly we can't break those, but since such documents would be essentially sandboxed in Chrome already maybe web devs wouldn't bother to add that attribute. I'd like to know what fraction of top-level data: documents are from navigations/links vs manual entry or bookmark. Whether or not there's a referrer could be a proxy for that, although Referrer Policy and/or user prefs can mess that up. Is there an easy way to check the \"real\" referrer from that point in DocShell? If not I could live with the simpler method and just hope Referrer Policy isn't used much to completely blank the referrer. Would prefer some descriptive #define or const for the buckets rather than raw numbers, though not sure where you'd stick them that would make much sense. If we ever added buckets that we counted elsewhere it would be even more important. r- mainly for not counting \"developer\" use of data: vs \"web\" encounters -- I think that's important to help us judge scale.",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 4,
                "quote": "Dan, thanks for your feedback. I flipped the patch around entirely. In fact we are only interested in top level data: URI loads and whether they are navigated or typed into the URL Bar (by a developer or also come from a bookmark). This patch relies on the triggeringPrincipal (which in most cases is identical to the referrer but also agnostic to the referrer policy). Whenever the a toplevel page is navigated then the triggeringPricnipal is a codebasePrincipal. When typing a data URL into the address bar, the triggeringPrincipal is a systemPrincipal. Similar when clicking a bookmark, then the triggeringPrincipal is a systemPrincipal. I think that should provide exactly the information we are seeking for: what breakage can we expect if we disallow navigations to data: URIs for toplevel loads.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "I flipped the patch around entirely. In fact we are only interested in top level data: URI loads and whether they are navigated or typed into the URL Bar (by a developer or also come from a bookmark).",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 6,
                "quote": "Backout by cbook@mozilla.com: https://hg.mozilla.org/integration/mozilla-inbound/rev/c928f0602185 Backed out changeset 2b92af4575ae https://hg.mozilla.org/integration/mozilla-inbound/rev/c51a2eaa0078 Backed out changeset 59567c6c1e71 for landing with wrong bugnumber",
                "code": "IMPLEMENTATION_REVERSION"
            },
            {
                "annotation_id": 7,
                "quote": "Why aren't we interested in frames also? I would guess (based on nothing!) that data: in frames is more common than navigating or window.open()ing a data: document. The sad thing is that none of these measures tells us what we really want to know: how much breakage would we cause by making data: urls not inherit. We might count tons of data: documents but have them all turn out to be perfectly fine without inheritance because they were written for all the other browsers. We have a pref that flips the behavior so we could do a shield or pref-flipping experiment -- except we need a way to measure the effects if we do so. Where's a good place for that? Maybe the cross-compartment wrapper access check? If it fails check to see if the target or source compartment is a data: url. By doing it on the failure path we should avoid perf impacts (but of course we should measure that, too, as part of the test). Some access failures might be normal, but we could compare the rates from the test groups vs the global population. The drawback to that is that a small sample study is likely to miss the specific cases that might break: \"Firefox-required\" internal apps for particular enterprises. I guess they could just flip the pref as part of their roll-out.",
                "code": "SOLUTION_REVIEW"
            },
            {
                "annotation_id": 8,
                "quote": "Ah. This bug is blocking both bug 1324406 and bug 1331351 so I thought it was trying to gather telemetry for both. We already have bug 1302399 for that, I guess. Can we remove bug 1324406 from the blocked list here then? Thanks for the clarification.",
                "code": "ISSUE_IMPACT"
            },
            {
                "annotation_id": 9,
                "quote": "If this telemetry is only for bug 1357386 then this is fine. r=dveditz",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1357065",
        "issue_id": 1357065,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Try push is looking green: https://treeherder.mozilla.org/#/jobs?repo=try&revision=529ac25bb2049b92ac7147b3418c7e1321a03373 Also note that I suspect some of these clips we're pushing from WebRenderContainerLayer are probably unnecessary. I tried removing the ones I thought were unnecessary and got crashes in webrender, for which I filed https://github.com/servo/webrender/issues/1122. Once that is resolved I'll try that again. I also suspect that we might not be pushing enough clips from WebRenderDisplayItemLayer - right now it checks to see if there is a mask layer and only pushes a clip in that case. We probably also need to push a clip if there is a non-empty cliprect set on the Layer. I'll investigate and file a follow-up if needed.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "I tried removing the ones I thought were unnecessary and got crashes in webrender, for which I filed https://github.com/servo/webrender/issues/1122.",
                "code": "NEW_ISSUE_FILING"
            },
            {
                "annotation_id": 3,
                "quote": "This changes the parameters to be in line with the clipping documentation. Review commit: https://reviewboard.mozilla.org/r/130832/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/130832/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 4,
                "quote": "Note that in upstream WR the push_scroll_layer API has already been renamed to push_clip_node, so conceptually the same API covers both \"scrolling clips\" (aka scroll layers) and non-scrolling clips. So using the same underlying API for two different WebRenderAPI.h functions makes sense. Review commit: https://reviewboard.mozilla.org/r/130834/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/130834/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 5,
                "quote": "Review commit: https://reviewboard.mozilla.org/r/130836/diff/#index_header See other reviews: https://reviewboard.mozilla.org/r/130836/",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/130832/diff/1-2/",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 7,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/130834/diff/1-2/",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 8,
                "quote": "Review request updated; see interdiff: https://reviewboard.mozilla.org/r/130836/diff/1-2/",
                "code": "CODE_REVIEW_REQUEST"
            },
            {
                "annotation_id": 9,
                "quote": "https://reviewboard.mozilla.org/r/130832/#review133794",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 10,
                "quote": "https://reviewboard.mozilla.org/r/130834/#review133802",
                "code": "CODE_REVIEW"
            },
            {
                "annotation_id": 11,
                "quote": "https://reviewboard.mozilla.org/r/130836/#review133804",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=866470",
        "issue_id": 866470,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Can you take a look please?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 2,
                "quote": "Matt, can you get the ball rolling on this please?",
                "code": "PROBLEM_REVIEW_REQUEST"
            },
            {
                "annotation_id": 3,
                "quote": "Bit of a guess, but that's the only reason I can see why they might come up with different results.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=861246",
        "issue_id": 861246,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Fix IPC for fixed layer margins \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Looks good, thanks for catching this Chris!",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=642412",
        "issue_id": 642412,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "I started analyzing pbkdf2. According to Shark we spend at least 8% in stubs::SetElem. Most of the time is spent inside sjcl.hash.sha256.prototype.C. This function has many setelem's, the most important one is inside the loop, something like this: b = d[a & 15] = (int + int) | 0; Type inference output: #35:00285: zero type 0: int #35:00286: bitor type 0: int #35:00287: setelem type 0: int monitored I think this is bug 621937 (JM not generating IC's for monitored setelem)",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 2,
                "quote": "This is a beautified, single-file version of stanford-crypto-pbkdf2.",
                "code": "PROBLEM_REVIEW"
            },
            {
                "annotation_id": 3,
                "quote": "Brian, the type information for function C (line 344) is really bad. I'm not sure why but the type of all locals, arg and this is all \"unknown\".",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 4,
                "quote": "Better type information may get rid of the monitored setelem and is needed to make this benchmark fast.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 5,
                "quote": "First step, assume that arithmetic involving objects produces integers (rather than unknown values), monitor double/string/XML results dynamically. http://hg.mozilla.org/projects/jaegermonkey/rev/897c257e5405",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 6,
                "quote": "Several fixes to inference precision. These mostly fall into the category of not overapproximating to capture the behavior of an unlikely event (calling a non-function, indexing an object with a non-integer), but waiting for it to happen dynamically. http://hg.mozilla.org/projects/jaegermonkey/rev/a900619f0e04 http://hg.mozilla.org/projects/jaegermonkey/rev/bff02e9994e3 http://hg.mozilla.org/projects/jaegermonkey/rev/ac5f63354ab2 http://hg.mozilla.org/projects/jaegermonkey/rev/b48f1d51c6f5 There is still some imprecision because of a few accesses to Math which are JSOP_NAME rather than GNAME. That can be fixed similarly to how we do monitored SETNAME/SETPROP, will file separately. For now adding '| 0' to the calls to Math.round and Math.floor should fix precision. I get these times: JM+TI (old): 691 JM+TI (new): 438 JM: 474 JM+TM: 345 V8: 229 Looking at shark, JM seems to be getting killed by the slow paths it takes for the '(...) | 0' operations in C's inner loop. We try to branchTruncateToInt32 on these, but on average about 1.5 times per iteration this truncation fails (the double does not fit in an int32) and we take I think a very expensive slow path. We could instead call an infallible native like the tracer does, but to get to V8's performance I think we should instead generate inline code which is good enough to capture the large finite doubles being truncated here.",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 7,
                "quote": "The patch in bug 643037 fixes the truncate-double paths and brings the JM+TI time down to 361 (still with the modification to the Math calls). Other things that should help: 1. Know that 'a' is an integer within the loop in the C function. It is initially an array but is then reused as an integer. Could use SSA-style techniques to add some flow sensitivity to let the inference distinguish its uses, or (probably better) make a Crankshaft-style speculation it is an integer within the loop body and hoist a check to the loop header. This is worth about 20ms (easy to test by hand). 2. Hoist array bounds checks and LICM the slots pointer computation on the 'd' array. 3. Regalloc tuning on the loop, get another GPR (heavy register pressure here). 4. Typed natives or inline code for various Array natives. Shark thinks we spend a decent amount of time in these.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 8,
                "quote": "Get precise type information for the results of JSOP_NAME/JSOP_CALLNAME (358ms on the unmodified test). http://hg.mozilla.org/projects/jaegermonkey/rev/9ee17aa5f938 This exposed an existing bug in the recompilation mechanism, where we would convert integer slots to doubles even if the recompiled code knew they were integers. The FrameState can be either more or less precise than the inferred types, and we only require args/locals inferred as int|double to be doubles at join points (the revised algorithm only uses the FrameState, not the inferred types, to figure out what needs repatching, and is a good deal cleaner). http://hg.mozilla.org/projects/jaegermonkey/rev/7154281e487b",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 9,
                "quote": "We're still slower than V8 on these tests but the info in this bug is unlikely to help much.",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=695213",
        "issue_id": 695213,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This is nice to have.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=674609",
        "issue_id": 674609,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "About 1/2 to 2/3 of this overhead is the extra 2 byte tag on each property access indexing into the observed type sets for the script, the rest is an increase in sizeof(JSScript) by five words.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            },
            {
                "annotation_id": 2,
                "quote": "The property access overhead can be eliminated either by doing a binary search for the type set on each property access in the interpreter or by requiring all interpreted scripts to have gone through bytecode analysis, which can index the type sets in storage that will be wiped out on GC. Inclined to go with the latter here. The sizeof(JSScript) increase can be reduced to two words, by combining two of the fields into a union (function and global, as the global can be determined from the script's function) and moving the others into a now-heap-allocated TypeScript.",
                "code": "POTENTIAL_SOLUTION_DESIGN"
            },
            {
                "annotation_id": 3,
                "quote": "Remove the two byte typeset tag following every property read and call op, and require analysis of the bytecode in such scripts when they are interpreted (should be cheap to do, need to see how it affects the inference-pools memory). Refactor TypeScript to be heap-allocated rather than embedded in JSScript, and reduce the size of JSScript by three words. This patch touches a lot of code outside of inference in simple ways, should just need to be skimmed for review.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=626855",
        "issue_id": 626855,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Crash: trying to scroll HTML page with frameset \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Layers were not properly getting their scroll IDs updated if there is no root scroll pane for a presshell. This happens for <framesets> at least.",
                "code": "PROBLEM_CAUSE_IDENTIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=590389",
        "issue_id": 590389,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch fix \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1079321",
        "issue_id": 1079321,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch Patch (v1) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1221593",
        "issue_id": 1221593,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "These are the changes asked for in your previous review. They got pushed to try but they got lost somewhere along the way.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=660762",
        "issue_id": 660762,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch patch (obsolete) \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "Review of attachment 536539 [details] [diff] [review]:",
                "code": "CODE_REVIEW"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=623742",
        "issue_id": 623742,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Attached patch v1 \u2014 Details \u2014 Splinter Review",
                "code": "CODE_IMPLEMENTATION"
            },
            {
                "annotation_id": 2,
                "quote": "verified with 1.6.2",
                "code": "SOLUTION_VERIFICATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=712870",
        "issue_id": 712870,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "Skia code will not able to compile for MacPPC and Android-x86 (and Windows/arm).",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    },
    {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=600489",
        "issue_id": 600489,
        "annotations": [
            {
                "annotation_id": 1,
                "quote": "This patch adds label() to handle this.",
                "code": "CODE_IMPLEMENTATION"
            }
        ]
    }
]